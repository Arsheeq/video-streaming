function I_(s,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in s)){const o=Object.getOwnPropertyDescriptor(n,r);o&&Object.defineProperty(s,r,o.get?o:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function NS(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var hh={exports:{}},bo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ox;function O_(){if(ox)return bo;ox=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,o){var l=null;if(o!==void 0&&(l=""+o),r.key!==void 0&&(l=""+r.key),"key"in r){o={};for(var u in r)u!=="key"&&(o[u]=r[u])}else o=r;return r=o.ref,{$$typeof:s,type:n,key:l,ref:r!==void 0?r:null,props:o}}return bo.Fragment=e,bo.jsx=t,bo.jsxs=t,bo}var lx;function M_(){return lx||(lx=1,hh.exports=O_()),hh.exports}var T=M_(),mh={exports:{}},Ao={},gh={exports:{}},ph={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cx;function N_(){return cx||(cx=1,(function(s){function e(P,F){var U=P.length;P.push(F);e:for(;0<U;){var Y=U-1>>>1,le=P[Y];if(0<r(le,F))P[Y]=F,P[U]=le,U=Y;else break e}}function t(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var F=P[0],U=P.pop();if(U!==F){P[0]=U;e:for(var Y=0,le=P.length,N=le>>>1;Y<N;){var H=2*(Y+1)-1,J=P[H],se=H+1,de=P[se];if(0>r(J,U))se<le&&0>r(de,J)?(P[Y]=de,P[se]=U,Y=se):(P[Y]=J,P[H]=U,Y=H);else if(se<le&&0>r(de,U))P[Y]=de,P[se]=U,Y=se;else break e}}return F}function r(P,F){var U=P.sortIndex-F.sortIndex;return U!==0?U:P.id-F.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();s.unstable_now=function(){return l.now()-u}}var f=[],d=[],m=1,g=null,y=3,x=!1,E=!1,S=!1,b=!1,R=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function D(P){for(var F=t(d);F!==null;){if(F.callback===null)n(d);else if(F.startTime<=P)n(d),F.sortIndex=F.expirationTime,e(f,F);else break;F=t(d)}}function M(P){if(S=!1,D(P),!E)if(t(f)!==null)E=!0,$||($=!0,ne());else{var F=t(d);F!==null&&ae(M,F.startTime-P)}}var $=!1,O=-1,k=5,G=-1;function B(){return b?!0:!(s.unstable_now()-G<k)}function K(){if(b=!1,$){var P=s.unstable_now();G=P;var F=!0;try{e:{E=!1,S&&(S=!1,w(O),O=-1),x=!0;var U=y;try{t:{for(D(P),g=t(f);g!==null&&!(g.expirationTime>P&&B());){var Y=g.callback;if(typeof Y=="function"){g.callback=null,y=g.priorityLevel;var le=Y(g.expirationTime<=P);if(P=s.unstable_now(),typeof le=="function"){g.callback=le,D(P),F=!0;break t}g===t(f)&&n(f),D(P)}else n(f);g=t(f)}if(g!==null)F=!0;else{var N=t(d);N!==null&&ae(M,N.startTime-P),F=!1}}break e}finally{g=null,y=U,x=!1}F=void 0}}finally{F?ne():$=!1}}}var ne;if(typeof _=="function")ne=function(){_(K)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,ee=ue.port2;ue.port1.onmessage=K,ne=function(){ee.postMessage(null)}}else ne=function(){R(K,0)};function ae(P,F){O=R(function(){P(s.unstable_now())},F)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(P){P.callback=null},s.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<P?Math.floor(1e3/P):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_next=function(P){switch(y){case 1:case 2:case 3:var F=3;break;default:F=y}var U=y;y=F;try{return P()}finally{y=U}},s.unstable_requestPaint=function(){b=!0},s.unstable_runWithPriority=function(P,F){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var U=y;y=P;try{return F()}finally{y=U}},s.unstable_scheduleCallback=function(P,F,U){var Y=s.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?Y+U:Y):U=Y,P){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=U+le,P={id:m++,callback:F,priorityLevel:P,startTime:U,expirationTime:le,sortIndex:-1},U>Y?(P.sortIndex=U,e(d,P),t(f)===null&&P===t(d)&&(S?(w(O),O=-1):S=!0,ae(M,U-Y))):(P.sortIndex=le,e(f,P),E||x||(E=!0,$||($=!0,ne()))),P},s.unstable_shouldYield=B,s.unstable_wrapCallback=function(P){var F=y;return function(){var U=y;y=F;try{return P.apply(this,arguments)}finally{y=U}}}})(ph)),ph}var ux;function k_(){return ux||(ux=1,gh.exports=N_()),gh.exports}var yh={exports:{}},Re={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dx;function P_(){if(dx)return Re;dx=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),y=Symbol.iterator;function x(N){return N===null||typeof N!="object"?null:(N=y&&N[y]||N["@@iterator"],typeof N=="function"?N:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,b={};function R(N,H,J){this.props=N,this.context=H,this.refs=b,this.updater=J||E}R.prototype.isReactComponent={},R.prototype.setState=function(N,H){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,H,"setState")},R.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function w(){}w.prototype=R.prototype;function _(N,H,J){this.props=N,this.context=H,this.refs=b,this.updater=J||E}var D=_.prototype=new w;D.constructor=_,S(D,R.prototype),D.isPureReactComponent=!0;var M=Array.isArray;function $(){}var O={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function G(N,H,J){var se=J.ref;return{$$typeof:s,type:N,key:H,ref:se!==void 0?se:null,props:J}}function B(N,H){return G(N.type,H,N.props)}function K(N){return typeof N=="object"&&N!==null&&N.$$typeof===s}function ne(N){var H={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(J){return H[J]})}var ue=/\/+/g;function ee(N,H){return typeof N=="object"&&N!==null&&N.key!=null?ne(""+N.key):H.toString(36)}function ae(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then($,$):(N.status="pending",N.then(function(H){N.status==="pending"&&(N.status="fulfilled",N.value=H)},function(H){N.status==="pending"&&(N.status="rejected",N.reason=H)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function P(N,H,J,se,de){var fe=typeof N;(fe==="undefined"||fe==="boolean")&&(N=null);var he=!1;if(N===null)he=!0;else switch(fe){case"bigint":case"string":case"number":he=!0;break;case"object":switch(N.$$typeof){case s:case e:he=!0;break;case m:return he=N._init,P(he(N._payload),H,J,se,de)}}if(he)return de=de(N),he=se===""?"."+ee(N,0):se,M(de)?(J="",he!=null&&(J=he.replace(ue,"$&/")+"/"),P(de,H,J,"",function(at){return at})):de!=null&&(K(de)&&(de=B(de,J+(de.key==null||N&&N.key===de.key?"":(""+de.key).replace(ue,"$&/")+"/")+he)),H.push(de)),1;he=0;var Le=se===""?".":se+":";if(M(N))for(var _e=0;_e<N.length;_e++)se=N[_e],fe=Le+ee(se,_e),he+=P(se,H,J,fe,de);else if(_e=x(N),typeof _e=="function")for(N=_e.call(N),_e=0;!(se=N.next()).done;)se=se.value,fe=Le+ee(se,_e++),he+=P(se,H,J,fe,de);else if(fe==="object"){if(typeof N.then=="function")return P(ae(N),H,J,se,de);throw H=String(N),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return he}function F(N,H,J){if(N==null)return N;var se=[],de=0;return P(N,se,"","",function(fe){return H.call(J,fe,de++)}),se}function U(N){if(N._status===-1){var H=N._result;H=H(),H.then(function(J){(N._status===0||N._status===-1)&&(N._status=1,N._result=J)},function(J){(N._status===0||N._status===-1)&&(N._status=2,N._result=J)}),N._status===-1&&(N._status=0,N._result=H)}if(N._status===1)return N._result.default;throw N._result}var Y=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)},le={map:F,forEach:function(N,H,J){F(N,function(){H.apply(this,arguments)},J)},count:function(N){var H=0;return F(N,function(){H++}),H},toArray:function(N){return F(N,function(H){return H})||[]},only:function(N){if(!K(N))throw Error("React.Children.only expected to receive a single React element child.");return N}};return Re.Activity=g,Re.Children=le,Re.Component=R,Re.Fragment=t,Re.Profiler=r,Re.PureComponent=_,Re.StrictMode=n,Re.Suspense=f,Re.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Re.__COMPILER_RUNTIME={__proto__:null,c:function(N){return O.H.useMemoCache(N)}},Re.cache=function(N){return function(){return N.apply(null,arguments)}},Re.cacheSignal=function(){return null},Re.cloneElement=function(N,H,J){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var se=S({},N.props),de=N.key;if(H!=null)for(fe in H.key!==void 0&&(de=""+H.key),H)!k.call(H,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&H.ref===void 0||(se[fe]=H[fe]);var fe=arguments.length-2;if(fe===1)se.children=J;else if(1<fe){for(var he=Array(fe),Le=0;Le<fe;Le++)he[Le]=arguments[Le+2];se.children=he}return G(N.type,de,se)},Re.createContext=function(N){return N={$$typeof:l,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:o,_context:N},N},Re.createElement=function(N,H,J){var se,de={},fe=null;if(H!=null)for(se in H.key!==void 0&&(fe=""+H.key),H)k.call(H,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(de[se]=H[se]);var he=arguments.length-2;if(he===1)de.children=J;else if(1<he){for(var Le=Array(he),_e=0;_e<he;_e++)Le[_e]=arguments[_e+2];de.children=Le}if(N&&N.defaultProps)for(se in he=N.defaultProps,he)de[se]===void 0&&(de[se]=he[se]);return G(N,fe,de)},Re.createRef=function(){return{current:null}},Re.forwardRef=function(N){return{$$typeof:u,render:N}},Re.isValidElement=K,Re.lazy=function(N){return{$$typeof:m,_payload:{_status:-1,_result:N},_init:U}},Re.memo=function(N,H){return{$$typeof:d,type:N,compare:H===void 0?null:H}},Re.startTransition=function(N){var H=O.T,J={};O.T=J;try{var se=N(),de=O.S;de!==null&&de(J,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then($,Y)}catch(fe){Y(fe)}finally{H!==null&&J.types!==null&&(H.types=J.types),O.T=H}},Re.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Re.use=function(N){return O.H.use(N)},Re.useActionState=function(N,H,J){return O.H.useActionState(N,H,J)},Re.useCallback=function(N,H){return O.H.useCallback(N,H)},Re.useContext=function(N){return O.H.useContext(N)},Re.useDebugValue=function(){},Re.useDeferredValue=function(N,H){return O.H.useDeferredValue(N,H)},Re.useEffect=function(N,H){return O.H.useEffect(N,H)},Re.useEffectEvent=function(N){return O.H.useEffectEvent(N)},Re.useId=function(){return O.H.useId()},Re.useImperativeHandle=function(N,H,J){return O.H.useImperativeHandle(N,H,J)},Re.useInsertionEffect=function(N,H){return O.H.useInsertionEffect(N,H)},Re.useLayoutEffect=function(N,H){return O.H.useLayoutEffect(N,H)},Re.useMemo=function(N,H){return O.H.useMemo(N,H)},Re.useOptimistic=function(N,H){return O.H.useOptimistic(N,H)},Re.useReducer=function(N,H,J){return O.H.useReducer(N,H,J)},Re.useRef=function(N){return O.H.useRef(N)},Re.useState=function(N){return O.H.useState(N)},Re.useSyncExternalStore=function(N,H,J){return O.H.useSyncExternalStore(N,H,J)},Re.useTransition=function(){return O.H.useTransition()},Re.version="19.2.0",Re}var fx;function Du(){return fx||(fx=1,yh.exports=P_()),yh.exports}var vh={exports:{}},$t={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hx;function F_(){if(hx)return $t;hx=1;var s=Du();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(f,d,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:f,containerInfo:d,implementation:m}}var l=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return $t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,$t.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(f,d,null,m)},$t.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},$t.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},$t.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},$t.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,g=u(m,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,x=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:x}):m==="script"&&n.d.X(f,{crossOrigin:g,integrity:y,fetchPriority:x,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},$t.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},$t.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,g=u(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},$t.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},$t.requestFormReset=function(f){n.d.r(f)},$t.unstable_batchedUpdates=function(f,d){return f(d)},$t.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},$t.useFormStatus=function(){return l.H.useHostTransitionStatus()},$t.version="19.2.0",$t}var mx;function kS(){if(mx)return vh.exports;mx=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),vh.exports=F_(),vh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gx;function U_(){if(gx)return Ao;gx=1;var s=k_(),e=Du(),t=kS();function n(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var a=i,c=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(c=a.return),i=a.return;while(i)}return a.tag===3?c:null}function l(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function u(i){if(i.tag===31){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(n(188))}function d(i){var a=i.alternate;if(!a){if(a=o(i),a===null)throw Error(n(188));return a!==i?null:i}for(var c=i,h=a;;){var p=c.return;if(p===null)break;var v=p.alternate;if(v===null){if(h=p.return,h!==null){c=h;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===c)return f(p),i;if(v===h)return f(p),a;v=v.sibling}throw Error(n(188))}if(c.return!==h.return)c=p,h=v;else{for(var L=!1,I=p.child;I;){if(I===c){L=!0,c=p,h=v;break}if(I===h){L=!0,h=p,c=v;break}I=I.sibling}if(!L){for(I=v.child;I;){if(I===c){L=!0,c=v,h=p;break}if(I===h){L=!0,h=v,c=p;break}I=I.sibling}if(!L)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:a}function m(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=m(i),a!==null)return a;i=i.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),_=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function ne(i){return i===null||typeof i!="object"?null:(i=K&&i[K]||i["@@iterator"],typeof i=="function"?i:null)}var ue=Symbol.for("react.client.reference");function ee(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===ue?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case S:return"Fragment";case R:return"Profiler";case b:return"StrictMode";case M:return"Suspense";case $:return"SuspenseList";case G:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case _:return i.displayName||"Context";case w:return(i._context.displayName||"Context")+".Consumer";case D:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case O:return a=i.displayName||null,a!==null?a:ee(i.type)||"Memo";case k:a=i._payload,i=i._init;try{return ee(i(a))}catch{}}return null}var ae=Array.isArray,P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},Y=[],le=-1;function N(i){return{current:i}}function H(i){0>le||(i.current=Y[le],Y[le]=null,le--)}function J(i,a){le++,Y[le]=i.current,i.current=a}var se=N(null),de=N(null),fe=N(null),he=N(null);function Le(i,a){switch(J(fe,a),J(de,i),J(se,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?Dv(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=Dv(a),i=Iv(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}H(se),J(se,i)}function _e(){H(se),H(de),H(fe)}function at(i){i.memoizedState!==null&&J(he,i);var a=se.current,c=Iv(a,i.type);a!==c&&(J(de,i),J(se,c))}function Rt(i){de.current===i&&(H(se),H(de)),he.current===i&&(H(he),xo._currentValue=U)}var bn,Fn;function Un(i){if(bn===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);bn=a&&a[1]||"",Fn=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+bn+i+Fn}var sl=!1;function Pe(i,a){if(!i||sl)return"";sl=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(a){var ce=function(){throw Error()};if(Object.defineProperty(ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ce,[])}catch(te){var Z=te}Reflect.construct(i,[],ce)}else{try{ce.call()}catch(te){Z=te}i.call(ce.prototype)}}else{try{throw Error()}catch(te){Z=te}(ce=i())&&typeof ce.catch=="function"&&ce.catch(function(){})}}catch(te){if(te&&Z&&typeof te.stack=="string")return[te.stack,Z.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=h.DetermineComponentFrameRoot(),L=v[0],I=v[1];if(L&&I){var j=L.split(`
`),Q=I.split(`
`);for(p=h=0;h<j.length&&!j[h].includes("DetermineComponentFrameRoot");)h++;for(;p<Q.length&&!Q[p].includes("DetermineComponentFrameRoot");)p++;if(h===j.length||p===Q.length)for(h=j.length-1,p=Q.length-1;1<=h&&0<=p&&j[h]!==Q[p];)p--;for(;1<=h&&0<=p;h--,p--)if(j[h]!==Q[p]){if(h!==1||p!==1)do if(h--,p--,0>p||j[h]!==Q[p]){var ie=`
`+j[h].replace(" at new "," at ");return i.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",i.displayName)),ie}while(1<=h&&0<=p);break}}}finally{sl=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?Un(c):""}function Lt(i,a){switch(i.tag){case 26:case 27:case 5:return Un(i.type);case 16:return Un("Lazy");case 13:return i.child!==a&&a!==null?Un("Suspense Fallback"):Un("Suspense");case 19:return Un("SuspenseList");case 0:case 15:return Pe(i.type,!1);case 11:return Pe(i.type.render,!1);case 1:return Pe(i.type,!0);case 31:return Un("Activity");default:return""}}function jt(i){try{var a="",c=null;do a+=Lt(i,c),c=i,i=i.return;while(i);return a}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Bn=Object.prototype.hasOwnProperty,Gt=s.unstable_scheduleCallback,Xn=s.unstable_cancelCallback,ys=s.unstable_shouldYield,il=s.unstable_requestPaint,Ct=s.unstable_now,rl=s.unstable_getCurrentPriorityLevel,Ys=s.unstable_ImmediatePriority,_a=s.unstable_UserBlockingPriority,lr=s.unstable_NormalPriority,al=s.unstable_LowPriority,wa=s.unstable_IdlePriority,Oi=s.log,mL=s.unstable_setDisableYieldValue,Da=null,an=null;function qs(i){if(typeof Oi=="function"&&mL(i),an&&typeof an.setStrictMode=="function")try{an.setStrictMode(Da,i)}catch{}}var on=Math.clz32?Math.clz32:yL,gL=Math.log,pL=Math.LN2;function yL(i){return i>>>=0,i===0?32:31-(gL(i)/pL|0)|0}var ol=256,ll=262144,cl=4194304;function Mi(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ul(i,a,c){var h=i.pendingLanes;if(h===0)return 0;var p=0,v=i.suspendedLanes,L=i.pingedLanes;i=i.warmLanes;var I=h&134217727;return I!==0?(h=I&~v,h!==0?p=Mi(h):(L&=I,L!==0?p=Mi(L):c||(c=I&~i,c!==0&&(p=Mi(c))))):(I=h&~v,I!==0?p=Mi(I):L!==0?p=Mi(L):c||(c=h&~i,c!==0&&(p=Mi(c)))),p===0?0:a!==0&&a!==p&&(a&v)===0&&(v=p&-p,c=a&-a,v>=c||v===32&&(c&4194048)!==0)?a:p}function Ia(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function vL(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dp(){var i=cl;return cl<<=1,(cl&62914560)===0&&(cl=4194304),i}function ed(i){for(var a=[],c=0;31>c;c++)a.push(i);return a}function Oa(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function xL(i,a,c,h,p,v){var L=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var I=i.entanglements,j=i.expirationTimes,Q=i.hiddenUpdates;for(c=L&~c;0<c;){var ie=31-on(c),ce=1<<ie;I[ie]=0,j[ie]=-1;var Z=Q[ie];if(Z!==null)for(Q[ie]=null,ie=0;ie<Z.length;ie++){var te=Z[ie];te!==null&&(te.lane&=-536870913)}c&=~ce}h!==0&&fp(i,h,0),v!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=v&~(L&~a))}function fp(i,a,c){i.pendingLanes|=a,i.suspendedLanes&=~a;var h=31-on(a);i.entangledLanes|=a,i.entanglements[h]=i.entanglements[h]|1073741824|c&261930}function hp(i,a){var c=i.entangledLanes|=a;for(i=i.entanglements;c;){var h=31-on(c),p=1<<h;p&a|i[h]&a&&(i[h]|=a),c&=~p}}function mp(i,a){var c=a&-a;return c=(c&42)!==0?1:td(c),(c&(i.suspendedLanes|a))!==0?0:c}function td(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function nd(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function gp(){var i=F.p;return i!==0?i:(i=window.event,i===void 0?32:ex(i.type))}function pp(i,a){var c=F.p;try{return F.p=i,a()}finally{F.p=c}}var Xs=Math.random().toString(36).slice(2),It="__reactFiber$"+Xs,Xt="__reactProps$"+Xs,cr="__reactContainer$"+Xs,sd="__reactEvents$"+Xs,EL="__reactListeners$"+Xs,SL="__reactHandles$"+Xs,yp="__reactResources$"+Xs,Ma="__reactMarker$"+Xs;function id(i){delete i[It],delete i[Xt],delete i[sd],delete i[EL],delete i[SL]}function ur(i){var a=i[It];if(a)return a;for(var c=i.parentNode;c;){if(a=c[cr]||c[It]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(i=Uv(i);i!==null;){if(c=i[It])return c;i=Uv(i)}return a}i=c,c=i.parentNode}return null}function dr(i){if(i=i[It]||i[cr]){var a=i.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return i}return null}function Na(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(n(33))}function fr(i){var a=i[yp];return a||(a=i[yp]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function _t(i){i[Ma]=!0}var vp=new Set,xp={};function Ni(i,a){hr(i,a),hr(i+"Capture",a)}function hr(i,a){for(xp[i]=a,i=0;i<a.length;i++)vp.add(a[i])}var TL=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ep={},Sp={};function bL(i){return Bn.call(Sp,i)?!0:Bn.call(Ep,i)?!1:TL.test(i)?Sp[i]=!0:(Ep[i]=!0,!1)}function dl(i,a,c){if(bL(a))if(c===null)i.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var h=a.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+c)}}function fl(i,a,c){if(c===null)i.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+c)}}function vs(i,a,c,h){if(h===null)i.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(a,c,""+h)}}function An(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Tp(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function AL(i,a,c){var h=Object.getOwnPropertyDescriptor(i.constructor.prototype,a);if(!i.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var p=h.get,v=h.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return p.call(this)},set:function(L){c=""+L,v.call(this,L)}}),Object.defineProperty(i,a,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(L){c=""+L},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function rd(i){if(!i._valueTracker){var a=Tp(i)?"checked":"value";i._valueTracker=AL(i,a,""+i[a])}}function bp(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var c=a.getValue(),h="";return i&&(h=Tp(i)?i.checked?"true":"false":i.value),i=h,i!==c?(a.setValue(i),!0):!1}function hl(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var RL=/[\n"\\]/g;function Rn(i){return i.replace(RL,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ad(i,a,c,h,p,v,L,I){i.name="",L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?i.type=L:i.removeAttribute("type"),a!=null?L==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+An(a)):i.value!==""+An(a)&&(i.value=""+An(a)):L!=="submit"&&L!=="reset"||i.removeAttribute("value"),a!=null?od(i,L,An(a)):c!=null?od(i,L,An(c)):h!=null&&i.removeAttribute("value"),p==null&&v!=null&&(i.defaultChecked=!!v),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?i.name=""+An(I):i.removeAttribute("name")}function Ap(i,a,c,h,p,v,L,I){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(i.type=v),a!=null||c!=null){if(!(v!=="submit"&&v!=="reset"||a!=null)){rd(i);return}c=c!=null?""+An(c):"",a=a!=null?""+An(a):c,I||a===i.value||(i.value=a),i.defaultValue=a}h=h??p,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=I?i.checked:!!h,i.defaultChecked=!!h,L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(i.name=L),rd(i)}function od(i,a,c){a==="number"&&hl(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function mr(i,a,c,h){if(i=i.options,a){a={};for(var p=0;p<c.length;p++)a["$"+c[p]]=!0;for(c=0;c<i.length;c++)p=a.hasOwnProperty("$"+i[c].value),i[c].selected!==p&&(i[c].selected=p),p&&h&&(i[c].defaultSelected=!0)}else{for(c=""+An(c),a=null,p=0;p<i.length;p++){if(i[p].value===c){i[p].selected=!0,h&&(i[p].defaultSelected=!0);return}a!==null||i[p].disabled||(a=i[p])}a!==null&&(a.selected=!0)}}function Rp(i,a,c){if(a!=null&&(a=""+An(a),a!==i.value&&(i.value=a),c==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=c!=null?""+An(c):""}function Lp(i,a,c,h){if(a==null){if(h!=null){if(c!=null)throw Error(n(92));if(ae(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),a=c}c=An(a),i.defaultValue=c,h=i.textContent,h===c&&h!==""&&h!==null&&(i.value=h),rd(i)}function gr(i,a){if(a){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=a;return}}i.textContent=a}var LL=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Cp(i,a,c){var h=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":h?i.setProperty(a,c):typeof c!="number"||c===0||LL.has(a)?a==="float"?i.cssFloat=c:i[a]=(""+c).trim():i[a]=c+"px"}function _p(i,a,c){if(a!=null&&typeof a!="object")throw Error(n(62));if(i=i.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||a!=null&&a.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var p in a)h=a[p],a.hasOwnProperty(p)&&c[p]!==h&&Cp(i,p,h)}else for(var v in a)a.hasOwnProperty(v)&&Cp(i,v,a[v])}function ld(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var CL=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_L=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ml(i){return _L.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function xs(){}var cd=null;function ud(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var pr=null,yr=null;function wp(i){var a=dr(i);if(a&&(i=a.stateNode)){var c=i[Xt]||null;e:switch(i=a.stateNode,a.type){case"input":if(ad(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Rn(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var h=c[a];if(h!==i&&h.form===i.form){var p=h[Xt]||null;if(!p)throw Error(n(90));ad(h,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(a=0;a<c.length;a++)h=c[a],h.form===i.form&&bp(h)}break e;case"textarea":Rp(i,c.value,c.defaultValue);break e;case"select":a=c.value,a!=null&&mr(i,!!c.multiple,a,!1)}}}var dd=!1;function Dp(i,a,c){if(dd)return i(a,c);dd=!0;try{var h=i(a);return h}finally{if(dd=!1,(pr!==null||yr!==null)&&(tc(),pr&&(a=pr,i=yr,yr=pr=null,wp(a),i)))for(a=0;a<i.length;a++)wp(i[a])}}function ka(i,a){var c=i.stateNode;if(c===null)return null;var h=c[Xt]||null;if(h===null)return null;c=h[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,a,typeof c));return c}var Es=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fd=!1;if(Es)try{var Pa={};Object.defineProperty(Pa,"passive",{get:function(){fd=!0}}),window.addEventListener("test",Pa,Pa),window.removeEventListener("test",Pa,Pa)}catch{fd=!1}var Ws=null,hd=null,gl=null;function Ip(){if(gl)return gl;var i,a=hd,c=a.length,h,p="value"in Ws?Ws.value:Ws.textContent,v=p.length;for(i=0;i<c&&a[i]===p[i];i++);var L=c-i;for(h=1;h<=L&&a[c-h]===p[v-h];h++);return gl=p.slice(i,1<h?1-h:void 0)}function pl(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function yl(){return!0}function Op(){return!1}function Wt(i){function a(c,h,p,v,L){this._reactName=c,this._targetInst=p,this.type=h,this.nativeEvent=v,this.target=L,this.currentTarget=null;for(var I in i)i.hasOwnProperty(I)&&(c=i[I],this[I]=c?c(v):v[I]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?yl:Op,this.isPropagationStopped=Op,this}return g(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=yl)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=yl)},persist:function(){},isPersistent:yl}),a}var ki={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vl=Wt(ki),Fa=g({},ki,{view:0,detail:0}),wL=Wt(Fa),md,gd,Ua,xl=g({},Fa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yd,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ua&&(Ua&&i.type==="mousemove"?(md=i.screenX-Ua.screenX,gd=i.screenY-Ua.screenY):gd=md=0,Ua=i),md)},movementY:function(i){return"movementY"in i?i.movementY:gd}}),Mp=Wt(xl),DL=g({},xl,{dataTransfer:0}),IL=Wt(DL),OL=g({},Fa,{relatedTarget:0}),pd=Wt(OL),ML=g({},ki,{animationName:0,elapsedTime:0,pseudoElement:0}),NL=Wt(ML),kL=g({},ki,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),PL=Wt(kL),FL=g({},ki,{data:0}),Np=Wt(FL),UL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$L={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jL(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=$L[i])?!!a[i]:!1}function yd(){return jL}var GL=g({},Fa,{key:function(i){if(i.key){var a=UL[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=pl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?BL[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yd,charCode:function(i){return i.type==="keypress"?pl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?pl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),HL=Wt(GL),VL=g({},xl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kp=Wt(VL),KL=g({},Fa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yd}),zL=Wt(KL),YL=g({},ki,{propertyName:0,elapsedTime:0,pseudoElement:0}),qL=Wt(YL),XL=g({},xl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),WL=Wt(XL),QL=g({},ki,{newState:0,oldState:0}),ZL=Wt(QL),JL=[9,13,27,32],vd=Es&&"CompositionEvent"in window,Ba=null;Es&&"documentMode"in document&&(Ba=document.documentMode);var eC=Es&&"TextEvent"in window&&!Ba,Pp=Es&&(!vd||Ba&&8<Ba&&11>=Ba),Fp=" ",Up=!1;function Bp(i,a){switch(i){case"keyup":return JL.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $p(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var vr=!1;function tC(i,a){switch(i){case"compositionend":return $p(a);case"keypress":return a.which!==32?null:(Up=!0,Fp);case"textInput":return i=a.data,i===Fp&&Up?null:i;default:return null}}function nC(i,a){if(vr)return i==="compositionend"||!vd&&Bp(i,a)?(i=Ip(),gl=hd=Ws=null,vr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Pp&&a.locale!=="ko"?null:a.data;default:return null}}var sC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jp(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!sC[i.type]:a==="textarea"}function Gp(i,a,c,h){pr?yr?yr.push(h):yr=[h]:pr=h,a=lc(a,"onChange"),0<a.length&&(c=new vl("onChange","change",null,c,h),i.push({event:c,listeners:a}))}var $a=null,ja=null;function iC(i){Av(i,0)}function El(i){var a=Na(i);if(bp(a))return i}function Hp(i,a){if(i==="change")return a}var Vp=!1;if(Es){var xd;if(Es){var Ed="oninput"in document;if(!Ed){var Kp=document.createElement("div");Kp.setAttribute("oninput","return;"),Ed=typeof Kp.oninput=="function"}xd=Ed}else xd=!1;Vp=xd&&(!document.documentMode||9<document.documentMode)}function zp(){$a&&($a.detachEvent("onpropertychange",Yp),ja=$a=null)}function Yp(i){if(i.propertyName==="value"&&El(ja)){var a=[];Gp(a,ja,i,ud(i)),Dp(iC,a)}}function rC(i,a,c){i==="focusin"?(zp(),$a=a,ja=c,$a.attachEvent("onpropertychange",Yp)):i==="focusout"&&zp()}function aC(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return El(ja)}function oC(i,a){if(i==="click")return El(a)}function lC(i,a){if(i==="input"||i==="change")return El(a)}function cC(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var ln=typeof Object.is=="function"?Object.is:cC;function Ga(i,a){if(ln(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var c=Object.keys(i),h=Object.keys(a);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var p=c[h];if(!Bn.call(a,p)||!ln(i[p],a[p]))return!1}return!0}function qp(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Xp(i,a){var c=qp(i);i=0;for(var h;c;){if(c.nodeType===3){if(h=i+c.textContent.length,i<=a&&h>=a)return{node:c,offset:a-i};i=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=qp(c)}}function Wp(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?Wp(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function Qp(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=hl(i.document);a instanceof i.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)i=a.contentWindow;else break;a=hl(i.document)}return a}function Sd(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var uC=Es&&"documentMode"in document&&11>=document.documentMode,xr=null,Td=null,Ha=null,bd=!1;function Zp(i,a,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;bd||xr==null||xr!==hl(h)||(h=xr,"selectionStart"in h&&Sd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ha&&Ga(Ha,h)||(Ha=h,h=lc(Td,"onSelect"),0<h.length&&(a=new vl("onSelect","select",null,a,c),i.push({event:a,listeners:h}),a.target=xr)))}function Pi(i,a){var c={};return c[i.toLowerCase()]=a.toLowerCase(),c["Webkit"+i]="webkit"+a,c["Moz"+i]="moz"+a,c}var Er={animationend:Pi("Animation","AnimationEnd"),animationiteration:Pi("Animation","AnimationIteration"),animationstart:Pi("Animation","AnimationStart"),transitionrun:Pi("Transition","TransitionRun"),transitionstart:Pi("Transition","TransitionStart"),transitioncancel:Pi("Transition","TransitionCancel"),transitionend:Pi("Transition","TransitionEnd")},Ad={},Jp={};Es&&(Jp=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);function Fi(i){if(Ad[i])return Ad[i];if(!Er[i])return i;var a=Er[i],c;for(c in a)if(a.hasOwnProperty(c)&&c in Jp)return Ad[i]=a[c];return i}var e0=Fi("animationend"),t0=Fi("animationiteration"),n0=Fi("animationstart"),dC=Fi("transitionrun"),fC=Fi("transitionstart"),hC=Fi("transitioncancel"),s0=Fi("transitionend"),i0=new Map,Rd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rd.push("scrollEnd");function $n(i,a){i0.set(i,a),Ni(a,[i])}var Sl=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ln=[],Sr=0,Ld=0;function Tl(){for(var i=Sr,a=Ld=Sr=0;a<i;){var c=Ln[a];Ln[a++]=null;var h=Ln[a];Ln[a++]=null;var p=Ln[a];Ln[a++]=null;var v=Ln[a];if(Ln[a++]=null,h!==null&&p!==null){var L=h.pending;L===null?p.next=p:(p.next=L.next,L.next=p),h.pending=p}v!==0&&r0(c,p,v)}}function bl(i,a,c,h){Ln[Sr++]=i,Ln[Sr++]=a,Ln[Sr++]=c,Ln[Sr++]=h,Ld|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function Cd(i,a,c,h){return bl(i,a,c,h),Al(i)}function Ui(i,a){return bl(i,null,null,a),Al(i)}function r0(i,a,c){i.lanes|=c;var h=i.alternate;h!==null&&(h.lanes|=c);for(var p=!1,v=i.return;v!==null;)v.childLanes|=c,h=v.alternate,h!==null&&(h.childLanes|=c),v.tag===22&&(i=v.stateNode,i===null||i._visibility&1||(p=!0)),i=v,v=v.return;return i.tag===3?(v=i.stateNode,p&&a!==null&&(p=31-on(c),i=v.hiddenUpdates,h=i[p],h===null?i[p]=[a]:h.push(a),a.lane=c|536870912),v):null}function Al(i){if(50<fo)throw fo=0,Ff=null,Error(n(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var Tr={};function mC(i,a,c,h){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cn(i,a,c,h){return new mC(i,a,c,h)}function _d(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ss(i,a){var c=i.alternate;return c===null?(c=cn(i.tag,a,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=a,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,a=i.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function a0(i,a){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,a=c.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function Rl(i,a,c,h,p,v){var L=0;if(h=i,typeof i=="function")_d(i)&&(L=1);else if(typeof i=="string")L=x_(i,c,se.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case G:return i=cn(31,c,a,p),i.elementType=G,i.lanes=v,i;case S:return Bi(c.children,p,v,a);case b:L=8,p|=24;break;case R:return i=cn(12,c,a,p|2),i.elementType=R,i.lanes=v,i;case M:return i=cn(13,c,a,p),i.elementType=M,i.lanes=v,i;case $:return i=cn(19,c,a,p),i.elementType=$,i.lanes=v,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case _:L=10;break e;case w:L=9;break e;case D:L=11;break e;case O:L=14;break e;case k:L=16,h=null;break e}L=29,c=Error(n(130,i===null?"null":typeof i,"")),h=null}return a=cn(L,c,a,p),a.elementType=i,a.type=h,a.lanes=v,a}function Bi(i,a,c,h){return i=cn(7,i,h,a),i.lanes=c,i}function wd(i,a,c){return i=cn(6,i,null,a),i.lanes=c,i}function o0(i){var a=cn(18,null,null,0);return a.stateNode=i,a}function Dd(i,a,c){return a=cn(4,i.children!==null?i.children:[],i.key,a),a.lanes=c,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var l0=new WeakMap;function Cn(i,a){if(typeof i=="object"&&i!==null){var c=l0.get(i);return c!==void 0?c:(a={value:i,source:a,stack:jt(a)},l0.set(i,a),a)}return{value:i,source:a,stack:jt(a)}}var br=[],Ar=0,Ll=null,Va=0,_n=[],wn=0,Qs=null,Wn=1,Qn="";function Ts(i,a){br[Ar++]=Va,br[Ar++]=Ll,Ll=i,Va=a}function c0(i,a,c){_n[wn++]=Wn,_n[wn++]=Qn,_n[wn++]=Qs,Qs=i;var h=Wn;i=Qn;var p=32-on(h)-1;h&=~(1<<p),c+=1;var v=32-on(a)+p;if(30<v){var L=p-p%5;v=(h&(1<<L)-1).toString(32),h>>=L,p-=L,Wn=1<<32-on(a)+p|c<<p|h,Qn=v+i}else Wn=1<<v|c<<p|h,Qn=i}function Id(i){i.return!==null&&(Ts(i,1),c0(i,1,0))}function Od(i){for(;i===Ll;)Ll=br[--Ar],br[Ar]=null,Va=br[--Ar],br[Ar]=null;for(;i===Qs;)Qs=_n[--wn],_n[wn]=null,Qn=_n[--wn],_n[wn]=null,Wn=_n[--wn],_n[wn]=null}function u0(i,a){_n[wn++]=Wn,_n[wn++]=Qn,_n[wn++]=Qs,Wn=a.id,Qn=a.overflow,Qs=i}var Ot=null,st=null,Be=!1,Zs=null,Dn=!1,Md=Error(n(519));function Js(i){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ka(Cn(a,i)),Md}function d0(i){var a=i.stateNode,c=i.type,h=i.memoizedProps;switch(a[It]=i,a[Xt]=h,c){case"dialog":ke("cancel",a),ke("close",a);break;case"iframe":case"object":case"embed":ke("load",a);break;case"video":case"audio":for(c=0;c<mo.length;c++)ke(mo[c],a);break;case"source":ke("error",a);break;case"img":case"image":case"link":ke("error",a),ke("load",a);break;case"details":ke("toggle",a);break;case"input":ke("invalid",a),Ap(a,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":ke("invalid",a);break;case"textarea":ke("invalid",a),Lp(a,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||h.suppressHydrationWarning===!0||_v(a.textContent,c)?(h.popover!=null&&(ke("beforetoggle",a),ke("toggle",a)),h.onScroll!=null&&ke("scroll",a),h.onScrollEnd!=null&&ke("scrollend",a),h.onClick!=null&&(a.onclick=xs),a=!0):a=!1,a||Js(i,!0)}function f0(i){for(Ot=i.return;Ot;)switch(Ot.tag){case 5:case 31:case 13:Dn=!1;return;case 27:case 3:Dn=!0;return;default:Ot=Ot.return}}function Rr(i){if(i!==Ot)return!1;if(!Be)return f0(i),Be=!0,!1;var a=i.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Zf(i.type,i.memoizedProps)),c=!c),c&&st&&Js(i),f0(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));st=Fv(i)}else if(a===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));st=Fv(i)}else a===27?(a=st,hi(i.type)?(i=sh,sh=null,st=i):st=a):st=Ot?On(i.stateNode.nextSibling):null;return!0}function $i(){st=Ot=null,Be=!1}function Nd(){var i=Zs;return i!==null&&(en===null?en=i:en.push.apply(en,i),Zs=null),i}function Ka(i){Zs===null?Zs=[i]:Zs.push(i)}var kd=N(null),ji=null,bs=null;function ei(i,a,c){J(kd,a._currentValue),a._currentValue=c}function As(i){i._currentValue=kd.current,H(kd)}function Pd(i,a,c){for(;i!==null;){var h=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),i===c)break;i=i.return}}function Fd(i,a,c,h){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var v=p.dependencies;if(v!==null){var L=p.child;v=v.firstContext;e:for(;v!==null;){var I=v;v=p;for(var j=0;j<a.length;j++)if(I.context===a[j]){v.lanes|=c,I=v.alternate,I!==null&&(I.lanes|=c),Pd(v.return,c,i),h||(L=null);break e}v=I.next}}else if(p.tag===18){if(L=p.return,L===null)throw Error(n(341));L.lanes|=c,v=L.alternate,v!==null&&(v.lanes|=c),Pd(L,c,i),L=null}else L=p.child;if(L!==null)L.return=p;else for(L=p;L!==null;){if(L===i){L=null;break}if(p=L.sibling,p!==null){p.return=L.return,L=p;break}L=L.return}p=L}}function Lr(i,a,c,h){i=null;for(var p=a,v=!1;p!==null;){if(!v){if((p.flags&524288)!==0)v=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var L=p.alternate;if(L===null)throw Error(n(387));if(L=L.memoizedProps,L!==null){var I=p.type;ln(p.pendingProps.value,L.value)||(i!==null?i.push(I):i=[I])}}else if(p===he.current){if(L=p.alternate,L===null)throw Error(n(387));L.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(xo):i=[xo])}p=p.return}i!==null&&Fd(a,i,c,h),a.flags|=262144}function Cl(i){for(i=i.firstContext;i!==null;){if(!ln(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Gi(i){ji=i,bs=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Mt(i){return h0(ji,i)}function _l(i,a){return ji===null&&Gi(i),h0(i,a)}function h0(i,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},bs===null){if(i===null)throw Error(n(308));bs=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else bs=bs.next=a;return c}var gC=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(c,h){i.push(h)}};this.abort=function(){a.aborted=!0,i.forEach(function(c){return c()})}},pC=s.unstable_scheduleCallback,yC=s.unstable_NormalPriority,yt={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ud(){return{controller:new gC,data:new Map,refCount:0}}function za(i){i.refCount--,i.refCount===0&&pC(yC,function(){i.controller.abort()})}var Ya=null,Bd=0,Cr=0,_r=null;function vC(i,a){if(Ya===null){var c=Ya=[];Bd=0,Cr=Hf(),_r={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Bd++,a.then(m0,m0),a}function m0(){if(--Bd===0&&Ya!==null){_r!==null&&(_r.status="fulfilled");var i=Ya;Ya=null,Cr=0,_r=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function xC(i,a){var c=[],h={status:"pending",value:null,reason:null,then:function(p){c.push(p)}};return i.then(function(){h.status="fulfilled",h.value=a;for(var p=0;p<c.length;p++)(0,c[p])(a)},function(p){for(h.status="rejected",h.reason=p,p=0;p<c.length;p++)(0,c[p])(void 0)}),h}var g0=P.S;P.S=function(i,a){Zy=Ct(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&vC(i,a),g0!==null&&g0(i,a)};var Hi=N(null);function $d(){var i=Hi.current;return i!==null?i:Je.pooledCache}function wl(i,a){a===null?J(Hi,Hi.current):J(Hi,a.pool)}function p0(){var i=$d();return i===null?null:{parent:yt._currentValue,pool:i}}var wr=Error(n(460)),jd=Error(n(474)),Dl=Error(n(542)),Il={then:function(){}};function y0(i){return i=i.status,i==="fulfilled"||i==="rejected"}function v0(i,a,c){switch(c=i[c],c===void 0?i.push(a):c!==a&&(a.then(xs,xs),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,E0(i),i;default:if(typeof a.status=="string")a.then(xs,xs);else{if(i=Je,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=a,i.status="pending",i.then(function(h){if(a.status==="pending"){var p=a;p.status="fulfilled",p.value=h}},function(h){if(a.status==="pending"){var p=a;p.status="rejected",p.reason=h}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,E0(i),i}throw Ki=a,wr}}function Vi(i){try{var a=i._init;return a(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Ki=c,wr):c}}var Ki=null;function x0(){if(Ki===null)throw Error(n(459));var i=Ki;return Ki=null,i}function E0(i){if(i===wr||i===Dl)throw Error(n(483))}var Dr=null,qa=0;function Ol(i){var a=qa;return qa+=1,Dr===null&&(Dr=[]),v0(Dr,i,a)}function Xa(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function Ml(i,a){throw a.$$typeof===y?Error(n(525)):(i=Object.prototype.toString.call(a),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function S0(i){function a(z,V){if(i){var W=z.deletions;W===null?(z.deletions=[V],z.flags|=16):W.push(V)}}function c(z,V){if(!i)return null;for(;V!==null;)a(z,V),V=V.sibling;return null}function h(z){for(var V=new Map;z!==null;)z.key!==null?V.set(z.key,z):V.set(z.index,z),z=z.sibling;return V}function p(z,V){return z=Ss(z,V),z.index=0,z.sibling=null,z}function v(z,V,W){return z.index=W,i?(W=z.alternate,W!==null?(W=W.index,W<V?(z.flags|=67108866,V):W):(z.flags|=67108866,V)):(z.flags|=1048576,V)}function L(z){return i&&z.alternate===null&&(z.flags|=67108866),z}function I(z,V,W,oe){return V===null||V.tag!==6?(V=wd(W,z.mode,oe),V.return=z,V):(V=p(V,W),V.return=z,V)}function j(z,V,W,oe){var Se=W.type;return Se===S?ie(z,V,W.props.children,oe,W.key):V!==null&&(V.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===k&&Vi(Se)===V.type)?(V=p(V,W.props),Xa(V,W),V.return=z,V):(V=Rl(W.type,W.key,W.props,null,z.mode,oe),Xa(V,W),V.return=z,V)}function Q(z,V,W,oe){return V===null||V.tag!==4||V.stateNode.containerInfo!==W.containerInfo||V.stateNode.implementation!==W.implementation?(V=Dd(W,z.mode,oe),V.return=z,V):(V=p(V,W.children||[]),V.return=z,V)}function ie(z,V,W,oe,Se){return V===null||V.tag!==7?(V=Bi(W,z.mode,oe,Se),V.return=z,V):(V=p(V,W),V.return=z,V)}function ce(z,V,W){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=wd(""+V,z.mode,W),V.return=z,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case x:return W=Rl(V.type,V.key,V.props,null,z.mode,W),Xa(W,V),W.return=z,W;case E:return V=Dd(V,z.mode,W),V.return=z,V;case k:return V=Vi(V),ce(z,V,W)}if(ae(V)||ne(V))return V=Bi(V,z.mode,W,null),V.return=z,V;if(typeof V.then=="function")return ce(z,Ol(V),W);if(V.$$typeof===_)return ce(z,_l(z,V),W);Ml(z,V)}return null}function Z(z,V,W,oe){var Se=V!==null?V.key:null;if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return Se!==null?null:I(z,V,""+W,oe);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case x:return W.key===Se?j(z,V,W,oe):null;case E:return W.key===Se?Q(z,V,W,oe):null;case k:return W=Vi(W),Z(z,V,W,oe)}if(ae(W)||ne(W))return Se!==null?null:ie(z,V,W,oe,null);if(typeof W.then=="function")return Z(z,V,Ol(W),oe);if(W.$$typeof===_)return Z(z,V,_l(z,W),oe);Ml(z,W)}return null}function te(z,V,W,oe,Se){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return z=z.get(W)||null,I(V,z,""+oe,Se);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case x:return z=z.get(oe.key===null?W:oe.key)||null,j(V,z,oe,Se);case E:return z=z.get(oe.key===null?W:oe.key)||null,Q(V,z,oe,Se);case k:return oe=Vi(oe),te(z,V,W,oe,Se)}if(ae(oe)||ne(oe))return z=z.get(W)||null,ie(V,z,oe,Se,null);if(typeof oe.then=="function")return te(z,V,W,Ol(oe),Se);if(oe.$$typeof===_)return te(z,V,W,_l(V,oe),Se);Ml(V,oe)}return null}function pe(z,V,W,oe){for(var Se=null,je=null,xe=V,we=V=0,Ue=null;xe!==null&&we<W.length;we++){xe.index>we?(Ue=xe,xe=null):Ue=xe.sibling;var Ge=Z(z,xe,W[we],oe);if(Ge===null){xe===null&&(xe=Ue);break}i&&xe&&Ge.alternate===null&&a(z,xe),V=v(Ge,V,we),je===null?Se=Ge:je.sibling=Ge,je=Ge,xe=Ue}if(we===W.length)return c(z,xe),Be&&Ts(z,we),Se;if(xe===null){for(;we<W.length;we++)xe=ce(z,W[we],oe),xe!==null&&(V=v(xe,V,we),je===null?Se=xe:je.sibling=xe,je=xe);return Be&&Ts(z,we),Se}for(xe=h(xe);we<W.length;we++)Ue=te(xe,z,we,W[we],oe),Ue!==null&&(i&&Ue.alternate!==null&&xe.delete(Ue.key===null?we:Ue.key),V=v(Ue,V,we),je===null?Se=Ue:je.sibling=Ue,je=Ue);return i&&xe.forEach(function(vi){return a(z,vi)}),Be&&Ts(z,we),Se}function Te(z,V,W,oe){if(W==null)throw Error(n(151));for(var Se=null,je=null,xe=V,we=V=0,Ue=null,Ge=W.next();xe!==null&&!Ge.done;we++,Ge=W.next()){xe.index>we?(Ue=xe,xe=null):Ue=xe.sibling;var vi=Z(z,xe,Ge.value,oe);if(vi===null){xe===null&&(xe=Ue);break}i&&xe&&vi.alternate===null&&a(z,xe),V=v(vi,V,we),je===null?Se=vi:je.sibling=vi,je=vi,xe=Ue}if(Ge.done)return c(z,xe),Be&&Ts(z,we),Se;if(xe===null){for(;!Ge.done;we++,Ge=W.next())Ge=ce(z,Ge.value,oe),Ge!==null&&(V=v(Ge,V,we),je===null?Se=Ge:je.sibling=Ge,je=Ge);return Be&&Ts(z,we),Se}for(xe=h(xe);!Ge.done;we++,Ge=W.next())Ge=te(xe,z,we,Ge.value,oe),Ge!==null&&(i&&Ge.alternate!==null&&xe.delete(Ge.key===null?we:Ge.key),V=v(Ge,V,we),je===null?Se=Ge:je.sibling=Ge,je=Ge);return i&&xe.forEach(function(D_){return a(z,D_)}),Be&&Ts(z,we),Se}function Qe(z,V,W,oe){if(typeof W=="object"&&W!==null&&W.type===S&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case x:e:{for(var Se=W.key;V!==null;){if(V.key===Se){if(Se=W.type,Se===S){if(V.tag===7){c(z,V.sibling),oe=p(V,W.props.children),oe.return=z,z=oe;break e}}else if(V.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===k&&Vi(Se)===V.type){c(z,V.sibling),oe=p(V,W.props),Xa(oe,W),oe.return=z,z=oe;break e}c(z,V);break}else a(z,V);V=V.sibling}W.type===S?(oe=Bi(W.props.children,z.mode,oe,W.key),oe.return=z,z=oe):(oe=Rl(W.type,W.key,W.props,null,z.mode,oe),Xa(oe,W),oe.return=z,z=oe)}return L(z);case E:e:{for(Se=W.key;V!==null;){if(V.key===Se)if(V.tag===4&&V.stateNode.containerInfo===W.containerInfo&&V.stateNode.implementation===W.implementation){c(z,V.sibling),oe=p(V,W.children||[]),oe.return=z,z=oe;break e}else{c(z,V);break}else a(z,V);V=V.sibling}oe=Dd(W,z.mode,oe),oe.return=z,z=oe}return L(z);case k:return W=Vi(W),Qe(z,V,W,oe)}if(ae(W))return pe(z,V,W,oe);if(ne(W)){if(Se=ne(W),typeof Se!="function")throw Error(n(150));return W=Se.call(W),Te(z,V,W,oe)}if(typeof W.then=="function")return Qe(z,V,Ol(W),oe);if(W.$$typeof===_)return Qe(z,V,_l(z,W),oe);Ml(z,W)}return typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint"?(W=""+W,V!==null&&V.tag===6?(c(z,V.sibling),oe=p(V,W),oe.return=z,z=oe):(c(z,V),oe=wd(W,z.mode,oe),oe.return=z,z=oe),L(z)):c(z,V)}return function(z,V,W,oe){try{qa=0;var Se=Qe(z,V,W,oe);return Dr=null,Se}catch(xe){if(xe===wr||xe===Dl)throw xe;var je=cn(29,xe,null,z.mode);return je.lanes=oe,je.return=z,je}finally{}}}var zi=S0(!0),T0=S0(!1),ti=!1;function Gd(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hd(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function ni(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function si(i,a,c){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Ve&2)!==0){var p=h.pending;return p===null?a.next=a:(a.next=p.next,p.next=a),h.pending=a,a=Al(i),r0(i,null,c),a}return bl(i,h,a,c),Al(i)}function Wa(i,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var h=a.lanes;h&=i.pendingLanes,c|=h,a.lanes=c,hp(i,c)}}function Vd(i,a){var c=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var p=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var L={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};v===null?p=v=L:v=v.next=L,c=c.next}while(c!==null);v===null?p=v=a:v=v.next=a}else p=v=a;c={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:h.shared,callbacks:h.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=a:i.next=a,c.lastBaseUpdate=a}var Kd=!1;function Qa(){if(Kd){var i=_r;if(i!==null)throw i}}function Za(i,a,c,h){Kd=!1;var p=i.updateQueue;ti=!1;var v=p.firstBaseUpdate,L=p.lastBaseUpdate,I=p.shared.pending;if(I!==null){p.shared.pending=null;var j=I,Q=j.next;j.next=null,L===null?v=Q:L.next=Q,L=j;var ie=i.alternate;ie!==null&&(ie=ie.updateQueue,I=ie.lastBaseUpdate,I!==L&&(I===null?ie.firstBaseUpdate=Q:I.next=Q,ie.lastBaseUpdate=j))}if(v!==null){var ce=p.baseState;L=0,ie=Q=j=null,I=v;do{var Z=I.lane&-536870913,te=Z!==I.lane;if(te?(Fe&Z)===Z:(h&Z)===Z){Z!==0&&Z===Cr&&(Kd=!0),ie!==null&&(ie=ie.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var pe=i,Te=I;Z=a;var Qe=c;switch(Te.tag){case 1:if(pe=Te.payload,typeof pe=="function"){ce=pe.call(Qe,ce,Z);break e}ce=pe;break e;case 3:pe.flags=pe.flags&-65537|128;case 0:if(pe=Te.payload,Z=typeof pe=="function"?pe.call(Qe,ce,Z):pe,Z==null)break e;ce=g({},ce,Z);break e;case 2:ti=!0}}Z=I.callback,Z!==null&&(i.flags|=64,te&&(i.flags|=8192),te=p.callbacks,te===null?p.callbacks=[Z]:te.push(Z))}else te={lane:Z,tag:I.tag,payload:I.payload,callback:I.callback,next:null},ie===null?(Q=ie=te,j=ce):ie=ie.next=te,L|=Z;if(I=I.next,I===null){if(I=p.shared.pending,I===null)break;te=I,I=te.next,te.next=null,p.lastBaseUpdate=te,p.shared.pending=null}}while(!0);ie===null&&(j=ce),p.baseState=j,p.firstBaseUpdate=Q,p.lastBaseUpdate=ie,v===null&&(p.shared.lanes=0),li|=L,i.lanes=L,i.memoizedState=ce}}function b0(i,a){if(typeof i!="function")throw Error(n(191,i));i.call(a)}function A0(i,a){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)b0(c[i],a)}var Ir=N(null),Nl=N(0);function R0(i,a){i=Ms,J(Nl,i),J(Ir,a),Ms=i|a.baseLanes}function zd(){J(Nl,Ms),J(Ir,Ir.current)}function Yd(){Ms=Nl.current,H(Ir),H(Nl)}var un=N(null),In=null;function ii(i){var a=i.alternate;J(ft,ft.current&1),J(un,i),In===null&&(a===null||Ir.current!==null||a.memoizedState!==null)&&(In=i)}function qd(i){J(ft,ft.current),J(un,i),In===null&&(In=i)}function L0(i){i.tag===22?(J(ft,ft.current),J(un,i),In===null&&(In=i)):ri()}function ri(){J(ft,ft.current),J(un,un.current)}function dn(i){H(un),In===i&&(In=null),H(ft)}var ft=N(0);function kl(i){for(var a=i;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||th(c)||nh(c)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Rs=0,Ce=null,Xe=null,vt=null,Pl=!1,Or=!1,Yi=!1,Fl=0,Ja=0,Mr=null,EC=0;function ct(){throw Error(n(321))}function Xd(i,a){if(a===null)return!1;for(var c=0;c<a.length&&c<i.length;c++)if(!ln(i[c],a[c]))return!1;return!0}function Wd(i,a,c,h,p,v){return Rs=v,Ce=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,P.H=i===null||i.memoizedState===null?cy:ff,Yi=!1,v=c(h,p),Yi=!1,Or&&(v=_0(a,c,h,p)),C0(i),v}function C0(i){P.H=no;var a=Xe!==null&&Xe.next!==null;if(Rs=0,vt=Xe=Ce=null,Pl=!1,Ja=0,Mr=null,a)throw Error(n(300));i===null||xt||(i=i.dependencies,i!==null&&Cl(i)&&(xt=!0))}function _0(i,a,c,h){Ce=i;var p=0;do{if(Or&&(Mr=null),Ja=0,Or=!1,25<=p)throw Error(n(301));if(p+=1,vt=Xe=null,i.updateQueue!=null){var v=i.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}P.H=uy,v=a(c,h)}while(Or);return v}function SC(){var i=P.H,a=i.useState()[0];return a=typeof a.then=="function"?eo(a):a,i=i.useState()[0],(Xe!==null?Xe.memoizedState:null)!==i&&(Ce.flags|=1024),a}function Qd(){var i=Fl!==0;return Fl=0,i}function Zd(i,a,c){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~c}function Jd(i){if(Pl){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}Pl=!1}Rs=0,vt=Xe=Ce=null,Or=!1,Ja=Fl=0,Mr=null}function Ht(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?Ce.memoizedState=vt=i:vt=vt.next=i,vt}function ht(){if(Xe===null){var i=Ce.alternate;i=i!==null?i.memoizedState:null}else i=Xe.next;var a=vt===null?Ce.memoizedState:vt.next;if(a!==null)vt=a,Xe=i;else{if(i===null)throw Ce.alternate===null?Error(n(467)):Error(n(310));Xe=i,i={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},vt===null?Ce.memoizedState=vt=i:vt=vt.next=i}return vt}function Ul(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function eo(i){var a=Ja;return Ja+=1,Mr===null&&(Mr=[]),i=v0(Mr,i,a),a=Ce,(vt===null?a.memoizedState:vt.next)===null&&(a=a.alternate,P.H=a===null||a.memoizedState===null?cy:ff),i}function Bl(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return eo(i);if(i.$$typeof===_)return Mt(i)}throw Error(n(438,String(i)))}function ef(i){var a=null,c=Ce.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var h=Ce.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(a={data:h.data.map(function(p){return p.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=Ul(),Ce.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(i),h=0;h<i;h++)c[h]=B;return a.index++,c}function Ls(i,a){return typeof a=="function"?a(i):a}function $l(i){var a=ht();return tf(a,Xe,i)}function tf(i,a,c){var h=i.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var p=i.baseQueue,v=h.pending;if(v!==null){if(p!==null){var L=p.next;p.next=v.next,v.next=L}a.baseQueue=p=v,h.pending=null}if(v=i.baseState,p===null)i.memoizedState=v;else{a=p.next;var I=L=null,j=null,Q=a,ie=!1;do{var ce=Q.lane&-536870913;if(ce!==Q.lane?(Fe&ce)===ce:(Rs&ce)===ce){var Z=Q.revertLane;if(Z===0)j!==null&&(j=j.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),ce===Cr&&(ie=!0);else if((Rs&Z)===Z){Q=Q.next,Z===Cr&&(ie=!0);continue}else ce={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},j===null?(I=j=ce,L=v):j=j.next=ce,Ce.lanes|=Z,li|=Z;ce=Q.action,Yi&&c(v,ce),v=Q.hasEagerState?Q.eagerState:c(v,ce)}else Z={lane:ce,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},j===null?(I=j=Z,L=v):j=j.next=Z,Ce.lanes|=ce,li|=ce;Q=Q.next}while(Q!==null&&Q!==a);if(j===null?L=v:j.next=I,!ln(v,i.memoizedState)&&(xt=!0,ie&&(c=_r,c!==null)))throw c;i.memoizedState=v,i.baseState=L,i.baseQueue=j,h.lastRenderedState=v}return p===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function nf(i){var a=ht(),c=a.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var h=c.dispatch,p=c.pending,v=a.memoizedState;if(p!==null){c.pending=null;var L=p=p.next;do v=i(v,L.action),L=L.next;while(L!==p);ln(v,a.memoizedState)||(xt=!0),a.memoizedState=v,a.baseQueue===null&&(a.baseState=v),c.lastRenderedState=v}return[v,h]}function w0(i,a,c){var h=Ce,p=ht(),v=Be;if(v){if(c===void 0)throw Error(n(407));c=c()}else c=a();var L=!ln((Xe||p).memoizedState,c);if(L&&(p.memoizedState=c,xt=!0),p=p.queue,af(O0.bind(null,h,p,i),[i]),p.getSnapshot!==a||L||vt!==null&&vt.memoizedState.tag&1){if(h.flags|=2048,Nr(9,{destroy:void 0},I0.bind(null,h,p,c,a),null),Je===null)throw Error(n(349));v||(Rs&127)!==0||D0(h,a,c)}return c}function D0(i,a,c){i.flags|=16384,i={getSnapshot:a,value:c},a=Ce.updateQueue,a===null?(a=Ul(),Ce.updateQueue=a,a.stores=[i]):(c=a.stores,c===null?a.stores=[i]:c.push(i))}function I0(i,a,c,h){a.value=c,a.getSnapshot=h,M0(a)&&N0(i)}function O0(i,a,c){return c(function(){M0(a)&&N0(i)})}function M0(i){var a=i.getSnapshot;i=i.value;try{var c=a();return!ln(i,c)}catch{return!0}}function N0(i){var a=Ui(i,2);a!==null&&tn(a,i,2)}function sf(i){var a=Ht();if(typeof i=="function"){var c=i;if(i=c(),Yi){qs(!0);try{c()}finally{qs(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:i},a}function k0(i,a,c,h){return i.baseState=c,tf(i,Xe,typeof h=="function"?h:Ls)}function TC(i,a,c,h,p){if(Hl(i))throw Error(n(485));if(i=a.action,i!==null){var v={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(L){v.listeners.push(L)}};P.T!==null?c(!0):v.isTransition=!1,h(v),c=a.pending,c===null?(v.next=a.pending=v,P0(a,v)):(v.next=c.next,a.pending=c.next=v)}}function P0(i,a){var c=a.action,h=a.payload,p=i.state;if(a.isTransition){var v=P.T,L={};P.T=L;try{var I=c(p,h),j=P.S;j!==null&&j(L,I),F0(i,a,I)}catch(Q){rf(i,a,Q)}finally{v!==null&&L.types!==null&&(v.types=L.types),P.T=v}}else try{v=c(p,h),F0(i,a,v)}catch(Q){rf(i,a,Q)}}function F0(i,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){U0(i,a,h)},function(h){return rf(i,a,h)}):U0(i,a,c)}function U0(i,a,c){a.status="fulfilled",a.value=c,B0(a),i.state=c,a=i.pending,a!==null&&(c=a.next,c===a?i.pending=null:(c=c.next,a.next=c,P0(i,c)))}function rf(i,a,c){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do a.status="rejected",a.reason=c,B0(a),a=a.next;while(a!==h)}i.action=null}function B0(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function $0(i,a){return a}function j0(i,a){if(Be){var c=Je.formState;if(c!==null){e:{var h=Ce;if(Be){if(st){t:{for(var p=st,v=Dn;p.nodeType!==8;){if(!v){p=null;break t}if(p=On(p.nextSibling),p===null){p=null;break t}}v=p.data,p=v==="F!"||v==="F"?p:null}if(p){st=On(p.nextSibling),h=p.data==="F!";break e}}Js(h)}h=!1}h&&(a=c[0])}}return c=Ht(),c.memoizedState=c.baseState=a,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$0,lastRenderedState:a},c.queue=h,c=ay.bind(null,Ce,h),h.dispatch=c,h=sf(!1),v=df.bind(null,Ce,!1,h.queue),h=Ht(),p={state:a,dispatch:null,action:i,pending:null},h.queue=p,c=TC.bind(null,Ce,p,v,c),p.dispatch=c,h.memoizedState=i,[a,c,!1]}function G0(i){var a=ht();return H0(a,Xe,i)}function H0(i,a,c){if(a=tf(i,a,$0)[0],i=$l(Ls)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var h=eo(a)}catch(L){throw L===wr?Dl:L}else h=a;a=ht();var p=a.queue,v=p.dispatch;return c!==a.memoizedState&&(Ce.flags|=2048,Nr(9,{destroy:void 0},bC.bind(null,p,c),null)),[h,v,i]}function bC(i,a){i.action=a}function V0(i){var a=ht(),c=Xe;if(c!==null)return H0(a,c,i);ht(),a=a.memoizedState,c=ht();var h=c.queue.dispatch;return c.memoizedState=i,[a,h,!1]}function Nr(i,a,c,h){return i={tag:i,create:c,deps:h,inst:a,next:null},a=Ce.updateQueue,a===null&&(a=Ul(),Ce.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=i.next=i:(h=c.next,c.next=i,i.next=h,a.lastEffect=i),i}function K0(){return ht().memoizedState}function jl(i,a,c,h){var p=Ht();Ce.flags|=i,p.memoizedState=Nr(1|a,{destroy:void 0},c,h===void 0?null:h)}function Gl(i,a,c,h){var p=ht();h=h===void 0?null:h;var v=p.memoizedState.inst;Xe!==null&&h!==null&&Xd(h,Xe.memoizedState.deps)?p.memoizedState=Nr(a,v,c,h):(Ce.flags|=i,p.memoizedState=Nr(1|a,v,c,h))}function z0(i,a){jl(8390656,8,i,a)}function af(i,a){Gl(2048,8,i,a)}function AC(i){Ce.flags|=4;var a=Ce.updateQueue;if(a===null)a=Ul(),Ce.updateQueue=a,a.events=[i];else{var c=a.events;c===null?a.events=[i]:c.push(i)}}function Y0(i){var a=ht().memoizedState;return AC({ref:a,nextImpl:i}),function(){if((Ve&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function q0(i,a){return Gl(4,2,i,a)}function X0(i,a){return Gl(4,4,i,a)}function W0(i,a){if(typeof a=="function"){i=i();var c=a(i);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function Q0(i,a,c){c=c!=null?c.concat([i]):null,Gl(4,4,W0.bind(null,a,i),c)}function of(){}function Z0(i,a){var c=ht();a=a===void 0?null:a;var h=c.memoizedState;return a!==null&&Xd(a,h[1])?h[0]:(c.memoizedState=[i,a],i)}function J0(i,a){var c=ht();a=a===void 0?null:a;var h=c.memoizedState;if(a!==null&&Xd(a,h[1]))return h[0];if(h=i(),Yi){qs(!0);try{i()}finally{qs(!1)}}return c.memoizedState=[h,a],h}function lf(i,a,c){return c===void 0||(Rs&1073741824)!==0&&(Fe&261930)===0?i.memoizedState=a:(i.memoizedState=c,i=ev(),Ce.lanes|=i,li|=i,c)}function ey(i,a,c,h){return ln(c,a)?c:Ir.current!==null?(i=lf(i,c,h),ln(i,a)||(xt=!0),i):(Rs&42)===0||(Rs&1073741824)!==0&&(Fe&261930)===0?(xt=!0,i.memoizedState=c):(i=ev(),Ce.lanes|=i,li|=i,a)}function ty(i,a,c,h,p){var v=F.p;F.p=v!==0&&8>v?v:8;var L=P.T,I={};P.T=I,df(i,!1,a,c);try{var j=p(),Q=P.S;if(Q!==null&&Q(I,j),j!==null&&typeof j=="object"&&typeof j.then=="function"){var ie=xC(j,h);to(i,a,ie,mn(i))}else to(i,a,h,mn(i))}catch(ce){to(i,a,{then:function(){},status:"rejected",reason:ce},mn())}finally{F.p=v,L!==null&&I.types!==null&&(L.types=I.types),P.T=L}}function RC(){}function cf(i,a,c,h){if(i.tag!==5)throw Error(n(476));var p=ny(i).queue;ty(i,p,a,U,c===null?RC:function(){return sy(i),c(h)})}function ny(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:U},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:c},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function sy(i){var a=ny(i);a.next===null&&(a=i.alternate.memoizedState),to(i,a.next.queue,{},mn())}function uf(){return Mt(xo)}function iy(){return ht().memoizedState}function ry(){return ht().memoizedState}function LC(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var c=mn();i=ni(c);var h=si(a,i,c);h!==null&&(tn(h,a,c),Wa(h,a,c)),a={cache:Ud()},i.payload=a;return}a=a.return}}function CC(i,a,c){var h=mn();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Hl(i)?oy(a,c):(c=Cd(i,a,c,h),c!==null&&(tn(c,i,h),ly(c,a,h)))}function ay(i,a,c){var h=mn();to(i,a,c,h)}function to(i,a,c,h){var p={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Hl(i))oy(a,p);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=a.lastRenderedReducer,v!==null))try{var L=a.lastRenderedState,I=v(L,c);if(p.hasEagerState=!0,p.eagerState=I,ln(I,L))return bl(i,a,p,0),Je===null&&Tl(),!1}catch{}finally{}if(c=Cd(i,a,p,h),c!==null)return tn(c,i,h),ly(c,a,h),!0}return!1}function df(i,a,c,h){if(h={lane:2,revertLane:Hf(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Hl(i)){if(a)throw Error(n(479))}else a=Cd(i,c,h,2),a!==null&&tn(a,i,2)}function Hl(i){var a=i.alternate;return i===Ce||a!==null&&a===Ce}function oy(i,a){Or=Pl=!0;var c=i.pending;c===null?a.next=a:(a.next=c.next,c.next=a),i.pending=a}function ly(i,a,c){if((c&4194048)!==0){var h=a.lanes;h&=i.pendingLanes,c|=h,a.lanes=c,hp(i,c)}}var no={readContext:Mt,use:Bl,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useLayoutEffect:ct,useInsertionEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useSyncExternalStore:ct,useId:ct,useHostTransitionStatus:ct,useFormState:ct,useActionState:ct,useOptimistic:ct,useMemoCache:ct,useCacheRefresh:ct};no.useEffectEvent=ct;var cy={readContext:Mt,use:Bl,useCallback:function(i,a){return Ht().memoizedState=[i,a===void 0?null:a],i},useContext:Mt,useEffect:z0,useImperativeHandle:function(i,a,c){c=c!=null?c.concat([i]):null,jl(4194308,4,W0.bind(null,a,i),c)},useLayoutEffect:function(i,a){return jl(4194308,4,i,a)},useInsertionEffect:function(i,a){jl(4,2,i,a)},useMemo:function(i,a){var c=Ht();a=a===void 0?null:a;var h=i();if(Yi){qs(!0);try{i()}finally{qs(!1)}}return c.memoizedState=[h,a],h},useReducer:function(i,a,c){var h=Ht();if(c!==void 0){var p=c(a);if(Yi){qs(!0);try{c(a)}finally{qs(!1)}}}else p=a;return h.memoizedState=h.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},h.queue=i,i=i.dispatch=CC.bind(null,Ce,i),[h.memoizedState,i]},useRef:function(i){var a=Ht();return i={current:i},a.memoizedState=i},useState:function(i){i=sf(i);var a=i.queue,c=ay.bind(null,Ce,a);return a.dispatch=c,[i.memoizedState,c]},useDebugValue:of,useDeferredValue:function(i,a){var c=Ht();return lf(c,i,a)},useTransition:function(){var i=sf(!1);return i=ty.bind(null,Ce,i.queue,!0,!1),Ht().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,c){var h=Ce,p=Ht();if(Be){if(c===void 0)throw Error(n(407));c=c()}else{if(c=a(),Je===null)throw Error(n(349));(Fe&127)!==0||D0(h,a,c)}p.memoizedState=c;var v={value:c,getSnapshot:a};return p.queue=v,z0(O0.bind(null,h,v,i),[i]),h.flags|=2048,Nr(9,{destroy:void 0},I0.bind(null,h,v,c,a),null),c},useId:function(){var i=Ht(),a=Je.identifierPrefix;if(Be){var c=Qn,h=Wn;c=(h&~(1<<32-on(h)-1)).toString(32)+c,a="_"+a+"R_"+c,c=Fl++,0<c&&(a+="H"+c.toString(32)),a+="_"}else c=EC++,a="_"+a+"r_"+c.toString(32)+"_";return i.memoizedState=a},useHostTransitionStatus:uf,useFormState:j0,useActionState:j0,useOptimistic:function(i){var a=Ht();a.memoizedState=a.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=df.bind(null,Ce,!0,c),c.dispatch=a,[i,a]},useMemoCache:ef,useCacheRefresh:function(){return Ht().memoizedState=LC.bind(null,Ce)},useEffectEvent:function(i){var a=Ht(),c={impl:i};return a.memoizedState=c,function(){if((Ve&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},ff={readContext:Mt,use:Bl,useCallback:Z0,useContext:Mt,useEffect:af,useImperativeHandle:Q0,useInsertionEffect:q0,useLayoutEffect:X0,useMemo:J0,useReducer:$l,useRef:K0,useState:function(){return $l(Ls)},useDebugValue:of,useDeferredValue:function(i,a){var c=ht();return ey(c,Xe.memoizedState,i,a)},useTransition:function(){var i=$l(Ls)[0],a=ht().memoizedState;return[typeof i=="boolean"?i:eo(i),a]},useSyncExternalStore:w0,useId:iy,useHostTransitionStatus:uf,useFormState:G0,useActionState:G0,useOptimistic:function(i,a){var c=ht();return k0(c,Xe,i,a)},useMemoCache:ef,useCacheRefresh:ry};ff.useEffectEvent=Y0;var uy={readContext:Mt,use:Bl,useCallback:Z0,useContext:Mt,useEffect:af,useImperativeHandle:Q0,useInsertionEffect:q0,useLayoutEffect:X0,useMemo:J0,useReducer:nf,useRef:K0,useState:function(){return nf(Ls)},useDebugValue:of,useDeferredValue:function(i,a){var c=ht();return Xe===null?lf(c,i,a):ey(c,Xe.memoizedState,i,a)},useTransition:function(){var i=nf(Ls)[0],a=ht().memoizedState;return[typeof i=="boolean"?i:eo(i),a]},useSyncExternalStore:w0,useId:iy,useHostTransitionStatus:uf,useFormState:V0,useActionState:V0,useOptimistic:function(i,a){var c=ht();return Xe!==null?k0(c,Xe,i,a):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:ef,useCacheRefresh:ry};uy.useEffectEvent=Y0;function hf(i,a,c,h){a=i.memoizedState,c=c(h,a),c=c==null?a:g({},a,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var mf={enqueueSetState:function(i,a,c){i=i._reactInternals;var h=mn(),p=ni(h);p.payload=a,c!=null&&(p.callback=c),a=si(i,p,h),a!==null&&(tn(a,i,h),Wa(a,i,h))},enqueueReplaceState:function(i,a,c){i=i._reactInternals;var h=mn(),p=ni(h);p.tag=1,p.payload=a,c!=null&&(p.callback=c),a=si(i,p,h),a!==null&&(tn(a,i,h),Wa(a,i,h))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var c=mn(),h=ni(c);h.tag=2,a!=null&&(h.callback=a),a=si(i,h,c),a!==null&&(tn(a,i,c),Wa(a,i,c))}};function dy(i,a,c,h,p,v,L){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,v,L):a.prototype&&a.prototype.isPureReactComponent?!Ga(c,h)||!Ga(p,v):!0}function fy(i,a,c,h){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,h),a.state!==i&&mf.enqueueReplaceState(a,a.state,null)}function qi(i,a){var c=a;if("ref"in a){c={};for(var h in a)h!=="ref"&&(c[h]=a[h])}if(i=i.defaultProps){c===a&&(c=g({},c));for(var p in i)c[p]===void 0&&(c[p]=i[p])}return c}function hy(i){Sl(i)}function my(i){console.error(i)}function gy(i){Sl(i)}function Vl(i,a){try{var c=i.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(h){setTimeout(function(){throw h})}}function py(i,a,c){try{var h=i.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function gf(i,a,c){return c=ni(c),c.tag=3,c.payload={element:null},c.callback=function(){Vl(i,a)},c}function yy(i){return i=ni(i),i.tag=3,i}function vy(i,a,c,h){var p=c.type.getDerivedStateFromError;if(typeof p=="function"){var v=h.value;i.payload=function(){return p(v)},i.callback=function(){py(a,c,h)}}var L=c.stateNode;L!==null&&typeof L.componentDidCatch=="function"&&(i.callback=function(){py(a,c,h),typeof p!="function"&&(ci===null?ci=new Set([this]):ci.add(this));var I=h.stack;this.componentDidCatch(h.value,{componentStack:I!==null?I:""})})}function _C(i,a,c,h,p){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(a=c.alternate,a!==null&&Lr(a,c,p,!0),c=un.current,c!==null){switch(c.tag){case 31:case 13:return In===null?nc():c.alternate===null&&ut===0&&(ut=3),c.flags&=-257,c.flags|=65536,c.lanes=p,h===Il?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([h]):a.add(h),$f(i,h,p)),!1;case 22:return c.flags|=65536,h===Il?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([h]):c.add(h)),$f(i,h,p)),!1}throw Error(n(435,c.tag))}return $f(i,h,p),nc(),!1}if(Be)return a=un.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=p,h!==Md&&(i=Error(n(422),{cause:h}),Ka(Cn(i,c)))):(h!==Md&&(a=Error(n(423),{cause:h}),Ka(Cn(a,c))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,h=Cn(h,c),p=gf(i.stateNode,h,p),Vd(i,p),ut!==4&&(ut=2)),!1;var v=Error(n(520),{cause:h});if(v=Cn(v,c),uo===null?uo=[v]:uo.push(v),ut!==4&&(ut=2),a===null)return!0;h=Cn(h,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,i=p&-p,c.lanes|=i,i=gf(c.stateNode,h,i),Vd(c,i),!1;case 1:if(a=c.type,v=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ci===null||!ci.has(v))))return c.flags|=65536,p&=-p,c.lanes|=p,p=yy(p),vy(p,i,c,h),Vd(c,p),!1}c=c.return}while(c!==null);return!1}var pf=Error(n(461)),xt=!1;function Nt(i,a,c,h){a.child=i===null?T0(a,null,c,h):zi(a,i.child,c,h)}function xy(i,a,c,h,p){c=c.render;var v=a.ref;if("ref"in h){var L={};for(var I in h)I!=="ref"&&(L[I]=h[I])}else L=h;return Gi(a),h=Wd(i,a,c,L,v,p),I=Qd(),i!==null&&!xt?(Zd(i,a,p),Cs(i,a,p)):(Be&&I&&Id(a),a.flags|=1,Nt(i,a,h,p),a.child)}function Ey(i,a,c,h,p){if(i===null){var v=c.type;return typeof v=="function"&&!_d(v)&&v.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=v,Sy(i,a,v,h,p)):(i=Rl(c.type,null,h,a,a.mode,p),i.ref=a.ref,i.return=a,a.child=i)}if(v=i.child,!Af(i,p)){var L=v.memoizedProps;if(c=c.compare,c=c!==null?c:Ga,c(L,h)&&i.ref===a.ref)return Cs(i,a,p)}return a.flags|=1,i=Ss(v,h),i.ref=a.ref,i.return=a,a.child=i}function Sy(i,a,c,h,p){if(i!==null){var v=i.memoizedProps;if(Ga(v,h)&&i.ref===a.ref)if(xt=!1,a.pendingProps=h=v,Af(i,p))(i.flags&131072)!==0&&(xt=!0);else return a.lanes=i.lanes,Cs(i,a,p)}return yf(i,a,c,h,p)}function Ty(i,a,c,h){var p=h.children,v=i!==null?i.memoizedState:null;if(i===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((a.flags&128)!==0){if(v=v!==null?v.baseLanes|c:c,i!==null){for(h=a.child=i.child,p=0;h!==null;)p=p|h.lanes|h.childLanes,h=h.sibling;h=p&~v}else h=0,a.child=null;return by(i,a,v,c,h)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&wl(a,v!==null?v.cachePool:null),v!==null?R0(a,v):zd(),L0(a);else return h=a.lanes=536870912,by(i,a,v!==null?v.baseLanes|c:c,c,h)}else v!==null?(wl(a,v.cachePool),R0(a,v),ri(),a.memoizedState=null):(i!==null&&wl(a,null),zd(),ri());return Nt(i,a,p,c),a.child}function so(i,a){return i!==null&&i.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function by(i,a,c,h,p){var v=$d();return v=v===null?null:{parent:yt._currentValue,pool:v},a.memoizedState={baseLanes:c,cachePool:v},i!==null&&wl(a,null),zd(),L0(a),i!==null&&Lr(i,a,h,!0),a.childLanes=p,null}function Kl(i,a){return a=Yl({mode:a.mode,children:a.children},i.mode),a.ref=i.ref,i.child=a,a.return=i,a}function Ay(i,a,c){return zi(a,i.child,null,c),i=Kl(a,a.pendingProps),i.flags|=2,dn(a),a.memoizedState=null,i}function wC(i,a,c){var h=a.pendingProps,p=(a.flags&128)!==0;if(a.flags&=-129,i===null){if(Be){if(h.mode==="hidden")return i=Kl(a,h),a.lanes=536870912,so(null,i);if(qd(a),(i=st)?(i=Pv(i,Dn),i=i!==null&&i.data==="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:Qs!==null?{id:Wn,overflow:Qn}:null,retryLane:536870912,hydrationErrors:null},c=o0(i),c.return=a,a.child=c,Ot=a,st=null)):i=null,i===null)throw Js(a);return a.lanes=536870912,null}return Kl(a,h)}var v=i.memoizedState;if(v!==null){var L=v.dehydrated;if(qd(a),p)if(a.flags&256)a.flags&=-257,a=Ay(i,a,c);else if(a.memoizedState!==null)a.child=i.child,a.flags|=128,a=null;else throw Error(n(558));else if(xt||Lr(i,a,c,!1),p=(c&i.childLanes)!==0,xt||p){if(h=Je,h!==null&&(L=mp(h,c),L!==0&&L!==v.retryLane))throw v.retryLane=L,Ui(i,L),tn(h,i,L),pf;nc(),a=Ay(i,a,c)}else i=v.treeContext,st=On(L.nextSibling),Ot=a,Be=!0,Zs=null,Dn=!1,i!==null&&u0(a,i),a=Kl(a,h),a.flags|=4096;return a}return i=Ss(i.child,{mode:h.mode,children:h.children}),i.ref=a.ref,a.child=i,i.return=a,i}function zl(i,a){var c=a.ref;if(c===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(a.flags|=4194816)}}function yf(i,a,c,h,p){return Gi(a),c=Wd(i,a,c,h,void 0,p),h=Qd(),i!==null&&!xt?(Zd(i,a,p),Cs(i,a,p)):(Be&&h&&Id(a),a.flags|=1,Nt(i,a,c,p),a.child)}function Ry(i,a,c,h,p,v){return Gi(a),a.updateQueue=null,c=_0(a,h,c,p),C0(i),h=Qd(),i!==null&&!xt?(Zd(i,a,v),Cs(i,a,v)):(Be&&h&&Id(a),a.flags|=1,Nt(i,a,c,v),a.child)}function Ly(i,a,c,h,p){if(Gi(a),a.stateNode===null){var v=Tr,L=c.contextType;typeof L=="object"&&L!==null&&(v=Mt(L)),v=new c(h,v),a.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=mf,a.stateNode=v,v._reactInternals=a,v=a.stateNode,v.props=h,v.state=a.memoizedState,v.refs={},Gd(a),L=c.contextType,v.context=typeof L=="object"&&L!==null?Mt(L):Tr,v.state=a.memoizedState,L=c.getDerivedStateFromProps,typeof L=="function"&&(hf(a,c,L,h),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(L=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),L!==v.state&&mf.enqueueReplaceState(v,v.state,null),Za(a,h,v,p),Qa(),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308),h=!0}else if(i===null){v=a.stateNode;var I=a.memoizedProps,j=qi(c,I);v.props=j;var Q=v.context,ie=c.contextType;L=Tr,typeof ie=="object"&&ie!==null&&(L=Mt(ie));var ce=c.getDerivedStateFromProps;ie=typeof ce=="function"||typeof v.getSnapshotBeforeUpdate=="function",I=a.pendingProps!==I,ie||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(I||Q!==L)&&fy(a,v,h,L),ti=!1;var Z=a.memoizedState;v.state=Z,Za(a,h,v,p),Qa(),Q=a.memoizedState,I||Z!==Q||ti?(typeof ce=="function"&&(hf(a,c,ce,h),Q=a.memoizedState),(j=ti||dy(a,c,j,h,Z,Q,L))?(ie||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(a.flags|=4194308)):(typeof v.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=Q),v.props=h,v.state=Q,v.context=L,h=j):(typeof v.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{v=a.stateNode,Hd(i,a),L=a.memoizedProps,ie=qi(c,L),v.props=ie,ce=a.pendingProps,Z=v.context,Q=c.contextType,j=Tr,typeof Q=="object"&&Q!==null&&(j=Mt(Q)),I=c.getDerivedStateFromProps,(Q=typeof I=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(L!==ce||Z!==j)&&fy(a,v,h,j),ti=!1,Z=a.memoizedState,v.state=Z,Za(a,h,v,p),Qa();var te=a.memoizedState;L!==ce||Z!==te||ti||i!==null&&i.dependencies!==null&&Cl(i.dependencies)?(typeof I=="function"&&(hf(a,c,I,h),te=a.memoizedState),(ie=ti||dy(a,c,ie,h,Z,te,j)||i!==null&&i.dependencies!==null&&Cl(i.dependencies))?(Q||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(h,te,j),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(h,te,j)),typeof v.componentDidUpdate=="function"&&(a.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof v.componentDidUpdate!="function"||L===i.memoizedProps&&Z===i.memoizedState||(a.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||L===i.memoizedProps&&Z===i.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=te),v.props=h,v.state=te,v.context=j,h=ie):(typeof v.componentDidUpdate!="function"||L===i.memoizedProps&&Z===i.memoizedState||(a.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||L===i.memoizedProps&&Z===i.memoizedState||(a.flags|=1024),h=!1)}return v=h,zl(i,a),h=(a.flags&128)!==0,v||h?(v=a.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:v.render(),a.flags|=1,i!==null&&h?(a.child=zi(a,i.child,null,p),a.child=zi(a,null,c,p)):Nt(i,a,c,p),a.memoizedState=v.state,i=a.child):i=Cs(i,a,p),i}function Cy(i,a,c,h){return $i(),a.flags|=256,Nt(i,a,c,h),a.child}var vf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xf(i){return{baseLanes:i,cachePool:p0()}}function Ef(i,a,c){return i=i!==null?i.childLanes&~c:0,a&&(i|=hn),i}function _y(i,a,c){var h=a.pendingProps,p=!1,v=(a.flags&128)!==0,L;if((L=v)||(L=i!==null&&i.memoizedState===null?!1:(ft.current&2)!==0),L&&(p=!0,a.flags&=-129),L=(a.flags&32)!==0,a.flags&=-33,i===null){if(Be){if(p?ii(a):ri(),(i=st)?(i=Pv(i,Dn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:Qs!==null?{id:Wn,overflow:Qn}:null,retryLane:536870912,hydrationErrors:null},c=o0(i),c.return=a,a.child=c,Ot=a,st=null)):i=null,i===null)throw Js(a);return nh(i)?a.lanes=32:a.lanes=536870912,null}var I=h.children;return h=h.fallback,p?(ri(),p=a.mode,I=Yl({mode:"hidden",children:I},p),h=Bi(h,p,c,null),I.return=a,h.return=a,I.sibling=h,a.child=I,h=a.child,h.memoizedState=xf(c),h.childLanes=Ef(i,L,c),a.memoizedState=vf,so(null,h)):(ii(a),Sf(a,I))}var j=i.memoizedState;if(j!==null&&(I=j.dehydrated,I!==null)){if(v)a.flags&256?(ii(a),a.flags&=-257,a=Tf(i,a,c)):a.memoizedState!==null?(ri(),a.child=i.child,a.flags|=128,a=null):(ri(),I=h.fallback,p=a.mode,h=Yl({mode:"visible",children:h.children},p),I=Bi(I,p,c,null),I.flags|=2,h.return=a,I.return=a,h.sibling=I,a.child=h,zi(a,i.child,null,c),h=a.child,h.memoizedState=xf(c),h.childLanes=Ef(i,L,c),a.memoizedState=vf,a=so(null,h));else if(ii(a),nh(I)){if(L=I.nextSibling&&I.nextSibling.dataset,L)var Q=L.dgst;L=Q,h=Error(n(419)),h.stack="",h.digest=L,Ka({value:h,source:null,stack:null}),a=Tf(i,a,c)}else if(xt||Lr(i,a,c,!1),L=(c&i.childLanes)!==0,xt||L){if(L=Je,L!==null&&(h=mp(L,c),h!==0&&h!==j.retryLane))throw j.retryLane=h,Ui(i,h),tn(L,i,h),pf;th(I)||nc(),a=Tf(i,a,c)}else th(I)?(a.flags|=192,a.child=i.child,a=null):(i=j.treeContext,st=On(I.nextSibling),Ot=a,Be=!0,Zs=null,Dn=!1,i!==null&&u0(a,i),a=Sf(a,h.children),a.flags|=4096);return a}return p?(ri(),I=h.fallback,p=a.mode,j=i.child,Q=j.sibling,h=Ss(j,{mode:"hidden",children:h.children}),h.subtreeFlags=j.subtreeFlags&65011712,Q!==null?I=Ss(Q,I):(I=Bi(I,p,c,null),I.flags|=2),I.return=a,h.return=a,h.sibling=I,a.child=h,so(null,h),h=a.child,I=i.child.memoizedState,I===null?I=xf(c):(p=I.cachePool,p!==null?(j=yt._currentValue,p=p.parent!==j?{parent:j,pool:j}:p):p=p0(),I={baseLanes:I.baseLanes|c,cachePool:p}),h.memoizedState=I,h.childLanes=Ef(i,L,c),a.memoizedState=vf,so(i.child,h)):(ii(a),c=i.child,i=c.sibling,c=Ss(c,{mode:"visible",children:h.children}),c.return=a,c.sibling=null,i!==null&&(L=a.deletions,L===null?(a.deletions=[i],a.flags|=16):L.push(i)),a.child=c,a.memoizedState=null,c)}function Sf(i,a){return a=Yl({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function Yl(i,a){return i=cn(22,i,null,a),i.lanes=0,i}function Tf(i,a,c){return zi(a,i.child,null,c),i=Sf(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function wy(i,a,c){i.lanes|=a;var h=i.alternate;h!==null&&(h.lanes|=a),Pd(i.return,a,c)}function bf(i,a,c,h,p,v){var L=i.memoizedState;L===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:p,treeForkCount:v}:(L.isBackwards=a,L.rendering=null,L.renderingStartTime=0,L.last=h,L.tail=c,L.tailMode=p,L.treeForkCount=v)}function Dy(i,a,c){var h=a.pendingProps,p=h.revealOrder,v=h.tail;h=h.children;var L=ft.current,I=(L&2)!==0;if(I?(L=L&1|2,a.flags|=128):L&=1,J(ft,L),Nt(i,a,h,c),h=Be?Va:0,!I&&i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&wy(i,c,a);else if(i.tag===19)wy(i,c,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(p){case"forwards":for(c=a.child,p=null;c!==null;)i=c.alternate,i!==null&&kl(i)===null&&(p=c),c=c.sibling;c=p,c===null?(p=a.child,a.child=null):(p=c.sibling,c.sibling=null),bf(a,!1,p,c,v,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,p=a.child,a.child=null;p!==null;){if(i=p.alternate,i!==null&&kl(i)===null){a.child=p;break}i=p.sibling,p.sibling=c,c=p,p=i}bf(a,!0,c,null,v,h);break;case"together":bf(a,!1,null,null,void 0,h);break;default:a.memoizedState=null}return a.child}function Cs(i,a,c){if(i!==null&&(a.dependencies=i.dependencies),li|=a.lanes,(c&a.childLanes)===0)if(i!==null){if(Lr(i,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(n(153));if(a.child!==null){for(i=a.child,c=Ss(i,i.pendingProps),a.child=c,c.return=a;i.sibling!==null;)i=i.sibling,c=c.sibling=Ss(i,i.pendingProps),c.return=a;c.sibling=null}return a.child}function Af(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&Cl(i)))}function DC(i,a,c){switch(a.tag){case 3:Le(a,a.stateNode.containerInfo),ei(a,yt,i.memoizedState.cache),$i();break;case 27:case 5:at(a);break;case 4:Le(a,a.stateNode.containerInfo);break;case 10:ei(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,qd(a),null;break;case 13:var h=a.memoizedState;if(h!==null)return h.dehydrated!==null?(ii(a),a.flags|=128,null):(c&a.child.childLanes)!==0?_y(i,a,c):(ii(a),i=Cs(i,a,c),i!==null?i.sibling:null);ii(a);break;case 19:var p=(i.flags&128)!==0;if(h=(c&a.childLanes)!==0,h||(Lr(i,a,c,!1),h=(c&a.childLanes)!==0),p){if(h)return Dy(i,a,c);a.flags|=128}if(p=a.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),J(ft,ft.current),h)break;return null;case 22:return a.lanes=0,Ty(i,a,c,a.pendingProps);case 24:ei(a,yt,i.memoizedState.cache)}return Cs(i,a,c)}function Iy(i,a,c){if(i!==null)if(i.memoizedProps!==a.pendingProps)xt=!0;else{if(!Af(i,c)&&(a.flags&128)===0)return xt=!1,DC(i,a,c);xt=(i.flags&131072)!==0}else xt=!1,Be&&(a.flags&1048576)!==0&&c0(a,Va,a.index);switch(a.lanes=0,a.tag){case 16:e:{var h=a.pendingProps;if(i=Vi(a.elementType),a.type=i,typeof i=="function")_d(i)?(h=qi(i,h),a.tag=1,a=Ly(null,a,i,h,c)):(a.tag=0,a=yf(null,a,i,h,c));else{if(i!=null){var p=i.$$typeof;if(p===D){a.tag=11,a=xy(null,a,i,h,c);break e}else if(p===O){a.tag=14,a=Ey(null,a,i,h,c);break e}}throw a=ee(i)||i,Error(n(306,a,""))}}return a;case 0:return yf(i,a,a.type,a.pendingProps,c);case 1:return h=a.type,p=qi(h,a.pendingProps),Ly(i,a,h,p,c);case 3:e:{if(Le(a,a.stateNode.containerInfo),i===null)throw Error(n(387));h=a.pendingProps;var v=a.memoizedState;p=v.element,Hd(i,a),Za(a,h,null,c);var L=a.memoizedState;if(h=L.cache,ei(a,yt,h),h!==v.cache&&Fd(a,[yt],c,!0),Qa(),h=L.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:L.cache},a.updateQueue.baseState=v,a.memoizedState=v,a.flags&256){a=Cy(i,a,h,c);break e}else if(h!==p){p=Cn(Error(n(424)),a),Ka(p),a=Cy(i,a,h,c);break e}else{switch(i=a.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(st=On(i.firstChild),Ot=a,Be=!0,Zs=null,Dn=!0,c=T0(a,null,h,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if($i(),h===p){a=Cs(i,a,c);break e}Nt(i,a,h,c)}a=a.child}return a;case 26:return zl(i,a),i===null?(c=Gv(a.type,null,a.pendingProps,null))?a.memoizedState=c:Be||(c=a.type,i=a.pendingProps,h=cc(fe.current).createElement(c),h[It]=a,h[Xt]=i,kt(h,c,i),_t(h),a.stateNode=h):a.memoizedState=Gv(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return at(a),i===null&&Be&&(h=a.stateNode=Bv(a.type,a.pendingProps,fe.current),Ot=a,Dn=!0,p=st,hi(a.type)?(sh=p,st=On(h.firstChild)):st=p),Nt(i,a,a.pendingProps.children,c),zl(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&Be&&((p=h=st)&&(h=a_(h,a.type,a.pendingProps,Dn),h!==null?(a.stateNode=h,Ot=a,st=On(h.firstChild),Dn=!1,p=!0):p=!1),p||Js(a)),at(a),p=a.type,v=a.pendingProps,L=i!==null?i.memoizedProps:null,h=v.children,Zf(p,v)?h=null:L!==null&&Zf(p,L)&&(a.flags|=32),a.memoizedState!==null&&(p=Wd(i,a,SC,null,null,c),xo._currentValue=p),zl(i,a),Nt(i,a,h,c),a.child;case 6:return i===null&&Be&&((i=c=st)&&(c=o_(c,a.pendingProps,Dn),c!==null?(a.stateNode=c,Ot=a,st=null,i=!0):i=!1),i||Js(a)),null;case 13:return _y(i,a,c);case 4:return Le(a,a.stateNode.containerInfo),h=a.pendingProps,i===null?a.child=zi(a,null,h,c):Nt(i,a,h,c),a.child;case 11:return xy(i,a,a.type,a.pendingProps,c);case 7:return Nt(i,a,a.pendingProps,c),a.child;case 8:return Nt(i,a,a.pendingProps.children,c),a.child;case 12:return Nt(i,a,a.pendingProps.children,c),a.child;case 10:return h=a.pendingProps,ei(a,a.type,h.value),Nt(i,a,h.children,c),a.child;case 9:return p=a.type._context,h=a.pendingProps.children,Gi(a),p=Mt(p),h=h(p),a.flags|=1,Nt(i,a,h,c),a.child;case 14:return Ey(i,a,a.type,a.pendingProps,c);case 15:return Sy(i,a,a.type,a.pendingProps,c);case 19:return Dy(i,a,c);case 31:return wC(i,a,c);case 22:return Ty(i,a,c,a.pendingProps);case 24:return Gi(a),h=Mt(yt),i===null?(p=$d(),p===null&&(p=Je,v=Ud(),p.pooledCache=v,v.refCount++,v!==null&&(p.pooledCacheLanes|=c),p=v),a.memoizedState={parent:h,cache:p},Gd(a),ei(a,yt,p)):((i.lanes&c)!==0&&(Hd(i,a),Za(a,null,null,c),Qa()),p=i.memoizedState,v=a.memoizedState,p.parent!==h?(p={parent:h,cache:h},a.memoizedState=p,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=p),ei(a,yt,h)):(h=v.cache,ei(a,yt,h),h!==p.cache&&Fd(a,[yt],c,!0))),Nt(i,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function _s(i){i.flags|=4}function Rf(i,a,c,h,p){if((a=(i.mode&32)!==0)&&(a=!1),a){if(i.flags|=16777216,(p&335544128)===p)if(i.stateNode.complete)i.flags|=8192;else if(iv())i.flags|=8192;else throw Ki=Il,jd}else i.flags&=-16777217}function Oy(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Yv(a))if(iv())i.flags|=8192;else throw Ki=Il,jd}function ql(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?dp():536870912,i.lanes|=a,Ur|=a)}function io(i,a){if(!Be)switch(i.tailMode){case"hidden":a=i.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function it(i){var a=i.alternate!==null&&i.alternate.child===i.child,c=0,h=0;if(a)for(var p=i.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags&65011712,h|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=h,i.childLanes=c,a}function IC(i,a,c){var h=a.pendingProps;switch(Od(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return it(a),null;case 1:return it(a),null;case 3:return c=a.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),As(yt),_e(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(Rr(a)?_s(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Nd())),it(a),null;case 26:var p=a.type,v=a.memoizedState;return i===null?(_s(a),v!==null?(it(a),Oy(a,v)):(it(a),Rf(a,p,null,h,c))):v?v!==i.memoizedState?(_s(a),it(a),Oy(a,v)):(it(a),a.flags&=-16777217):(i=i.memoizedProps,i!==h&&_s(a),it(a),Rf(a,p,i,h,c)),null;case 27:if(Rt(a),c=fe.current,p=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==h&&_s(a);else{if(!h){if(a.stateNode===null)throw Error(n(166));return it(a),null}i=se.current,Rr(a)?d0(a):(i=Bv(p,h,c),a.stateNode=i,_s(a))}return it(a),null;case 5:if(Rt(a),p=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==h&&_s(a);else{if(!h){if(a.stateNode===null)throw Error(n(166));return it(a),null}if(v=se.current,Rr(a))d0(a);else{var L=cc(fe.current);switch(v){case 1:v=L.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:v=L.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":v=L.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":v=L.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":v=L.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof h.is=="string"?L.createElement("select",{is:h.is}):L.createElement("select"),h.multiple?v.multiple=!0:h.size&&(v.size=h.size);break;default:v=typeof h.is=="string"?L.createElement(p,{is:h.is}):L.createElement(p)}}v[It]=a,v[Xt]=h;e:for(L=a.child;L!==null;){if(L.tag===5||L.tag===6)v.appendChild(L.stateNode);else if(L.tag!==4&&L.tag!==27&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===a)break e;for(;L.sibling===null;){if(L.return===null||L.return===a)break e;L=L.return}L.sibling.return=L.return,L=L.sibling}a.stateNode=v;e:switch(kt(v,p,h),p){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&_s(a)}}return it(a),Rf(a,a.type,i===null?null:i.memoizedProps,a.pendingProps,c),null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==h&&_s(a);else{if(typeof h!="string"&&a.stateNode===null)throw Error(n(166));if(i=fe.current,Rr(a)){if(i=a.stateNode,c=a.memoizedProps,h=null,p=Ot,p!==null)switch(p.tag){case 27:case 5:h=p.memoizedProps}i[It]=a,i=!!(i.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||_v(i.nodeValue,c)),i||Js(a,!0)}else i=cc(i).createTextNode(h),i[It]=a,a.stateNode=i}return it(a),null;case 31:if(c=a.memoizedState,i===null||i.memoizedState!==null){if(h=Rr(a),c!==null){if(i===null){if(!h)throw Error(n(318));if(i=a.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[It]=a}else $i(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;it(a),i=!1}else c=Nd(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return a.flags&256?(dn(a),a):(dn(a),null);if((a.flags&128)!==0)throw Error(n(558))}return it(a),null;case 13:if(h=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=Rr(a),h!==null&&h.dehydrated!==null){if(i===null){if(!p)throw Error(n(318));if(p=a.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));p[It]=a}else $i(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;it(a),p=!1}else p=Nd(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return a.flags&256?(dn(a),a):(dn(a),null)}return dn(a),(a.flags&128)!==0?(a.lanes=c,a):(c=h!==null,i=i!==null&&i.memoizedState!==null,c&&(h=a.child,p=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(p=h.alternate.memoizedState.cachePool.pool),v=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(v=h.memoizedState.cachePool.pool),v!==p&&(h.flags|=2048)),c!==i&&c&&(a.child.flags|=8192),ql(a,a.updateQueue),it(a),null);case 4:return _e(),i===null&&Yf(a.stateNode.containerInfo),it(a),null;case 10:return As(a.type),it(a),null;case 19:if(H(ft),h=a.memoizedState,h===null)return it(a),null;if(p=(a.flags&128)!==0,v=h.rendering,v===null)if(p)io(h,!1);else{if(ut!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(v=kl(i),v!==null){for(a.flags|=128,io(h,!1),i=v.updateQueue,a.updateQueue=i,ql(a,i),a.subtreeFlags=0,i=c,c=a.child;c!==null;)a0(c,i),c=c.sibling;return J(ft,ft.current&1|2),Be&&Ts(a,h.treeForkCount),a.child}i=i.sibling}h.tail!==null&&Ct()>Jl&&(a.flags|=128,p=!0,io(h,!1),a.lanes=4194304)}else{if(!p)if(i=kl(v),i!==null){if(a.flags|=128,p=!0,i=i.updateQueue,a.updateQueue=i,ql(a,i),io(h,!0),h.tail===null&&h.tailMode==="hidden"&&!v.alternate&&!Be)return it(a),null}else 2*Ct()-h.renderingStartTime>Jl&&c!==536870912&&(a.flags|=128,p=!0,io(h,!1),a.lanes=4194304);h.isBackwards?(v.sibling=a.child,a.child=v):(i=h.last,i!==null?i.sibling=v:a.child=v,h.last=v)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=Ct(),i.sibling=null,c=ft.current,J(ft,p?c&1|2:c&1),Be&&Ts(a,h.treeForkCount),i):(it(a),null);case 22:case 23:return dn(a),Yd(),h=a.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(a.flags|=8192):h&&(a.flags|=8192),h?(c&536870912)!==0&&(a.flags&128)===0&&(it(a),a.subtreeFlags&6&&(a.flags|=8192)):it(a),c=a.updateQueue,c!==null&&ql(a,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==c&&(a.flags|=2048),i!==null&&H(Hi),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),As(yt),it(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function OC(i,a){switch(Od(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return As(yt),_e(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return Rt(a),null;case 31:if(a.memoizedState!==null){if(dn(a),a.alternate===null)throw Error(n(340));$i()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 13:if(dn(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(n(340));$i()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return H(ft),null;case 4:return _e(),null;case 10:return As(a.type),null;case 22:case 23:return dn(a),Yd(),i!==null&&H(Hi),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return As(yt),null;case 25:return null;default:return null}}function My(i,a){switch(Od(a),a.tag){case 3:As(yt),_e();break;case 26:case 27:case 5:Rt(a);break;case 4:_e();break;case 31:a.memoizedState!==null&&dn(a);break;case 13:dn(a);break;case 19:H(ft);break;case 10:As(a.type);break;case 22:case 23:dn(a),Yd(),i!==null&&H(Hi);break;case 24:As(yt)}}function ro(i,a){try{var c=a.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var p=h.next;c=p;do{if((c.tag&i)===i){h=void 0;var v=c.create,L=c.inst;h=v(),L.destroy=h}c=c.next}while(c!==p)}}catch(I){ze(a,a.return,I)}}function ai(i,a,c){try{var h=a.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var v=p.next;h=v;do{if((h.tag&i)===i){var L=h.inst,I=L.destroy;if(I!==void 0){L.destroy=void 0,p=a;var j=c,Q=I;try{Q()}catch(ie){ze(p,j,ie)}}}h=h.next}while(h!==v)}}catch(ie){ze(a,a.return,ie)}}function Ny(i){var a=i.updateQueue;if(a!==null){var c=i.stateNode;try{A0(a,c)}catch(h){ze(i,i.return,h)}}}function ky(i,a,c){c.props=qi(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(h){ze(i,a,h)}}function ao(i,a){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof c=="function"?i.refCleanup=c(h):c.current=h}}catch(p){ze(i,a,p)}}function Zn(i,a){var c=i.ref,h=i.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(p){ze(i,a,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(p){ze(i,a,p)}else c.current=null}function Py(i){var a=i.type,c=i.memoizedProps,h=i.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(p){ze(i,i.return,p)}}function Lf(i,a,c){try{var h=i.stateNode;e_(h,i.type,c,a),h[Xt]=a}catch(p){ze(i,i.return,p)}}function Fy(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&hi(i.type)||i.tag===4}function Cf(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Fy(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&hi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function _f(i,a,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(i),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=xs));else if(h!==4&&(h===27&&hi(i.type)&&(c=i.stateNode,a=null),i=i.child,i!==null))for(_f(i,a,c),i=i.sibling;i!==null;)_f(i,a,c),i=i.sibling}function Xl(i,a,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,a?c.insertBefore(i,a):c.appendChild(i);else if(h!==4&&(h===27&&hi(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(Xl(i,a,c),i=i.sibling;i!==null;)Xl(i,a,c),i=i.sibling}function Uy(i){var a=i.stateNode,c=i.memoizedProps;try{for(var h=i.type,p=a.attributes;p.length;)a.removeAttributeNode(p[0]);kt(a,h,c),a[It]=i,a[Xt]=c}catch(v){ze(i,i.return,v)}}var ws=!1,Et=!1,wf=!1,By=typeof WeakSet=="function"?WeakSet:Set,wt=null;function MC(i,a){if(i=i.containerInfo,Wf=pc,i=Qp(i),Sd(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var p=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var L=0,I=-1,j=-1,Q=0,ie=0,ce=i,Z=null;t:for(;;){for(var te;ce!==c||p!==0&&ce.nodeType!==3||(I=L+p),ce!==v||h!==0&&ce.nodeType!==3||(j=L+h),ce.nodeType===3&&(L+=ce.nodeValue.length),(te=ce.firstChild)!==null;)Z=ce,ce=te;for(;;){if(ce===i)break t;if(Z===c&&++Q===p&&(I=L),Z===v&&++ie===h&&(j=L),(te=ce.nextSibling)!==null)break;ce=Z,Z=ce.parentNode}ce=te}c=I===-1||j===-1?null:{start:I,end:j}}else c=null}c=c||{start:0,end:0}}else c=null;for(Qf={focusedElem:i,selectionRange:c},pc=!1,wt=a;wt!==null;)if(a=wt,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,wt=i;else for(;wt!==null;){switch(a=wt,v=a.alternate,i=a.flags,a.tag){case 0:if((i&4)!==0&&(i=a.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)p=i[c],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&v!==null){i=void 0,c=a,p=v.memoizedProps,v=v.memoizedState,h=c.stateNode;try{var pe=qi(c.type,p);i=h.getSnapshotBeforeUpdate(pe,v),h.__reactInternalSnapshotBeforeUpdate=i}catch(Te){ze(c,c.return,Te)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,c=i.nodeType,c===9)eh(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":eh(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=a.sibling,i!==null){i.return=a.return,wt=i;break}wt=a.return}}function $y(i,a,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:Is(i,c),h&4&&ro(5,c);break;case 1:if(Is(i,c),h&4)if(i=c.stateNode,a===null)try{i.componentDidMount()}catch(L){ze(c,c.return,L)}else{var p=qi(c.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(p,a,i.__reactInternalSnapshotBeforeUpdate)}catch(L){ze(c,c.return,L)}}h&64&&Ny(c),h&512&&ao(c,c.return);break;case 3:if(Is(i,c),h&64&&(i=c.updateQueue,i!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{A0(i,a)}catch(L){ze(c,c.return,L)}}break;case 27:a===null&&h&4&&Uy(c);case 26:case 5:Is(i,c),a===null&&h&4&&Py(c),h&512&&ao(c,c.return);break;case 12:Is(i,c);break;case 31:Is(i,c),h&4&&Hy(i,c);break;case 13:Is(i,c),h&4&&Vy(i,c),h&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=GC.bind(null,c),l_(i,c))));break;case 22:if(h=c.memoizedState!==null||ws,!h){a=a!==null&&a.memoizedState!==null||Et,p=ws;var v=Et;ws=h,(Et=a)&&!v?Os(i,c,(c.subtreeFlags&8772)!==0):Is(i,c),ws=p,Et=v}break;case 30:break;default:Is(i,c)}}function jy(i){var a=i.alternate;a!==null&&(i.alternate=null,jy(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&id(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var rt=null,Qt=!1;function Ds(i,a,c){for(c=c.child;c!==null;)Gy(i,a,c),c=c.sibling}function Gy(i,a,c){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Da,c)}catch{}switch(c.tag){case 26:Et||Zn(c,a),Ds(i,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Et||Zn(c,a);var h=rt,p=Qt;hi(c.type)&&(rt=c.stateNode,Qt=!1),Ds(i,a,c),po(c.stateNode),rt=h,Qt=p;break;case 5:Et||Zn(c,a);case 6:if(h=rt,p=Qt,rt=null,Ds(i,a,c),rt=h,Qt=p,rt!==null)if(Qt)try{(rt.nodeType===9?rt.body:rt.nodeName==="HTML"?rt.ownerDocument.body:rt).removeChild(c.stateNode)}catch(v){ze(c,a,v)}else try{rt.removeChild(c.stateNode)}catch(v){ze(c,a,v)}break;case 18:rt!==null&&(Qt?(i=rt,Nv(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),zr(i)):Nv(rt,c.stateNode));break;case 4:h=rt,p=Qt,rt=c.stateNode.containerInfo,Qt=!0,Ds(i,a,c),rt=h,Qt=p;break;case 0:case 11:case 14:case 15:ai(2,c,a),Et||ai(4,c,a),Ds(i,a,c);break;case 1:Et||(Zn(c,a),h=c.stateNode,typeof h.componentWillUnmount=="function"&&ky(c,a,h)),Ds(i,a,c);break;case 21:Ds(i,a,c);break;case 22:Et=(h=Et)||c.memoizedState!==null,Ds(i,a,c),Et=h;break;default:Ds(i,a,c)}}function Hy(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{zr(i)}catch(c){ze(a,a.return,c)}}}function Vy(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{zr(i)}catch(c){ze(a,a.return,c)}}function NC(i){switch(i.tag){case 31:case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new By),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new By),a;default:throw Error(n(435,i.tag))}}function Wl(i,a){var c=NC(i);a.forEach(function(h){if(!c.has(h)){c.add(h);var p=HC.bind(null,i,h);h.then(p,p)}})}function Zt(i,a){var c=a.deletions;if(c!==null)for(var h=0;h<c.length;h++){var p=c[h],v=i,L=a,I=L;e:for(;I!==null;){switch(I.tag){case 27:if(hi(I.type)){rt=I.stateNode,Qt=!1;break e}break;case 5:rt=I.stateNode,Qt=!1;break e;case 3:case 4:rt=I.stateNode.containerInfo,Qt=!0;break e}I=I.return}if(rt===null)throw Error(n(160));Gy(v,L,p),rt=null,Qt=!1,v=p.alternate,v!==null&&(v.return=null),p.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Ky(a,i),a=a.sibling}var jn=null;function Ky(i,a){var c=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Zt(a,i),Jt(i),h&4&&(ai(3,i,i.return),ro(3,i),ai(5,i,i.return));break;case 1:Zt(a,i),Jt(i),h&512&&(Et||c===null||Zn(c,c.return)),h&64&&ws&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var p=jn;if(Zt(a,i),Jt(i),h&512&&(Et||c===null||Zn(c,c.return)),h&4){var v=c!==null?c.memoizedState:null;if(h=i.memoizedState,c===null)if(h===null)if(i.stateNode===null){e:{h=i.type,c=i.memoizedProps,p=p.ownerDocument||p;t:switch(h){case"title":v=p.getElementsByTagName("title")[0],(!v||v[Ma]||v[It]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=p.createElement(h),p.head.insertBefore(v,p.querySelector("head > title"))),kt(v,h,c),v[It]=i,_t(v),h=v;break e;case"link":var L=Kv("link","href",p).get(h+(c.href||""));if(L){for(var I=0;I<L.length;I++)if(v=L[I],v.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&v.getAttribute("rel")===(c.rel==null?null:c.rel)&&v.getAttribute("title")===(c.title==null?null:c.title)&&v.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){L.splice(I,1);break t}}v=p.createElement(h),kt(v,h,c),p.head.appendChild(v);break;case"meta":if(L=Kv("meta","content",p).get(h+(c.content||""))){for(I=0;I<L.length;I++)if(v=L[I],v.getAttribute("content")===(c.content==null?null:""+c.content)&&v.getAttribute("name")===(c.name==null?null:c.name)&&v.getAttribute("property")===(c.property==null?null:c.property)&&v.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&v.getAttribute("charset")===(c.charSet==null?null:c.charSet)){L.splice(I,1);break t}}v=p.createElement(h),kt(v,h,c),p.head.appendChild(v);break;default:throw Error(n(468,h))}v[It]=i,_t(v),h=v}i.stateNode=h}else zv(p,i.type,i.stateNode);else i.stateNode=Vv(p,h,i.memoizedProps);else v!==h?(v===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):v.count--,h===null?zv(p,i.type,i.stateNode):Vv(p,h,i.memoizedProps)):h===null&&i.stateNode!==null&&Lf(i,i.memoizedProps,c.memoizedProps)}break;case 27:Zt(a,i),Jt(i),h&512&&(Et||c===null||Zn(c,c.return)),c!==null&&h&4&&Lf(i,i.memoizedProps,c.memoizedProps);break;case 5:if(Zt(a,i),Jt(i),h&512&&(Et||c===null||Zn(c,c.return)),i.flags&32){p=i.stateNode;try{gr(p,"")}catch(pe){ze(i,i.return,pe)}}h&4&&i.stateNode!=null&&(p=i.memoizedProps,Lf(i,p,c!==null?c.memoizedProps:p)),h&1024&&(wf=!0);break;case 6:if(Zt(a,i),Jt(i),h&4){if(i.stateNode===null)throw Error(n(162));h=i.memoizedProps,c=i.stateNode;try{c.nodeValue=h}catch(pe){ze(i,i.return,pe)}}break;case 3:if(fc=null,p=jn,jn=uc(a.containerInfo),Zt(a,i),jn=p,Jt(i),h&4&&c!==null&&c.memoizedState.isDehydrated)try{zr(a.containerInfo)}catch(pe){ze(i,i.return,pe)}wf&&(wf=!1,zy(i));break;case 4:h=jn,jn=uc(i.stateNode.containerInfo),Zt(a,i),Jt(i),jn=h;break;case 12:Zt(a,i),Jt(i);break;case 31:Zt(a,i),Jt(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Wl(i,h)));break;case 13:Zt(a,i),Jt(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Zl=Ct()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Wl(i,h)));break;case 22:p=i.memoizedState!==null;var j=c!==null&&c.memoizedState!==null,Q=ws,ie=Et;if(ws=Q||p,Et=ie||j,Zt(a,i),Et=ie,ws=Q,Jt(i),h&8192)e:for(a=i.stateNode,a._visibility=p?a._visibility&-2:a._visibility|1,p&&(c===null||j||ws||Et||Xi(i)),c=null,a=i;;){if(a.tag===5||a.tag===26){if(c===null){j=c=a;try{if(v=j.stateNode,p)L=v.style,typeof L.setProperty=="function"?L.setProperty("display","none","important"):L.display="none";else{I=j.stateNode;var ce=j.memoizedProps.style,Z=ce!=null&&ce.hasOwnProperty("display")?ce.display:null;I.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(pe){ze(j,j.return,pe)}}}else if(a.tag===6){if(c===null){j=a;try{j.stateNode.nodeValue=p?"":j.memoizedProps}catch(pe){ze(j,j.return,pe)}}}else if(a.tag===18){if(c===null){j=a;try{var te=j.stateNode;p?kv(te,!0):kv(j.stateNode,!1)}catch(pe){ze(j,j.return,pe)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}h&4&&(h=i.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Wl(i,c))));break;case 19:Zt(a,i),Jt(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Wl(i,h)));break;case 30:break;case 21:break;default:Zt(a,i),Jt(i)}}function Jt(i){var a=i.flags;if(a&2){try{for(var c,h=i.return;h!==null;){if(Fy(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var p=c.stateNode,v=Cf(i);Xl(i,v,p);break;case 5:var L=c.stateNode;c.flags&32&&(gr(L,""),c.flags&=-33);var I=Cf(i);Xl(i,I,L);break;case 3:case 4:var j=c.stateNode.containerInfo,Q=Cf(i);_f(i,Q,j);break;default:throw Error(n(161))}}catch(ie){ze(i,i.return,ie)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function zy(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;zy(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function Is(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)$y(i,a.alternate,a),a=a.sibling}function Xi(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:ai(4,a,a.return),Xi(a);break;case 1:Zn(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&ky(a,a.return,c),Xi(a);break;case 27:po(a.stateNode);case 26:case 5:Zn(a,a.return),Xi(a);break;case 22:a.memoizedState===null&&Xi(a);break;case 30:Xi(a);break;default:Xi(a)}i=i.sibling}}function Os(i,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var h=a.alternate,p=i,v=a,L=v.flags;switch(v.tag){case 0:case 11:case 15:Os(p,v,c),ro(4,v);break;case 1:if(Os(p,v,c),h=v,p=h.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(Q){ze(h,h.return,Q)}if(h=v,p=h.updateQueue,p!==null){var I=h.stateNode;try{var j=p.shared.hiddenCallbacks;if(j!==null)for(p.shared.hiddenCallbacks=null,p=0;p<j.length;p++)b0(j[p],I)}catch(Q){ze(h,h.return,Q)}}c&&L&64&&Ny(v),ao(v,v.return);break;case 27:Uy(v);case 26:case 5:Os(p,v,c),c&&h===null&&L&4&&Py(v),ao(v,v.return);break;case 12:Os(p,v,c);break;case 31:Os(p,v,c),c&&L&4&&Hy(p,v);break;case 13:Os(p,v,c),c&&L&4&&Vy(p,v);break;case 22:v.memoizedState===null&&Os(p,v,c),ao(v,v.return);break;case 30:break;default:Os(p,v,c)}a=a.sibling}}function Df(i,a){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&za(c))}function If(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&za(i))}function Gn(i,a,c,h){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Yy(i,a,c,h),a=a.sibling}function Yy(i,a,c,h){var p=a.flags;switch(a.tag){case 0:case 11:case 15:Gn(i,a,c,h),p&2048&&ro(9,a);break;case 1:Gn(i,a,c,h);break;case 3:Gn(i,a,c,h),p&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&za(i)));break;case 12:if(p&2048){Gn(i,a,c,h),i=a.stateNode;try{var v=a.memoizedProps,L=v.id,I=v.onPostCommit;typeof I=="function"&&I(L,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(j){ze(a,a.return,j)}}else Gn(i,a,c,h);break;case 31:Gn(i,a,c,h);break;case 13:Gn(i,a,c,h);break;case 23:break;case 22:v=a.stateNode,L=a.alternate,a.memoizedState!==null?v._visibility&2?Gn(i,a,c,h):oo(i,a):v._visibility&2?Gn(i,a,c,h):(v._visibility|=2,kr(i,a,c,h,(a.subtreeFlags&10256)!==0||!1)),p&2048&&Df(L,a);break;case 24:Gn(i,a,c,h),p&2048&&If(a.alternate,a);break;default:Gn(i,a,c,h)}}function kr(i,a,c,h,p){for(p=p&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var v=i,L=a,I=c,j=h,Q=L.flags;switch(L.tag){case 0:case 11:case 15:kr(v,L,I,j,p),ro(8,L);break;case 23:break;case 22:var ie=L.stateNode;L.memoizedState!==null?ie._visibility&2?kr(v,L,I,j,p):oo(v,L):(ie._visibility|=2,kr(v,L,I,j,p)),p&&Q&2048&&Df(L.alternate,L);break;case 24:kr(v,L,I,j,p),p&&Q&2048&&If(L.alternate,L);break;default:kr(v,L,I,j,p)}a=a.sibling}}function oo(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=i,h=a,p=h.flags;switch(h.tag){case 22:oo(c,h),p&2048&&Df(h.alternate,h);break;case 24:oo(c,h),p&2048&&If(h.alternate,h);break;default:oo(c,h)}a=a.sibling}}var lo=8192;function Pr(i,a,c){if(i.subtreeFlags&lo)for(i=i.child;i!==null;)qy(i,a,c),i=i.sibling}function qy(i,a,c){switch(i.tag){case 26:Pr(i,a,c),i.flags&lo&&i.memoizedState!==null&&E_(c,jn,i.memoizedState,i.memoizedProps);break;case 5:Pr(i,a,c);break;case 3:case 4:var h=jn;jn=uc(i.stateNode.containerInfo),Pr(i,a,c),jn=h;break;case 22:i.memoizedState===null&&(h=i.alternate,h!==null&&h.memoizedState!==null?(h=lo,lo=16777216,Pr(i,a,c),lo=h):Pr(i,a,c));break;default:Pr(i,a,c)}}function Xy(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function co(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];wt=h,Qy(h,i)}Xy(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Wy(i),i=i.sibling}function Wy(i){switch(i.tag){case 0:case 11:case 15:co(i),i.flags&2048&&ai(9,i,i.return);break;case 3:co(i);break;case 12:co(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,Ql(i)):co(i);break;default:co(i)}}function Ql(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];wt=h,Qy(h,i)}Xy(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:ai(8,a,a.return),Ql(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,Ql(a));break;default:Ql(a)}i=i.sibling}}function Qy(i,a){for(;wt!==null;){var c=wt;switch(c.tag){case 0:case 11:case 15:ai(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:za(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,wt=h;else e:for(c=i;wt!==null;){h=wt;var p=h.sibling,v=h.return;if(jy(h),h===c){wt=null;break e}if(p!==null){p.return=v,wt=p;break e}wt=v}}}var kC={getCacheForType:function(i){var a=Mt(yt),c=a.data.get(i);return c===void 0&&(c=i(),a.data.set(i,c)),c},cacheSignal:function(){return Mt(yt).controller.signal}},PC=typeof WeakMap=="function"?WeakMap:Map,Ve=0,Je=null,Ne=null,Fe=0,Ke=0,fn=null,oi=!1,Fr=!1,Of=!1,Ms=0,ut=0,li=0,Wi=0,Mf=0,hn=0,Ur=0,uo=null,en=null,Nf=!1,Zl=0,Zy=0,Jl=1/0,ec=null,ci=null,St=0,ui=null,Br=null,Ns=0,kf=0,Pf=null,Jy=null,fo=0,Ff=null;function mn(){return(Ve&2)!==0&&Fe!==0?Fe&-Fe:P.T!==null?Hf():gp()}function ev(){if(hn===0)if((Fe&536870912)===0||Be){var i=ll;ll<<=1,(ll&3932160)===0&&(ll=262144),hn=i}else hn=536870912;return i=un.current,i!==null&&(i.flags|=32),hn}function tn(i,a,c){(i===Je&&(Ke===2||Ke===9)||i.cancelPendingCommit!==null)&&($r(i,0),di(i,Fe,hn,!1)),Oa(i,c),((Ve&2)===0||i!==Je)&&(i===Je&&((Ve&2)===0&&(Wi|=c),ut===4&&di(i,Fe,hn,!1)),Jn(i))}function tv(i,a,c){if((Ve&6)!==0)throw Error(n(327));var h=!c&&(a&127)===0&&(a&i.expiredLanes)===0||Ia(i,a),p=h?BC(i,a):Bf(i,a,!0),v=h;do{if(p===0){Fr&&!h&&di(i,a,0,!1);break}else{if(c=i.current.alternate,v&&!FC(c)){p=Bf(i,a,!1),v=!1;continue}if(p===2){if(v=a,i.errorRecoveryDisabledLanes&v)var L=0;else L=i.pendingLanes&-536870913,L=L!==0?L:L&536870912?536870912:0;if(L!==0){a=L;e:{var I=i;p=uo;var j=I.current.memoizedState.isDehydrated;if(j&&($r(I,L).flags|=256),L=Bf(I,L,!1),L!==2){if(Of&&!j){I.errorRecoveryDisabledLanes|=v,Wi|=v,p=4;break e}v=en,en=p,v!==null&&(en===null?en=v:en.push.apply(en,v))}p=L}if(v=!1,p!==2)continue}}if(p===1){$r(i,0),di(i,a,0,!0);break}e:{switch(h=i,v=p,v){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:di(h,a,hn,!oi);break e;case 2:en=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(p=Zl+300-Ct(),10<p)){if(di(h,a,hn,!oi),ul(h,0,!0)!==0)break e;Ns=a,h.timeoutHandle=Ov(nv.bind(null,h,c,en,ec,Nf,a,hn,Wi,Ur,oi,v,"Throttled",-0,0),p);break e}nv(h,c,en,ec,Nf,a,hn,Wi,Ur,oi,v,null,-0,0)}}break}while(!0);Jn(i)}function nv(i,a,c,h,p,v,L,I,j,Q,ie,ce,Z,te){if(i.timeoutHandle=-1,ce=a.subtreeFlags,ce&8192||(ce&16785408)===16785408){ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:xs},qy(a,v,ce);var pe=(v&62914560)===v?Zl-Ct():(v&4194048)===v?Zy-Ct():0;if(pe=S_(ce,pe),pe!==null){Ns=v,i.cancelPendingCommit=pe(uv.bind(null,i,a,v,c,h,p,L,I,j,ie,ce,null,Z,te)),di(i,v,L,!Q);return}}uv(i,a,v,c,h,p,L,I,j)}function FC(i){for(var a=i;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var p=c[h],v=p.getSnapshot;p=p.value;try{if(!ln(v(),p))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function di(i,a,c,h){a&=~Mf,a&=~Wi,i.suspendedLanes|=a,i.pingedLanes&=~a,h&&(i.warmLanes|=a),h=i.expirationTimes;for(var p=a;0<p;){var v=31-on(p),L=1<<v;h[v]=-1,p&=~L}c!==0&&fp(i,c,a)}function tc(){return(Ve&6)===0?(ho(0),!1):!0}function Uf(){if(Ne!==null){if(Ke===0)var i=Ne.return;else i=Ne,bs=ji=null,Jd(i),Dr=null,qa=0,i=Ne;for(;i!==null;)My(i.alternate,i),i=i.return;Ne=null}}function $r(i,a){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,s_(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),Ns=0,Uf(),Je=i,Ne=c=Ss(i.current,null),Fe=a,Ke=0,fn=null,oi=!1,Fr=Ia(i,a),Of=!1,Ur=hn=Mf=Wi=li=ut=0,en=uo=null,Nf=!1,(a&8)!==0&&(a|=a&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=a;0<h;){var p=31-on(h),v=1<<p;a|=i[p],h&=~v}return Ms=a,Tl(),c}function sv(i,a){Ce=null,P.H=no,a===wr||a===Dl?(a=x0(),Ke=3):a===jd?(a=x0(),Ke=4):Ke=a===pf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,fn=a,Ne===null&&(ut=1,Vl(i,Cn(a,i.current)))}function iv(){var i=un.current;return i===null?!0:(Fe&4194048)===Fe?In===null:(Fe&62914560)===Fe||(Fe&536870912)!==0?i===In:!1}function rv(){var i=P.H;return P.H=no,i===null?no:i}function av(){var i=P.A;return P.A=kC,i}function nc(){ut=4,oi||(Fe&4194048)!==Fe&&un.current!==null||(Fr=!0),(li&134217727)===0&&(Wi&134217727)===0||Je===null||di(Je,Fe,hn,!1)}function Bf(i,a,c){var h=Ve;Ve|=2;var p=rv(),v=av();(Je!==i||Fe!==a)&&(ec=null,$r(i,a)),a=!1;var L=ut;e:do try{if(Ke!==0&&Ne!==null){var I=Ne,j=fn;switch(Ke){case 8:Uf(),L=6;break e;case 3:case 2:case 9:case 6:un.current===null&&(a=!0);var Q=Ke;if(Ke=0,fn=null,jr(i,I,j,Q),c&&Fr){L=0;break e}break;default:Q=Ke,Ke=0,fn=null,jr(i,I,j,Q)}}UC(),L=ut;break}catch(ie){sv(i,ie)}while(!0);return a&&i.shellSuspendCounter++,bs=ji=null,Ve=h,P.H=p,P.A=v,Ne===null&&(Je=null,Fe=0,Tl()),L}function UC(){for(;Ne!==null;)ov(Ne)}function BC(i,a){var c=Ve;Ve|=2;var h=rv(),p=av();Je!==i||Fe!==a?(ec=null,Jl=Ct()+500,$r(i,a)):Fr=Ia(i,a);e:do try{if(Ke!==0&&Ne!==null){a=Ne;var v=fn;t:switch(Ke){case 1:Ke=0,fn=null,jr(i,a,v,1);break;case 2:case 9:if(y0(v)){Ke=0,fn=null,lv(a);break}a=function(){Ke!==2&&Ke!==9||Je!==i||(Ke=7),Jn(i)},v.then(a,a);break e;case 3:Ke=7;break e;case 4:Ke=5;break e;case 7:y0(v)?(Ke=0,fn=null,lv(a)):(Ke=0,fn=null,jr(i,a,v,7));break;case 5:var L=null;switch(Ne.tag){case 26:L=Ne.memoizedState;case 5:case 27:var I=Ne;if(L?Yv(L):I.stateNode.complete){Ke=0,fn=null;var j=I.sibling;if(j!==null)Ne=j;else{var Q=I.return;Q!==null?(Ne=Q,sc(Q)):Ne=null}break t}}Ke=0,fn=null,jr(i,a,v,5);break;case 6:Ke=0,fn=null,jr(i,a,v,6);break;case 8:Uf(),ut=6;break e;default:throw Error(n(462))}}$C();break}catch(ie){sv(i,ie)}while(!0);return bs=ji=null,P.H=h,P.A=p,Ve=c,Ne!==null?0:(Je=null,Fe=0,Tl(),ut)}function $C(){for(;Ne!==null&&!ys();)ov(Ne)}function ov(i){var a=Iy(i.alternate,i,Ms);i.memoizedProps=i.pendingProps,a===null?sc(i):Ne=a}function lv(i){var a=i,c=a.alternate;switch(a.tag){case 15:case 0:a=Ry(c,a,a.pendingProps,a.type,void 0,Fe);break;case 11:a=Ry(c,a,a.pendingProps,a.type.render,a.ref,Fe);break;case 5:Jd(a);default:My(c,a),a=Ne=a0(a,Ms),a=Iy(c,a,Ms)}i.memoizedProps=i.pendingProps,a===null?sc(i):Ne=a}function jr(i,a,c,h){bs=ji=null,Jd(a),Dr=null,qa=0;var p=a.return;try{if(_C(i,p,a,c,Fe)){ut=1,Vl(i,Cn(c,i.current)),Ne=null;return}}catch(v){if(p!==null)throw Ne=p,v;ut=1,Vl(i,Cn(c,i.current)),Ne=null;return}a.flags&32768?(Be||h===1?i=!0:Fr||(Fe&536870912)!==0?i=!1:(oi=i=!0,(h===2||h===9||h===3||h===6)&&(h=un.current,h!==null&&h.tag===13&&(h.flags|=16384))),cv(a,i)):sc(a)}function sc(i){var a=i;do{if((a.flags&32768)!==0){cv(a,oi);return}i=a.return;var c=IC(a.alternate,a,Ms);if(c!==null){Ne=c;return}if(a=a.sibling,a!==null){Ne=a;return}Ne=a=i}while(a!==null);ut===0&&(ut=5)}function cv(i,a){do{var c=OC(i.alternate,i);if(c!==null){c.flags&=32767,Ne=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(i=i.sibling,i!==null)){Ne=i;return}Ne=i=c}while(i!==null);ut=6,Ne=null}function uv(i,a,c,h,p,v,L,I,j){i.cancelPendingCommit=null;do ic();while(St!==0);if((Ve&6)!==0)throw Error(n(327));if(a!==null){if(a===i.current)throw Error(n(177));if(v=a.lanes|a.childLanes,v|=Ld,xL(i,c,v,L,I,j),i===Je&&(Ne=Je=null,Fe=0),Br=a,ui=i,Ns=c,kf=v,Pf=p,Jy=h,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,VC(lr,function(){return gv(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||h){h=P.T,P.T=null,p=F.p,F.p=2,L=Ve,Ve|=4;try{MC(i,a,c)}finally{Ve=L,F.p=p,P.T=h}}St=1,dv(),fv(),hv()}}function dv(){if(St===1){St=0;var i=ui,a=Br,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=P.T,P.T=null;var h=F.p;F.p=2;var p=Ve;Ve|=4;try{Ky(a,i);var v=Qf,L=Qp(i.containerInfo),I=v.focusedElem,j=v.selectionRange;if(L!==I&&I&&I.ownerDocument&&Wp(I.ownerDocument.documentElement,I)){if(j!==null&&Sd(I)){var Q=j.start,ie=j.end;if(ie===void 0&&(ie=Q),"selectionStart"in I)I.selectionStart=Q,I.selectionEnd=Math.min(ie,I.value.length);else{var ce=I.ownerDocument||document,Z=ce&&ce.defaultView||window;if(Z.getSelection){var te=Z.getSelection(),pe=I.textContent.length,Te=Math.min(j.start,pe),Qe=j.end===void 0?Te:Math.min(j.end,pe);!te.extend&&Te>Qe&&(L=Qe,Qe=Te,Te=L);var z=Xp(I,Te),V=Xp(I,Qe);if(z&&V&&(te.rangeCount!==1||te.anchorNode!==z.node||te.anchorOffset!==z.offset||te.focusNode!==V.node||te.focusOffset!==V.offset)){var W=ce.createRange();W.setStart(z.node,z.offset),te.removeAllRanges(),Te>Qe?(te.addRange(W),te.extend(V.node,V.offset)):(W.setEnd(V.node,V.offset),te.addRange(W))}}}}for(ce=[],te=I;te=te.parentNode;)te.nodeType===1&&ce.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<ce.length;I++){var oe=ce[I];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}pc=!!Wf,Qf=Wf=null}finally{Ve=p,F.p=h,P.T=c}}i.current=a,St=2}}function fv(){if(St===2){St=0;var i=ui,a=Br,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=P.T,P.T=null;var h=F.p;F.p=2;var p=Ve;Ve|=4;try{$y(i,a.alternate,a)}finally{Ve=p,F.p=h,P.T=c}}St=3}}function hv(){if(St===4||St===3){St=0,il();var i=ui,a=Br,c=Ns,h=Jy;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?St=5:(St=0,Br=ui=null,mv(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(ci=null),nd(c),a=a.stateNode,an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Da,a,void 0,(a.current.flags&128)===128)}catch{}if(h!==null){a=P.T,p=F.p,F.p=2,P.T=null;try{for(var v=i.onRecoverableError,L=0;L<h.length;L++){var I=h[L];v(I.value,{componentStack:I.stack})}}finally{P.T=a,F.p=p}}(Ns&3)!==0&&ic(),Jn(i),p=i.pendingLanes,(c&261930)!==0&&(p&42)!==0?i===Ff?fo++:(fo=0,Ff=i):fo=0,ho(0)}}function mv(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,za(a)))}function ic(){return dv(),fv(),hv(),gv()}function gv(){if(St!==5)return!1;var i=ui,a=kf;kf=0;var c=nd(Ns),h=P.T,p=F.p;try{F.p=32>c?32:c,P.T=null,c=Pf,Pf=null;var v=ui,L=Ns;if(St=0,Br=ui=null,Ns=0,(Ve&6)!==0)throw Error(n(331));var I=Ve;if(Ve|=4,Wy(v.current),Yy(v,v.current,L,c),Ve=I,ho(0,!1),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Da,v)}catch{}return!0}finally{F.p=p,P.T=h,mv(i,a)}}function pv(i,a,c){a=Cn(c,a),a=gf(i.stateNode,a,2),i=si(i,a,2),i!==null&&(Oa(i,2),Jn(i))}function ze(i,a,c){if(i.tag===3)pv(i,i,c);else for(;a!==null;){if(a.tag===3){pv(a,i,c);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ci===null||!ci.has(h))){i=Cn(c,i),c=yy(2),h=si(a,c,2),h!==null&&(vy(c,h,a,i),Oa(h,2),Jn(h));break}}a=a.return}}function $f(i,a,c){var h=i.pingCache;if(h===null){h=i.pingCache=new PC;var p=new Set;h.set(a,p)}else p=h.get(a),p===void 0&&(p=new Set,h.set(a,p));p.has(c)||(Of=!0,p.add(c),i=jC.bind(null,i,a,c),a.then(i,i))}function jC(i,a,c){var h=i.pingCache;h!==null&&h.delete(a),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,Je===i&&(Fe&c)===c&&(ut===4||ut===3&&(Fe&62914560)===Fe&&300>Ct()-Zl?(Ve&2)===0&&$r(i,0):Mf|=c,Ur===Fe&&(Ur=0)),Jn(i)}function yv(i,a){a===0&&(a=dp()),i=Ui(i,a),i!==null&&(Oa(i,a),Jn(i))}function GC(i){var a=i.memoizedState,c=0;a!==null&&(c=a.retryLane),yv(i,c)}function HC(i,a){var c=0;switch(i.tag){case 31:case 13:var h=i.stateNode,p=i.memoizedState;p!==null&&(c=p.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(a),yv(i,c)}function VC(i,a){return Gt(i,a)}var rc=null,Gr=null,jf=!1,ac=!1,Gf=!1,fi=0;function Jn(i){i!==Gr&&i.next===null&&(Gr===null?rc=Gr=i:Gr=Gr.next=i),ac=!0,jf||(jf=!0,zC())}function ho(i,a){if(!Gf&&ac){Gf=!0;do for(var c=!1,h=rc;h!==null;){if(i!==0){var p=h.pendingLanes;if(p===0)var v=0;else{var L=h.suspendedLanes,I=h.pingedLanes;v=(1<<31-on(42|i)+1)-1,v&=p&~(L&~I),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(c=!0,Sv(h,v))}else v=Fe,v=ul(h,h===Je?v:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(v&3)===0||Ia(h,v)||(c=!0,Sv(h,v));h=h.next}while(c);Gf=!1}}function KC(){vv()}function vv(){ac=jf=!1;var i=0;fi!==0&&n_()&&(i=fi);for(var a=Ct(),c=null,h=rc;h!==null;){var p=h.next,v=xv(h,a);v===0?(h.next=null,c===null?rc=p:c.next=p,p===null&&(Gr=c)):(c=h,(i!==0||(v&3)!==0)&&(ac=!0)),h=p}St!==0&&St!==5||ho(i),fi!==0&&(fi=0)}function xv(i,a){for(var c=i.suspendedLanes,h=i.pingedLanes,p=i.expirationTimes,v=i.pendingLanes&-62914561;0<v;){var L=31-on(v),I=1<<L,j=p[L];j===-1?((I&c)===0||(I&h)!==0)&&(p[L]=vL(I,a)):j<=a&&(i.expiredLanes|=I),v&=~I}if(a=Je,c=Fe,c=ul(i,i===a?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,c===0||i===a&&(Ke===2||Ke===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&Xn(h),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||Ia(i,c)){if(a=c&-c,a===i.callbackPriority)return a;switch(h!==null&&Xn(h),nd(c)){case 2:case 8:c=_a;break;case 32:c=lr;break;case 268435456:c=wa;break;default:c=lr}return h=Ev.bind(null,i),c=Gt(c,h),i.callbackPriority=a,i.callbackNode=c,a}return h!==null&&h!==null&&Xn(h),i.callbackPriority=2,i.callbackNode=null,2}function Ev(i,a){if(St!==0&&St!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(ic()&&i.callbackNode!==c)return null;var h=Fe;return h=ul(i,i===Je?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(tv(i,h,a),xv(i,Ct()),i.callbackNode!=null&&i.callbackNode===c?Ev.bind(null,i):null)}function Sv(i,a){if(ic())return null;tv(i,a,!0)}function zC(){i_(function(){(Ve&6)!==0?Gt(Ys,KC):vv()})}function Hf(){if(fi===0){var i=Cr;i===0&&(i=ol,ol<<=1,(ol&261888)===0&&(ol=256)),fi=i}return fi}function Tv(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ml(""+i)}function bv(i,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,i.id&&c.setAttribute("form",i.id),a.parentNode.insertBefore(c,a),i=new FormData(i),c.parentNode.removeChild(c),i}function YC(i,a,c,h,p){if(a==="submit"&&c&&c.stateNode===p){var v=Tv((p[Xt]||null).action),L=h.submitter;L&&(a=(a=L[Xt]||null)?Tv(a.formAction):L.getAttribute("formAction"),a!==null&&(v=a,L=null));var I=new vl("action","action",null,h,p);i.push({event:I,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(fi!==0){var j=L?bv(p,L):new FormData(p);cf(c,{pending:!0,data:j,method:p.method,action:v},null,j)}}else typeof v=="function"&&(I.preventDefault(),j=L?bv(p,L):new FormData(p),cf(c,{pending:!0,data:j,method:p.method,action:v},v,j))},currentTarget:p}]})}}for(var Vf=0;Vf<Rd.length;Vf++){var Kf=Rd[Vf],qC=Kf.toLowerCase(),XC=Kf[0].toUpperCase()+Kf.slice(1);$n(qC,"on"+XC)}$n(e0,"onAnimationEnd"),$n(t0,"onAnimationIteration"),$n(n0,"onAnimationStart"),$n("dblclick","onDoubleClick"),$n("focusin","onFocus"),$n("focusout","onBlur"),$n(dC,"onTransitionRun"),$n(fC,"onTransitionStart"),$n(hC,"onTransitionCancel"),$n(s0,"onTransitionEnd"),hr("onMouseEnter",["mouseout","mouseover"]),hr("onMouseLeave",["mouseout","mouseover"]),hr("onPointerEnter",["pointerout","pointerover"]),hr("onPointerLeave",["pointerout","pointerover"]),Ni("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ni("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ni("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ni("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ni("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ni("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(mo));function Av(i,a){a=(a&4)!==0;for(var c=0;c<i.length;c++){var h=i[c],p=h.event;h=h.listeners;e:{var v=void 0;if(a)for(var L=h.length-1;0<=L;L--){var I=h[L],j=I.instance,Q=I.currentTarget;if(I=I.listener,j!==v&&p.isPropagationStopped())break e;v=I,p.currentTarget=Q;try{v(p)}catch(ie){Sl(ie)}p.currentTarget=null,v=j}else for(L=0;L<h.length;L++){if(I=h[L],j=I.instance,Q=I.currentTarget,I=I.listener,j!==v&&p.isPropagationStopped())break e;v=I,p.currentTarget=Q;try{v(p)}catch(ie){Sl(ie)}p.currentTarget=null,v=j}}}}function ke(i,a){var c=a[sd];c===void 0&&(c=a[sd]=new Set);var h=i+"__bubble";c.has(h)||(Rv(a,i,2,!1),c.add(h))}function zf(i,a,c){var h=0;a&&(h|=4),Rv(c,i,h,a)}var oc="_reactListening"+Math.random().toString(36).slice(2);function Yf(i){if(!i[oc]){i[oc]=!0,vp.forEach(function(c){c!=="selectionchange"&&(WC.has(c)||zf(c,!1,i),zf(c,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[oc]||(a[oc]=!0,zf("selectionchange",!1,a))}}function Rv(i,a,c,h){switch(ex(a)){case 2:var p=A_;break;case 8:p=R_;break;default:p=lh}c=p.bind(null,a,c,i),p=void 0,!fd||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(p=!0),h?p!==void 0?i.addEventListener(a,c,{capture:!0,passive:p}):i.addEventListener(a,c,!0):p!==void 0?i.addEventListener(a,c,{passive:p}):i.addEventListener(a,c,!1)}function qf(i,a,c,h,p){var v=h;if((a&1)===0&&(a&2)===0&&h!==null)e:for(;;){if(h===null)return;var L=h.tag;if(L===3||L===4){var I=h.stateNode.containerInfo;if(I===p)break;if(L===4)for(L=h.return;L!==null;){var j=L.tag;if((j===3||j===4)&&L.stateNode.containerInfo===p)return;L=L.return}for(;I!==null;){if(L=ur(I),L===null)return;if(j=L.tag,j===5||j===6||j===26||j===27){h=v=L;continue e}I=I.parentNode}}h=h.return}Dp(function(){var Q=v,ie=ud(c),ce=[];e:{var Z=i0.get(i);if(Z!==void 0){var te=vl,pe=i;switch(i){case"keypress":if(pl(c)===0)break e;case"keydown":case"keyup":te=HL;break;case"focusin":pe="focus",te=pd;break;case"focusout":pe="blur",te=pd;break;case"beforeblur":case"afterblur":te=pd;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=Mp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=IL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=zL;break;case e0:case t0:case n0:te=NL;break;case s0:te=qL;break;case"scroll":case"scrollend":te=wL;break;case"wheel":te=WL;break;case"copy":case"cut":case"paste":te=PL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=kp;break;case"toggle":case"beforetoggle":te=ZL}var Te=(a&4)!==0,Qe=!Te&&(i==="scroll"||i==="scrollend"),z=Te?Z!==null?Z+"Capture":null:Z;Te=[];for(var V=Q,W;V!==null;){var oe=V;if(W=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||W===null||z===null||(oe=ka(V,z),oe!=null&&Te.push(go(V,oe,W))),Qe)break;V=V.return}0<Te.length&&(Z=new te(Z,pe,null,c,ie),ce.push({event:Z,listeners:Te}))}}if((a&7)===0){e:{if(Z=i==="mouseover"||i==="pointerover",te=i==="mouseout"||i==="pointerout",Z&&c!==cd&&(pe=c.relatedTarget||c.fromElement)&&(ur(pe)||pe[cr]))break e;if((te||Z)&&(Z=ie.window===ie?ie:(Z=ie.ownerDocument)?Z.defaultView||Z.parentWindow:window,te?(pe=c.relatedTarget||c.toElement,te=Q,pe=pe?ur(pe):null,pe!==null&&(Qe=o(pe),Te=pe.tag,pe!==Qe||Te!==5&&Te!==27&&Te!==6)&&(pe=null)):(te=null,pe=Q),te!==pe)){if(Te=Mp,oe="onMouseLeave",z="onMouseEnter",V="mouse",(i==="pointerout"||i==="pointerover")&&(Te=kp,oe="onPointerLeave",z="onPointerEnter",V="pointer"),Qe=te==null?Z:Na(te),W=pe==null?Z:Na(pe),Z=new Te(oe,V+"leave",te,c,ie),Z.target=Qe,Z.relatedTarget=W,oe=null,ur(ie)===Q&&(Te=new Te(z,V+"enter",pe,c,ie),Te.target=W,Te.relatedTarget=Qe,oe=Te),Qe=oe,te&&pe)t:{for(Te=QC,z=te,V=pe,W=0,oe=z;oe;oe=Te(oe))W++;oe=0;for(var Se=V;Se;Se=Te(Se))oe++;for(;0<W-oe;)z=Te(z),W--;for(;0<oe-W;)V=Te(V),oe--;for(;W--;){if(z===V||V!==null&&z===V.alternate){Te=z;break t}z=Te(z),V=Te(V)}Te=null}else Te=null;te!==null&&Lv(ce,Z,te,Te,!1),pe!==null&&Qe!==null&&Lv(ce,Qe,pe,Te,!0)}}e:{if(Z=Q?Na(Q):window,te=Z.nodeName&&Z.nodeName.toLowerCase(),te==="select"||te==="input"&&Z.type==="file")var je=Hp;else if(jp(Z))if(Vp)je=lC;else{je=aC;var xe=rC}else te=Z.nodeName,!te||te.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?Q&&ld(Q.elementType)&&(je=Hp):je=oC;if(je&&(je=je(i,Q))){Gp(ce,je,c,ie);break e}xe&&xe(i,Z,Q),i==="focusout"&&Q&&Z.type==="number"&&Q.memoizedProps.value!=null&&od(Z,"number",Z.value)}switch(xe=Q?Na(Q):window,i){case"focusin":(jp(xe)||xe.contentEditable==="true")&&(xr=xe,Td=Q,Ha=null);break;case"focusout":Ha=Td=xr=null;break;case"mousedown":bd=!0;break;case"contextmenu":case"mouseup":case"dragend":bd=!1,Zp(ce,c,ie);break;case"selectionchange":if(uC)break;case"keydown":case"keyup":Zp(ce,c,ie)}var we;if(vd)e:{switch(i){case"compositionstart":var Ue="onCompositionStart";break e;case"compositionend":Ue="onCompositionEnd";break e;case"compositionupdate":Ue="onCompositionUpdate";break e}Ue=void 0}else vr?Bp(i,c)&&(Ue="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(Ue="onCompositionStart");Ue&&(Pp&&c.locale!=="ko"&&(vr||Ue!=="onCompositionStart"?Ue==="onCompositionEnd"&&vr&&(we=Ip()):(Ws=ie,hd="value"in Ws?Ws.value:Ws.textContent,vr=!0)),xe=lc(Q,Ue),0<xe.length&&(Ue=new Np(Ue,i,null,c,ie),ce.push({event:Ue,listeners:xe}),we?Ue.data=we:(we=$p(c),we!==null&&(Ue.data=we)))),(we=eC?tC(i,c):nC(i,c))&&(Ue=lc(Q,"onBeforeInput"),0<Ue.length&&(xe=new Np("onBeforeInput","beforeinput",null,c,ie),ce.push({event:xe,listeners:Ue}),xe.data=we)),YC(ce,i,Q,c,ie)}Av(ce,a)})}function go(i,a,c){return{instance:i,listener:a,currentTarget:c}}function lc(i,a){for(var c=a+"Capture",h=[];i!==null;){var p=i,v=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||v===null||(p=ka(i,c),p!=null&&h.unshift(go(i,p,v)),p=ka(i,a),p!=null&&h.push(go(i,p,v))),i.tag===3)return h;i=i.return}return[]}function QC(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Lv(i,a,c,h,p){for(var v=a._reactName,L=[];c!==null&&c!==h;){var I=c,j=I.alternate,Q=I.stateNode;if(I=I.tag,j!==null&&j===h)break;I!==5&&I!==26&&I!==27||Q===null||(j=Q,p?(Q=ka(c,v),Q!=null&&L.unshift(go(c,Q,j))):p||(Q=ka(c,v),Q!=null&&L.push(go(c,Q,j)))),c=c.return}L.length!==0&&i.push({event:a,listeners:L})}var ZC=/\r\n?/g,JC=/\u0000|\uFFFD/g;function Cv(i){return(typeof i=="string"?i:""+i).replace(ZC,`
`).replace(JC,"")}function _v(i,a){return a=Cv(a),Cv(i)===a}function We(i,a,c,h,p,v){switch(c){case"children":typeof h=="string"?a==="body"||a==="textarea"&&h===""||gr(i,h):(typeof h=="number"||typeof h=="bigint")&&a!=="body"&&gr(i,""+h);break;case"className":fl(i,"class",h);break;case"tabIndex":fl(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":fl(i,c,h);break;case"style":_p(i,h,v);break;case"data":if(a!=="object"){fl(i,"data",h);break}case"src":case"href":if(h===""&&(a!=="a"||c!=="href")){i.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=ml(""+h),i.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(c==="formAction"?(a!=="input"&&We(i,a,"name",p.name,p,null),We(i,a,"formEncType",p.formEncType,p,null),We(i,a,"formMethod",p.formMethod,p,null),We(i,a,"formTarget",p.formTarget,p,null)):(We(i,a,"encType",p.encType,p,null),We(i,a,"method",p.method,p,null),We(i,a,"target",p.target,p,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=ml(""+h),i.setAttribute(c,h);break;case"onClick":h!=null&&(i.onclick=xs);break;case"onScroll":h!=null&&ke("scroll",i);break;case"onScrollEnd":h!=null&&ke("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}c=ml(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""+h):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":h===!0?i.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,h):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(c,h):i.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(c):i.setAttribute(c,h);break;case"popover":ke("beforetoggle",i),ke("toggle",i),dl(i,"popover",h);break;case"xlinkActuate":vs(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":vs(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":vs(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":vs(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":vs(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":vs(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":vs(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":vs(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":vs(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":dl(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=CL.get(c)||c,dl(i,c,h))}}function Xf(i,a,c,h,p,v){switch(c){case"style":_p(i,h,v);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof h=="string"?gr(i,h):(typeof h=="number"||typeof h=="bigint")&&gr(i,""+h);break;case"onScroll":h!=null&&ke("scroll",i);break;case"onScrollEnd":h!=null&&ke("scrollend",i);break;case"onClick":h!=null&&(i.onclick=xs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xp.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(p=c.endsWith("Capture"),a=c.slice(2,p?c.length-7:void 0),v=i[Xt]||null,v=v!=null?v[c]:null,typeof v=="function"&&i.removeEventListener(a,v,p),typeof h=="function")){typeof v!="function"&&v!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(a,h,p);break e}c in i?i[c]=h:h===!0?i.setAttribute(c,""):dl(i,c,h)}}}function kt(i,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ke("error",i),ke("load",i);var h=!1,p=!1,v;for(v in c)if(c.hasOwnProperty(v)){var L=c[v];if(L!=null)switch(v){case"src":h=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:We(i,a,v,L,c,null)}}p&&We(i,a,"srcSet",c.srcSet,c,null),h&&We(i,a,"src",c.src,c,null);return;case"input":ke("invalid",i);var I=v=L=p=null,j=null,Q=null;for(h in c)if(c.hasOwnProperty(h)){var ie=c[h];if(ie!=null)switch(h){case"name":p=ie;break;case"type":L=ie;break;case"checked":j=ie;break;case"defaultChecked":Q=ie;break;case"value":v=ie;break;case"defaultValue":I=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(n(137,a));break;default:We(i,a,h,ie,c,null)}}Ap(i,v,I,j,Q,L,p,!1);return;case"select":ke("invalid",i),h=L=v=null;for(p in c)if(c.hasOwnProperty(p)&&(I=c[p],I!=null))switch(p){case"value":v=I;break;case"defaultValue":L=I;break;case"multiple":h=I;default:We(i,a,p,I,c,null)}a=v,c=L,i.multiple=!!h,a!=null?mr(i,!!h,a,!1):c!=null&&mr(i,!!h,c,!0);return;case"textarea":ke("invalid",i),v=p=h=null;for(L in c)if(c.hasOwnProperty(L)&&(I=c[L],I!=null))switch(L){case"value":h=I;break;case"defaultValue":p=I;break;case"children":v=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(91));break;default:We(i,a,L,I,c,null)}Lp(i,h,p,v);return;case"option":for(j in c)if(c.hasOwnProperty(j)&&(h=c[j],h!=null))switch(j){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:We(i,a,j,h,c,null)}return;case"dialog":ke("beforetoggle",i),ke("toggle",i),ke("cancel",i),ke("close",i);break;case"iframe":case"object":ke("load",i);break;case"video":case"audio":for(h=0;h<mo.length;h++)ke(mo[h],i);break;case"image":ke("error",i),ke("load",i);break;case"details":ke("toggle",i);break;case"embed":case"source":case"link":ke("error",i),ke("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in c)if(c.hasOwnProperty(Q)&&(h=c[Q],h!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:We(i,a,Q,h,c,null)}return;default:if(ld(a)){for(ie in c)c.hasOwnProperty(ie)&&(h=c[ie],h!==void 0&&Xf(i,a,ie,h,c,void 0));return}}for(I in c)c.hasOwnProperty(I)&&(h=c[I],h!=null&&We(i,a,I,h,c,null))}function e_(i,a,c,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,v=null,L=null,I=null,j=null,Q=null,ie=null;for(te in c){var ce=c[te];if(c.hasOwnProperty(te)&&ce!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":j=ce;default:h.hasOwnProperty(te)||We(i,a,te,null,h,ce)}}for(var Z in h){var te=h[Z];if(ce=c[Z],h.hasOwnProperty(Z)&&(te!=null||ce!=null))switch(Z){case"type":v=te;break;case"name":p=te;break;case"checked":Q=te;break;case"defaultChecked":ie=te;break;case"value":L=te;break;case"defaultValue":I=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(137,a));break;default:te!==ce&&We(i,a,Z,te,h,ce)}}ad(i,L,I,j,Q,ie,v,p);return;case"select":te=L=I=Z=null;for(v in c)if(j=c[v],c.hasOwnProperty(v)&&j!=null)switch(v){case"value":break;case"multiple":te=j;default:h.hasOwnProperty(v)||We(i,a,v,null,h,j)}for(p in h)if(v=h[p],j=c[p],h.hasOwnProperty(p)&&(v!=null||j!=null))switch(p){case"value":Z=v;break;case"defaultValue":I=v;break;case"multiple":L=v;default:v!==j&&We(i,a,p,v,h,j)}a=I,c=L,h=te,Z!=null?mr(i,!!c,Z,!1):!!h!=!!c&&(a!=null?mr(i,!!c,a,!0):mr(i,!!c,c?[]:"",!1));return;case"textarea":te=Z=null;for(I in c)if(p=c[I],c.hasOwnProperty(I)&&p!=null&&!h.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:We(i,a,I,null,h,p)}for(L in h)if(p=h[L],v=c[L],h.hasOwnProperty(L)&&(p!=null||v!=null))switch(L){case"value":Z=p;break;case"defaultValue":te=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(n(91));break;default:p!==v&&We(i,a,L,p,h,v)}Rp(i,Z,te);return;case"option":for(var pe in c)if(Z=c[pe],c.hasOwnProperty(pe)&&Z!=null&&!h.hasOwnProperty(pe))switch(pe){case"selected":i.selected=!1;break;default:We(i,a,pe,null,h,Z)}for(j in h)if(Z=h[j],te=c[j],h.hasOwnProperty(j)&&Z!==te&&(Z!=null||te!=null))switch(j){case"selected":i.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:We(i,a,j,Z,h,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Te in c)Z=c[Te],c.hasOwnProperty(Te)&&Z!=null&&!h.hasOwnProperty(Te)&&We(i,a,Te,null,h,Z);for(Q in h)if(Z=h[Q],te=c[Q],h.hasOwnProperty(Q)&&Z!==te&&(Z!=null||te!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(n(137,a));break;default:We(i,a,Q,Z,h,te)}return;default:if(ld(a)){for(var Qe in c)Z=c[Qe],c.hasOwnProperty(Qe)&&Z!==void 0&&!h.hasOwnProperty(Qe)&&Xf(i,a,Qe,void 0,h,Z);for(ie in h)Z=h[ie],te=c[ie],!h.hasOwnProperty(ie)||Z===te||Z===void 0&&te===void 0||Xf(i,a,ie,Z,h,te);return}}for(var z in c)Z=c[z],c.hasOwnProperty(z)&&Z!=null&&!h.hasOwnProperty(z)&&We(i,a,z,null,h,Z);for(ce in h)Z=h[ce],te=c[ce],!h.hasOwnProperty(ce)||Z===te||Z==null&&te==null||We(i,a,ce,Z,h,te)}function wv(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function t_(){if(typeof performance.getEntriesByType=="function"){for(var i=0,a=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var p=c[h],v=p.transferSize,L=p.initiatorType,I=p.duration;if(v&&I&&wv(L)){for(L=0,I=p.responseEnd,h+=1;h<c.length;h++){var j=c[h],Q=j.startTime;if(Q>I)break;var ie=j.transferSize,ce=j.initiatorType;ie&&wv(ce)&&(j=j.responseEnd,L+=ie*(j<I?1:(I-Q)/(j-Q)))}if(--h,a+=8*(v+L)/(p.duration/1e3),i++,10<i)break}}if(0<i)return a/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Wf=null,Qf=null;function cc(i){return i.nodeType===9?i:i.ownerDocument}function Dv(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Iv(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function Zf(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Jf=null;function n_(){var i=window.event;return i&&i.type==="popstate"?i===Jf?!1:(Jf=i,!0):(Jf=null,!1)}var Ov=typeof setTimeout=="function"?setTimeout:void 0,s_=typeof clearTimeout=="function"?clearTimeout:void 0,Mv=typeof Promise=="function"?Promise:void 0,i_=typeof queueMicrotask=="function"?queueMicrotask:typeof Mv<"u"?function(i){return Mv.resolve(null).then(i).catch(r_)}:Ov;function r_(i){setTimeout(function(){throw i})}function hi(i){return i==="head"}function Nv(i,a){var c=a,h=0;do{var p=c.nextSibling;if(i.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"||c==="/&"){if(h===0){i.removeChild(p),zr(a);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")po(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,po(c);for(var v=c.firstChild;v;){var L=v.nextSibling,I=v.nodeName;v[Ma]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&v.rel.toLowerCase()==="stylesheet"||c.removeChild(v),v=L}}else c==="body"&&po(i.ownerDocument.body);c=p}while(c);zr(a)}function kv(i,a){var c=i;i=0;do{var h=c.nextSibling;if(c.nodeType===1?a?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(a?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=h}while(c)}function eh(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":eh(c),id(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function a_(i,a,c,h){for(;i.nodeType===1;){var p=c;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[Ma])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(v=i.getAttribute("rel"),v==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(v!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(v=i.getAttribute("src"),(v!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&v&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var v=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===v)return i}else return i;if(i=On(i.nextSibling),i===null)break}return null}function o_(i,a,c){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=On(i.nextSibling),i===null))return null;return i}function Pv(i,a){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=On(i.nextSibling),i===null))return null;return i}function th(i){return i.data==="$?"||i.data==="$~"}function nh(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function l_(i,a){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=a;else if(i.data!=="$?"||c.readyState!=="loading")a();else{var h=function(){a(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function On(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return i}var sh=null;function Fv(i){i=i.nextSibling;for(var a=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(a===0)return On(i.nextSibling);a--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||a++}i=i.nextSibling}return null}function Uv(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(a===0)return i;a--}else c!=="/$"&&c!=="/&"||a++}i=i.previousSibling}return null}function Bv(i,a,c){switch(a=cc(c),i){case"html":if(i=a.documentElement,!i)throw Error(n(452));return i;case"head":if(i=a.head,!i)throw Error(n(453));return i;case"body":if(i=a.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function po(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);id(i)}var Mn=new Map,$v=new Set;function uc(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var ks=F.d;F.d={f:c_,r:u_,D:d_,C:f_,L:h_,m:m_,X:p_,S:g_,M:y_};function c_(){var i=ks.f(),a=tc();return i||a}function u_(i){var a=dr(i);a!==null&&a.tag===5&&a.type==="form"?sy(a):ks.r(i)}var Hr=typeof document>"u"?null:document;function jv(i,a,c){var h=Hr;if(h&&typeof a=="string"&&a){var p=Rn(a);p='link[rel="'+i+'"][href="'+p+'"]',typeof c=="string"&&(p+='[crossorigin="'+c+'"]'),$v.has(p)||($v.add(p),i={rel:i,crossOrigin:c,href:a},h.querySelector(p)===null&&(a=h.createElement("link"),kt(a,"link",i),_t(a),h.head.appendChild(a)))}}function d_(i){ks.D(i),jv("dns-prefetch",i,null)}function f_(i,a){ks.C(i,a),jv("preconnect",i,a)}function h_(i,a,c){ks.L(i,a,c);var h=Hr;if(h&&i&&a){var p='link[rel="preload"][as="'+Rn(a)+'"]';a==="image"&&c&&c.imageSrcSet?(p+='[imagesrcset="'+Rn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(p+='[imagesizes="'+Rn(c.imageSizes)+'"]')):p+='[href="'+Rn(i)+'"]';var v=p;switch(a){case"style":v=Vr(i);break;case"script":v=Kr(i)}Mn.has(v)||(i=g({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:i,as:a},c),Mn.set(v,i),h.querySelector(p)!==null||a==="style"&&h.querySelector(yo(v))||a==="script"&&h.querySelector(vo(v))||(a=h.createElement("link"),kt(a,"link",i),_t(a),h.head.appendChild(a)))}}function m_(i,a){ks.m(i,a);var c=Hr;if(c&&i){var h=a&&typeof a.as=="string"?a.as:"script",p='link[rel="modulepreload"][as="'+Rn(h)+'"][href="'+Rn(i)+'"]',v=p;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Kr(i)}if(!Mn.has(v)&&(i=g({rel:"modulepreload",href:i},a),Mn.set(v,i),c.querySelector(p)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(vo(v)))return}h=c.createElement("link"),kt(h,"link",i),_t(h),c.head.appendChild(h)}}}function g_(i,a,c){ks.S(i,a,c);var h=Hr;if(h&&i){var p=fr(h).hoistableStyles,v=Vr(i);a=a||"default";var L=p.get(v);if(!L){var I={loading:0,preload:null};if(L=h.querySelector(yo(v)))I.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":a},c),(c=Mn.get(v))&&ih(i,c);var j=L=h.createElement("link");_t(j),kt(j,"link",i),j._p=new Promise(function(Q,ie){j.onload=Q,j.onerror=ie}),j.addEventListener("load",function(){I.loading|=1}),j.addEventListener("error",function(){I.loading|=2}),I.loading|=4,dc(L,a,h)}L={type:"stylesheet",instance:L,count:1,state:I},p.set(v,L)}}}function p_(i,a){ks.X(i,a);var c=Hr;if(c&&i){var h=fr(c).hoistableScripts,p=Kr(i),v=h.get(p);v||(v=c.querySelector(vo(p)),v||(i=g({src:i,async:!0},a),(a=Mn.get(p))&&rh(i,a),v=c.createElement("script"),_t(v),kt(v,"link",i),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},h.set(p,v))}}function y_(i,a){ks.M(i,a);var c=Hr;if(c&&i){var h=fr(c).hoistableScripts,p=Kr(i),v=h.get(p);v||(v=c.querySelector(vo(p)),v||(i=g({src:i,async:!0,type:"module"},a),(a=Mn.get(p))&&rh(i,a),v=c.createElement("script"),_t(v),kt(v,"link",i),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},h.set(p,v))}}function Gv(i,a,c,h){var p=(p=fe.current)?uc(p):null;if(!p)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=Vr(c.href),c=fr(p).hoistableStyles,h=c.get(a),h||(h={type:"style",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Vr(c.href);var v=fr(p).hoistableStyles,L=v.get(i);if(L||(p=p.ownerDocument||p,L={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(i,L),(v=p.querySelector(yo(i)))&&!v._p&&(L.instance=v,L.state.loading=5),Mn.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Mn.set(i,c),v||v_(p,i,c,L.state))),a&&h===null)throw Error(n(528,""));return L}if(a&&h!==null)throw Error(n(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Kr(c),c=fr(p).hoistableScripts,h=c.get(a),h||(h={type:"script",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Vr(i){return'href="'+Rn(i)+'"'}function yo(i){return'link[rel="stylesheet"]['+i+"]"}function Hv(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function v_(i,a,c,h){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?h.loading=1:(a=i.createElement("link"),h.preload=a,a.addEventListener("load",function(){return h.loading|=1}),a.addEventListener("error",function(){return h.loading|=2}),kt(a,"link",c),_t(a),i.head.appendChild(a))}function Kr(i){return'[src="'+Rn(i)+'"]'}function vo(i){return"script[async]"+i}function Vv(i,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var h=i.querySelector('style[data-href~="'+Rn(c.href)+'"]');if(h)return a.instance=h,_t(h),h;var p=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),_t(h),kt(h,"style",p),dc(h,c.precedence,i),a.instance=h;case"stylesheet":p=Vr(c.href);var v=i.querySelector(yo(p));if(v)return a.state.loading|=4,a.instance=v,_t(v),v;h=Hv(c),(p=Mn.get(p))&&ih(h,p),v=(i.ownerDocument||i).createElement("link"),_t(v);var L=v;return L._p=new Promise(function(I,j){L.onload=I,L.onerror=j}),kt(v,"link",h),a.state.loading|=4,dc(v,c.precedence,i),a.instance=v;case"script":return v=Kr(c.src),(p=i.querySelector(vo(v)))?(a.instance=p,_t(p),p):(h=c,(p=Mn.get(v))&&(h=g({},c),rh(h,p)),i=i.ownerDocument||i,p=i.createElement("script"),_t(p),kt(p,"link",h),i.head.appendChild(p),a.instance=p);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(h=a.instance,a.state.loading|=4,dc(h,c.precedence,i));return a.instance}function dc(i,a,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=h.length?h[h.length-1]:null,v=p,L=0;L<h.length;L++){var I=h[L];if(I.dataset.precedence===a)v=I;else if(v!==p)break}v?v.parentNode.insertBefore(i,v.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(i,a.firstChild))}function ih(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function rh(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var fc=null;function Kv(i,a,c){if(fc===null){var h=new Map,p=fc=new Map;p.set(c,h)}else p=fc,h=p.get(c),h||(h=new Map,p.set(c,h));if(h.has(i))return h;for(h.set(i,null),c=c.getElementsByTagName(i),p=0;p<c.length;p++){var v=c[p];if(!(v[Ma]||v[It]||i==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var L=v.getAttribute(a)||"";L=i+L;var I=h.get(L);I?I.push(v):h.set(L,[v])}}return h}function zv(i,a,c){i=i.ownerDocument||i,i.head.insertBefore(c,a==="title"?i.querySelector("head > title"):null)}function x_(i,a,c){if(c===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return i=a.disabled,typeof a.precedence=="string"&&i==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Yv(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function E_(i,a,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var p=Vr(h.href),v=a.querySelector(yo(p));if(v){a=v._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(i.count++,i=hc.bind(i),a.then(i,i)),c.state.loading|=4,c.instance=v,_t(v);return}v=a.ownerDocument||a,h=Hv(h),(p=Mn.get(p))&&ih(h,p),v=v.createElement("link"),_t(v);var L=v;L._p=new Promise(function(I,j){L.onload=I,L.onerror=j}),kt(v,"link",h),c.instance=v}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=hc.bind(i),a.addEventListener("load",c),a.addEventListener("error",c))}}var ah=0;function S_(i,a){return i.stylesheets&&i.count===0&&gc(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var h=setTimeout(function(){if(i.stylesheets&&gc(i,i.stylesheets),i.unsuspend){var v=i.unsuspend;i.unsuspend=null,v()}},6e4+a);0<i.imgBytes&&ah===0&&(ah=62500*t_());var p=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&gc(i,i.stylesheets),i.unsuspend)){var v=i.unsuspend;i.unsuspend=null,v()}},(i.imgBytes>ah?50:800)+a);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(h),clearTimeout(p)}}:null}function hc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)gc(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var mc=null;function gc(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,mc=new Map,a.forEach(T_,i),mc=null,hc.call(i))}function T_(i,a){if(!(a.state.loading&4)){var c=mc.get(i);if(c)var h=c.get(null);else{c=new Map,mc.set(i,c);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<p.length;v++){var L=p[v];(L.nodeName==="LINK"||L.getAttribute("media")!=="not all")&&(c.set(L.dataset.precedence,L),h=L)}h&&c.set(null,h)}p=a.instance,L=p.getAttribute("data-precedence"),v=c.get(L)||h,v===h&&c.set(null,p),c.set(L,p),this.count++,h=hc.bind(this),p.addEventListener("load",h),p.addEventListener("error",h),v?v.parentNode.insertBefore(p,v.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),a.state.loading|=4}}var xo={$$typeof:_,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function b_(i,a,c,h,p,v,L,I,j){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ed(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ed(0),this.hiddenUpdates=ed(null),this.identifierPrefix=h,this.onUncaughtError=p,this.onCaughtError=v,this.onRecoverableError=L,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=j,this.incompleteTransitions=new Map}function qv(i,a,c,h,p,v,L,I,j,Q,ie,ce){return i=new b_(i,a,c,L,j,Q,ie,ce,I),a=1,v===!0&&(a|=24),v=cn(3,null,null,a),i.current=v,v.stateNode=i,a=Ud(),a.refCount++,i.pooledCache=a,a.refCount++,v.memoizedState={element:h,isDehydrated:c,cache:a},Gd(v),i}function Xv(i){return i?(i=Tr,i):Tr}function Wv(i,a,c,h,p,v){p=Xv(p),h.context===null?h.context=p:h.pendingContext=p,h=ni(a),h.payload={element:c},v=v===void 0?null:v,v!==null&&(h.callback=v),c=si(i,h,a),c!==null&&(tn(c,i,a),Wa(c,i,a))}function Qv(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<a?c:a}}function oh(i,a){Qv(i,a),(i=i.alternate)&&Qv(i,a)}function Zv(i){if(i.tag===13||i.tag===31){var a=Ui(i,67108864);a!==null&&tn(a,i,67108864),oh(i,67108864)}}function Jv(i){if(i.tag===13||i.tag===31){var a=mn();a=td(a);var c=Ui(i,a);c!==null&&tn(c,i,a),oh(i,a)}}var pc=!0;function A_(i,a,c,h){var p=P.T;P.T=null;var v=F.p;try{F.p=2,lh(i,a,c,h)}finally{F.p=v,P.T=p}}function R_(i,a,c,h){var p=P.T;P.T=null;var v=F.p;try{F.p=8,lh(i,a,c,h)}finally{F.p=v,P.T=p}}function lh(i,a,c,h){if(pc){var p=ch(h);if(p===null)qf(i,a,h,yc,c),tx(i,h);else if(C_(p,i,a,c,h))h.stopPropagation();else if(tx(i,h),a&4&&-1<L_.indexOf(i)){for(;p!==null;){var v=dr(p);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var L=Mi(v.pendingLanes);if(L!==0){var I=v;for(I.pendingLanes|=2,I.entangledLanes|=2;L;){var j=1<<31-on(L);I.entanglements[1]|=j,L&=~j}Jn(v),(Ve&6)===0&&(Jl=Ct()+500,ho(0))}}break;case 31:case 13:I=Ui(v,2),I!==null&&tn(I,v,2),tc(),oh(v,2)}if(v=ch(h),v===null&&qf(i,a,h,yc,c),v===p)break;p=v}p!==null&&h.stopPropagation()}else qf(i,a,h,null,c)}}function ch(i){return i=ud(i),uh(i)}var yc=null;function uh(i){if(yc=null,i=ur(i),i!==null){var a=o(i);if(a===null)i=null;else{var c=a.tag;if(c===13){if(i=l(a),i!==null)return i;i=null}else if(c===31){if(i=u(a),i!==null)return i;i=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return yc=i,null}function ex(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(rl()){case Ys:return 2;case _a:return 8;case lr:case al:return 32;case wa:return 268435456;default:return 32}default:return 32}}var dh=!1,mi=null,gi=null,pi=null,Eo=new Map,So=new Map,yi=[],L_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function tx(i,a){switch(i){case"focusin":case"focusout":mi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":pi=null;break;case"pointerover":case"pointerout":Eo.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":So.delete(a.pointerId)}}function To(i,a,c,h,p,v){return i===null||i.nativeEvent!==v?(i={blockedOn:a,domEventName:c,eventSystemFlags:h,nativeEvent:v,targetContainers:[p]},a!==null&&(a=dr(a),a!==null&&Zv(a)),i):(i.eventSystemFlags|=h,a=i.targetContainers,p!==null&&a.indexOf(p)===-1&&a.push(p),i)}function C_(i,a,c,h,p){switch(a){case"focusin":return mi=To(mi,i,a,c,h,p),!0;case"dragenter":return gi=To(gi,i,a,c,h,p),!0;case"mouseover":return pi=To(pi,i,a,c,h,p),!0;case"pointerover":var v=p.pointerId;return Eo.set(v,To(Eo.get(v)||null,i,a,c,h,p)),!0;case"gotpointercapture":return v=p.pointerId,So.set(v,To(So.get(v)||null,i,a,c,h,p)),!0}return!1}function nx(i){var a=ur(i.target);if(a!==null){var c=o(a);if(c!==null){if(a=c.tag,a===13){if(a=l(c),a!==null){i.blockedOn=a,pp(i.priority,function(){Jv(c)});return}}else if(a===31){if(a=u(c),a!==null){i.blockedOn=a,pp(i.priority,function(){Jv(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function vc(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var c=ch(i.nativeEvent);if(c===null){c=i.nativeEvent;var h=new c.constructor(c.type,c);cd=h,c.target.dispatchEvent(h),cd=null}else return a=dr(c),a!==null&&Zv(a),i.blockedOn=c,!1;a.shift()}return!0}function sx(i,a,c){vc(i)&&c.delete(a)}function __(){dh=!1,mi!==null&&vc(mi)&&(mi=null),gi!==null&&vc(gi)&&(gi=null),pi!==null&&vc(pi)&&(pi=null),Eo.forEach(sx),So.forEach(sx)}function xc(i,a){i.blockedOn===a&&(i.blockedOn=null,dh||(dh=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,__)))}var Ec=null;function ix(i){Ec!==i&&(Ec=i,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Ec===i&&(Ec=null);for(var a=0;a<i.length;a+=3){var c=i[a],h=i[a+1],p=i[a+2];if(typeof h!="function"){if(uh(h||c)===null)continue;break}var v=dr(c);v!==null&&(i.splice(a,3),a-=3,cf(v,{pending:!0,data:p,method:c.method,action:h},h,p))}}))}function zr(i){function a(j){return xc(j,i)}mi!==null&&xc(mi,i),gi!==null&&xc(gi,i),pi!==null&&xc(pi,i),Eo.forEach(a),So.forEach(a);for(var c=0;c<yi.length;c++){var h=yi[c];h.blockedOn===i&&(h.blockedOn=null)}for(;0<yi.length&&(c=yi[0],c.blockedOn===null);)nx(c),c.blockedOn===null&&yi.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var p=c[h],v=c[h+1],L=p[Xt]||null;if(typeof v=="function")L||ix(c);else if(L){var I=null;if(v&&v.hasAttribute("formAction")){if(p=v,L=v[Xt]||null)I=L.formAction;else if(uh(p)!==null)continue}else I=L.action;typeof I=="function"?c[h+1]=I:(c.splice(h,3),h-=3),ix(c)}}}function rx(){function i(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(L){return p=L})},focusReset:"manual",scroll:"manual"})}function a(){p!==null&&(p(),p=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,p=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),p!==null&&(p(),p=null)}}}function fh(i){this._internalRoot=i}Sc.prototype.render=fh.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(n(409));var c=a.current,h=mn();Wv(c,h,i,a,null,null)},Sc.prototype.unmount=fh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;Wv(i.current,2,null,i,null,null),tc(),a[cr]=null}};function Sc(i){this._internalRoot=i}Sc.prototype.unstable_scheduleHydration=function(i){if(i){var a=gp();i={blockedOn:null,target:i,priority:a};for(var c=0;c<yi.length&&a!==0&&a<yi[c].priority;c++);yi.splice(c,0,i),c===0&&nx(i)}};var ax=e.version;if(ax!=="19.2.0")throw Error(n(527,ax,"19.2.0"));F.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=d(a),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var w_={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tc.isDisabled&&Tc.supportsFiber)try{Da=Tc.inject(w_),an=Tc}catch{}}return Ao.createRoot=function(i,a){if(!r(i))throw Error(n(299));var c=!1,h="",p=hy,v=my,L=gy;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(p=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(L=a.onRecoverableError)),a=qv(i,1,!1,null,null,c,h,null,p,v,L,rx),i[cr]=a.current,Yf(i),new fh(a)},Ao.hydrateRoot=function(i,a,c){if(!r(i))throw Error(n(299));var h=!1,p="",v=hy,L=my,I=gy,j=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(v=c.onUncaughtError),c.onCaughtError!==void 0&&(L=c.onCaughtError),c.onRecoverableError!==void 0&&(I=c.onRecoverableError),c.formState!==void 0&&(j=c.formState)),a=qv(i,1,!0,a,c??null,h,p,j,v,L,I,rx),a.context=Xv(null),c=a.current,h=mn(),h=td(h),p=ni(h),p.callback=null,si(c,p,h),c=h,a.current.lanes=c,Oa(a,c),Jn(a),i[cr]=a.current,Yf(i),new Sc(a)},Ao.version="19.2.0",Ao}var px;function B_(){if(px)return mh.exports;px=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),mh.exports=U_(),mh.exports}var $_=B_();function j_(s,e){if(s instanceof RegExp)return{keys:!1,pattern:s};var t,n,r,o,l=[],u="",f=s.split("/");for(f[0]||f.shift();r=f.shift();)t=r[0],t==="*"?(l.push(t),u+=r[1]==="?"?"(?:/(.*))?":"/(.*)"):t===":"?(n=r.indexOf("?",1),o=r.indexOf(".",1),l.push(r.substring(1,~n?n:~o?o:r.length)),u+=~n&&!~o?"(?:/([^/]+?))?":"/([^/]+?)",~o&&(u+=(~n?"?":"")+"\\"+r.substring(o))):u+="/"+r;return{keys:l,pattern:new RegExp("^"+u+(e?"(?=$|/)":"/?$"),"i")}}var A=Du();const Vt=NS(A),rr=I_({__proto__:null,default:Vt},[A]);var xh={exports:{}},Eh={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yx;function G_(){if(yx)return Eh;yx=1;var s=Du();function e(g,y){return g===y&&(g!==0||1/g===1/y)||g!==g&&y!==y}var t=typeof Object.is=="function"?Object.is:e,n=s.useState,r=s.useEffect,o=s.useLayoutEffect,l=s.useDebugValue;function u(g,y){var x=y(),E=n({inst:{value:x,getSnapshot:y}}),S=E[0].inst,b=E[1];return o(function(){S.value=x,S.getSnapshot=y,f(S)&&b({inst:S})},[g,x,y]),r(function(){return f(S)&&b({inst:S}),g(function(){f(S)&&b({inst:S})})},[g]),l(x),x}function f(g){var y=g.getSnapshot;g=g.value;try{var x=y();return!t(g,x)}catch{return!0}}function d(g,y){return y()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:u;return Eh.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:m,Eh}var vx;function H_(){return vx||(vx=1,xh.exports=G_()),xh.exports}var V_=H_();const K_=rr.useInsertionEffect,z_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Y_=z_?A.useLayoutEffect:A.useEffect,q_=K_||Y_,PS=s=>{const e=A.useRef([s,(...t)=>e[0](...t)]).current;return q_(()=>{e[0]=s}),e[1]},X_="popstate",ng="pushState",sg="replaceState",W_="hashchange",xx=[X_,ng,sg,W_],Q_=s=>{for(const e of xx)addEventListener(e,s);return()=>{for(const e of xx)removeEventListener(e,s)}},FS=(s,e)=>V_.useSyncExternalStore(Q_,s,e),Z_=()=>location.search,J_=({ssrSearch:s=""}={})=>FS(Z_,()=>s),Ex=()=>location.pathname,ew=({ssrPath:s}={})=>FS(Ex,s?()=>s:Ex),tw=(s,{replace:e=!1,state:t=null}={})=>history[e?sg:ng](t,"",s),nw=(s={})=>[ew(s),tw],Sx=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Sx]>"u"){for(const s of[ng,sg]){const e=history[s];history[s]=function(){const t=e.apply(this,arguments),n=new Event(s);return n.arguments=arguments,dispatchEvent(n),t}}Object.defineProperty(window,Sx,{value:!0})}const sw=(s,e)=>e.toLowerCase().indexOf(s.toLowerCase())?"~"+e:e.slice(s.length)||"/",US=(s="")=>s==="/"?"":s,iw=(s,e)=>s[0]==="~"?s.slice(1):US(e)+s,rw=(s="",e)=>sw(Tx(US(s)),Tx(e)),Tx=s=>{try{return decodeURI(s)}catch{return s}},BS={hook:nw,searchHook:J_,parser:j_,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:s=>s},$S=A.createContext(BS),Ta=()=>A.useContext($S),jS={},GS=A.createContext(jS),aw=()=>A.useContext(GS),Iu=s=>{const[e,t]=s.hook(s);return[rw(s.base,e),PS((n,r)=>t(iw(n,s.base),r))]},ig=()=>Iu(Ta()),rg=(s,e,t,n)=>{const{pattern:r,keys:o}=e instanceof RegExp?{keys:!1,pattern:e}:s(e||"*",n),l=r.exec(t)||[],[u,...f]=l;return u!==void 0?[!0,(()=>{const d=o!==!1?Object.fromEntries(o.map((g,y)=>[g,f[y]])):l.groups;let m={...f};return d&&Object.assign(m,d),m})(),...n?[u]:[]]:[!1,null]},ow=s=>rg(Ta().parser,s,ig()[0]),lw=({children:s,...e})=>{const t=Ta(),n=e.hook?BS:t;let r=n;const[o,l]=e.ssrPath?.split("?")??[];l&&(e.ssrSearch=l,e.ssrPath=o),e.hrefs=e.hrefs??e.hook?.hrefs;let u=A.useRef({}),f=u.current,d=f;for(let m in n){const g=m==="base"?n[m]+(e[m]||""):e[m]||n[m];f===d&&g!==d[m]&&(u.current=d={...d}),d[m]=g,g!==n[m]&&(r=d)}return A.createElement($S.Provider,{value:r,children:s})},bx=({children:s,component:e},t)=>e?A.createElement(e,{params:t}):typeof s=="function"?s(t):s,cw=s=>{let e=A.useRef(jS),t=e.current;for(const n in s)s[n]!==t[n]&&(t=s);return Object.keys(s).length===0&&(t=s),e.current=t},es=({path:s,nest:e,match:t,...n})=>{const r=Ta(),[o]=Iu(r),[l,u,f]=t??rg(r.parser,s,o,e),d=cw({...aw(),...u});if(!l)return null;const m=f?A.createElement(lw,{base:f},bx(n,d)):bx(n,d);return A.createElement(GS.Provider,{value:d,children:m})},Hs=A.forwardRef((s,e)=>{const t=Ta(),[n,r]=Iu(t),{to:o="",href:l=o,onClick:u,asChild:f,children:d,className:m,replace:g,state:y,...x}=s,E=PS(b=>{b.ctrlKey||b.metaKey||b.altKey||b.shiftKey||b.button!==0||(u?.(b),b.defaultPrevented||(b.preventDefault(),r(l,s)))}),S=t.hrefs(l[0]==="~"?l.slice(1):t.base+l,t);return f&&A.isValidElement(d)?A.cloneElement(d,{onClick:E,href:S}):A.createElement("a",{...x,onClick:E,href:S,className:m?.call?m(n===l):m,children:d,ref:e})}),HS=s=>Array.isArray(s)?s.flatMap(e=>HS(e&&e.type===A.Fragment?e.props.children:e)):[s],uw=({children:s,location:e})=>{const t=Ta(),[n]=Iu(t);for(const r of HS(s)){let o=0;if(A.isValidElement(r)&&(o=rg(t.parser,r.props.path,e||n,r.props.nest))[0])return A.cloneElement(r,{match:o})}return null};var Ou=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Mu=typeof window>"u"||"Deno"in globalThis;function Kn(){}function dw(s,e){return typeof s=="function"?s(e):s}function fw(s){return typeof s=="number"&&s>=0&&s!==1/0}function hw(s,e){return Math.max(s+(e||0)-Date.now(),0)}function Ax(s,e){return typeof s=="function"?s(e):s}function mw(s,e){return typeof s=="function"?s(e):s}function Rx(s,e){const{type:t="all",exact:n,fetchStatus:r,predicate:o,queryKey:l,stale:u}=s;if(l){if(n){if(e.queryHash!==ag(l,e.options))return!1}else if(!Uo(e.queryKey,l))return!1}if(t!=="all"){const f=e.isActive();if(t==="active"&&!f||t==="inactive"&&f)return!1}return!(typeof u=="boolean"&&e.isStale()!==u||r&&r!==e.state.fetchStatus||o&&!o(e))}function Lx(s,e){const{exact:t,status:n,predicate:r,mutationKey:o}=s;if(o){if(!e.options.mutationKey)return!1;if(t){if(Fo(e.options.mutationKey)!==Fo(o))return!1}else if(!Uo(e.options.mutationKey,o))return!1}return!(n&&e.state.status!==n||r&&!r(e))}function ag(s,e){return(e?.queryKeyHashFn||Fo)(s)}function Fo(s){return JSON.stringify(s,(e,t)=>lm(t)?Object.keys(t).sort().reduce((n,r)=>(n[r]=t[r],n),{}):t)}function Uo(s,e){return s===e?!0:typeof s!=typeof e?!1:s&&e&&typeof s=="object"&&typeof e=="object"?!Object.keys(e).some(t=>!Uo(s[t],e[t])):!1}function VS(s,e){if(s===e)return s;const t=Cx(s)&&Cx(e);if(t||lm(s)&&lm(e)){const n=t?s:Object.keys(s),r=n.length,o=t?e:Object.keys(e),l=o.length,u=t?[]:{};let f=0;for(let d=0;d<l;d++){const m=t?d:o[d];(!t&&n.includes(m)||t)&&s[m]===void 0&&e[m]===void 0?(u[m]=void 0,f++):(u[m]=VS(s[m],e[m]),u[m]===s[m]&&s[m]!==void 0&&f++)}return r===l&&f===r?s:u}return e}function Cx(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function lm(s){if(!_x(s))return!1;const e=s.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!_x(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function _x(s){return Object.prototype.toString.call(s)==="[object Object]"}function gw(s){return new Promise(e=>{setTimeout(e,s)})}function pw(s,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(s,e):t.structuralSharing!==!1?VS(s,e):e}function yw(s,e,t=0){const n=[...s,e];return t&&n.length>t?n.slice(1):n}function vw(s,e,t=0){const n=[e,...s];return t&&n.length>t?n.slice(0,-1):n}var og=Symbol();function KS(s,e){return!s.queryFn&&e?.initialPromise?()=>e.initialPromise:!s.queryFn||s.queryFn===og?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}var xw=class extends Ou{#e;#t;#n;constructor(){super(),this.#n=s=>{if(!Mu&&window.addEventListener){const e=()=>s();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(s){this.#n=s,this.#t?.(),this.#t=s(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(s){this.#e!==s&&(this.#e=s,this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(e=>{e(s)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},zS=new xw,Ew=class extends Ou{#e=!0;#t;#n;constructor(){super(),this.#n=s=>{if(!Mu&&window.addEventListener){const e=()=>s(!0),t=()=>s(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(s){this.#n=s,this.#t?.(),this.#t=s(this.setOnline.bind(this))}setOnline(s){this.#e!==s&&(this.#e=s,this.listeners.forEach(t=>{t(s)}))}isOnline(){return this.#e}},cu=new Ew;function Sw(){let s,e;const t=new Promise((r,o)=>{s=r,e=o});t.status="pending",t.catch(()=>{});function n(r){Object.assign(t,r),delete t.resolve,delete t.reject}return t.resolve=r=>{n({status:"fulfilled",value:r}),s(r)},t.reject=r=>{n({status:"rejected",reason:r}),e(r)},t}function Tw(s){return Math.min(1e3*2**s,3e4)}function YS(s){return(s??"online")==="online"?cu.isOnline():!0}var qS=class extends Error{constructor(s){super("CancelledError"),this.revert=s?.revert,this.silent=s?.silent}};function Sh(s){return s instanceof qS}function XS(s){let e=!1,t=0,n=!1,r;const o=Sw(),l=S=>{n||(y(new qS(S)),s.abort?.())},u=()=>{e=!0},f=()=>{e=!1},d=()=>zS.isFocused()&&(s.networkMode==="always"||cu.isOnline())&&s.canRun(),m=()=>YS(s.networkMode)&&s.canRun(),g=S=>{n||(n=!0,s.onSuccess?.(S),r?.(),o.resolve(S))},y=S=>{n||(n=!0,s.onError?.(S),r?.(),o.reject(S))},x=()=>new Promise(S=>{r=b=>{(n||d())&&S(b)},s.onPause?.()}).then(()=>{r=void 0,n||s.onContinue?.()}),E=()=>{if(n)return;let S;const b=t===0?s.initialPromise:void 0;try{S=b??s.fn()}catch(R){S=Promise.reject(R)}Promise.resolve(S).then(g).catch(R=>{if(n)return;const w=s.retry??(Mu?0:3),_=s.retryDelay??Tw,D=typeof _=="function"?_(t,R):_,M=w===!0||typeof w=="number"&&t<w||typeof w=="function"&&w(t,R);if(e||!M){y(R);return}t++,s.onFail?.(t,R),gw(D).then(()=>d()?void 0:x()).then(()=>{e?y(R):E()})})};return{promise:o,cancel:l,continue:()=>(r?.(),o),cancelRetry:u,continueRetry:f,canStart:m,start:()=>(m()?E():x().then(E),o)}}function bw(){let s=[],e=0,t=u=>{u()},n=u=>{u()},r=u=>setTimeout(u,0);const o=u=>{e?s.push(u):r(()=>{t(u)})},l=()=>{const u=s;s=[],u.length&&r(()=>{n(()=>{u.forEach(f=>{t(f)})})})};return{batch:u=>{let f;e++;try{f=u()}finally{e--,e||l()}return f},batchCalls:u=>(...f)=>{o(()=>{u(...f)})},schedule:o,setNotifyFunction:u=>{t=u},setBatchNotifyFunction:u=>{n=u},setScheduler:u=>{r=u}}}var Kt=bw(),WS=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),fw(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(Mu?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},Aw=class extends WS{#e;#t;#n;#s;#a;#r;constructor(s){super(),this.#r=!1,this.#a=s.defaultOptions,this.setOptions(s.options),this.observers=[],this.#n=s.cache,this.queryKey=s.queryKey,this.queryHash=s.queryHash,this.#e=Lw(this.options),this.state=s.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(s){this.options={...this.#a,...s},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(s,e){const t=pw(this.state.data,s,this.options);return this.#i({data:t,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),t}setState(s,e){this.#i({type:"setState",state:s,setStateOptions:e})}cancel(s){const e=this.#s?.promise;return this.#s?.cancel(s),e?e.then(Kn).catch(Kn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(s=>mw(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===og||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(s=0){return this.state.isInvalidated||this.state.data===void 0||!hw(this.state.dataUpdatedAt,s)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(e=>e!==s),this.observers.length||(this.#s&&(this.#r?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}fetch(s,e){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(s&&this.setOptions(s),!this.options.queryFn){const u=this.observers.find(f=>f.options.queryFn);u&&this.setOptions(u.options)}const t=new AbortController,n=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(this.#r=!0,t.signal)})},r=()=>{const u=KS(this.options,e),f={queryKey:this.queryKey,meta:this.meta};return n(f),this.#r=!1,this.options.persister?this.options.persister(u,f,this):u(f)},o={fetchOptions:e,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:r};n(o),this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#i({type:"fetch",meta:o.fetchOptions?.meta});const l=u=>{Sh(u)&&u.silent||this.#i({type:"error",error:u}),Sh(u)||(this.#n.config.onError?.(u,this),this.#n.config.onSettled?.(this.state.data,u,this)),this.scheduleGc()};return this.#s=XS({initialPromise:e?.initialPromise,fn:o.fetchFn,abort:t.abort.bind(t),onSuccess:u=>{if(u===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(u)}catch(f){l(f);return}this.#n.config.onSuccess?.(u,this),this.#n.config.onSettled?.(u,this.state.error,this),this.scheduleGc()},onError:l,onFail:(u,f)=>{this.#i({type:"failed",failureCount:u,error:f})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}),this.#s.start()}#i(s){const e=t=>{switch(s.type){case"failed":return{...t,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...Rw(t.data,this.options),fetchMeta:s.meta??null};case"success":return{...t,data:s.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:s.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=s.error;return Sh(n)&&n.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...s.state}}};this.state=e(this.state),Kt.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:s})})}};function Rw(s,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:YS(e.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function Lw(s){const e=typeof s.initialData=="function"?s.initialData():s.initialData,t=e!==void 0,n=t?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var Cw=class extends Ou{constructor(s={}){super(),this.config=s,this.#e=new Map}#e;build(s,e,t){const n=e.queryKey,r=e.queryHash??ag(n,e);let o=this.get(r);return o||(o=new Aw({cache:this,queryKey:n,queryHash:r,options:s.defaultQueryOptions(e),state:t,defaultOptions:s.getQueryDefaults(n)}),this.add(o)),o}add(s){this.#e.has(s.queryHash)||(this.#e.set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const e=this.#e.get(s.queryHash);e&&(s.destroy(),e===s&&this.#e.delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){Kt.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return this.#e.get(s)}getAll(){return[...this.#e.values()]}find(s){const e={exact:!0,...s};return this.getAll().find(t=>Rx(e,t))}findAll(s={}){const e=this.getAll();return Object.keys(s).length>0?e.filter(t=>Rx(s,t)):e}notify(s){Kt.batch(()=>{this.listeners.forEach(e=>{e(s)})})}onFocus(){Kt.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){Kt.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},_w=class extends WS{#e;#t;#n;constructor(s){super(),this.mutationId=s.mutationId,this.#t=s.mutationCache,this.#e=[],this.state=s.state||ww(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){this.#e.includes(s)||(this.#e.push(s),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){this.#e=this.#e.filter(e=>e!==s),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(s){this.#n=XS({fn:()=>this.options.mutationFn?this.options.mutationFn(s):Promise.reject(new Error("No mutationFn found")),onFail:(n,r)=>{this.#s({type:"failed",failureCount:n,error:r})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const e=this.state.status==="pending",t=!this.#n.canStart();try{if(!e){this.#s({type:"pending",variables:s,isPaused:t}),await this.#t.config.onMutate?.(s,this);const r=await this.options.onMutate?.(s);r!==this.state.context&&this.#s({type:"pending",context:r,variables:s,isPaused:t})}const n=await this.#n.start();return await this.#t.config.onSuccess?.(n,s,this.state.context,this),await this.options.onSuccess?.(n,s,this.state.context),await this.#t.config.onSettled?.(n,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(n,null,s,this.state.context),this.#s({type:"success",data:n}),n}catch(n){try{throw await this.#t.config.onError?.(n,s,this.state.context,this),await this.options.onError?.(n,s,this.state.context),await this.#t.config.onSettled?.(void 0,n,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,n,s,this.state.context),n}finally{this.#s({type:"error",error:n})}}finally{this.#t.runNext(this)}}#s(s){const e=t=>{switch(s.type){case"failed":return{...t,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...t,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:s.error,failureCount:t.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=e(this.state),Kt.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(s)}),this.#t.notify({mutation:this,type:"updated",action:s})})}};function ww(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Dw=class extends Ou{constructor(s={}){super(),this.config=s,this.#e=new Map,this.#t=Date.now()}#e;#t;build(s,e,t){const n=new _w({mutationCache:this,mutationId:++this.#t,options:s.defaultMutationOptions(e),state:t});return this.add(n),n}add(s){const e=bc(s),t=this.#e.get(e)??[];t.push(s),this.#e.set(e,t),this.notify({type:"added",mutation:s})}remove(s){const e=bc(s);if(this.#e.has(e)){const t=this.#e.get(e)?.filter(n=>n!==s);t&&(t.length===0?this.#e.delete(e):this.#e.set(e,t))}this.notify({type:"removed",mutation:s})}canRun(s){const e=this.#e.get(bc(s))?.find(t=>t.state.status==="pending");return!e||e===s}runNext(s){return this.#e.get(bc(s))?.find(t=>t!==s&&t.state.isPaused)?.continue()??Promise.resolve()}clear(){Kt.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}getAll(){return[...this.#e.values()].flat()}find(s){const e={exact:!0,...s};return this.getAll().find(t=>Lx(e,t))}findAll(s={}){return this.getAll().filter(e=>Lx(s,e))}notify(s){Kt.batch(()=>{this.listeners.forEach(e=>{e(s)})})}resumePausedMutations(){const s=this.getAll().filter(e=>e.state.isPaused);return Kt.batch(()=>Promise.all(s.map(e=>e.continue().catch(Kn))))}};function bc(s){return s.options.scope?.id??String(s.mutationId)}function wx(s){return{onFetch:(e,t)=>{const n=e.options,r=e.fetchOptions?.meta?.fetchMore?.direction,o=e.state.data?.pages||[],l=e.state.data?.pageParams||[];let u={pages:[],pageParams:[]},f=0;const d=async()=>{let m=!1;const g=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(e.signal.aborted?m=!0:e.signal.addEventListener("abort",()=>{m=!0}),e.signal)})},y=KS(e.options,e.fetchOptions),x=async(E,S,b)=>{if(m)return Promise.reject();if(S==null&&E.pages.length)return Promise.resolve(E);const R={queryKey:e.queryKey,pageParam:S,direction:b?"backward":"forward",meta:e.options.meta};g(R);const w=await y(R),{maxPages:_}=e.options,D=b?vw:yw;return{pages:D(E.pages,w,_),pageParams:D(E.pageParams,S,_)}};if(r&&o.length){const E=r==="backward",S=E?Iw:Dx,b={pages:o,pageParams:l},R=S(n,b);u=await x(b,R,E)}else{const E=s??o.length;do{const S=f===0?l[0]??n.initialPageParam:Dx(n,u);if(f>0&&S==null)break;u=await x(u,S),f++}while(f<E)}return u};e.options.persister?e.fetchFn=()=>e.options.persister?.(d,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t):e.fetchFn=d}}}function Dx(s,{pages:e,pageParams:t}){const n=e.length-1;return e.length>0?s.getNextPageParam(e[n],e,t[n],t):void 0}function Iw(s,{pages:e,pageParams:t}){return e.length>0?s.getPreviousPageParam?.(e[0],e,t[0],t):void 0}var Ow=class{#e;#t;#n;#s;#a;#r;#i;#o;constructor(s={}){this.#e=s.queryCache||new Cw,this.#t=s.mutationCache||new Dw,this.#n=s.defaultOptions||{},this.#s=new Map,this.#a=new Map,this.#r=0}mount(){this.#r++,this.#r===1&&(this.#i=zS.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#o=cu.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#r--,this.#r===0&&(this.#i?.(),this.#i=void 0,this.#o?.(),this.#o=void 0)}isFetching(s){return this.#e.findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return this.#t.findAll({...s,status:"pending"}).length}getQueryData(s){const e=this.defaultQueryOptions({queryKey:s});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(s){const e=this.getQueryData(s.queryKey);if(e===void 0)return this.fetchQuery(s);{const t=this.defaultQueryOptions(s),n=this.#e.build(this,t);return s.revalidateIfStale&&n.isStaleByTime(Ax(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(e)}}getQueriesData(s){return this.#e.findAll(s).map(({queryKey:e,state:t})=>{const n=t.data;return[e,n]})}setQueryData(s,e,t){const n=this.defaultQueryOptions({queryKey:s}),o=this.#e.get(n.queryHash)?.state.data,l=dw(e,o);if(l!==void 0)return this.#e.build(this,n).setData(l,{...t,manual:!0})}setQueriesData(s,e,t){return Kt.batch(()=>this.#e.findAll(s).map(({queryKey:n})=>[n,this.setQueryData(n,e,t)]))}getQueryState(s){const e=this.defaultQueryOptions({queryKey:s});return this.#e.get(e.queryHash)?.state}removeQueries(s){const e=this.#e;Kt.batch(()=>{e.findAll(s).forEach(t=>{e.remove(t)})})}resetQueries(s,e){const t=this.#e,n={type:"active",...s};return Kt.batch(()=>(t.findAll(s).forEach(r=>{r.reset()}),this.refetchQueries(n,e)))}cancelQueries(s={},e={}){const t={revert:!0,...e},n=Kt.batch(()=>this.#e.findAll(s).map(r=>r.cancel(t)));return Promise.all(n).then(Kn).catch(Kn)}invalidateQueries(s={},e={}){return Kt.batch(()=>{if(this.#e.findAll(s).forEach(n=>{n.invalidate()}),s.refetchType==="none")return Promise.resolve();const t={...s,type:s.refetchType??s.type??"active"};return this.refetchQueries(t,e)})}refetchQueries(s={},e){const t={...e,cancelRefetch:e?.cancelRefetch??!0},n=Kt.batch(()=>this.#e.findAll(s).filter(r=>!r.isDisabled()).map(r=>{let o=r.fetch(void 0,t);return t.throwOnError||(o=o.catch(Kn)),r.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(Kn)}fetchQuery(s){const e=this.defaultQueryOptions(s);e.retry===void 0&&(e.retry=!1);const t=this.#e.build(this,e);return t.isStaleByTime(Ax(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(Kn).catch(Kn)}fetchInfiniteQuery(s){return s.behavior=wx(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(Kn).catch(Kn)}ensureInfiniteQueryData(s){return s.behavior=wx(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return cu.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(s){this.#n=s}setQueryDefaults(s,e){this.#s.set(Fo(s),{queryKey:s,defaultOptions:e})}getQueryDefaults(s){const e=[...this.#s.values()];let t={};return e.forEach(n=>{Uo(s,n.queryKey)&&(t={...t,...n.defaultOptions})}),t}setMutationDefaults(s,e){this.#a.set(Fo(s),{mutationKey:s,defaultOptions:e})}getMutationDefaults(s){const e=[...this.#a.values()];let t={};return e.forEach(n=>{Uo(s,n.mutationKey)&&(t={...t,...n.defaultOptions})}),t}defaultQueryOptions(s){if(s._defaulted)return s;const e={...this.#n.queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return e.queryHash||(e.queryHash=ag(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===og&&(e.enabled=!1),e}defaultMutationOptions(s){return s?._defaulted?s:{...this.#n.mutations,...s?.mutationKey&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Mw=A.createContext(void 0),Nw=({client:s,children:e})=>(A.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),T.jsx(Mw.Provider,{value:s,children:e}));async function kw(s){if(!s.ok){const e=await s.text()||s.statusText;throw new Error(`${s.status}: ${e}`)}}const Pw=({on401:s})=>async({queryKey:e})=>{const t=await fetch(e.join("/"),{credentials:"include"});return await kw(t),await t.json()},Fw=new Ow({defaultOptions:{queries:{queryFn:Pw({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),Uw=1,Bw=1e6;let Th=0;function $w(){return Th=(Th+1)%Number.MAX_SAFE_INTEGER,Th.toString()}const bh=new Map,Ix=s=>{if(bh.has(s))return;const e=setTimeout(()=>{bh.delete(s),Oo({type:"REMOVE_TOAST",toastId:s})},Bw);bh.set(s,e)},jw=(s,e)=>{switch(e.type){case"ADD_TOAST":return{...s,toasts:[e.toast,...s.toasts].slice(0,Uw)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?Ix(t):s.toasts.forEach(n=>{Ix(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===t||t===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return e.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==e.toastId)}}},Wc=[];let Qc={toasts:[]};function Oo(s){Qc=jw(Qc,s),Wc.forEach(e=>{e(Qc)})}function Gw({...s}){const e=$w(),t=r=>Oo({type:"UPDATE_TOAST",toast:{...r,id:e}}),n=()=>Oo({type:"DISMISS_TOAST",toastId:e});return Oo({type:"ADD_TOAST",toast:{...s,id:e,open:!0,onOpenChange:r=>{r||n()}}}),{id:e,dismiss:n,update:t}}function QS(){const[s,e]=A.useState(Qc);return A.useEffect(()=>(Wc.push(e),()=>{const t=Wc.indexOf(e);t>-1&&Wc.splice(t,1)}),[s]),{...s,toast:Gw,dismiss:t=>Oo({type:"DISMISS_TOAST",toastId:t})}}var Qo=kS();const ZS=NS(Qo);function En(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}function Ox(s,e){if(typeof s=="function")return s(e);s!=null&&(s.current=e)}function zs(...s){return e=>{let t=!1;const n=s.map(r=>{const o=Ox(r,e);return!t&&typeof o=="function"&&(t=!0),o});if(t)return()=>{for(let r=0;r<n.length;r++){const o=n[r];typeof o=="function"?o():Ox(s[r],null)}}}}function He(...s){return A.useCallback(zs(...s),s)}function Hw(s,e){const t=A.createContext(e),n=o=>{const{children:l,...u}=o,f=A.useMemo(()=>u,Object.values(u));return T.jsx(t.Provider,{value:f,children:l})};n.displayName=s+"Provider";function r(o){const l=A.useContext(t);if(l)return l;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${s}\``)}return[n,r]}function hs(s,e=[]){let t=[];function n(o,l){const u=A.createContext(l),f=t.length;t=[...t,l];const d=g=>{const{scope:y,children:x,...E}=g,S=y?.[s]?.[f]||u,b=A.useMemo(()=>E,Object.values(E));return T.jsx(S.Provider,{value:b,children:x})};d.displayName=o+"Provider";function m(g,y){const x=y?.[s]?.[f]||u,E=A.useContext(x);if(E)return E;if(l!==void 0)return l;throw new Error(`\`${g}\` must be used within \`${o}\``)}return[d,m]}const r=()=>{const o=t.map(l=>A.createContext(l));return function(u){const f=u?.[s]||o;return A.useMemo(()=>({[`__scope${s}`]:{...u,[s]:f}}),[u,f])}};return r.scopeName=s,[n,Vw(r,...e)]}function Vw(...s){const e=s[0];if(s.length===1)return e;const t=()=>{const n=s.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(o){const l=n.reduce((u,{useScope:f,scopeName:d})=>{const g=f(o)[`__scope${d}`];return{...u,...g}},{});return A.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return t.scopeName=e.scopeName,t}function cm(s){const e=Kw(s),t=A.forwardRef((n,r)=>{const{children:o,...l}=n,u=A.Children.toArray(o),f=u.find(Yw);if(f){const d=f.props.children,m=u.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}function Kw(s){const e=A.forwardRef((t,n)=>{const{children:r,...o}=t;if(A.isValidElement(r)){const l=Xw(r),u=qw(o,r.props);return r.type!==A.Fragment&&(u.ref=n?zs(n,l):l),A.cloneElement(r,u)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var zw=Symbol("radix.slottable");function Yw(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===zw}function qw(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{o(...u),r(...u)}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function Xw(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}function Ww(s){const e=s+"CollectionProvider",[t,n]=hs(e),[r,o]=t(e,{collectionRef:{current:null},itemMap:new Map}),l=S=>{const{scope:b,children:R}=S,w=Vt.useRef(null),_=Vt.useRef(new Map).current;return T.jsx(r,{scope:b,itemMap:_,collectionRef:w,children:R})};l.displayName=e;const u=s+"CollectionSlot",f=cm(u),d=Vt.forwardRef((S,b)=>{const{scope:R,children:w}=S,_=o(u,R),D=He(b,_.collectionRef);return T.jsx(f,{ref:D,children:w})});d.displayName=u;const m=s+"CollectionItemSlot",g="data-radix-collection-item",y=cm(m),x=Vt.forwardRef((S,b)=>{const{scope:R,children:w,..._}=S,D=Vt.useRef(null),M=He(b,D),$=o(m,R);return Vt.useEffect(()=>($.itemMap.set(D,{ref:D,..._}),()=>void $.itemMap.delete(D))),T.jsx(y,{[g]:"",ref:M,children:w})});x.displayName=m;function E(S){const b=o(s+"CollectionConsumer",S);return Vt.useCallback(()=>{const w=b.collectionRef.current;if(!w)return[];const _=Array.from(w.querySelectorAll(`[${g}]`));return Array.from(b.itemMap.values()).sort(($,O)=>_.indexOf($.ref.current)-_.indexOf(O.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:l,Slot:d,ItemSlot:x},E,n]}var Qw=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ms=Qw.reduce((s,e)=>{const t=cm(`Primitive.${e}`),n=A.forwardRef((r,o)=>{const{asChild:l,...u}=r,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),T.jsx(f,{...u,ref:o})});return n.displayName=`Primitive.${e}`,{...s,[e]:n}},{});function JS(s,e){s&&Qo.flushSync(()=>s.dispatchEvent(e))}function Bt(s){const e=A.useRef(s);return A.useEffect(()=>{e.current=s}),A.useMemo(()=>(...t)=>e.current?.(...t),[])}function eT(s,e=globalThis?.document){const t=Bt(s);A.useEffect(()=>{const n=r=>{r.key==="Escape"&&t(r)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var Zw="DismissableLayer",um="dismissableLayer.update",Jw="dismissableLayer.pointerDownOutside",eD="dismissableLayer.focusOutside",Mx,tT=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),nT=A.forwardRef((s,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:o,onInteractOutside:l,onDismiss:u,...f}=s,d=A.useContext(tT),[m,g]=A.useState(null),y=m?.ownerDocument??globalThis?.document,[,x]=A.useState({}),E=He(e,O=>g(O)),S=Array.from(d.layers),[b]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),R=S.indexOf(b),w=m?S.indexOf(m):-1,_=d.layersWithOutsidePointerEventsDisabled.size>0,D=w>=R,M=nD(O=>{const k=O.target,G=[...d.branches].some(B=>B.contains(k));!D||G||(r?.(O),l?.(O),O.defaultPrevented||u?.())},y),$=sD(O=>{const k=O.target;[...d.branches].some(B=>B.contains(k))||(o?.(O),l?.(O),O.defaultPrevented||u?.())},y);return eT(O=>{w===d.layers.size-1&&(n?.(O),!O.defaultPrevented&&u&&(O.preventDefault(),u()))},y),A.useEffect(()=>{if(m)return t&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(Mx=y.body.style.pointerEvents,y.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(m)),d.layers.add(m),Nx(),()=>{t&&d.layersWithOutsidePointerEventsDisabled.size===1&&(y.body.style.pointerEvents=Mx)}},[m,y,t,d]),A.useEffect(()=>()=>{m&&(d.layers.delete(m),d.layersWithOutsidePointerEventsDisabled.delete(m),Nx())},[m,d]),A.useEffect(()=>{const O=()=>x({});return document.addEventListener(um,O),()=>document.removeEventListener(um,O)},[]),T.jsx(ms.div,{...f,ref:E,style:{pointerEvents:_?D?"auto":"none":void 0,...s.style},onFocusCapture:En(s.onFocusCapture,$.onFocusCapture),onBlurCapture:En(s.onBlurCapture,$.onBlurCapture),onPointerDownCapture:En(s.onPointerDownCapture,M.onPointerDownCapture)})});nT.displayName=Zw;var tD="DismissableLayerBranch",sT=A.forwardRef((s,e)=>{const t=A.useContext(tT),n=A.useRef(null),r=He(e,n);return A.useEffect(()=>{const o=n.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),T.jsx(ms.div,{...s,ref:r})});sT.displayName=tD;function nD(s,e=globalThis?.document){const t=Bt(s),n=A.useRef(!1),r=A.useRef(()=>{});return A.useEffect(()=>{const o=u=>{if(u.target&&!n.current){let f=function(){iT(Jw,t,d,{discrete:!0})};const d={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=f,e.addEventListener("click",r.current,{once:!0})):f()}else e.removeEventListener("click",r.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",r.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function sD(s,e=globalThis?.document){const t=Bt(s),n=A.useRef(!1);return A.useEffect(()=>{const r=o=>{o.target&&!n.current&&iT(eD,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Nx(){const s=new CustomEvent(um);document.dispatchEvent(s)}function iT(s,e,t,{discrete:n}){const r=t.originalEvent.target,o=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:t});e&&r.addEventListener(s,e,{once:!0}),n?JS(r,o):r.dispatchEvent(o)}var iD=nT,rD=sT,Yt=globalThis?.document?A.useLayoutEffect:()=>{},aD="Portal",rT=A.forwardRef((s,e)=>{const{container:t,...n}=s,[r,o]=A.useState(!1);Yt(()=>o(!0),[]);const l=t||r&&globalThis?.document?.body;return l?ZS.createPortal(T.jsx(ms.div,{...n,ref:e}),l):null});rT.displayName=aD;function oD(s,e){return A.useReducer((t,n)=>e[t][n]??t,s)}var aT=s=>{const{present:e,children:t}=s,n=lD(e),r=typeof t=="function"?t({present:n.isPresent}):A.Children.only(t),o=He(n.ref,cD(r));return typeof t=="function"||n.isPresent?A.cloneElement(r,{ref:o}):null};aT.displayName="Presence";function lD(s){const[e,t]=A.useState(),n=A.useRef({}),r=A.useRef(s),o=A.useRef("none"),l=s?"mounted":"unmounted",[u,f]=oD(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const d=Ac(n.current);o.current=u==="mounted"?d:"none"},[u]),Yt(()=>{const d=n.current,m=r.current;if(m!==s){const y=o.current,x=Ac(d);s?f("MOUNT"):x==="none"||d?.display==="none"?f("UNMOUNT"):f(m&&y!==x?"ANIMATION_OUT":"UNMOUNT"),r.current=s}},[s,f]),Yt(()=>{if(e){let d;const m=e.ownerDocument.defaultView??window,g=x=>{const S=Ac(n.current).includes(x.animationName);if(x.target===e&&S&&(f("ANIMATION_END"),!r.current)){const b=e.style.animationFillMode;e.style.animationFillMode="forwards",d=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=b)})}},y=x=>{x.target===e&&(o.current=Ac(n.current))};return e.addEventListener("animationstart",y),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{m.clearTimeout(d),e.removeEventListener("animationstart",y),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else f("ANIMATION_END")},[e,f]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:A.useCallback(d=>{d&&(n.current=getComputedStyle(d)),t(d)},[])}}function Ac(s){return s?.animationName||"none"}function cD(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}function uD({prop:s,defaultProp:e,onChange:t=()=>{}}){const[n,r]=dD({defaultProp:e,onChange:t}),o=s!==void 0,l=o?s:n,u=Bt(t),f=A.useCallback(d=>{if(o){const g=typeof d=="function"?d(s):d;g!==s&&u(g)}else r(d)},[o,s,r,u]);return[l,f]}function dD({defaultProp:s,onChange:e}){const t=A.useState(s),[n]=t,r=A.useRef(n),o=Bt(e);return A.useEffect(()=>{r.current!==n&&(o(n),r.current=n)},[n,r,o]),t}var fD="VisuallyHidden",lg=A.forwardRef((s,e)=>T.jsx(ms.span,{...s,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...s.style}}));lg.displayName=fD;var cg="ToastProvider",[ug,hD,mD]=Ww("Toast"),[oT]=hs("Toast",[mD]),[gD,Nu]=oT(cg),lT=s=>{const{__scopeToast:e,label:t="Notification",duration:n=5e3,swipeDirection:r="right",swipeThreshold:o=50,children:l}=s,[u,f]=A.useState(null),[d,m]=A.useState(0),g=A.useRef(!1),y=A.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${cg}\`. Expected non-empty \`string\`.`),T.jsx(ug.Provider,{scope:e,children:T.jsx(gD,{scope:e,label:t,duration:n,swipeDirection:r,swipeThreshold:o,toastCount:d,viewport:u,onViewportChange:f,onToastAdd:A.useCallback(()=>m(x=>x+1),[]),onToastRemove:A.useCallback(()=>m(x=>x-1),[]),isFocusedToastEscapeKeyDownRef:g,isClosePausedRef:y,children:l})})};lT.displayName=cg;var cT="ToastViewport",pD=["F8"],dm="toast.viewportPause",fm="toast.viewportResume",uT=A.forwardRef((s,e)=>{const{__scopeToast:t,hotkey:n=pD,label:r="Notifications ({hotkey})",...o}=s,l=Nu(cT,t),u=hD(t),f=A.useRef(null),d=A.useRef(null),m=A.useRef(null),g=A.useRef(null),y=He(e,g,l.onViewportChange),x=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),E=l.toastCount>0;A.useEffect(()=>{const b=R=>{n.length!==0&&n.every(_=>R[_]||R.code===_)&&g.current?.focus()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[n]),A.useEffect(()=>{const b=f.current,R=g.current;if(E&&b&&R){const w=()=>{if(!l.isClosePausedRef.current){const $=new CustomEvent(dm);R.dispatchEvent($),l.isClosePausedRef.current=!0}},_=()=>{if(l.isClosePausedRef.current){const $=new CustomEvent(fm);R.dispatchEvent($),l.isClosePausedRef.current=!1}},D=$=>{!b.contains($.relatedTarget)&&_()},M=()=>{b.contains(document.activeElement)||_()};return b.addEventListener("focusin",w),b.addEventListener("focusout",D),b.addEventListener("pointermove",w),b.addEventListener("pointerleave",M),window.addEventListener("blur",w),window.addEventListener("focus",_),()=>{b.removeEventListener("focusin",w),b.removeEventListener("focusout",D),b.removeEventListener("pointermove",w),b.removeEventListener("pointerleave",M),window.removeEventListener("blur",w),window.removeEventListener("focus",_)}}},[E,l.isClosePausedRef]);const S=A.useCallback(({tabbingDirection:b})=>{const w=u().map(_=>{const D=_.ref.current,M=[D,...wD(D)];return b==="forwards"?M:M.reverse()});return(b==="forwards"?w.reverse():w).flat()},[u]);return A.useEffect(()=>{const b=g.current;if(b){const R=w=>{const _=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!_){const M=document.activeElement,$=w.shiftKey;if(w.target===b&&$){d.current?.focus();return}const G=S({tabbingDirection:$?"backwards":"forwards"}),B=G.findIndex(K=>K===M);Ah(G.slice(B+1))?w.preventDefault():$?d.current?.focus():m.current?.focus()}};return b.addEventListener("keydown",R),()=>b.removeEventListener("keydown",R)}},[u,S]),T.jsxs(rD,{ref:f,role:"region","aria-label":r.replace("{hotkey}",x),tabIndex:-1,style:{pointerEvents:E?void 0:"none"},children:[E&&T.jsx(hm,{ref:d,onFocusFromOutsideViewport:()=>{const b=S({tabbingDirection:"forwards"});Ah(b)}}),T.jsx(ug.Slot,{scope:t,children:T.jsx(ms.ol,{tabIndex:-1,...o,ref:y})}),E&&T.jsx(hm,{ref:m,onFocusFromOutsideViewport:()=>{const b=S({tabbingDirection:"backwards"});Ah(b)}})]})});uT.displayName=cT;var dT="ToastFocusProxy",hm=A.forwardRef((s,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:n,...r}=s,o=Nu(dT,t);return T.jsx(lg,{"aria-hidden":!0,tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:l=>{const u=l.relatedTarget;!o.viewport?.contains(u)&&n()}})});hm.displayName=dT;var ku="Toast",yD="toast.swipeStart",vD="toast.swipeMove",xD="toast.swipeCancel",ED="toast.swipeEnd",fT=A.forwardRef((s,e)=>{const{forceMount:t,open:n,defaultOpen:r,onOpenChange:o,...l}=s,[u=!0,f]=uD({prop:n,defaultProp:r,onChange:o});return T.jsx(aT,{present:t||u,children:T.jsx(bD,{open:u,...l,ref:e,onClose:()=>f(!1),onPause:Bt(s.onPause),onResume:Bt(s.onResume),onSwipeStart:En(s.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:En(s.onSwipeMove,d=>{const{x:m,y:g}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${m}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${g}px`)}),onSwipeCancel:En(s.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:En(s.onSwipeEnd,d=>{const{x:m,y:g}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${m}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${g}px`),f(!1)})})})});fT.displayName=ku;var[SD,TD]=oT(ku,{onClose(){}}),bD=A.forwardRef((s,e)=>{const{__scopeToast:t,type:n="foreground",duration:r,open:o,onClose:l,onEscapeKeyDown:u,onPause:f,onResume:d,onSwipeStart:m,onSwipeMove:g,onSwipeCancel:y,onSwipeEnd:x,...E}=s,S=Nu(ku,t),[b,R]=A.useState(null),w=He(e,ee=>R(ee)),_=A.useRef(null),D=A.useRef(null),M=r||S.duration,$=A.useRef(0),O=A.useRef(M),k=A.useRef(0),{onToastAdd:G,onToastRemove:B}=S,K=Bt(()=>{b?.contains(document.activeElement)&&S.viewport?.focus(),l()}),ne=A.useCallback(ee=>{!ee||ee===1/0||(window.clearTimeout(k.current),$.current=new Date().getTime(),k.current=window.setTimeout(K,ee))},[K]);A.useEffect(()=>{const ee=S.viewport;if(ee){const ae=()=>{ne(O.current),d?.()},P=()=>{const F=new Date().getTime()-$.current;O.current=O.current-F,window.clearTimeout(k.current),f?.()};return ee.addEventListener(dm,P),ee.addEventListener(fm,ae),()=>{ee.removeEventListener(dm,P),ee.removeEventListener(fm,ae)}}},[S.viewport,M,f,d,ne]),A.useEffect(()=>{o&&!S.isClosePausedRef.current&&ne(M)},[o,M,S.isClosePausedRef,ne]),A.useEffect(()=>(G(),()=>B()),[G,B]);const ue=A.useMemo(()=>b?xT(b):null,[b]);return S.viewport?T.jsxs(T.Fragment,{children:[ue&&T.jsx(AD,{__scopeToast:t,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:ue}),T.jsx(SD,{scope:t,onClose:K,children:Qo.createPortal(T.jsx(ug.ItemSlot,{scope:t,children:T.jsx(iD,{asChild:!0,onEscapeKeyDown:En(u,()=>{S.isFocusedToastEscapeKeyDownRef.current||K(),S.isFocusedToastEscapeKeyDownRef.current=!1}),children:T.jsx(ms.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":S.swipeDirection,...E,ref:w,style:{userSelect:"none",touchAction:"none",...s.style},onKeyDown:En(s.onKeyDown,ee=>{ee.key==="Escape"&&(u?.(ee.nativeEvent),ee.nativeEvent.defaultPrevented||(S.isFocusedToastEscapeKeyDownRef.current=!0,K()))}),onPointerDown:En(s.onPointerDown,ee=>{ee.button===0&&(_.current={x:ee.clientX,y:ee.clientY})}),onPointerMove:En(s.onPointerMove,ee=>{if(!_.current)return;const ae=ee.clientX-_.current.x,P=ee.clientY-_.current.y,F=!!D.current,U=["left","right"].includes(S.swipeDirection),Y=["left","up"].includes(S.swipeDirection)?Math.min:Math.max,le=U?Y(0,ae):0,N=U?0:Y(0,P),H=ee.pointerType==="touch"?10:2,J={x:le,y:N},se={originalEvent:ee,delta:J};F?(D.current=J,Rc(vD,g,se,{discrete:!1})):kx(J,S.swipeDirection,H)?(D.current=J,Rc(yD,m,se,{discrete:!1}),ee.target.setPointerCapture(ee.pointerId)):(Math.abs(ae)>H||Math.abs(P)>H)&&(_.current=null)}),onPointerUp:En(s.onPointerUp,ee=>{const ae=D.current,P=ee.target;if(P.hasPointerCapture(ee.pointerId)&&P.releasePointerCapture(ee.pointerId),D.current=null,_.current=null,ae){const F=ee.currentTarget,U={originalEvent:ee,delta:ae};kx(ae,S.swipeDirection,S.swipeThreshold)?Rc(ED,x,U,{discrete:!0}):Rc(xD,y,U,{discrete:!0}),F.addEventListener("click",Y=>Y.preventDefault(),{once:!0})}})})})}),S.viewport)})]}):null}),AD=s=>{const{__scopeToast:e,children:t,...n}=s,r=Nu(ku,e),[o,l]=A.useState(!1),[u,f]=A.useState(!1);return CD(()=>l(!0)),A.useEffect(()=>{const d=window.setTimeout(()=>f(!0),1e3);return()=>window.clearTimeout(d)},[]),u?null:T.jsx(rT,{asChild:!0,children:T.jsx(lg,{...n,children:o&&T.jsxs(T.Fragment,{children:[r.label," ",t]})})})},RD="ToastTitle",hT=A.forwardRef((s,e)=>{const{__scopeToast:t,...n}=s;return T.jsx(ms.div,{...n,ref:e})});hT.displayName=RD;var LD="ToastDescription",mT=A.forwardRef((s,e)=>{const{__scopeToast:t,...n}=s;return T.jsx(ms.div,{...n,ref:e})});mT.displayName=LD;var gT="ToastAction",pT=A.forwardRef((s,e)=>{const{altText:t,...n}=s;return t.trim()?T.jsx(vT,{altText:t,asChild:!0,children:T.jsx(dg,{...n,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${gT}\`. Expected non-empty \`string\`.`),null)});pT.displayName=gT;var yT="ToastClose",dg=A.forwardRef((s,e)=>{const{__scopeToast:t,...n}=s,r=TD(yT,t);return T.jsx(vT,{asChild:!0,children:T.jsx(ms.button,{type:"button",...n,ref:e,onClick:En(s.onClick,r.onClose)})})});dg.displayName=yT;var vT=A.forwardRef((s,e)=>{const{__scopeToast:t,altText:n,...r}=s;return T.jsx(ms.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...r,ref:e})});function xT(s){const e=[];return Array.from(s.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&e.push(n.textContent),_D(n)){const r=n.ariaHidden||n.hidden||n.style.display==="none",o=n.dataset.radixToastAnnounceExclude==="";if(!r)if(o){const l=n.dataset.radixToastAnnounceAlt;l&&e.push(l)}else e.push(...xT(n))}}),e}function Rc(s,e,t,{discrete:n}){const r=t.originalEvent.currentTarget,o=new CustomEvent(s,{bubbles:!0,cancelable:!0,detail:t});e&&r.addEventListener(s,e,{once:!0}),n?JS(r,o):r.dispatchEvent(o)}var kx=(s,e,t=0)=>{const n=Math.abs(s.x),r=Math.abs(s.y),o=n>r;return e==="left"||e==="right"?o&&n>t:!o&&r>t};function CD(s=()=>{}){const e=Bt(s);Yt(()=>{let t=0,n=0;return t=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(n)}},[e])}function _D(s){return s.nodeType===s.ELEMENT_NODE}function wD(s){const e=[],t=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const r=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||r?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function Ah(s){const e=document.activeElement;return s.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var DD=lT,ET=uT,ST=fT,TT=hT,bT=mT,AT=pT,RT=dg;function LT(s){var e,t,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var r=s.length;for(e=0;e<r;e++)s[e]&&(t=LT(s[e]))&&(n&&(n+=" "),n+=t)}else for(t in s)s[t]&&(n&&(n+=" "),n+=t);return n}function CT(){for(var s,e,t=0,n="",r=arguments.length;t<r;t++)(s=arguments[t])&&(e=LT(s))&&(n&&(n+=" "),n+=e);return n}const Px=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,Fx=CT,Pu=(s,e)=>t=>{var n;if(e?.variants==null)return Fx(s,t?.class,t?.className);const{variants:r,defaultVariants:o}=e,l=Object.keys(r).map(d=>{const m=t?.[d],g=o?.[d];if(m===null)return null;const y=Px(m)||Px(g);return r[d][y]}),u=t&&Object.entries(t).reduce((d,m)=>{let[g,y]=m;return y===void 0||(d[g]=y),d},{}),f=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((d,m)=>{let{class:g,className:y,...x}=m;return Object.entries(x).every(E=>{let[S,b]=E;return Array.isArray(b)?b.includes({...o,...u}[S]):{...o,...u}[S]===b})?[...d,g,y]:d},[]);return Fx(s,l,f,t?.class,t?.className)};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ID=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),OD=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),Ux=s=>{const e=OD(s);return e.charAt(0).toUpperCase()+e.slice(1)},_T=(...s)=>s.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),MD=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ND={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kD=A.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:r="",children:o,iconNode:l,...u},f)=>A.createElement("svg",{ref:f,...ND,width:e,height:e,stroke:s,strokeWidth:n?Number(t)*24/Number(e):t,className:_T("lucide",r),...!o&&!MD(u)&&{"aria-hidden":"true"},...u},[...l.map(([d,m])=>A.createElement(d,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=(s,e)=>{const t=A.forwardRef(({className:n,...r},o)=>A.createElement(kD,{ref:o,iconNode:e,className:_T(`lucide-${ID(Ux(s))}`,`lucide-${s}`,n),...r}));return t.displayName=Ux(s),t};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PD=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],FD=$e("activity",PD);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],BD=$e("arrow-left",UD);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],jD=$e("bell",$D);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],HD=$e("check",GD);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],KD=$e("chevron-down",VD);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zD=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],YD=$e("chevron-right",zD);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],wT=$e("circle-alert",qD);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],WD=$e("circle-check",XD);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ZD=$e("circle-check-big",QD);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],eI=$e("circle-x",JD);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],nI=$e("circle",tI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],DT=$e("film",sI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],rI=$e("hard-drive",iI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],oI=$e("house",aI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],cI=$e("info",lI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],IT=$e("layout-dashboard",uI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],mm=$e("loader-circle",dI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],hI=$e("log-out",fI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],gI=$e("maximize",mI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],yI=$e("minimize",pI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],xI=$e("pause",vI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ya=$e("play",EI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],OT=$e("plus",SI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],bI=$e("refresh-cw",TI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],RI=$e("search",AI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],MT=$e("settings",LI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],_I=$e("square-pen",CI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],DI=$e("thumbs-up",wI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],OI=$e("trash-2",II);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],NI=$e("users",MI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],PI=$e("volume-2",kI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],UI=$e("volume-x",FI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],NT=$e("x",BI),fg="-",$I=s=>{const e=GI(s),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:l=>{const u=l.split(fg);return u[0]===""&&u.length!==1&&u.shift(),kT(u,e)||jI(l)},getConflictingClassGroupIds:(l,u)=>{const f=t[l]||[];return u&&n[l]?[...f,...n[l]]:f}}},kT=(s,e)=>{if(s.length===0)return e.classGroupId;const t=s[0],n=e.nextPart.get(t),r=n?kT(s.slice(1),n):void 0;if(r)return r;if(e.validators.length===0)return;const o=s.join(fg);return e.validators.find(({validator:l})=>l(o))?.classGroupId},Bx=/^\[(.+)\]$/,jI=s=>{if(Bx.test(s)){const e=Bx.exec(s)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},GI=s=>{const{theme:e,classGroups:t}=s,n={nextPart:new Map,validators:[]};for(const r in t)gm(t[r],n,r,e);return n},gm=(s,e,t,n)=>{s.forEach(r=>{if(typeof r=="string"){const o=r===""?e:$x(e,r);o.classGroupId=t;return}if(typeof r=="function"){if(HI(r)){gm(r(n),e,t,n);return}e.validators.push({validator:r,classGroupId:t});return}Object.entries(r).forEach(([o,l])=>{gm(l,$x(e,o),t,n)})})},$x=(s,e)=>{let t=s;return e.split(fg).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},HI=s=>s.isThemeGetter,VI=s=>{if(s<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const r=(o,l)=>{t.set(o,l),e++,e>s&&(e=0,n=t,t=new Map)};return{get(o){let l=t.get(o);if(l!==void 0)return l;if((l=n.get(o))!==void 0)return r(o,l),l},set(o,l){t.has(o)?t.set(o,l):r(o,l)}}},pm="!",ym=":",KI=ym.length,zI=s=>{const{prefix:e,experimentalParseClassName:t}=s;let n=r=>{const o=[];let l=0,u=0,f=0,d;for(let E=0;E<r.length;E++){let S=r[E];if(l===0&&u===0){if(S===ym){o.push(r.slice(f,E)),f=E+KI;continue}if(S==="/"){d=E;continue}}S==="["?l++:S==="]"?l--:S==="("?u++:S===")"&&u--}const m=o.length===0?r:r.substring(f),g=YI(m),y=g!==m,x=d&&d>f?d-f:void 0;return{modifiers:o,hasImportantModifier:y,baseClassName:g,maybePostfixModifierPosition:x}};if(e){const r=e+ym,o=n;n=l=>l.startsWith(r)?o(l.substring(r.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(t){const r=n;n=o=>t({className:o,parseClassName:r})}return n},YI=s=>s.endsWith(pm)?s.substring(0,s.length-1):s.startsWith(pm)?s.substring(1):s,qI=s=>{const e=Object.fromEntries(s.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const r=[];let o=[];return n.forEach(l=>{l[0]==="["||e[l]?(r.push(...o.sort(),l),o=[]):o.push(l)}),r.push(...o.sort()),r}},XI=s=>({cache:VI(s.cacheSize),parseClassName:zI(s),sortModifiers:qI(s),...$I(s)}),WI=/\s+/,QI=(s,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:r,sortModifiers:o}=e,l=[],u=s.trim().split(WI);let f="";for(let d=u.length-1;d>=0;d-=1){const m=u[d],{isExternal:g,modifiers:y,hasImportantModifier:x,baseClassName:E,maybePostfixModifierPosition:S}=t(m);if(g){f=m+(f.length>0?" "+f:f);continue}let b=!!S,R=n(b?E.substring(0,S):E);if(!R){if(!b){f=m+(f.length>0?" "+f:f);continue}if(R=n(E),!R){f=m+(f.length>0?" "+f:f);continue}b=!1}const w=o(y).join(":"),_=x?w+pm:w,D=_+R;if(l.includes(D))continue;l.push(D);const M=r(R,b);for(let $=0;$<M.length;++$){const O=M[$];l.push(_+O)}f=m+(f.length>0?" "+f:f)}return f};function ZI(){let s=0,e,t,n="";for(;s<arguments.length;)(e=arguments[s++])&&(t=PT(e))&&(n&&(n+=" "),n+=t);return n}const PT=s=>{if(typeof s=="string")return s;let e,t="";for(let n=0;n<s.length;n++)s[n]&&(e=PT(s[n]))&&(t&&(t+=" "),t+=e);return t};function JI(s,...e){let t,n,r,o=l;function l(f){const d=e.reduce((m,g)=>g(m),s());return t=XI(d),n=t.cache.get,r=t.cache.set,o=u,u(f)}function u(f){const d=n(f);if(d)return d;const m=QI(f,t);return r(f,m),m}return function(){return o(ZI.apply(null,arguments))}}const Tt=s=>{const e=t=>t[s]||[];return e.isThemeGetter=!0,e},FT=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,UT=/^\((?:(\w[\w-]*):)?(.+)\)$/i,eO=/^\d+\/\d+$/,tO=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,nO=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,sO=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,iO=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,rO=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Yr=s=>eO.test(s),Ie=s=>!!s&&!Number.isNaN(Number(s)),xi=s=>!!s&&Number.isInteger(Number(s)),Rh=s=>s.endsWith("%")&&Ie(s.slice(0,-1)),Ps=s=>tO.test(s),aO=()=>!0,oO=s=>nO.test(s)&&!sO.test(s),BT=()=>!1,lO=s=>iO.test(s),cO=s=>rO.test(s),uO=s=>!ye(s)&&!ve(s),dO=s=>ba(s,GT,BT),ye=s=>FT.test(s),Qi=s=>ba(s,HT,oO),Lh=s=>ba(s,pO,Ie),jx=s=>ba(s,$T,BT),fO=s=>ba(s,jT,cO),Lc=s=>ba(s,VT,lO),ve=s=>UT.test(s),Ro=s=>Aa(s,HT),hO=s=>Aa(s,yO),Gx=s=>Aa(s,$T),mO=s=>Aa(s,GT),gO=s=>Aa(s,jT),Cc=s=>Aa(s,VT,!0),ba=(s,e,t)=>{const n=FT.exec(s);return n?n[1]?e(n[1]):t(n[2]):!1},Aa=(s,e,t=!1)=>{const n=UT.exec(s);return n?n[1]?e(n[1]):t:!1},$T=s=>s==="position"||s==="percentage",jT=s=>s==="image"||s==="url",GT=s=>s==="length"||s==="size"||s==="bg-size",HT=s=>s==="length",pO=s=>s==="number",yO=s=>s==="family-name",VT=s=>s==="shadow",vO=()=>{const s=Tt("color"),e=Tt("font"),t=Tt("text"),n=Tt("font-weight"),r=Tt("tracking"),o=Tt("leading"),l=Tt("breakpoint"),u=Tt("container"),f=Tt("spacing"),d=Tt("radius"),m=Tt("shadow"),g=Tt("inset-shadow"),y=Tt("text-shadow"),x=Tt("drop-shadow"),E=Tt("blur"),S=Tt("perspective"),b=Tt("aspect"),R=Tt("ease"),w=Tt("animate"),_=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],M=()=>[...D(),ve,ye],$=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto","contain","none"],k=()=>[ve,ye,f],G=()=>[Yr,"full","auto",...k()],B=()=>[xi,"none","subgrid",ve,ye],K=()=>["auto",{span:["full",xi,ve,ye]},xi,ve,ye],ne=()=>[xi,"auto",ve,ye],ue=()=>["auto","min","max","fr",ve,ye],ee=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ae=()=>["start","end","center","stretch","center-safe","end-safe"],P=()=>["auto",...k()],F=()=>[Yr,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],U=()=>[s,ve,ye],Y=()=>[...D(),Gx,jx,{position:[ve,ye]}],le=()=>["no-repeat",{repeat:["","x","y","space","round"]}],N=()=>["auto","cover","contain",mO,dO,{size:[ve,ye]}],H=()=>[Rh,Ro,Qi],J=()=>["","none","full",d,ve,ye],se=()=>["",Ie,Ro,Qi],de=()=>["solid","dashed","dotted","double"],fe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],he=()=>[Ie,Rh,Gx,jx],Le=()=>["","none",E,ve,ye],_e=()=>["none",Ie,ve,ye],at=()=>["none",Ie,ve,ye],Rt=()=>[Ie,ve,ye],bn=()=>[Yr,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ps],breakpoint:[Ps],color:[aO],container:[Ps],"drop-shadow":[Ps],ease:["in","out","in-out"],font:[uO],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ps],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ps],shadow:[Ps],spacing:["px",Ie],text:[Ps],"text-shadow":[Ps],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Yr,ye,ve,b]}],container:["container"],columns:[{columns:[Ie,ye,ve,u]}],"break-after":[{"break-after":_()}],"break-before":[{"break-before":_()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:M()}],overflow:[{overflow:$()}],"overflow-x":[{"overflow-x":$()}],"overflow-y":[{"overflow-y":$()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:G()}],"inset-x":[{"inset-x":G()}],"inset-y":[{"inset-y":G()}],start:[{start:G()}],end:[{end:G()}],top:[{top:G()}],right:[{right:G()}],bottom:[{bottom:G()}],left:[{left:G()}],visibility:["visible","invisible","collapse"],z:[{z:[xi,"auto",ve,ye]}],basis:[{basis:[Yr,"full","auto",u,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ie,Yr,"auto","initial","none",ye]}],grow:[{grow:["",Ie,ve,ye]}],shrink:[{shrink:["",Ie,ve,ye]}],order:[{order:[xi,"first","last","none",ve,ye]}],"grid-cols":[{"grid-cols":B()}],"col-start-end":[{col:K()}],"col-start":[{"col-start":ne()}],"col-end":[{"col-end":ne()}],"grid-rows":[{"grid-rows":B()}],"row-start-end":[{row:K()}],"row-start":[{"row-start":ne()}],"row-end":[{"row-end":ne()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ue()}],"auto-rows":[{"auto-rows":ue()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...ee(),"normal"]}],"justify-items":[{"justify-items":[...ae(),"normal"]}],"justify-self":[{"justify-self":["auto",...ae()]}],"align-content":[{content:["normal",...ee()]}],"align-items":[{items:[...ae(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ae(),{baseline:["","last"]}]}],"place-content":[{"place-content":ee()}],"place-items":[{"place-items":[...ae(),"baseline"]}],"place-self":[{"place-self":["auto",...ae()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:P()}],mx:[{mx:P()}],my:[{my:P()}],ms:[{ms:P()}],me:[{me:P()}],mt:[{mt:P()}],mr:[{mr:P()}],mb:[{mb:P()}],ml:[{ml:P()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:F()}],w:[{w:[u,"screen",...F()]}],"min-w":[{"min-w":[u,"screen","none",...F()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[l]},...F()]}],h:[{h:["screen","lh",...F()]}],"min-h":[{"min-h":["screen","lh","none",...F()]}],"max-h":[{"max-h":["screen","lh",...F()]}],"font-size":[{text:["base",t,Ro,Qi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,ve,Lh]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Rh,ye]}],"font-family":[{font:[hO,ye,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,ve,ye]}],"line-clamp":[{"line-clamp":[Ie,"none",ve,Lh]}],leading:[{leading:[o,...k()]}],"list-image":[{"list-image":["none",ve,ye]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",ve,ye]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:U()}],"text-color":[{text:U()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ie,"from-font","auto",ve,Qi]}],"text-decoration-color":[{decoration:U()}],"underline-offset":[{"underline-offset":[Ie,"auto",ve,ye]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ve,ye]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ve,ye]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Y()}],"bg-repeat":[{bg:le()}],"bg-size":[{bg:N()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},xi,ve,ye],radial:["",ve,ye],conic:[xi,ve,ye]},gO,fO]}],"bg-color":[{bg:U()}],"gradient-from-pos":[{from:H()}],"gradient-via-pos":[{via:H()}],"gradient-to-pos":[{to:H()}],"gradient-from":[{from:U()}],"gradient-via":[{via:U()}],"gradient-to":[{to:U()}],rounded:[{rounded:J()}],"rounded-s":[{"rounded-s":J()}],"rounded-e":[{"rounded-e":J()}],"rounded-t":[{"rounded-t":J()}],"rounded-r":[{"rounded-r":J()}],"rounded-b":[{"rounded-b":J()}],"rounded-l":[{"rounded-l":J()}],"rounded-ss":[{"rounded-ss":J()}],"rounded-se":[{"rounded-se":J()}],"rounded-ee":[{"rounded-ee":J()}],"rounded-es":[{"rounded-es":J()}],"rounded-tl":[{"rounded-tl":J()}],"rounded-tr":[{"rounded-tr":J()}],"rounded-br":[{"rounded-br":J()}],"rounded-bl":[{"rounded-bl":J()}],"border-w":[{border:se()}],"border-w-x":[{"border-x":se()}],"border-w-y":[{"border-y":se()}],"border-w-s":[{"border-s":se()}],"border-w-e":[{"border-e":se()}],"border-w-t":[{"border-t":se()}],"border-w-r":[{"border-r":se()}],"border-w-b":[{"border-b":se()}],"border-w-l":[{"border-l":se()}],"divide-x":[{"divide-x":se()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":se()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...de(),"hidden","none"]}],"divide-style":[{divide:[...de(),"hidden","none"]}],"border-color":[{border:U()}],"border-color-x":[{"border-x":U()}],"border-color-y":[{"border-y":U()}],"border-color-s":[{"border-s":U()}],"border-color-e":[{"border-e":U()}],"border-color-t":[{"border-t":U()}],"border-color-r":[{"border-r":U()}],"border-color-b":[{"border-b":U()}],"border-color-l":[{"border-l":U()}],"divide-color":[{divide:U()}],"outline-style":[{outline:[...de(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ie,ve,ye]}],"outline-w":[{outline:["",Ie,Ro,Qi]}],"outline-color":[{outline:U()}],shadow:[{shadow:["","none",m,Cc,Lc]}],"shadow-color":[{shadow:U()}],"inset-shadow":[{"inset-shadow":["none",g,Cc,Lc]}],"inset-shadow-color":[{"inset-shadow":U()}],"ring-w":[{ring:se()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:U()}],"ring-offset-w":[{"ring-offset":[Ie,Qi]}],"ring-offset-color":[{"ring-offset":U()}],"inset-ring-w":[{"inset-ring":se()}],"inset-ring-color":[{"inset-ring":U()}],"text-shadow":[{"text-shadow":["none",y,Cc,Lc]}],"text-shadow-color":[{"text-shadow":U()}],opacity:[{opacity:[Ie,ve,ye]}],"mix-blend":[{"mix-blend":[...fe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":fe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ie]}],"mask-image-linear-from-pos":[{"mask-linear-from":he()}],"mask-image-linear-to-pos":[{"mask-linear-to":he()}],"mask-image-linear-from-color":[{"mask-linear-from":U()}],"mask-image-linear-to-color":[{"mask-linear-to":U()}],"mask-image-t-from-pos":[{"mask-t-from":he()}],"mask-image-t-to-pos":[{"mask-t-to":he()}],"mask-image-t-from-color":[{"mask-t-from":U()}],"mask-image-t-to-color":[{"mask-t-to":U()}],"mask-image-r-from-pos":[{"mask-r-from":he()}],"mask-image-r-to-pos":[{"mask-r-to":he()}],"mask-image-r-from-color":[{"mask-r-from":U()}],"mask-image-r-to-color":[{"mask-r-to":U()}],"mask-image-b-from-pos":[{"mask-b-from":he()}],"mask-image-b-to-pos":[{"mask-b-to":he()}],"mask-image-b-from-color":[{"mask-b-from":U()}],"mask-image-b-to-color":[{"mask-b-to":U()}],"mask-image-l-from-pos":[{"mask-l-from":he()}],"mask-image-l-to-pos":[{"mask-l-to":he()}],"mask-image-l-from-color":[{"mask-l-from":U()}],"mask-image-l-to-color":[{"mask-l-to":U()}],"mask-image-x-from-pos":[{"mask-x-from":he()}],"mask-image-x-to-pos":[{"mask-x-to":he()}],"mask-image-x-from-color":[{"mask-x-from":U()}],"mask-image-x-to-color":[{"mask-x-to":U()}],"mask-image-y-from-pos":[{"mask-y-from":he()}],"mask-image-y-to-pos":[{"mask-y-to":he()}],"mask-image-y-from-color":[{"mask-y-from":U()}],"mask-image-y-to-color":[{"mask-y-to":U()}],"mask-image-radial":[{"mask-radial":[ve,ye]}],"mask-image-radial-from-pos":[{"mask-radial-from":he()}],"mask-image-radial-to-pos":[{"mask-radial-to":he()}],"mask-image-radial-from-color":[{"mask-radial-from":U()}],"mask-image-radial-to-color":[{"mask-radial-to":U()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":D()}],"mask-image-conic-pos":[{"mask-conic":[Ie]}],"mask-image-conic-from-pos":[{"mask-conic-from":he()}],"mask-image-conic-to-pos":[{"mask-conic-to":he()}],"mask-image-conic-from-color":[{"mask-conic-from":U()}],"mask-image-conic-to-color":[{"mask-conic-to":U()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Y()}],"mask-repeat":[{mask:le()}],"mask-size":[{mask:N()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",ve,ye]}],filter:[{filter:["","none",ve,ye]}],blur:[{blur:Le()}],brightness:[{brightness:[Ie,ve,ye]}],contrast:[{contrast:[Ie,ve,ye]}],"drop-shadow":[{"drop-shadow":["","none",x,Cc,Lc]}],"drop-shadow-color":[{"drop-shadow":U()}],grayscale:[{grayscale:["",Ie,ve,ye]}],"hue-rotate":[{"hue-rotate":[Ie,ve,ye]}],invert:[{invert:["",Ie,ve,ye]}],saturate:[{saturate:[Ie,ve,ye]}],sepia:[{sepia:["",Ie,ve,ye]}],"backdrop-filter":[{"backdrop-filter":["","none",ve,ye]}],"backdrop-blur":[{"backdrop-blur":Le()}],"backdrop-brightness":[{"backdrop-brightness":[Ie,ve,ye]}],"backdrop-contrast":[{"backdrop-contrast":[Ie,ve,ye]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ie,ve,ye]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ie,ve,ye]}],"backdrop-invert":[{"backdrop-invert":["",Ie,ve,ye]}],"backdrop-opacity":[{"backdrop-opacity":[Ie,ve,ye]}],"backdrop-saturate":[{"backdrop-saturate":[Ie,ve,ye]}],"backdrop-sepia":[{"backdrop-sepia":["",Ie,ve,ye]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",ve,ye]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ie,"initial",ve,ye]}],ease:[{ease:["linear","initial",R,ve,ye]}],delay:[{delay:[Ie,ve,ye]}],animate:[{animate:["none",w,ve,ye]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[S,ve,ye]}],"perspective-origin":[{"perspective-origin":M()}],rotate:[{rotate:_e()}],"rotate-x":[{"rotate-x":_e()}],"rotate-y":[{"rotate-y":_e()}],"rotate-z":[{"rotate-z":_e()}],scale:[{scale:at()}],"scale-x":[{"scale-x":at()}],"scale-y":[{"scale-y":at()}],"scale-z":[{"scale-z":at()}],"scale-3d":["scale-3d"],skew:[{skew:Rt()}],"skew-x":[{"skew-x":Rt()}],"skew-y":[{"skew-y":Rt()}],transform:[{transform:[ve,ye,"","none","gpu","cpu"]}],"transform-origin":[{origin:M()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:bn()}],"translate-x":[{"translate-x":bn()}],"translate-y":[{"translate-y":bn()}],"translate-z":[{"translate-z":bn()}],"translate-none":["translate-none"],accent:[{accent:U()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:U()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ve,ye]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ve,ye]}],fill:[{fill:["none",...U()]}],"stroke-w":[{stroke:[Ie,Ro,Qi,Lh]}],stroke:[{stroke:["none",...U()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},xO=JI(vO);function De(...s){return xO(CT(s))}const EO=DD,KT=A.forwardRef(({className:s,...e},t)=>T.jsx(ET,{ref:t,className:De("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...e}));KT.displayName=ET.displayName;const SO=Pu("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),zT=A.forwardRef(({className:s,variant:e,...t},n)=>T.jsx(ST,{ref:n,className:De(SO({variant:e}),s),...t}));zT.displayName=ST.displayName;const TO=A.forwardRef(({className:s,...e},t)=>T.jsx(AT,{ref:t,className:De("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...e}));TO.displayName=AT.displayName;const YT=A.forwardRef(({className:s,...e},t)=>T.jsx(RT,{ref:t,className:De("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...e,children:T.jsx(NT,{className:"h-4 w-4"})}));YT.displayName=RT.displayName;const qT=A.forwardRef(({className:s,...e},t)=>T.jsx(TT,{ref:t,className:De("text-sm font-semibold",s),...e}));qT.displayName=TT.displayName;const XT=A.forwardRef(({className:s,...e},t)=>T.jsx(bT,{ref:t,className:De("text-sm opacity-90",s),...e}));XT.displayName=bT.displayName;function bO(){const{toasts:s}=QS();return T.jsxs(EO,{children:[s.map(function({id:e,title:t,description:n,action:r,...o}){return T.jsxs(zT,{...o,children:[T.jsxs("div",{className:"grid gap-1",children:[t&&T.jsx(qT,{children:t}),n&&T.jsx(XT,{children:n})]}),r,T.jsx(YT,{})]},e)}),T.jsx(KT,{})]})}function qr(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}function Ch(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}function AO(s){const e=RO(s),t=A.forwardRef((n,r)=>{const{children:o,...l}=n,u=A.Children.toArray(o),f=u.find(CO);if(f){const d=f.props.children,m=u.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}function RO(s){const e=A.forwardRef((t,n)=>{const{children:r,...o}=t;if(A.isValidElement(r)){const l=wO(r),u=_O(o,r.props);return r.type!==A.Fragment&&(u.ref=n?zs(n,l):l),A.cloneElement(r,u)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var LO=Symbol("radix.slottable");function CO(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===LO}function _O(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function wO(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var DO=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],nt=DO.reduce((s,e)=>{const t=AO(`Primitive.${e}`),n=A.forwardRef((r,o)=>{const{asChild:l,...u}=r,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),T.jsx(f,{...u,ref:o})});return n.displayName=`Primitive.${e}`,{...s,[e]:n}},{});function WT(s,e){s&&Qo.flushSync(()=>s.dispatchEvent(e))}var IO="DismissableLayer",vm="dismissableLayer.update",OO="dismissableLayer.pointerDownOutside",MO="dismissableLayer.focusOutside",Hx,QT=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Fu=A.forwardRef((s,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:o,onInteractOutside:l,onDismiss:u,...f}=s,d=A.useContext(QT),[m,g]=A.useState(null),y=m?.ownerDocument??globalThis?.document,[,x]=A.useState({}),E=He(e,O=>g(O)),S=Array.from(d.layers),[b]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),R=S.indexOf(b),w=m?S.indexOf(m):-1,_=d.layersWithOutsidePointerEventsDisabled.size>0,D=w>=R,M=PO(O=>{const k=O.target,G=[...d.branches].some(B=>B.contains(k));!D||G||(r?.(O),l?.(O),O.defaultPrevented||u?.())},y),$=FO(O=>{const k=O.target;[...d.branches].some(B=>B.contains(k))||(o?.(O),l?.(O),O.defaultPrevented||u?.())},y);return eT(O=>{w===d.layers.size-1&&(n?.(O),!O.defaultPrevented&&u&&(O.preventDefault(),u()))},y),A.useEffect(()=>{if(m)return t&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(Hx=y.body.style.pointerEvents,y.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(m)),d.layers.add(m),Vx(),()=>{t&&d.layersWithOutsidePointerEventsDisabled.size===1&&(y.body.style.pointerEvents=Hx)}},[m,y,t,d]),A.useEffect(()=>()=>{m&&(d.layers.delete(m),d.layersWithOutsidePointerEventsDisabled.delete(m),Vx())},[m,d]),A.useEffect(()=>{const O=()=>x({});return document.addEventListener(vm,O),()=>document.removeEventListener(vm,O)},[]),T.jsx(nt.div,{...f,ref:E,style:{pointerEvents:_?D?"auto":"none":void 0,...s.style},onFocusCapture:Ch(s.onFocusCapture,$.onFocusCapture),onBlurCapture:Ch(s.onBlurCapture,$.onBlurCapture),onPointerDownCapture:Ch(s.onPointerDownCapture,M.onPointerDownCapture)})});Fu.displayName=IO;var NO="DismissableLayerBranch",kO=A.forwardRef((s,e)=>{const t=A.useContext(QT),n=A.useRef(null),r=He(e,n);return A.useEffect(()=>{const o=n.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),T.jsx(nt.div,{...s,ref:r})});kO.displayName=NO;function PO(s,e=globalThis?.document){const t=Bt(s),n=A.useRef(!1),r=A.useRef(()=>{});return A.useEffect(()=>{const o=u=>{if(u.target&&!n.current){let f=function(){ZT(OO,t,d,{discrete:!0})};const d={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=f,e.addEventListener("click",r.current,{once:!0})):f()}else e.removeEventListener("click",r.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",r.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function FO(s,e=globalThis?.document){const t=Bt(s),n=A.useRef(!1);return A.useEffect(()=>{const r=o=>{o.target&&!n.current&&ZT(MO,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Vx(){const s=new CustomEvent(vm);document.dispatchEvent(s)}function ZT(s,e,t,{discrete:n}){const r=t.originalEvent.target,o=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:t});e&&r.addEventListener(s,e,{once:!0}),n?WT(r,o):r.dispatchEvent(o)}var UO=rr[" useId ".trim().toString()]||(()=>{}),BO=0;function la(s){const[e,t]=A.useState(UO());return Yt(()=>{t(n=>n??String(BO++))},[s]),e?`radix-${e}`:""}const $O=["top","right","bottom","left"],_i=Math.min,vn=Math.max,uu=Math.round,_c=Math.floor,cs=s=>({x:s,y:s}),jO={left:"right",right:"left",bottom:"top",top:"bottom"},GO={start:"end",end:"start"};function xm(s,e,t){return vn(s,_i(e,t))}function Vs(s,e){return typeof s=="function"?s(e):s}function Ks(s){return s.split("-")[0]}function Ra(s){return s.split("-")[1]}function hg(s){return s==="x"?"y":"x"}function mg(s){return s==="y"?"height":"width"}const HO=new Set(["top","bottom"]);function as(s){return HO.has(Ks(s))?"y":"x"}function gg(s){return hg(as(s))}function VO(s,e,t){t===void 0&&(t=!1);const n=Ra(s),r=gg(s),o=mg(r);let l=r==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(l=du(l)),[l,du(l)]}function KO(s){const e=du(s);return[Em(s),e,Em(e)]}function Em(s){return s.replace(/start|end/g,e=>GO[e])}const Kx=["left","right"],zx=["right","left"],zO=["top","bottom"],YO=["bottom","top"];function qO(s,e,t){switch(s){case"top":case"bottom":return t?e?zx:Kx:e?Kx:zx;case"left":case"right":return e?zO:YO;default:return[]}}function XO(s,e,t,n){const r=Ra(s);let o=qO(Ks(s),t==="start",n);return r&&(o=o.map(l=>l+"-"+r),e&&(o=o.concat(o.map(Em)))),o}function du(s){return s.replace(/left|right|bottom|top/g,e=>jO[e])}function WO(s){return{top:0,right:0,bottom:0,left:0,...s}}function JT(s){return typeof s!="number"?WO(s):{top:s,right:s,bottom:s,left:s}}function fu(s){const{x:e,y:t,width:n,height:r}=s;return{width:n,height:r,top:t,left:e,right:e+n,bottom:t+r,x:e,y:t}}function Yx(s,e,t){let{reference:n,floating:r}=s;const o=as(e),l=gg(e),u=mg(l),f=Ks(e),d=o==="y",m=n.x+n.width/2-r.width/2,g=n.y+n.height/2-r.height/2,y=n[u]/2-r[u]/2;let x;switch(f){case"top":x={x:m,y:n.y-r.height};break;case"bottom":x={x:m,y:n.y+n.height};break;case"right":x={x:n.x+n.width,y:g};break;case"left":x={x:n.x-r.width,y:g};break;default:x={x:n.x,y:n.y}}switch(Ra(e)){case"start":x[l]-=y*(t&&d?-1:1);break;case"end":x[l]+=y*(t&&d?-1:1);break}return x}const QO=async(s,e,t)=>{const{placement:n="bottom",strategy:r="absolute",middleware:o=[],platform:l}=t,u=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(e));let d=await l.getElementRects({reference:s,floating:e,strategy:r}),{x:m,y:g}=Yx(d,n,f),y=n,x={},E=0;for(let S=0;S<u.length;S++){const{name:b,fn:R}=u[S],{x:w,y:_,data:D,reset:M}=await R({x:m,y:g,initialPlacement:n,placement:y,strategy:r,middlewareData:x,rects:d,platform:l,elements:{reference:s,floating:e}});m=w??m,g=_??g,x={...x,[b]:{...x[b],...D}},M&&E<=50&&(E++,typeof M=="object"&&(M.placement&&(y=M.placement),M.rects&&(d=M.rects===!0?await l.getElementRects({reference:s,floating:e,strategy:r}):M.rects),{x:m,y:g}=Yx(d,y,f)),S=-1)}return{x:m,y:g,placement:y,strategy:r,middlewareData:x}};async function Bo(s,e){var t;e===void 0&&(e={});const{x:n,y:r,platform:o,rects:l,elements:u,strategy:f}=s,{boundary:d="clippingAncestors",rootBoundary:m="viewport",elementContext:g="floating",altBoundary:y=!1,padding:x=0}=Vs(e,s),E=JT(x),b=u[y?g==="floating"?"reference":"floating":g],R=fu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(b)))==null||t?b:b.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(u.floating)),boundary:d,rootBoundary:m,strategy:f})),w=g==="floating"?{x:n,y:r,width:l.floating.width,height:l.floating.height}:l.reference,_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u.floating)),D=await(o.isElement==null?void 0:o.isElement(_))?await(o.getScale==null?void 0:o.getScale(_))||{x:1,y:1}:{x:1,y:1},M=fu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:w,offsetParent:_,strategy:f}):w);return{top:(R.top-M.top+E.top)/D.y,bottom:(M.bottom-R.bottom+E.bottom)/D.y,left:(R.left-M.left+E.left)/D.x,right:(M.right-R.right+E.right)/D.x}}const ZO=s=>({name:"arrow",options:s,async fn(e){const{x:t,y:n,placement:r,rects:o,platform:l,elements:u,middlewareData:f}=e,{element:d,padding:m=0}=Vs(s,e)||{};if(d==null)return{};const g=JT(m),y={x:t,y:n},x=gg(r),E=mg(x),S=await l.getDimensions(d),b=x==="y",R=b?"top":"left",w=b?"bottom":"right",_=b?"clientHeight":"clientWidth",D=o.reference[E]+o.reference[x]-y[x]-o.floating[E],M=y[x]-o.reference[x],$=await(l.getOffsetParent==null?void 0:l.getOffsetParent(d));let O=$?$[_]:0;(!O||!await(l.isElement==null?void 0:l.isElement($)))&&(O=u.floating[_]||o.floating[E]);const k=D/2-M/2,G=O/2-S[E]/2-1,B=_i(g[R],G),K=_i(g[w],G),ne=B,ue=O-S[E]-K,ee=O/2-S[E]/2+k,ae=xm(ne,ee,ue),P=!f.arrow&&Ra(r)!=null&&ee!==ae&&o.reference[E]/2-(ee<ne?B:K)-S[E]/2<0,F=P?ee<ne?ee-ne:ee-ue:0;return{[x]:y[x]+F,data:{[x]:ae,centerOffset:ee-ae-F,...P&&{alignmentOffset:F}},reset:P}}}),JO=function(s){return s===void 0&&(s={}),{name:"flip",options:s,async fn(e){var t,n;const{placement:r,middlewareData:o,rects:l,initialPlacement:u,platform:f,elements:d}=e,{mainAxis:m=!0,crossAxis:g=!0,fallbackPlacements:y,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:E="none",flipAlignment:S=!0,...b}=Vs(s,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const R=Ks(r),w=as(u),_=Ks(u)===u,D=await(f.isRTL==null?void 0:f.isRTL(d.floating)),M=y||(_||!S?[du(u)]:KO(u)),$=E!=="none";!y&&$&&M.push(...XO(u,S,E,D));const O=[u,...M],k=await Bo(e,b),G=[];let B=((n=o.flip)==null?void 0:n.overflows)||[];if(m&&G.push(k[R]),g){const ee=VO(r,l,D);G.push(k[ee[0]],k[ee[1]])}if(B=[...B,{placement:r,overflows:G}],!G.every(ee=>ee<=0)){var K,ne;const ee=(((K=o.flip)==null?void 0:K.index)||0)+1,ae=O[ee];if(ae&&(!(g==="alignment"?w!==as(ae):!1)||B.every(U=>as(U.placement)===w?U.overflows[0]>0:!0)))return{data:{index:ee,overflows:B},reset:{placement:ae}};let P=(ne=B.filter(F=>F.overflows[0]<=0).sort((F,U)=>F.overflows[1]-U.overflows[1])[0])==null?void 0:ne.placement;if(!P)switch(x){case"bestFit":{var ue;const F=(ue=B.filter(U=>{if($){const Y=as(U.placement);return Y===w||Y==="y"}return!0}).map(U=>[U.placement,U.overflows.filter(Y=>Y>0).reduce((Y,le)=>Y+le,0)]).sort((U,Y)=>U[1]-Y[1])[0])==null?void 0:ue[0];F&&(P=F);break}case"initialPlacement":P=u;break}if(r!==P)return{reset:{placement:P}}}return{}}}};function qx(s,e){return{top:s.top-e.height,right:s.right-e.width,bottom:s.bottom-e.height,left:s.left-e.width}}function Xx(s){return $O.some(e=>s[e]>=0)}const eM=function(s){return s===void 0&&(s={}),{name:"hide",options:s,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...r}=Vs(s,e);switch(n){case"referenceHidden":{const o=await Bo(e,{...r,elementContext:"reference"}),l=qx(o,t.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:Xx(l)}}}case"escaped":{const o=await Bo(e,{...r,altBoundary:!0}),l=qx(o,t.floating);return{data:{escapedOffsets:l,escaped:Xx(l)}}}default:return{}}}}},eb=new Set(["left","top"]);async function tM(s,e){const{placement:t,platform:n,elements:r}=s,o=await(n.isRTL==null?void 0:n.isRTL(r.floating)),l=Ks(t),u=Ra(t),f=as(t)==="y",d=eb.has(l)?-1:1,m=o&&f?-1:1,g=Vs(e,s);let{mainAxis:y,crossAxis:x,alignmentAxis:E}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return u&&typeof E=="number"&&(x=u==="end"?E*-1:E),f?{x:x*m,y:y*d}:{x:y*d,y:x*m}}const nM=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(e){var t,n;const{x:r,y:o,placement:l,middlewareData:u}=e,f=await tM(e,s);return l===((t=u.offset)==null?void 0:t.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:r+f.x,y:o+f.y,data:{...f,placement:l}}}}},sM=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(e){const{x:t,y:n,placement:r}=e,{mainAxis:o=!0,crossAxis:l=!1,limiter:u={fn:b=>{let{x:R,y:w}=b;return{x:R,y:w}}},...f}=Vs(s,e),d={x:t,y:n},m=await Bo(e,f),g=as(Ks(r)),y=hg(g);let x=d[y],E=d[g];if(o){const b=y==="y"?"top":"left",R=y==="y"?"bottom":"right",w=x+m[b],_=x-m[R];x=xm(w,x,_)}if(l){const b=g==="y"?"top":"left",R=g==="y"?"bottom":"right",w=E+m[b],_=E-m[R];E=xm(w,E,_)}const S=u.fn({...e,[y]:x,[g]:E});return{...S,data:{x:S.x-t,y:S.y-n,enabled:{[y]:o,[g]:l}}}}}},iM=function(s){return s===void 0&&(s={}),{options:s,fn(e){const{x:t,y:n,placement:r,rects:o,middlewareData:l}=e,{offset:u=0,mainAxis:f=!0,crossAxis:d=!0}=Vs(s,e),m={x:t,y:n},g=as(r),y=hg(g);let x=m[y],E=m[g];const S=Vs(u,e),b=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(f){const _=y==="y"?"height":"width",D=o.reference[y]-o.floating[_]+b.mainAxis,M=o.reference[y]+o.reference[_]-b.mainAxis;x<D?x=D:x>M&&(x=M)}if(d){var R,w;const _=y==="y"?"width":"height",D=eb.has(Ks(r)),M=o.reference[g]-o.floating[_]+(D&&((R=l.offset)==null?void 0:R[g])||0)+(D?0:b.crossAxis),$=o.reference[g]+o.reference[_]+(D?0:((w=l.offset)==null?void 0:w[g])||0)-(D?b.crossAxis:0);E<M?E=M:E>$&&(E=$)}return{[y]:x,[g]:E}}}},rM=function(s){return s===void 0&&(s={}),{name:"size",options:s,async fn(e){var t,n;const{placement:r,rects:o,platform:l,elements:u}=e,{apply:f=()=>{},...d}=Vs(s,e),m=await Bo(e,d),g=Ks(r),y=Ra(r),x=as(r)==="y",{width:E,height:S}=o.floating;let b,R;g==="top"||g==="bottom"?(b=g,R=y===(await(l.isRTL==null?void 0:l.isRTL(u.floating))?"start":"end")?"left":"right"):(R=g,b=y==="end"?"top":"bottom");const w=S-m.top-m.bottom,_=E-m.left-m.right,D=_i(S-m[b],w),M=_i(E-m[R],_),$=!e.middlewareData.shift;let O=D,k=M;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(k=_),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(O=w),$&&!y){const B=vn(m.left,0),K=vn(m.right,0),ne=vn(m.top,0),ue=vn(m.bottom,0);x?k=E-2*(B!==0||K!==0?B+K:vn(m.left,m.right)):O=S-2*(ne!==0||ue!==0?ne+ue:vn(m.top,m.bottom))}await f({...e,availableWidth:k,availableHeight:O});const G=await l.getDimensions(u.floating);return E!==G.width||S!==G.height?{reset:{rects:!0}}:{}}}};function Uu(){return typeof window<"u"}function La(s){return tb(s)?(s.nodeName||"").toLowerCase():"#document"}function Sn(s){var e;return(s==null||(e=s.ownerDocument)==null?void 0:e.defaultView)||window}function gs(s){var e;return(e=(tb(s)?s.ownerDocument:s.document)||window.document)==null?void 0:e.documentElement}function tb(s){return Uu()?s instanceof Node||s instanceof Sn(s).Node:!1}function zn(s){return Uu()?s instanceof Element||s instanceof Sn(s).Element:!1}function us(s){return Uu()?s instanceof HTMLElement||s instanceof Sn(s).HTMLElement:!1}function Wx(s){return!Uu()||typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof Sn(s).ShadowRoot}const aM=new Set(["inline","contents"]);function Zo(s){const{overflow:e,overflowX:t,overflowY:n,display:r}=Yn(s);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!aM.has(r)}const oM=new Set(["table","td","th"]);function lM(s){return oM.has(La(s))}const cM=[":popover-open",":modal"];function Bu(s){return cM.some(e=>{try{return s.matches(e)}catch{return!1}})}const uM=["transform","translate","scale","rotate","perspective"],dM=["transform","translate","scale","rotate","perspective","filter"],fM=["paint","layout","strict","content"];function pg(s){const e=yg(),t=zn(s)?Yn(s):s;return uM.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||dM.some(n=>(t.willChange||"").includes(n))||fM.some(n=>(t.contain||"").includes(n))}function hM(s){let e=wi(s);for(;us(e)&&!va(e);){if(pg(e))return e;if(Bu(e))return null;e=wi(e)}return null}function yg(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const mM=new Set(["html","body","#document"]);function va(s){return mM.has(La(s))}function Yn(s){return Sn(s).getComputedStyle(s)}function $u(s){return zn(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.scrollX,scrollTop:s.scrollY}}function wi(s){if(La(s)==="html")return s;const e=s.assignedSlot||s.parentNode||Wx(s)&&s.host||gs(s);return Wx(e)?e.host:e}function nb(s){const e=wi(s);return va(e)?s.ownerDocument?s.ownerDocument.body:s.body:us(e)&&Zo(e)?e:nb(e)}function $o(s,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const r=nb(s),o=r===((n=s.ownerDocument)==null?void 0:n.body),l=Sn(r);if(o){const u=Sm(l);return e.concat(l,l.visualViewport||[],Zo(r)?r:[],u&&t?$o(u):[])}return e.concat(r,$o(r,[],t))}function Sm(s){return s.parent&&Object.getPrototypeOf(s.parent)?s.frameElement:null}function sb(s){const e=Yn(s);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const r=us(s),o=r?s.offsetWidth:t,l=r?s.offsetHeight:n,u=uu(t)!==o||uu(n)!==l;return u&&(t=o,n=l),{width:t,height:n,$:u}}function vg(s){return zn(s)?s:s.contextElement}function ca(s){const e=vg(s);if(!us(e))return cs(1);const t=e.getBoundingClientRect(),{width:n,height:r,$:o}=sb(e);let l=(o?uu(t.width):t.width)/n,u=(o?uu(t.height):t.height)/r;return(!l||!Number.isFinite(l))&&(l=1),(!u||!Number.isFinite(u))&&(u=1),{x:l,y:u}}const gM=cs(0);function ib(s){const e=Sn(s);return!yg()||!e.visualViewport?gM:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function pM(s,e,t){return e===void 0&&(e=!1),!t||e&&t!==Sn(s)?!1:e}function nr(s,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const r=s.getBoundingClientRect(),o=vg(s);let l=cs(1);e&&(n?zn(n)&&(l=ca(n)):l=ca(s));const u=pM(o,t,n)?ib(o):cs(0);let f=(r.left+u.x)/l.x,d=(r.top+u.y)/l.y,m=r.width/l.x,g=r.height/l.y;if(o){const y=Sn(o),x=n&&zn(n)?Sn(n):n;let E=y,S=Sm(E);for(;S&&n&&x!==E;){const b=ca(S),R=S.getBoundingClientRect(),w=Yn(S),_=R.left+(S.clientLeft+parseFloat(w.paddingLeft))*b.x,D=R.top+(S.clientTop+parseFloat(w.paddingTop))*b.y;f*=b.x,d*=b.y,m*=b.x,g*=b.y,f+=_,d+=D,E=Sn(S),S=Sm(E)}}return fu({width:m,height:g,x:f,y:d})}function ju(s,e){const t=$u(s).scrollLeft;return e?e.left+t:nr(gs(s)).left+t}function rb(s,e){const t=s.getBoundingClientRect(),n=t.left+e.scrollLeft-ju(s,t),r=t.top+e.scrollTop;return{x:n,y:r}}function yM(s){let{elements:e,rect:t,offsetParent:n,strategy:r}=s;const o=r==="fixed",l=gs(n),u=e?Bu(e.floating):!1;if(n===l||u&&o)return t;let f={scrollLeft:0,scrollTop:0},d=cs(1);const m=cs(0),g=us(n);if((g||!g&&!o)&&((La(n)!=="body"||Zo(l))&&(f=$u(n)),us(n))){const x=nr(n);d=ca(n),m.x=x.x+n.clientLeft,m.y=x.y+n.clientTop}const y=l&&!g&&!o?rb(l,f):cs(0);return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-f.scrollLeft*d.x+m.x+y.x,y:t.y*d.y-f.scrollTop*d.y+m.y+y.y}}function vM(s){return Array.from(s.getClientRects())}function xM(s){const e=gs(s),t=$u(s),n=s.ownerDocument.body,r=vn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),o=vn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let l=-t.scrollLeft+ju(s);const u=-t.scrollTop;return Yn(n).direction==="rtl"&&(l+=vn(e.clientWidth,n.clientWidth)-r),{width:r,height:o,x:l,y:u}}const Qx=25;function EM(s,e){const t=Sn(s),n=gs(s),r=t.visualViewport;let o=n.clientWidth,l=n.clientHeight,u=0,f=0;if(r){o=r.width,l=r.height;const m=yg();(!m||m&&e==="fixed")&&(u=r.offsetLeft,f=r.offsetTop)}const d=ju(n);if(d<=0){const m=n.ownerDocument,g=m.body,y=getComputedStyle(g),x=m.compatMode==="CSS1Compat"&&parseFloat(y.marginLeft)+parseFloat(y.marginRight)||0,E=Math.abs(n.clientWidth-g.clientWidth-x);E<=Qx&&(o-=E)}else d<=Qx&&(o+=d);return{width:o,height:l,x:u,y:f}}const SM=new Set(["absolute","fixed"]);function TM(s,e){const t=nr(s,!0,e==="fixed"),n=t.top+s.clientTop,r=t.left+s.clientLeft,o=us(s)?ca(s):cs(1),l=s.clientWidth*o.x,u=s.clientHeight*o.y,f=r*o.x,d=n*o.y;return{width:l,height:u,x:f,y:d}}function Zx(s,e,t){let n;if(e==="viewport")n=EM(s,t);else if(e==="document")n=xM(gs(s));else if(zn(e))n=TM(e,t);else{const r=ib(s);n={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return fu(n)}function ab(s,e){const t=wi(s);return t===e||!zn(t)||va(t)?!1:Yn(t).position==="fixed"||ab(t,e)}function bM(s,e){const t=e.get(s);if(t)return t;let n=$o(s,[],!1).filter(u=>zn(u)&&La(u)!=="body"),r=null;const o=Yn(s).position==="fixed";let l=o?wi(s):s;for(;zn(l)&&!va(l);){const u=Yn(l),f=pg(l);!f&&u.position==="fixed"&&(r=null),(o?!f&&!r:!f&&u.position==="static"&&!!r&&SM.has(r.position)||Zo(l)&&!f&&ab(s,l))?n=n.filter(m=>m!==l):r=u,l=wi(l)}return e.set(s,n),n}function AM(s){let{element:e,boundary:t,rootBoundary:n,strategy:r}=s;const l=[...t==="clippingAncestors"?Bu(e)?[]:bM(e,this._c):[].concat(t),n],u=l[0],f=l.reduce((d,m)=>{const g=Zx(e,m,r);return d.top=vn(g.top,d.top),d.right=_i(g.right,d.right),d.bottom=_i(g.bottom,d.bottom),d.left=vn(g.left,d.left),d},Zx(e,u,r));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function RM(s){const{width:e,height:t}=sb(s);return{width:e,height:t}}function LM(s,e,t){const n=us(e),r=gs(e),o=t==="fixed",l=nr(s,!0,o,e);let u={scrollLeft:0,scrollTop:0};const f=cs(0);function d(){f.x=ju(r)}if(n||!n&&!o)if((La(e)!=="body"||Zo(r))&&(u=$u(e)),n){const x=nr(e,!0,o,e);f.x=x.x+e.clientLeft,f.y=x.y+e.clientTop}else r&&d();o&&!n&&r&&d();const m=r&&!n&&!o?rb(r,u):cs(0),g=l.left+u.scrollLeft-f.x-m.x,y=l.top+u.scrollTop-f.y-m.y;return{x:g,y,width:l.width,height:l.height}}function _h(s){return Yn(s).position==="static"}function Jx(s,e){if(!us(s)||Yn(s).position==="fixed")return null;if(e)return e(s);let t=s.offsetParent;return gs(s)===t&&(t=t.ownerDocument.body),t}function ob(s,e){const t=Sn(s);if(Bu(s))return t;if(!us(s)){let r=wi(s);for(;r&&!va(r);){if(zn(r)&&!_h(r))return r;r=wi(r)}return t}let n=Jx(s,e);for(;n&&lM(n)&&_h(n);)n=Jx(n,e);return n&&va(n)&&_h(n)&&!pg(n)?t:n||hM(s)||t}const CM=async function(s){const e=this.getOffsetParent||ob,t=this.getDimensions,n=await t(s.floating);return{reference:LM(s.reference,await e(s.floating),s.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function _M(s){return Yn(s).direction==="rtl"}const wM={convertOffsetParentRelativeRectToViewportRelativeRect:yM,getDocumentElement:gs,getClippingRect:AM,getOffsetParent:ob,getElementRects:CM,getClientRects:vM,getDimensions:RM,getScale:ca,isElement:zn,isRTL:_M};function lb(s,e){return s.x===e.x&&s.y===e.y&&s.width===e.width&&s.height===e.height}function DM(s,e){let t=null,n;const r=gs(s);function o(){var u;clearTimeout(n),(u=t)==null||u.disconnect(),t=null}function l(u,f){u===void 0&&(u=!1),f===void 0&&(f=1),o();const d=s.getBoundingClientRect(),{left:m,top:g,width:y,height:x}=d;if(u||e(),!y||!x)return;const E=_c(g),S=_c(r.clientWidth-(m+y)),b=_c(r.clientHeight-(g+x)),R=_c(m),_={rootMargin:-E+"px "+-S+"px "+-b+"px "+-R+"px",threshold:vn(0,_i(1,f))||1};let D=!0;function M($){const O=$[0].intersectionRatio;if(O!==f){if(!D)return l();O?l(!1,O):n=setTimeout(()=>{l(!1,1e-7)},1e3)}O===1&&!lb(d,s.getBoundingClientRect())&&l(),D=!1}try{t=new IntersectionObserver(M,{..._,root:r.ownerDocument})}catch{t=new IntersectionObserver(M,_)}t.observe(s)}return l(!0),o}function IM(s,e,t,n){n===void 0&&(n={});const{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:f=!1}=n,d=vg(s),m=r||o?[...d?$o(d):[],...$o(e)]:[];m.forEach(R=>{r&&R.addEventListener("scroll",t,{passive:!0}),o&&R.addEventListener("resize",t)});const g=d&&u?DM(d,t):null;let y=-1,x=null;l&&(x=new ResizeObserver(R=>{let[w]=R;w&&w.target===d&&x&&(x.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var _;(_=x)==null||_.observe(e)})),t()}),d&&!f&&x.observe(d),x.observe(e));let E,S=f?nr(s):null;f&&b();function b(){const R=nr(s);S&&!lb(S,R)&&t(),S=R,E=requestAnimationFrame(b)}return t(),()=>{var R;m.forEach(w=>{r&&w.removeEventListener("scroll",t),o&&w.removeEventListener("resize",t)}),g?.(),(R=x)==null||R.disconnect(),x=null,f&&cancelAnimationFrame(E)}}const OM=nM,MM=sM,NM=JO,kM=rM,PM=eM,eE=ZO,FM=iM,UM=(s,e,t)=>{const n=new Map,r={platform:wM,...t},o={...r.platform,_c:n};return QO(s,e,{...r,platform:o})};var BM=typeof document<"u",$M=function(){},Zc=BM?A.useLayoutEffect:$M;function hu(s,e){if(s===e)return!0;if(typeof s!=typeof e)return!1;if(typeof s=="function"&&s.toString()===e.toString())return!0;let t,n,r;if(s&&e&&typeof s=="object"){if(Array.isArray(s)){if(t=s.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!hu(s[n],e[n]))return!1;return!0}if(r=Object.keys(s),t=r.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,r[n]))return!1;for(n=t;n--!==0;){const o=r[n];if(!(o==="_owner"&&s.$$typeof)&&!hu(s[o],e[o]))return!1}return!0}return s!==s&&e!==e}function cb(s){return typeof window>"u"?1:(s.ownerDocument.defaultView||window).devicePixelRatio||1}function tE(s,e){const t=cb(s);return Math.round(e*t)/t}function wh(s){const e=A.useRef(s);return Zc(()=>{e.current=s}),e}function jM(s){s===void 0&&(s={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:r,elements:{reference:o,floating:l}={},transform:u=!0,whileElementsMounted:f,open:d}=s,[m,g]=A.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[y,x]=A.useState(n);hu(y,n)||x(n);const[E,S]=A.useState(null),[b,R]=A.useState(null),w=A.useCallback(U=>{U!==$.current&&($.current=U,S(U))},[]),_=A.useCallback(U=>{U!==O.current&&(O.current=U,R(U))},[]),D=o||E,M=l||b,$=A.useRef(null),O=A.useRef(null),k=A.useRef(m),G=f!=null,B=wh(f),K=wh(r),ne=wh(d),ue=A.useCallback(()=>{if(!$.current||!O.current)return;const U={placement:e,strategy:t,middleware:y};K.current&&(U.platform=K.current),UM($.current,O.current,U).then(Y=>{const le={...Y,isPositioned:ne.current!==!1};ee.current&&!hu(k.current,le)&&(k.current=le,Qo.flushSync(()=>{g(le)}))})},[y,e,t,K,ne]);Zc(()=>{d===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,g(U=>({...U,isPositioned:!1})))},[d]);const ee=A.useRef(!1);Zc(()=>(ee.current=!0,()=>{ee.current=!1}),[]),Zc(()=>{if(D&&($.current=D),M&&(O.current=M),D&&M){if(B.current)return B.current(D,M,ue);ue()}},[D,M,ue,B,G]);const ae=A.useMemo(()=>({reference:$,floating:O,setReference:w,setFloating:_}),[w,_]),P=A.useMemo(()=>({reference:D,floating:M}),[D,M]),F=A.useMemo(()=>{const U={position:t,left:0,top:0};if(!P.floating)return U;const Y=tE(P.floating,m.x),le=tE(P.floating,m.y);return u?{...U,transform:"translate("+Y+"px, "+le+"px)",...cb(P.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:Y,top:le}},[t,u,P.floating,m.x,m.y]);return A.useMemo(()=>({...m,update:ue,refs:ae,elements:P,floatingStyles:F}),[m,ue,ae,P,F])}const GM=s=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:s,fn(t){const{element:n,padding:r}=typeof s=="function"?s(t):s;return n&&e(n)?n.current!=null?eE({element:n.current,padding:r}).fn(t):{}:n?eE({element:n,padding:r}).fn(t):{}}}},HM=(s,e)=>({...OM(s),options:[s,e]}),VM=(s,e)=>({...MM(s),options:[s,e]}),KM=(s,e)=>({...FM(s),options:[s,e]}),zM=(s,e)=>({...NM(s),options:[s,e]}),YM=(s,e)=>({...kM(s),options:[s,e]}),qM=(s,e)=>({...PM(s),options:[s,e]}),XM=(s,e)=>({...GM(s),options:[s,e]});var WM="Arrow",ub=A.forwardRef((s,e)=>{const{children:t,width:n=10,height:r=5,...o}=s;return T.jsx(nt.svg,{...o,ref:e,width:n,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:s.asChild?t:T.jsx("polygon",{points:"0,0 30,0 15,10"})})});ub.displayName=WM;var QM=ub;function db(s){const[e,t]=A.useState(void 0);return Yt(()=>{if(s){t({width:s.offsetWidth,height:s.offsetHeight});const n=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const o=r[0];let l,u;if("borderBoxSize"in o){const f=o.borderBoxSize,d=Array.isArray(f)?f[0]:f;l=d.inlineSize,u=d.blockSize}else l=s.offsetWidth,u=s.offsetHeight;t({width:l,height:u})});return n.observe(s,{box:"border-box"}),()=>n.unobserve(s)}else t(void 0)},[s]),e}var xg="Popper",[fb,Gu]=hs(xg),[ZM,hb]=fb(xg),mb=s=>{const{__scopePopper:e,children:t}=s,[n,r]=A.useState(null);return T.jsx(ZM,{scope:e,anchor:n,onAnchorChange:r,children:t})};mb.displayName=xg;var gb="PopperAnchor",pb=A.forwardRef((s,e)=>{const{__scopePopper:t,virtualRef:n,...r}=s,o=hb(gb,t),l=A.useRef(null),u=He(e,l),f=A.useRef(null);return A.useEffect(()=>{const d=f.current;f.current=n?.current||l.current,d!==f.current&&o.onAnchorChange(f.current)}),n?null:T.jsx(nt.div,{...r,ref:u})});pb.displayName=gb;var Eg="PopperContent",[JM,eN]=fb(Eg),yb=A.forwardRef((s,e)=>{const{__scopePopper:t,side:n="bottom",sideOffset:r=0,align:o="center",alignOffset:l=0,arrowPadding:u=0,avoidCollisions:f=!0,collisionBoundary:d=[],collisionPadding:m=0,sticky:g="partial",hideWhenDetached:y=!1,updatePositionStrategy:x="optimized",onPlaced:E,...S}=s,b=hb(Eg,t),[R,w]=A.useState(null),_=He(e,he=>w(he)),[D,M]=A.useState(null),$=db(D),O=$?.width??0,k=$?.height??0,G=n+(o!=="center"?"-"+o:""),B=typeof m=="number"?m:{top:0,right:0,bottom:0,left:0,...m},K=Array.isArray(d)?d:[d],ne=K.length>0,ue={padding:B,boundary:K.filter(nN),altBoundary:ne},{refs:ee,floatingStyles:ae,placement:P,isPositioned:F,middlewareData:U}=jM({strategy:"fixed",placement:G,whileElementsMounted:(...he)=>IM(...he,{animationFrame:x==="always"}),elements:{reference:b.anchor},middleware:[HM({mainAxis:r+k,alignmentAxis:l}),f&&VM({mainAxis:!0,crossAxis:!1,limiter:g==="partial"?KM():void 0,...ue}),f&&zM({...ue}),YM({...ue,apply:({elements:he,rects:Le,availableWidth:_e,availableHeight:at})=>{const{width:Rt,height:bn}=Le.reference,Fn=he.floating.style;Fn.setProperty("--radix-popper-available-width",`${_e}px`),Fn.setProperty("--radix-popper-available-height",`${at}px`),Fn.setProperty("--radix-popper-anchor-width",`${Rt}px`),Fn.setProperty("--radix-popper-anchor-height",`${bn}px`)}}),D&&XM({element:D,padding:u}),sN({arrowWidth:O,arrowHeight:k}),y&&qM({strategy:"referenceHidden",...ue})]}),[Y,le]=Eb(P),N=Bt(E);Yt(()=>{F&&N?.()},[F,N]);const H=U.arrow?.x,J=U.arrow?.y,se=U.arrow?.centerOffset!==0,[de,fe]=A.useState();return Yt(()=>{R&&fe(window.getComputedStyle(R).zIndex)},[R]),T.jsx("div",{ref:ee.setFloating,"data-radix-popper-content-wrapper":"",style:{...ae,transform:F?ae.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:de,"--radix-popper-transform-origin":[U.transformOrigin?.x,U.transformOrigin?.y].join(" "),...U.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:s.dir,children:T.jsx(JM,{scope:t,placedSide:Y,onArrowChange:M,arrowX:H,arrowY:J,shouldHideArrow:se,children:T.jsx(nt.div,{"data-side":Y,"data-align":le,...S,ref:_,style:{...S.style,animation:F?void 0:"none"}})})})});yb.displayName=Eg;var vb="PopperArrow",tN={top:"bottom",right:"left",bottom:"top",left:"right"},xb=A.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,o=eN(vb,n),l=tN[o.placedSide];return T.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:T.jsx(QM,{...r,ref:t,style:{...r.style,display:"block"}})})});xb.displayName=vb;function nN(s){return s!==null}var sN=s=>({name:"transformOrigin",options:s,fn(e){const{placement:t,rects:n,middlewareData:r}=e,l=r.arrow?.centerOffset!==0,u=l?0:s.arrowWidth,f=l?0:s.arrowHeight,[d,m]=Eb(t),g={start:"0%",center:"50%",end:"100%"}[m],y=(r.arrow?.x??0)+u/2,x=(r.arrow?.y??0)+f/2;let E="",S="";return d==="bottom"?(E=l?g:`${y}px`,S=`${-f}px`):d==="top"?(E=l?g:`${y}px`,S=`${n.floating.height+f}px`):d==="right"?(E=`${-f}px`,S=l?g:`${x}px`):d==="left"&&(E=`${n.floating.width+f}px`,S=l?g:`${x}px`),{data:{x:E,y:S}}}});function Eb(s){const[e,t="center"]=s.split("-");return[e,t]}var iN=mb,Sb=pb,Tb=yb,bb=xb,rN="Portal",Hu=A.forwardRef((s,e)=>{const{container:t,...n}=s,[r,o]=A.useState(!1);Yt(()=>o(!0),[]);const l=t||r&&globalThis?.document?.body;return l?ZS.createPortal(T.jsx(nt.div,{...n,ref:e}),l):null});Hu.displayName=rN;function aN(s,e){return A.useReducer((t,n)=>e[t][n]??t,s)}var ps=s=>{const{present:e,children:t}=s,n=oN(e),r=typeof t=="function"?t({present:n.isPresent}):A.Children.only(t),o=He(n.ref,lN(r));return typeof t=="function"||n.isPresent?A.cloneElement(r,{ref:o}):null};ps.displayName="Presence";function oN(s){const[e,t]=A.useState(),n=A.useRef(null),r=A.useRef(s),o=A.useRef("none"),l=s?"mounted":"unmounted",[u,f]=aN(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const d=wc(n.current);o.current=u==="mounted"?d:"none"},[u]),Yt(()=>{const d=n.current,m=r.current;if(m!==s){const y=o.current,x=wc(d);s?f("MOUNT"):x==="none"||d?.display==="none"?f("UNMOUNT"):f(m&&y!==x?"ANIMATION_OUT":"UNMOUNT"),r.current=s}},[s,f]),Yt(()=>{if(e){let d;const m=e.ownerDocument.defaultView??window,g=x=>{const S=wc(n.current).includes(CSS.escape(x.animationName));if(x.target===e&&S&&(f("ANIMATION_END"),!r.current)){const b=e.style.animationFillMode;e.style.animationFillMode="forwards",d=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=b)})}},y=x=>{x.target===e&&(o.current=wc(n.current))};return e.addEventListener("animationstart",y),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{m.clearTimeout(d),e.removeEventListener("animationstart",y),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else f("ANIMATION_END")},[e,f]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:A.useCallback(d=>{n.current=d?getComputedStyle(d):null,t(d)},[])}}function wc(s){return s?.animationName||"none"}function lN(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var cN=Symbol("radix.slottable");function uN(s){const e=({children:t})=>T.jsx(T.Fragment,{children:t});return e.displayName=`${s}.Slottable`,e.__radixId=cN,e}var dN=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),fN="VisuallyHidden",Ab=A.forwardRef((s,e)=>T.jsx(nt.span,{...s,ref:e,style:{...dN,...s.style}}));Ab.displayName=fN;var hN=Ab,[Vu]=hs("Tooltip",[Gu]),Sg=Gu(),Rb="TooltipProvider",mN=700,nE="tooltip.open",[gN,Lb]=Vu(Rb),Cb=s=>{const{__scopeTooltip:e,delayDuration:t=mN,skipDelayDuration:n=300,disableHoverableContent:r=!1,children:o}=s,l=A.useRef(!0),u=A.useRef(!1),f=A.useRef(0);return A.useEffect(()=>{const d=f.current;return()=>window.clearTimeout(d)},[]),T.jsx(gN,{scope:e,isOpenDelayedRef:l,delayDuration:t,onOpen:A.useCallback(()=>{window.clearTimeout(f.current),l.current=!1},[]),onClose:A.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>l.current=!0,n)},[n]),isPointerInTransitRef:u,onPointerInTransitChange:A.useCallback(d=>{u.current=d},[]),disableHoverableContent:r,children:o})};Cb.displayName=Rb;var _b="Tooltip",[$j,Jo]=Vu(_b),Tm="TooltipTrigger",pN=A.forwardRef((s,e)=>{const{__scopeTooltip:t,...n}=s,r=Jo(Tm,t),o=Lb(Tm,t),l=Sg(t),u=A.useRef(null),f=He(e,u,r.onTriggerChange),d=A.useRef(!1),m=A.useRef(!1),g=A.useCallback(()=>d.current=!1,[]);return A.useEffect(()=>()=>document.removeEventListener("pointerup",g),[g]),T.jsx(Sb,{asChild:!0,...l,children:T.jsx(nt.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...n,ref:f,onPointerMove:qr(s.onPointerMove,y=>{y.pointerType!=="touch"&&!m.current&&!o.isPointerInTransitRef.current&&(r.onTriggerEnter(),m.current=!0)}),onPointerLeave:qr(s.onPointerLeave,()=>{r.onTriggerLeave(),m.current=!1}),onPointerDown:qr(s.onPointerDown,()=>{r.open&&r.onClose(),d.current=!0,document.addEventListener("pointerup",g,{once:!0})}),onFocus:qr(s.onFocus,()=>{d.current||r.onOpen()}),onBlur:qr(s.onBlur,r.onClose),onClick:qr(s.onClick,r.onClose)})})});pN.displayName=Tm;var Tg="TooltipPortal",[yN,vN]=Vu(Tg,{forceMount:void 0}),wb=s=>{const{__scopeTooltip:e,forceMount:t,children:n,container:r}=s,o=Jo(Tg,e);return T.jsx(yN,{scope:e,forceMount:t,children:T.jsx(ps,{present:t||o.open,children:T.jsx(Hu,{asChild:!0,container:r,children:n})})})};wb.displayName=Tg;var xa="TooltipContent",Db=A.forwardRef((s,e)=>{const t=vN(xa,s.__scopeTooltip),{forceMount:n=t.forceMount,side:r="top",...o}=s,l=Jo(xa,s.__scopeTooltip);return T.jsx(ps,{present:n||l.open,children:l.disableHoverableContent?T.jsx(Ib,{side:r,...o,ref:e}):T.jsx(xN,{side:r,...o,ref:e})})}),xN=A.forwardRef((s,e)=>{const t=Jo(xa,s.__scopeTooltip),n=Lb(xa,s.__scopeTooltip),r=A.useRef(null),o=He(e,r),[l,u]=A.useState(null),{trigger:f,onClose:d}=t,m=r.current,{onPointerInTransitChange:g}=n,y=A.useCallback(()=>{u(null),g(!1)},[g]),x=A.useCallback((E,S)=>{const b=E.currentTarget,R={x:E.clientX,y:E.clientY},w=AN(R,b.getBoundingClientRect()),_=RN(R,w),D=LN(S.getBoundingClientRect()),M=_N([..._,...D]);u(M),g(!0)},[g]);return A.useEffect(()=>()=>y(),[y]),A.useEffect(()=>{if(f&&m){const E=b=>x(b,m),S=b=>x(b,f);return f.addEventListener("pointerleave",E),m.addEventListener("pointerleave",S),()=>{f.removeEventListener("pointerleave",E),m.removeEventListener("pointerleave",S)}}},[f,m,x,y]),A.useEffect(()=>{if(l){const E=S=>{const b=S.target,R={x:S.clientX,y:S.clientY},w=f?.contains(b)||m?.contains(b),_=!CN(R,l);w?y():_&&(y(),d())};return document.addEventListener("pointermove",E),()=>document.removeEventListener("pointermove",E)}},[f,m,l,d,y]),T.jsx(Ib,{...s,ref:o})}),[EN,SN]=Vu(_b,{isInside:!1}),TN=uN("TooltipContent"),Ib=A.forwardRef((s,e)=>{const{__scopeTooltip:t,children:n,"aria-label":r,onEscapeKeyDown:o,onPointerDownOutside:l,...u}=s,f=Jo(xa,t),d=Sg(t),{onClose:m}=f;return A.useEffect(()=>(document.addEventListener(nE,m),()=>document.removeEventListener(nE,m)),[m]),A.useEffect(()=>{if(f.trigger){const g=y=>{y.target?.contains(f.trigger)&&m()};return window.addEventListener("scroll",g,{capture:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})}},[f.trigger,m]),T.jsx(Fu,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:g=>g.preventDefault(),onDismiss:m,children:T.jsxs(Tb,{"data-state":f.stateAttribute,...d,...u,ref:e,style:{...u.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[T.jsx(TN,{children:n}),T.jsx(EN,{scope:t,isInside:!0,children:T.jsx(hN,{id:f.contentId,role:"tooltip",children:r||n})})]})})});Db.displayName=xa;var Ob="TooltipArrow",bN=A.forwardRef((s,e)=>{const{__scopeTooltip:t,...n}=s,r=Sg(t);return SN(Ob,t).isInside?null:T.jsx(bb,{...r,...n,ref:e})});bN.displayName=Ob;function AN(s,e){const t=Math.abs(e.top-s.y),n=Math.abs(e.bottom-s.y),r=Math.abs(e.right-s.x),o=Math.abs(e.left-s.x);switch(Math.min(t,n,r,o)){case o:return"left";case r:return"right";case t:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function RN(s,e,t=5){const n=[];switch(e){case"top":n.push({x:s.x-t,y:s.y+t},{x:s.x+t,y:s.y+t});break;case"bottom":n.push({x:s.x-t,y:s.y-t},{x:s.x+t,y:s.y-t});break;case"left":n.push({x:s.x+t,y:s.y-t},{x:s.x+t,y:s.y+t});break;case"right":n.push({x:s.x-t,y:s.y-t},{x:s.x-t,y:s.y+t});break}return n}function LN(s){const{top:e,right:t,bottom:n,left:r}=s;return[{x:r,y:e},{x:t,y:e},{x:t,y:n},{x:r,y:n}]}function CN(s,e){const{x:t,y:n}=s;let r=!1;for(let o=0,l=e.length-1;o<e.length;l=o++){const u=e[o],f=e[l],d=u.x,m=u.y,g=f.x,y=f.y;m>n!=y>n&&t<(g-d)*(n-m)/(y-m)+d&&(r=!r)}return r}function _N(s){const e=s.slice();return e.sort((t,n)=>t.x<n.x?-1:t.x>n.x?1:t.y<n.y?-1:t.y>n.y?1:0),wN(e)}function wN(s){if(s.length<=1)return s.slice();const e=[];for(let n=0;n<s.length;n++){const r=s[n];for(;e.length>=2;){const o=e[e.length-1],l=e[e.length-2];if((o.x-l.x)*(r.y-l.y)>=(o.y-l.y)*(r.x-l.x))e.pop();else break}e.push(r)}e.pop();const t=[];for(let n=s.length-1;n>=0;n--){const r=s[n];for(;t.length>=2;){const o=t[t.length-1],l=t[t.length-2];if((o.x-l.x)*(r.y-l.y)>=(o.y-l.y)*(r.x-l.x))t.pop();else break}t.push(r)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var DN=Cb,IN=wb,Mb=Db;const ON=DN,MN=A.forwardRef(({className:s,sideOffset:e=4,...t},n)=>T.jsx(IN,{children:T.jsx(Mb,{ref:n,sideOffset:e,className:De("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...t})}));MN.displayName=Mb.displayName;const Nb=A.createContext(void 0);function NN({children:s}){const[e,t]=A.useState([]),[n,r]=A.useState(!0),o=f=>({id:f.id,title:f.title,description:f.description||"No description available",thumbnail:f.thumbnailUrl||"https://images.unsplash.com/photo-1536440136628-849c177e76a1?auto=format&fit=crop&w=500&q=60",heroImage:f.heroImageUrl||f.thumbnailUrl||"https://images.unsplash.com/photo-1536440136628-849c177e76a1?auto=format&fit=crop&w=1200&q=80",duration:f.duration,year:f.year,genre:f.genre,rating:f.rating,videoUrl:f.hlsUrl||f.videoUrl||""}),l=async()=>{try{r(!0);const f=await fetch("/api/videos");if(f.ok){const m=(await f.json()).filter(g=>g.hlsUrl||g.videoUrl);t(m.map(o))}}catch(f){console.error("Failed to load videos:",f)}finally{r(!1)}};A.useEffect(()=>{l()},[]);const u=async()=>{await l()};return T.jsx(Nb.Provider,{value:{movies:e,loading:n,refreshMovies:u},children:s})}function bg(){const s=A.useContext(Nb);if(s===void 0)throw new Error("useMovies must be used within a MovieProvider");return s}const js=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:De("rounded-xl border bg-card text-card-foreground shadow",s),...e}));js.displayName="Card";const Ri=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:De("flex flex-col space-y-1.5 p-6",s),...e}));Ri.displayName="CardHeader";const Li=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:De("font-semibold leading-none tracking-tight",s),...e}));Li.displayName="CardTitle";const _o=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:De("text-sm text-muted-foreground",s),...e}));_o.displayName="CardDescription";const Gs=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:De("p-6 pt-0",s),...e}));Gs.displayName="CardContent";const kN=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:De("flex items-center p-6 pt-0",s),...e}));kN.displayName="CardFooter";function bm(){return T.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:T.jsx(js,{className:"w-full max-w-md mx-4",children:T.jsxs(Gs,{className:"pt-6",children:[T.jsxs("div",{className:"flex mb-4 gap-2",children:[T.jsx(wT,{className:"h-8 w-8 text-red-500"}),T.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),T.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const PN="/assets/nubinix-logo-W61dMJqR.png";var FN=Symbol.for("react.lazy"),mu=rr[" use ".trim().toString()];function UN(s){return typeof s=="object"&&s!==null&&"then"in s}function kb(s){return s!=null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===FN&&"_payload"in s&&UN(s._payload)}function Pb(s){const e=$N(s),t=A.forwardRef((n,r)=>{let{children:o,...l}=n;kb(o)&&typeof mu=="function"&&(o=mu(o._payload));const u=A.Children.toArray(o),f=u.find(GN);if(f){const d=f.props.children,m=u.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}var BN=Pb("Slot");function $N(s){const e=A.forwardRef((t,n)=>{let{children:r,...o}=t;if(kb(r)&&typeof mu=="function"&&(r=mu(r._payload)),A.isValidElement(r)){const l=VN(r),u=HN(o,r.props);return r.type!==A.Fragment&&(u.ref=n?zs(n,l):l),A.cloneElement(r,u)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var jN=Symbol("radix.slottable");function GN(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===jN}function HN(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function VN(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}const KN=Pu("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground shadow-sm border-destructive-border",outline:" border [border-color:var(--button-outline)] shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent",link:"text-primary underline-offset-4 hover:underline"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),mt=A.forwardRef(({className:s,variant:e,size:t,asChild:n=!1,...r},o)=>{const l=n?BN:"button";return T.jsx(l,{className:De(KN({variant:e,size:t,className:s})),ref:o,...r})});mt.displayName="Button";function gu(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}var zN=rr[" useInsertionEffect ".trim().toString()]||Yt;function YN({prop:s,defaultProp:e,onChange:t=()=>{},caller:n}){const[r,o,l]=qN({defaultProp:e,onChange:t}),u=s!==void 0,f=u?s:r;{const m=A.useRef(s!==void 0);A.useEffect(()=>{const g=m.current;g!==u&&console.warn(`${n} is changing from ${g?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=u},[u,n])}const d=A.useCallback(m=>{if(u){const g=XN(m)?m(s):m;g!==s&&l.current?.(g)}else o(m)},[u,s,o,l]);return[f,d]}function qN({defaultProp:s,onChange:e}){const[t,n]=A.useState(s),r=A.useRef(t),o=A.useRef(e);return zN(()=>{o.current=e},[e]),A.useEffect(()=>{r.current!==t&&(o.current?.(t),r.current=t)},[t,r]),[t,n,o]}function XN(s){return typeof s=="function"}function pt(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}function sE(s){const e=WN(s),t=A.forwardRef((n,r)=>{const{children:o,...l}=n,u=A.Children.toArray(o),f=u.find(ZN);if(f){const d=f.props.children,m=u.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}function WN(s){const e=A.forwardRef((t,n)=>{const{children:r,...o}=t;if(A.isValidElement(r)){const l=ek(r),u=JN(o,r.props);return r.type!==A.Fragment&&(u.ref=n?zs(n,l):l),A.cloneElement(r,u)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var QN=Symbol("radix.slottable");function ZN(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===QN}function JN(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function ek(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}function Ag(s){const e=s+"CollectionProvider",[t,n]=hs(e),[r,o]=t(e,{collectionRef:{current:null},itemMap:new Map}),l=S=>{const{scope:b,children:R}=S,w=Vt.useRef(null),_=Vt.useRef(new Map).current;return T.jsx(r,{scope:b,itemMap:_,collectionRef:w,children:R})};l.displayName=e;const u=s+"CollectionSlot",f=sE(u),d=Vt.forwardRef((S,b)=>{const{scope:R,children:w}=S,_=o(u,R),D=He(b,_.collectionRef);return T.jsx(f,{ref:D,children:w})});d.displayName=u;const m=s+"CollectionItemSlot",g="data-radix-collection-item",y=sE(m),x=Vt.forwardRef((S,b)=>{const{scope:R,children:w,..._}=S,D=Vt.useRef(null),M=He(b,D),$=o(m,R);return Vt.useEffect(()=>($.itemMap.set(D,{ref:D,..._}),()=>void $.itemMap.delete(D))),T.jsx(y,{[g]:"",ref:M,children:w})});x.displayName=m;function E(S){const b=o(s+"CollectionConsumer",S);return Vt.useCallback(()=>{const w=b.collectionRef.current;if(!w)return[];const _=Array.from(w.querySelectorAll(`[${g}]`));return Array.from(b.itemMap.values()).sort(($,O)=>_.indexOf($.ref.current)-_.indexOf(O.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:l,Slot:d,ItemSlot:x},E,n]}var tk=A.createContext(void 0);function Rg(s){const e=A.useContext(tk);return s||e||"ltr"}var Dh=0;function Fb(){A.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??iE()),document.body.insertAdjacentElement("beforeend",s[1]??iE()),Dh++,()=>{Dh===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Dh--}},[])}function iE(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var Ih="focusScope.autoFocusOnMount",Oh="focusScope.autoFocusOnUnmount",rE={bubbles:!1,cancelable:!0},nk="FocusScope",Lg=A.forwardRef((s,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:r,onUnmountAutoFocus:o,...l}=s,[u,f]=A.useState(null),d=Bt(r),m=Bt(o),g=A.useRef(null),y=He(e,S=>f(S)),x=A.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;A.useEffect(()=>{if(n){let S=function(_){if(x.paused||!u)return;const D=_.target;u.contains(D)?g.current=D:Ti(g.current,{select:!0})},b=function(_){if(x.paused||!u)return;const D=_.relatedTarget;D!==null&&(u.contains(D)||Ti(g.current,{select:!0}))},R=function(_){if(document.activeElement===document.body)for(const M of _)M.removedNodes.length>0&&Ti(u)};document.addEventListener("focusin",S),document.addEventListener("focusout",b);const w=new MutationObserver(R);return u&&w.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",b),w.disconnect()}}},[n,u,x.paused]),A.useEffect(()=>{if(u){oE.add(x);const S=document.activeElement;if(!u.contains(S)){const R=new CustomEvent(Ih,rE);u.addEventListener(Ih,d),u.dispatchEvent(R),R.defaultPrevented||(sk(lk(Ub(u)),{select:!0}),document.activeElement===S&&Ti(u))}return()=>{u.removeEventListener(Ih,d),setTimeout(()=>{const R=new CustomEvent(Oh,rE);u.addEventListener(Oh,m),u.dispatchEvent(R),R.defaultPrevented||Ti(S??document.body,{select:!0}),u.removeEventListener(Oh,m),oE.remove(x)},0)}}},[u,d,m,x]);const E=A.useCallback(S=>{if(!t&&!n||x.paused)return;const b=S.key==="Tab"&&!S.altKey&&!S.ctrlKey&&!S.metaKey,R=document.activeElement;if(b&&R){const w=S.currentTarget,[_,D]=ik(w);_&&D?!S.shiftKey&&R===D?(S.preventDefault(),t&&Ti(_,{select:!0})):S.shiftKey&&R===_&&(S.preventDefault(),t&&Ti(D,{select:!0})):R===w&&S.preventDefault()}},[t,n,x.paused]);return T.jsx(nt.div,{tabIndex:-1,...l,ref:y,onKeyDown:E})});Lg.displayName=nk;function sk(s,{select:e=!1}={}){const t=document.activeElement;for(const n of s)if(Ti(n,{select:e}),document.activeElement!==t)return}function ik(s){const e=Ub(s),t=aE(e,s),n=aE(e.reverse(),s);return[t,n]}function Ub(s){const e=[],t=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const r=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||r?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function aE(s,e){for(const t of s)if(!rk(t,{upTo:e}))return t}function rk(s,{upTo:e}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(e!==void 0&&s===e)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function ak(s){return s instanceof HTMLInputElement&&"select"in s}function Ti(s,{select:e=!1}={}){if(s&&s.focus){const t=document.activeElement;s.focus({preventScroll:!0}),s!==t&&ak(s)&&e&&s.select()}}var oE=ok();function ok(){let s=[];return{add(e){const t=s[0];e!==t&&t?.pause(),s=lE(s,e),s.unshift(e)},remove(e){s=lE(s,e),s[0]?.resume()}}}function lE(s,e){const t=[...s],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function lk(s){return s.filter(e=>e.tagName!=="A")}function ua(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}var ck=rr[" useInsertionEffect ".trim().toString()]||Yt;function uk({prop:s,defaultProp:e,onChange:t=()=>{},caller:n}){const[r,o,l]=dk({defaultProp:e,onChange:t}),u=s!==void 0,f=u?s:r;{const m=A.useRef(s!==void 0);A.useEffect(()=>{const g=m.current;g!==u&&console.warn(`${n} is changing from ${g?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=u},[u,n])}const d=A.useCallback(m=>{if(u){const g=fk(m)?m(s):m;g!==s&&l.current?.(g)}else o(m)},[u,s,o,l]);return[f,d]}function dk({defaultProp:s,onChange:e}){const[t,n]=A.useState(s),r=A.useRef(t),o=A.useRef(e);return ck(()=>{o.current=e},[e]),A.useEffect(()=>{r.current!==t&&(o.current?.(t),r.current=t)},[t,r]),[t,n,o]}function fk(s){return typeof s=="function"}var Mh="rovingFocusGroup.onEntryFocus",hk={bubbles:!1,cancelable:!0},el="RovingFocusGroup",[Am,Bb,mk]=Ag(el),[gk,$b]=hs(el,[mk]),[pk,yk]=gk(el),jb=A.forwardRef((s,e)=>T.jsx(Am.Provider,{scope:s.__scopeRovingFocusGroup,children:T.jsx(Am.Slot,{scope:s.__scopeRovingFocusGroup,children:T.jsx(vk,{...s,ref:e})})}));jb.displayName=el;var vk=A.forwardRef((s,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:r=!1,dir:o,currentTabStopId:l,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:f,onEntryFocus:d,preventScrollOnEntryFocus:m=!1,...g}=s,y=A.useRef(null),x=He(e,y),E=Rg(o),[S,b]=uk({prop:l,defaultProp:u??null,onChange:f,caller:el}),[R,w]=A.useState(!1),_=Bt(d),D=Bb(t),M=A.useRef(!1),[$,O]=A.useState(0);return A.useEffect(()=>{const k=y.current;if(k)return k.addEventListener(Mh,_),()=>k.removeEventListener(Mh,_)},[_]),T.jsx(pk,{scope:t,orientation:n,dir:E,loop:r,currentTabStopId:S,onItemFocus:A.useCallback(k=>b(k),[b]),onItemShiftTab:A.useCallback(()=>w(!0),[]),onFocusableItemAdd:A.useCallback(()=>O(k=>k+1),[]),onFocusableItemRemove:A.useCallback(()=>O(k=>k-1),[]),children:T.jsx(nt.div,{tabIndex:R||$===0?-1:0,"data-orientation":n,...g,ref:x,style:{outline:"none",...s.style},onMouseDown:ua(s.onMouseDown,()=>{M.current=!0}),onFocus:ua(s.onFocus,k=>{const G=!M.current;if(k.target===k.currentTarget&&G&&!R){const B=new CustomEvent(Mh,hk);if(k.currentTarget.dispatchEvent(B),!B.defaultPrevented){const K=D().filter(P=>P.focusable),ne=K.find(P=>P.active),ue=K.find(P=>P.id===S),ae=[ne,ue,...K].filter(Boolean).map(P=>P.ref.current);Vb(ae,m)}}M.current=!1}),onBlur:ua(s.onBlur,()=>w(!1))})})}),Gb="RovingFocusGroupItem",Hb=A.forwardRef((s,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:r=!1,tabStopId:o,children:l,...u}=s,f=la(),d=o||f,m=yk(Gb,t),g=m.currentTabStopId===d,y=Bb(t),{onFocusableItemAdd:x,onFocusableItemRemove:E,currentTabStopId:S}=m;return A.useEffect(()=>{if(n)return x(),()=>E()},[n,x,E]),T.jsx(Am.ItemSlot,{scope:t,id:d,focusable:n,active:r,children:T.jsx(nt.span,{tabIndex:g?0:-1,"data-orientation":m.orientation,...u,ref:e,onMouseDown:ua(s.onMouseDown,b=>{n?m.onItemFocus(d):b.preventDefault()}),onFocus:ua(s.onFocus,()=>m.onItemFocus(d)),onKeyDown:ua(s.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){m.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const R=Sk(b,m.orientation,m.dir);if(R!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let _=y().filter(D=>D.focusable).map(D=>D.ref.current);if(R==="last")_.reverse();else if(R==="prev"||R==="next"){R==="prev"&&_.reverse();const D=_.indexOf(b.currentTarget);_=m.loop?Tk(_,D+1):_.slice(D+1)}setTimeout(()=>Vb(_))}}),children:typeof l=="function"?l({isCurrentTabStop:g,hasTabStop:S!=null}):l})})});Hb.displayName=Gb;var xk={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Ek(s,e){return e!=="rtl"?s:s==="ArrowLeft"?"ArrowRight":s==="ArrowRight"?"ArrowLeft":s}function Sk(s,e,t){const n=Ek(s.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return xk[n]}function Vb(s,e=!1){const t=document.activeElement;for(const n of s)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function Tk(s,e){return s.map((t,n)=>s[(e+n)%s.length])}var bk=jb,Ak=Hb;function Rk(s){const e=Lk(s),t=A.forwardRef((n,r)=>{const{children:o,...l}=n,u=A.Children.toArray(o),f=u.find(_k);if(f){const d=f.props.children,m=u.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}function Lk(s){const e=A.forwardRef((t,n)=>{const{children:r,...o}=t;if(A.isValidElement(r)){const l=Dk(r),u=wk(o,r.props);return r.type!==A.Fragment&&(u.ref=n?zs(n,l):l),A.cloneElement(r,u)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var Ck=Symbol("radix.slottable");function _k(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Ck}function wk(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function Dk(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var Ik=function(s){if(typeof document>"u")return null;var e=Array.isArray(s)?s[0]:s;return e.ownerDocument.body},Xr=new WeakMap,Dc=new WeakMap,Ic={},Nh=0,Kb=function(s){return s&&(s.host||Kb(s.parentNode))},Ok=function(s,e){return e.map(function(t){if(s.contains(t))return t;var n=Kb(t);return n&&s.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",s,". Doing nothing"),null)}).filter(function(t){return!!t})},Mk=function(s,e,t,n){var r=Ok(e,Array.isArray(s)?s:[s]);Ic[t]||(Ic[t]=new WeakMap);var o=Ic[t],l=[],u=new Set,f=new Set(r),d=function(g){!g||u.has(g)||(u.add(g),d(g.parentNode))};r.forEach(d);var m=function(g){!g||f.has(g)||Array.prototype.forEach.call(g.children,function(y){if(u.has(y))m(y);else try{var x=y.getAttribute(n),E=x!==null&&x!=="false",S=(Xr.get(y)||0)+1,b=(o.get(y)||0)+1;Xr.set(y,S),o.set(y,b),l.push(y),S===1&&E&&Dc.set(y,!0),b===1&&y.setAttribute(t,"true"),E||y.setAttribute(n,"true")}catch(R){console.error("aria-hidden: cannot operate on ",y,R)}})};return m(e),u.clear(),Nh++,function(){l.forEach(function(g){var y=Xr.get(g)-1,x=o.get(g)-1;Xr.set(g,y),o.set(g,x),y||(Dc.has(g)||g.removeAttribute(n),Dc.delete(g)),x||g.removeAttribute(t)}),Nh--,Nh||(Xr=new WeakMap,Xr=new WeakMap,Dc=new WeakMap,Ic={})}},zb=function(s,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(s)?s:[s]),r=Ik(s);return r?(n.push.apply(n,Array.from(r.querySelectorAll("[aria-live]"))),Mk(n,r,t,"aria-hidden")):function(){return null}},rs=function(){return rs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},rs.apply(this,arguments)};function Yb(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(s);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(s,n[r])&&(t[n[r]]=s[n[r]]);return t}function Nk(s,e,t){if(t||arguments.length===2)for(var n=0,r=e.length,o;n<r;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return s.concat(o||Array.prototype.slice.call(e))}var Jc="right-scroll-bar-position",eu="width-before-scroll-bar",kk="with-scroll-bars-hidden",Pk="--removed-body-scroll-bar-size";function kh(s,e){return typeof s=="function"?s(e):s&&(s.current=e),s}function Fk(s,e){var t=A.useState(function(){return{value:s,callback:e,facade:{get current(){return t.value},set current(n){var r=t.value;r!==n&&(t.value=n,t.callback(n,r))}}}})[0];return t.callback=e,t.facade}var Uk=typeof window<"u"?A.useLayoutEffect:A.useEffect,cE=new WeakMap;function Bk(s,e){var t=Fk(null,function(n){return s.forEach(function(r){return kh(r,n)})});return Uk(function(){var n=cE.get(t);if(n){var r=new Set(n),o=new Set(s),l=t.current;r.forEach(function(u){o.has(u)||kh(u,null)}),o.forEach(function(u){r.has(u)||kh(u,l)})}cE.set(t,s)},[s]),t}function $k(s){return s}function jk(s,e){e===void 0&&(e=$k);var t=[],n=!1,r={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:s},useMedium:function(o){var l=e(o,n);return t.push(l),function(){t=t.filter(function(u){return u!==l})}},assignSyncMedium:function(o){for(n=!0;t.length;){var l=t;t=[],l.forEach(o)}t={push:function(u){return o(u)},filter:function(){return t}}},assignMedium:function(o){n=!0;var l=[];if(t.length){var u=t;t=[],u.forEach(o),l=t}var f=function(){var m=l;l=[],m.forEach(o)},d=function(){return Promise.resolve().then(f)};d(),t={push:function(m){l.push(m),d()},filter:function(m){return l=l.filter(m),t}}}};return r}function Gk(s){s===void 0&&(s={});var e=jk(null);return e.options=rs({async:!0,ssr:!1},s),e}var qb=function(s){var e=s.sideCar,t=Yb(s,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return A.createElement(n,rs({},t))};qb.isSideCarExport=!0;function Hk(s,e){return s.useMedium(e),qb}var Xb=Gk(),Ph=function(){},Ku=A.forwardRef(function(s,e){var t=A.useRef(null),n=A.useState({onScrollCapture:Ph,onWheelCapture:Ph,onTouchMoveCapture:Ph}),r=n[0],o=n[1],l=s.forwardProps,u=s.children,f=s.className,d=s.removeScrollBar,m=s.enabled,g=s.shards,y=s.sideCar,x=s.noIsolation,E=s.inert,S=s.allowPinchZoom,b=s.as,R=b===void 0?"div":b,w=s.gapMode,_=Yb(s,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),D=y,M=Bk([t,e]),$=rs(rs({},_),r);return A.createElement(A.Fragment,null,m&&A.createElement(D,{sideCar:Xb,removeScrollBar:d,shards:g,noIsolation:x,inert:E,setCallbacks:o,allowPinchZoom:!!S,lockRef:t,gapMode:w}),l?A.cloneElement(A.Children.only(u),rs(rs({},$),{ref:M})):A.createElement(R,rs({},$,{className:f,ref:M}),u))});Ku.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ku.classNames={fullWidth:eu,zeroRight:Jc};var Vk=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Kk(){if(!document)return null;var s=document.createElement("style");s.type="text/css";var e=Vk();return e&&s.setAttribute("nonce",e),s}function zk(s,e){s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}function Yk(s){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(s)}var qk=function(){var s=0,e=null;return{add:function(t){s==0&&(e=Kk())&&(zk(e,t),Yk(e)),s++},remove:function(){s--,!s&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Xk=function(){var s=qk();return function(e,t){A.useEffect(function(){return s.add(e),function(){s.remove()}},[e&&t])}},Wb=function(){var s=Xk(),e=function(t){var n=t.styles,r=t.dynamic;return s(n,r),null};return e},Wk={left:0,top:0,right:0,gap:0},Fh=function(s){return parseInt(s||"",10)||0},Qk=function(s){var e=window.getComputedStyle(document.body),t=e[s==="padding"?"paddingLeft":"marginLeft"],n=e[s==="padding"?"paddingTop":"marginTop"],r=e[s==="padding"?"paddingRight":"marginRight"];return[Fh(t),Fh(n),Fh(r)]},Zk=function(s){if(s===void 0&&(s="margin"),typeof window>"u")return Wk;var e=Qk(s),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},Jk=Wb(),da="data-scroll-locked",eP=function(s,e,t,n){var r=s.left,o=s.top,l=s.right,u=s.gap;return t===void 0&&(t="margin"),`
  .`.concat(kk,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(u,"px ").concat(n,`;
  }
  body[`).concat(da,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(u,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Jc,` {
    right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(eu,` {
    margin-right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(Jc," .").concat(Jc,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(eu," .").concat(eu,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(da,`] {
    `).concat(Pk,": ").concat(u,`px;
  }
`)},uE=function(){var s=parseInt(document.body.getAttribute(da)||"0",10);return isFinite(s)?s:0},tP=function(){A.useEffect(function(){return document.body.setAttribute(da,(uE()+1).toString()),function(){var s=uE()-1;s<=0?document.body.removeAttribute(da):document.body.setAttribute(da,s.toString())}},[])},nP=function(s){var e=s.noRelative,t=s.noImportant,n=s.gapMode,r=n===void 0?"margin":n;tP();var o=A.useMemo(function(){return Zk(r)},[r]);return A.createElement(Jk,{styles:eP(o,!e,r,t?"":"!important")})},Rm=!1;if(typeof window<"u")try{var Oc=Object.defineProperty({},"passive",{get:function(){return Rm=!0,!0}});window.addEventListener("test",Oc,Oc),window.removeEventListener("test",Oc,Oc)}catch{Rm=!1}var Wr=Rm?{passive:!1}:!1,sP=function(s){return s.tagName==="TEXTAREA"},Qb=function(s,e){if(!(s instanceof Element))return!1;var t=window.getComputedStyle(s);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!sP(s)&&t[e]==="visible")},iP=function(s){return Qb(s,"overflowY")},rP=function(s){return Qb(s,"overflowX")},dE=function(s,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=Zb(s,n);if(r){var o=Jb(s,n),l=o[1],u=o[2];if(l>u)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},aP=function(s){var e=s.scrollTop,t=s.scrollHeight,n=s.clientHeight;return[e,t,n]},oP=function(s){var e=s.scrollLeft,t=s.scrollWidth,n=s.clientWidth;return[e,t,n]},Zb=function(s,e){return s==="v"?iP(e):rP(e)},Jb=function(s,e){return s==="v"?aP(e):oP(e)},lP=function(s,e){return s==="h"&&e==="rtl"?-1:1},cP=function(s,e,t,n,r){var o=lP(s,window.getComputedStyle(e).direction),l=o*n,u=t.target,f=e.contains(u),d=!1,m=l>0,g=0,y=0;do{var x=Jb(s,u),E=x[0],S=x[1],b=x[2],R=S-b-o*E;(E||R)&&Zb(s,u)&&(g+=R,y+=E),u instanceof ShadowRoot?u=u.host:u=u.parentNode}while(!f&&u!==document.body||f&&(e.contains(u)||e===u));return(m&&Math.abs(g)<1||!m&&Math.abs(y)<1)&&(d=!0),d},Mc=function(s){return"changedTouches"in s?[s.changedTouches[0].clientX,s.changedTouches[0].clientY]:[0,0]},fE=function(s){return[s.deltaX,s.deltaY]},hE=function(s){return s&&"current"in s?s.current:s},uP=function(s,e){return s[0]===e[0]&&s[1]===e[1]},dP=function(s){return`
  .block-interactivity-`.concat(s,` {pointer-events: none;}
  .allow-interactivity-`).concat(s,` {pointer-events: all;}
`)},fP=0,Qr=[];function hP(s){var e=A.useRef([]),t=A.useRef([0,0]),n=A.useRef(),r=A.useState(fP++)[0],o=A.useState(Wb)[0],l=A.useRef(s);A.useEffect(function(){l.current=s},[s]),A.useEffect(function(){if(s.inert){document.body.classList.add("block-interactivity-".concat(r));var S=Nk([s.lockRef.current],(s.shards||[]).map(hE),!0).filter(Boolean);return S.forEach(function(b){return b.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),S.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(r))})}}},[s.inert,s.lockRef.current,s.shards]);var u=A.useCallback(function(S,b){if("touches"in S&&S.touches.length===2||S.type==="wheel"&&S.ctrlKey)return!l.current.allowPinchZoom;var R=Mc(S),w=t.current,_="deltaX"in S?S.deltaX:w[0]-R[0],D="deltaY"in S?S.deltaY:w[1]-R[1],M,$=S.target,O=Math.abs(_)>Math.abs(D)?"h":"v";if("touches"in S&&O==="h"&&$.type==="range")return!1;var k=dE(O,$);if(!k)return!0;if(k?M=O:(M=O==="v"?"h":"v",k=dE(O,$)),!k)return!1;if(!n.current&&"changedTouches"in S&&(_||D)&&(n.current=M),!M)return!0;var G=n.current||M;return cP(G,b,S,G==="h"?_:D)},[]),f=A.useCallback(function(S){var b=S;if(!(!Qr.length||Qr[Qr.length-1]!==o)){var R="deltaY"in b?fE(b):Mc(b),w=e.current.filter(function(M){return M.name===b.type&&(M.target===b.target||b.target===M.shadowParent)&&uP(M.delta,R)})[0];if(w&&w.should){b.cancelable&&b.preventDefault();return}if(!w){var _=(l.current.shards||[]).map(hE).filter(Boolean).filter(function(M){return M.contains(b.target)}),D=_.length>0?u(b,_[0]):!l.current.noIsolation;D&&b.cancelable&&b.preventDefault()}}},[]),d=A.useCallback(function(S,b,R,w){var _={name:S,delta:b,target:R,should:w,shadowParent:mP(R)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(D){return D!==_})},1)},[]),m=A.useCallback(function(S){t.current=Mc(S),n.current=void 0},[]),g=A.useCallback(function(S){d(S.type,fE(S),S.target,u(S,s.lockRef.current))},[]),y=A.useCallback(function(S){d(S.type,Mc(S),S.target,u(S,s.lockRef.current))},[]);A.useEffect(function(){return Qr.push(o),s.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:y}),document.addEventListener("wheel",f,Wr),document.addEventListener("touchmove",f,Wr),document.addEventListener("touchstart",m,Wr),function(){Qr=Qr.filter(function(S){return S!==o}),document.removeEventListener("wheel",f,Wr),document.removeEventListener("touchmove",f,Wr),document.removeEventListener("touchstart",m,Wr)}},[]);var x=s.removeScrollBar,E=s.inert;return A.createElement(A.Fragment,null,E?A.createElement(o,{styles:dP(r)}):null,x?A.createElement(nP,{gapMode:s.gapMode}):null)}function mP(s){for(var e=null;s!==null;)s instanceof ShadowRoot&&(e=s.host,s=s.host),s=s.parentNode;return e}const gP=Hk(Xb,hP);var Cg=A.forwardRef(function(s,e){return A.createElement(Ku,rs({},s,{ref:e,sideCar:gP}))});Cg.classNames=Ku.classNames;var Lm=["Enter"," "],pP=["ArrowDown","PageUp","Home"],eA=["ArrowUp","PageDown","End"],yP=[...pP,...eA],vP={ltr:[...Lm,"ArrowRight"],rtl:[...Lm,"ArrowLeft"]},xP={ltr:["ArrowLeft"],rtl:["ArrowRight"]},tl="Menu",[jo,EP,SP]=Ag(tl),[ar,tA]=hs(tl,[SP,Gu,$b]),zu=Gu(),nA=$b(),[TP,or]=ar(tl),[bP,nl]=ar(tl),sA=s=>{const{__scopeMenu:e,open:t=!1,children:n,dir:r,onOpenChange:o,modal:l=!0}=s,u=zu(e),[f,d]=A.useState(null),m=A.useRef(!1),g=Bt(o),y=Rg(r);return A.useEffect(()=>{const x=()=>{m.current=!0,document.addEventListener("pointerdown",E,{capture:!0,once:!0}),document.addEventListener("pointermove",E,{capture:!0,once:!0})},E=()=>m.current=!1;return document.addEventListener("keydown",x,{capture:!0}),()=>{document.removeEventListener("keydown",x,{capture:!0}),document.removeEventListener("pointerdown",E,{capture:!0}),document.removeEventListener("pointermove",E,{capture:!0})}},[]),T.jsx(iN,{...u,children:T.jsx(TP,{scope:e,open:t,onOpenChange:g,content:f,onContentChange:d,children:T.jsx(bP,{scope:e,onClose:A.useCallback(()=>g(!1),[g]),isUsingKeyboardRef:m,dir:y,modal:l,children:n})})})};sA.displayName=tl;var AP="MenuAnchor",_g=A.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s,r=zu(t);return T.jsx(Sb,{...r,...n,ref:e})});_g.displayName=AP;var wg="MenuPortal",[RP,iA]=ar(wg,{forceMount:void 0}),rA=s=>{const{__scopeMenu:e,forceMount:t,children:n,container:r}=s,o=or(wg,e);return T.jsx(RP,{scope:e,forceMount:t,children:T.jsx(ps,{present:t||o.open,children:T.jsx(Hu,{asChild:!0,container:r,children:n})})})};rA.displayName=wg;var Nn="MenuContent",[LP,Dg]=ar(Nn),aA=A.forwardRef((s,e)=>{const t=iA(Nn,s.__scopeMenu),{forceMount:n=t.forceMount,...r}=s,o=or(Nn,s.__scopeMenu),l=nl(Nn,s.__scopeMenu);return T.jsx(jo.Provider,{scope:s.__scopeMenu,children:T.jsx(ps,{present:n||o.open,children:T.jsx(jo.Slot,{scope:s.__scopeMenu,children:l.modal?T.jsx(CP,{...r,ref:e}):T.jsx(_P,{...r,ref:e})})})})}),CP=A.forwardRef((s,e)=>{const t=or(Nn,s.__scopeMenu),n=A.useRef(null),r=He(e,n);return A.useEffect(()=>{const o=n.current;if(o)return zb(o)},[]),T.jsx(Ig,{...s,ref:r,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:pt(s.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),_P=A.forwardRef((s,e)=>{const t=or(Nn,s.__scopeMenu);return T.jsx(Ig,{...s,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),wP=Rk("MenuContent.ScrollLock"),Ig=A.forwardRef((s,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:l,disableOutsidePointerEvents:u,onEntryFocus:f,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:g,onInteractOutside:y,onDismiss:x,disableOutsideScroll:E,...S}=s,b=or(Nn,t),R=nl(Nn,t),w=zu(t),_=nA(t),D=EP(t),[M,$]=A.useState(null),O=A.useRef(null),k=He(e,O,b.onContentChange),G=A.useRef(0),B=A.useRef(""),K=A.useRef(0),ne=A.useRef(null),ue=A.useRef("right"),ee=A.useRef(0),ae=E?Cg:A.Fragment,P=E?{as:wP,allowPinchZoom:!0}:void 0,F=Y=>{const le=B.current+Y,N=D().filter(he=>!he.disabled),H=document.activeElement,J=N.find(he=>he.ref.current===H)?.textValue,se=N.map(he=>he.textValue),de=jP(se,le,J),fe=N.find(he=>he.textValue===de)?.ref.current;(function he(Le){B.current=Le,window.clearTimeout(G.current),Le!==""&&(G.current=window.setTimeout(()=>he(""),1e3))})(le),fe&&setTimeout(()=>fe.focus())};A.useEffect(()=>()=>window.clearTimeout(G.current),[]),Fb();const U=A.useCallback(Y=>ue.current===ne.current?.side&&HP(Y,ne.current?.area),[]);return T.jsx(LP,{scope:t,searchRef:B,onItemEnter:A.useCallback(Y=>{U(Y)&&Y.preventDefault()},[U]),onItemLeave:A.useCallback(Y=>{U(Y)||(O.current?.focus(),$(null))},[U]),onTriggerLeave:A.useCallback(Y=>{U(Y)&&Y.preventDefault()},[U]),pointerGraceTimerRef:K,onPointerGraceIntentChange:A.useCallback(Y=>{ne.current=Y},[]),children:T.jsx(ae,{...P,children:T.jsx(Lg,{asChild:!0,trapped:r,onMountAutoFocus:pt(o,Y=>{Y.preventDefault(),O.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:T.jsx(Fu,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:g,onInteractOutside:y,onDismiss:x,children:T.jsx(bk,{asChild:!0,..._,dir:R.dir,orientation:"vertical",loop:n,currentTabStopId:M,onCurrentTabStopIdChange:$,onEntryFocus:pt(f,Y=>{R.isUsingKeyboardRef.current||Y.preventDefault()}),preventScrollOnEntryFocus:!0,children:T.jsx(Tb,{role:"menu","aria-orientation":"vertical","data-state":TA(b.open),"data-radix-menu-content":"",dir:R.dir,...w,...S,ref:k,style:{outline:"none",...S.style},onKeyDown:pt(S.onKeyDown,Y=>{const N=Y.target.closest("[data-radix-menu-content]")===Y.currentTarget,H=Y.ctrlKey||Y.altKey||Y.metaKey,J=Y.key.length===1;N&&(Y.key==="Tab"&&Y.preventDefault(),!H&&J&&F(Y.key));const se=O.current;if(Y.target!==se||!yP.includes(Y.key))return;Y.preventDefault();const fe=D().filter(he=>!he.disabled).map(he=>he.ref.current);eA.includes(Y.key)&&fe.reverse(),BP(fe)}),onBlur:pt(s.onBlur,Y=>{Y.currentTarget.contains(Y.target)||(window.clearTimeout(G.current),B.current="")}),onPointerMove:pt(s.onPointerMove,Go(Y=>{const le=Y.target,N=ee.current!==Y.clientX;if(Y.currentTarget.contains(le)&&N){const H=Y.clientX>ee.current?"right":"left";ue.current=H,ee.current=Y.clientX}}))})})})})})})});aA.displayName=Nn;var DP="MenuGroup",Og=A.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s;return T.jsx(nt.div,{role:"group",...n,ref:e})});Og.displayName=DP;var IP="MenuLabel",oA=A.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s;return T.jsx(nt.div,{...n,ref:e})});oA.displayName=IP;var pu="MenuItem",mE="menu.itemSelect",Yu=A.forwardRef((s,e)=>{const{disabled:t=!1,onSelect:n,...r}=s,o=A.useRef(null),l=nl(pu,s.__scopeMenu),u=Dg(pu,s.__scopeMenu),f=He(e,o),d=A.useRef(!1),m=()=>{const g=o.current;if(!t&&g){const y=new CustomEvent(mE,{bubbles:!0,cancelable:!0});g.addEventListener(mE,x=>n?.(x),{once:!0}),WT(g,y),y.defaultPrevented?d.current=!1:l.onClose()}};return T.jsx(lA,{...r,ref:f,disabled:t,onClick:pt(s.onClick,m),onPointerDown:g=>{s.onPointerDown?.(g),d.current=!0},onPointerUp:pt(s.onPointerUp,g=>{d.current||g.currentTarget?.click()}),onKeyDown:pt(s.onKeyDown,g=>{const y=u.searchRef.current!=="";t||y&&g.key===" "||Lm.includes(g.key)&&(g.currentTarget.click(),g.preventDefault())})})});Yu.displayName=pu;var lA=A.forwardRef((s,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:r,...o}=s,l=Dg(pu,t),u=nA(t),f=A.useRef(null),d=He(e,f),[m,g]=A.useState(!1),[y,x]=A.useState("");return A.useEffect(()=>{const E=f.current;E&&x((E.textContent??"").trim())},[o.children]),T.jsx(jo.ItemSlot,{scope:t,disabled:n,textValue:r??y,children:T.jsx(Ak,{asChild:!0,...u,focusable:!n,children:T.jsx(nt.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...o,ref:d,onPointerMove:pt(s.onPointerMove,Go(E=>{n?l.onItemLeave(E):(l.onItemEnter(E),E.defaultPrevented||E.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:pt(s.onPointerLeave,Go(E=>l.onItemLeave(E))),onFocus:pt(s.onFocus,()=>g(!0)),onBlur:pt(s.onBlur,()=>g(!1))})})})}),OP="MenuCheckboxItem",cA=A.forwardRef((s,e)=>{const{checked:t=!1,onCheckedChange:n,...r}=s;return T.jsx(mA,{scope:s.__scopeMenu,checked:t,children:T.jsx(Yu,{role:"menuitemcheckbox","aria-checked":yu(t)?"mixed":t,...r,ref:e,"data-state":Ng(t),onSelect:pt(r.onSelect,()=>n?.(yu(t)?!0:!t),{checkForDefaultPrevented:!1})})})});cA.displayName=OP;var uA="MenuRadioGroup",[MP,NP]=ar(uA,{value:void 0,onValueChange:()=>{}}),dA=A.forwardRef((s,e)=>{const{value:t,onValueChange:n,...r}=s,o=Bt(n);return T.jsx(MP,{scope:s.__scopeMenu,value:t,onValueChange:o,children:T.jsx(Og,{...r,ref:e})})});dA.displayName=uA;var fA="MenuRadioItem",hA=A.forwardRef((s,e)=>{const{value:t,...n}=s,r=NP(fA,s.__scopeMenu),o=t===r.value;return T.jsx(mA,{scope:s.__scopeMenu,checked:o,children:T.jsx(Yu,{role:"menuitemradio","aria-checked":o,...n,ref:e,"data-state":Ng(o),onSelect:pt(n.onSelect,()=>r.onValueChange?.(t),{checkForDefaultPrevented:!1})})})});hA.displayName=fA;var Mg="MenuItemIndicator",[mA,kP]=ar(Mg,{checked:!1}),gA=A.forwardRef((s,e)=>{const{__scopeMenu:t,forceMount:n,...r}=s,o=kP(Mg,t);return T.jsx(ps,{present:n||yu(o.checked)||o.checked===!0,children:T.jsx(nt.span,{...r,ref:e,"data-state":Ng(o.checked)})})});gA.displayName=Mg;var PP="MenuSeparator",pA=A.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s;return T.jsx(nt.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});pA.displayName=PP;var FP="MenuArrow",yA=A.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s,r=zu(t);return T.jsx(bb,{...r,...n,ref:e})});yA.displayName=FP;var UP="MenuSub",[jj,vA]=ar(UP),wo="MenuSubTrigger",xA=A.forwardRef((s,e)=>{const t=or(wo,s.__scopeMenu),n=nl(wo,s.__scopeMenu),r=vA(wo,s.__scopeMenu),o=Dg(wo,s.__scopeMenu),l=A.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:f}=o,d={__scopeMenu:s.__scopeMenu},m=A.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return A.useEffect(()=>m,[m]),A.useEffect(()=>{const g=u.current;return()=>{window.clearTimeout(g),f(null)}},[u,f]),T.jsx(_g,{asChild:!0,...d,children:T.jsx(lA,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":r.contentId,"data-state":TA(t.open),...s,ref:zs(e,r.onTriggerChange),onClick:g=>{s.onClick?.(g),!(s.disabled||g.defaultPrevented)&&(g.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:pt(s.onPointerMove,Go(g=>{o.onItemEnter(g),!g.defaultPrevented&&!s.disabled&&!t.open&&!l.current&&(o.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{t.onOpenChange(!0),m()},100))})),onPointerLeave:pt(s.onPointerLeave,Go(g=>{m();const y=t.content?.getBoundingClientRect();if(y){const x=t.content?.dataset.side,E=x==="right",S=E?-5:5,b=y[E?"left":"right"],R=y[E?"right":"left"];o.onPointerGraceIntentChange({area:[{x:g.clientX+S,y:g.clientY},{x:b,y:y.top},{x:R,y:y.top},{x:R,y:y.bottom},{x:b,y:y.bottom}],side:x}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(g),g.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:pt(s.onKeyDown,g=>{const y=o.searchRef.current!=="";s.disabled||y&&g.key===" "||vP[n.dir].includes(g.key)&&(t.onOpenChange(!0),t.content?.focus(),g.preventDefault())})})})});xA.displayName=wo;var EA="MenuSubContent",SA=A.forwardRef((s,e)=>{const t=iA(Nn,s.__scopeMenu),{forceMount:n=t.forceMount,...r}=s,o=or(Nn,s.__scopeMenu),l=nl(Nn,s.__scopeMenu),u=vA(EA,s.__scopeMenu),f=A.useRef(null),d=He(e,f);return T.jsx(jo.Provider,{scope:s.__scopeMenu,children:T.jsx(ps,{present:n||o.open,children:T.jsx(jo.Slot,{scope:s.__scopeMenu,children:T.jsx(Ig,{id:u.contentId,"aria-labelledby":u.triggerId,...r,ref:d,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{l.isUsingKeyboardRef.current&&f.current?.focus(),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:pt(s.onFocusOutside,m=>{m.target!==u.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:pt(s.onEscapeKeyDown,m=>{l.onClose(),m.preventDefault()}),onKeyDown:pt(s.onKeyDown,m=>{const g=m.currentTarget.contains(m.target),y=xP[l.dir].includes(m.key);g&&y&&(o.onOpenChange(!1),u.trigger?.focus(),m.preventDefault())})})})})})});SA.displayName=EA;function TA(s){return s?"open":"closed"}function yu(s){return s==="indeterminate"}function Ng(s){return yu(s)?"indeterminate":s?"checked":"unchecked"}function BP(s){const e=document.activeElement;for(const t of s)if(t===e||(t.focus(),document.activeElement!==e))return}function $P(s,e){return s.map((t,n)=>s[(e+n)%s.length])}function jP(s,e,t){const r=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,o=t?s.indexOf(t):-1;let l=$P(s,Math.max(o,0));r.length===1&&(l=l.filter(d=>d!==t));const f=l.find(d=>d.toLowerCase().startsWith(r.toLowerCase()));return f!==t?f:void 0}function GP(s,e){const{x:t,y:n}=s;let r=!1;for(let o=0,l=e.length-1;o<e.length;l=o++){const u=e[o],f=e[l],d=u.x,m=u.y,g=f.x,y=f.y;m>n!=y>n&&t<(g-d)*(n-m)/(y-m)+d&&(r=!r)}return r}function HP(s,e){if(!e)return!1;const t={x:s.clientX,y:s.clientY};return GP(t,e)}function Go(s){return e=>e.pointerType==="mouse"?s(e):void 0}var VP=sA,KP=_g,zP=rA,YP=aA,qP=Og,XP=oA,WP=Yu,QP=cA,ZP=dA,JP=hA,e2=gA,t2=pA,n2=yA,s2=xA,i2=SA,qu="DropdownMenu",[r2]=hs(qu,[tA]),qt=tA(),[a2,bA]=r2(qu),AA=s=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:r,defaultOpen:o,onOpenChange:l,modal:u=!0}=s,f=qt(e),d=A.useRef(null),[m,g]=YN({prop:r,defaultProp:o??!1,onChange:l,caller:qu});return T.jsx(a2,{scope:e,triggerId:la(),triggerRef:d,contentId:la(),open:m,onOpenChange:g,onOpenToggle:A.useCallback(()=>g(y=>!y),[g]),modal:u,children:T.jsx(VP,{...f,open:m,onOpenChange:g,dir:n,modal:u,children:t})})};AA.displayName=qu;var RA="DropdownMenuTrigger",LA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...r}=s,o=bA(RA,t),l=qt(t);return T.jsx(KP,{asChild:!0,...l,children:T.jsx(nt.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...r,ref:zs(e,o.triggerRef),onPointerDown:gu(s.onPointerDown,u=>{!n&&u.button===0&&u.ctrlKey===!1&&(o.onOpenToggle(),o.open||u.preventDefault())}),onKeyDown:gu(s.onKeyDown,u=>{n||(["Enter"," "].includes(u.key)&&o.onOpenToggle(),u.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});LA.displayName=RA;var o2="DropdownMenuPortal",CA=s=>{const{__scopeDropdownMenu:e,...t}=s,n=qt(e);return T.jsx(zP,{...n,...t})};CA.displayName=o2;var _A="DropdownMenuContent",wA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=bA(_A,t),o=qt(t),l=A.useRef(!1);return T.jsx(YP,{id:r.contentId,"aria-labelledby":r.triggerId,...o,...n,ref:e,onCloseAutoFocus:gu(s.onCloseAutoFocus,u=>{l.current||r.triggerRef.current?.focus(),l.current=!1,u.preventDefault()}),onInteractOutside:gu(s.onInteractOutside,u=>{const f=u.detail.originalEvent,d=f.button===0&&f.ctrlKey===!0,m=f.button===2||d;(!r.modal||m)&&(l.current=!0)}),style:{...s.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});wA.displayName=_A;var l2="DropdownMenuGroup",c2=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(qP,{...r,...n,ref:e})});c2.displayName=l2;var u2="DropdownMenuLabel",DA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(XP,{...r,...n,ref:e})});DA.displayName=u2;var d2="DropdownMenuItem",IA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(WP,{...r,...n,ref:e})});IA.displayName=d2;var f2="DropdownMenuCheckboxItem",OA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(QP,{...r,...n,ref:e})});OA.displayName=f2;var h2="DropdownMenuRadioGroup",MA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(ZP,{...r,...n,ref:e})});MA.displayName=h2;var m2="DropdownMenuRadioItem",NA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(JP,{...r,...n,ref:e})});NA.displayName=m2;var g2="DropdownMenuItemIndicator",kA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(e2,{...r,...n,ref:e})});kA.displayName=g2;var p2="DropdownMenuSeparator",PA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(t2,{...r,...n,ref:e})});PA.displayName=p2;var y2="DropdownMenuArrow",v2=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(n2,{...r,...n,ref:e})});v2.displayName=y2;var x2="DropdownMenuSubTrigger",FA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(s2,{...r,...n,ref:e})});FA.displayName=x2;var E2="DropdownMenuSubContent",UA=A.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,r=qt(t);return T.jsx(i2,{...r,...n,ref:e,style:{...s.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});UA.displayName=E2;var S2=AA,T2=LA,b2=CA,BA=wA,$A=DA,jA=IA,GA=OA,A2=MA,HA=NA,VA=kA,KA=PA,zA=FA,YA=UA;const qA=S2,XA=T2,R2=A2,L2=A.forwardRef(({className:s,inset:e,children:t,...n},r)=>T.jsxs(zA,{ref:r,className:De("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",s),...n,children:[t,T.jsx(YD,{className:"ml-auto"})]}));L2.displayName=zA.displayName;const C2=A.forwardRef(({className:s,...e},t)=>T.jsx(YA,{ref:t,className:De("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",s),...e}));C2.displayName=YA.displayName;const kg=A.forwardRef(({className:s,sideOffset:e=4,container:t,...n},r)=>T.jsx(b2,{container:t,children:T.jsx(BA,{ref:r,sideOffset:e,className:De("z-[9999] max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",s),...n})}));kg.displayName=BA.displayName;const sa=A.forwardRef(({className:s,inset:e,...t},n)=>T.jsx(jA,{ref:n,className:De("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",e&&"pl-8",s),...t}));sa.displayName=jA.displayName;const _2=A.forwardRef(({className:s,children:e,checked:t,...n},r)=>T.jsxs(GA,{ref:r,className:De("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...n,children:[T.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:T.jsx(VA,{children:T.jsx(HD,{className:"h-4 w-4"})})}),e]}));_2.displayName=GA.displayName;const WA=A.forwardRef(({className:s,children:e,...t},n)=>T.jsxs(HA,{ref:n,className:De("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[T.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:T.jsx(VA,{children:T.jsx(nI,{className:"h-2 w-2 fill-current"})})}),e]}));WA.displayName=HA.displayName;const Pg=A.forwardRef(({className:s,inset:e,...t},n)=>T.jsx($A,{ref:n,className:De("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",s),...t}));Pg.displayName=$A.displayName;const fa=A.forwardRef(({className:s,...e},t)=>T.jsx(KA,{ref:t,className:De("-mx-1 my-1 h-px bg-muted",s),...e}));fa.displayName=KA.displayName;function gE(){const[s,e]=A.useState(!1),[t]=ig();A.useEffect(()=>{const r=()=>{window.scrollY>0?e(!0):e(!1)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]);const n=[{name:"Home",href:"/"},{name:"Series",href:"/series"},{name:"Movies",href:"/movies"},{name:"New & Popular",href:"/new"},{name:"My List",href:"/my-list"}];return T.jsxs("nav",{className:De("fixed top-0 w-full z-50 transition-colors duration-300 px-4 md:px-12 py-4 flex items-center justify-between",s?"bg-background/95 backdrop-blur-sm shadow-lg":"bg-gradient-to-b from-black/80 to-transparent"),children:[T.jsxs("div",{className:"flex items-center gap-8",children:[T.jsx(Hs,{href:"/",children:T.jsx("div",{className:"cursor-pointer",children:T.jsx("img",{src:PN,alt:"Nubinix",className:"h-10 object-contain"})})}),T.jsx("div",{className:"hidden md:flex items-center gap-6",children:n.map(r=>T.jsx(Hs,{href:r.href,children:T.jsx("div",{className:De("text-sm font-medium transition-colors hover:text-primary cursor-pointer",t===r.href?"text-white font-bold":"text-gray-300"),children:r.name})},r.name))})]}),T.jsxs("div",{className:"flex items-center gap-4",children:[T.jsx(mt,{variant:"ghost",size:"icon",className:"text-gray-300 hover:text-white",children:T.jsx(RI,{className:"w-5 h-5"})}),T.jsx(mt,{variant:"ghost",size:"icon",className:"text-gray-300 hover:text-white",children:T.jsx(jD,{className:"w-5 h-5"})}),T.jsxs(qA,{children:[T.jsx(XA,{asChild:!0,children:T.jsx(mt,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:T.jsx("div",{className:"h-8 w-8 rounded bg-gradient-brand flex items-center justify-center text-white font-bold",children:"N"})})}),T.jsxs(kg,{className:"w-56",align:"end",forceMount:!0,children:[T.jsx(Pg,{className:"font-normal",children:T.jsxs("div",{className:"flex flex-col space-y-1",children:[T.jsx("p",{className:"text-sm font-medium leading-none",children:"User"}),T.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:"user@example.com"})]})}),T.jsx(fa,{}),T.jsx(Hs,{href:"/admin",children:T.jsxs(sa,{className:"cursor-pointer",children:[T.jsx(IT,{className:"mr-2 h-4 w-4"}),T.jsx("span",{children:"Admin Panel"})]})}),T.jsx(fa,{}),T.jsx(sa,{children:"Account"}),T.jsx(sa,{children:"Settings"}),T.jsx(sa,{children:"Help Center"}),T.jsx(fa,{}),T.jsx(sa,{className:"text-red-500",children:"Log out"})]})]})]})]})}function w2({movie:s}){return T.jsxs("div",{className:"relative w-full h-[85vh] md:h-screen",children:[T.jsxs("div",{className:"absolute inset-0",children:[T.jsx("img",{src:s.heroImage,alt:s.title,className:"w-full h-full object-cover"}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black via-black/50 to-transparent"}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background via-transparent to-transparent"})]}),T.jsxs("div",{className:"relative z-10 flex flex-col justify-center h-full px-4 md:px-16 max-w-3xl space-y-6 pt-20",children:[T.jsxs("div",{className:"space-y-2",children:[T.jsxs("div",{className:"flex items-center gap-3 text-sm font-medium text-gray-300 mb-2",children:[T.jsx("span",{className:"px-2 py-1 border border-gray-500 rounded text-xs tracking-wider",children:"N SERIES"}),T.jsx("span",{className:"text-primary font-bold tracking-wider",children:"NEW EPISODES"})]}),T.jsx("h1",{className:"text-5xl md:text-7xl font-heading font-extrabold tracking-tight text-white leading-tight drop-shadow-lg",children:s.title})]}),T.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-300",children:[T.jsx("span",{className:"text-green-400 font-bold",children:"98% Match"}),T.jsx("span",{children:s.year}),T.jsx("span",{className:"border border-gray-500 px-1 text-xs rounded",children:s.rating}),T.jsx("span",{children:s.duration}),T.jsx("span",{className:"hidden md:inline px-2 py-0.5 border border-white/40 rounded text-[10px]",children:"HD"})]}),T.jsx("p",{className:"text-lg text-gray-200 line-clamp-3 drop-shadow-md max-w-xl",children:s.description}),T.jsxs("div",{className:"flex items-center gap-4 pt-4",children:[T.jsx(Hs,{href:`/watch/${s.id}`,children:T.jsxs(mt,{size:"lg",className:"bg-white text-black hover:bg-white/90 font-bold px-8 h-14 text-lg rounded-md transition-transform hover:scale-105",children:[T.jsx(ya,{className:"mr-2 h-6 w-6 fill-black"})," Play"]})}),T.jsxs(mt,{size:"lg",variant:"secondary",className:"bg-gray-600/70 text-white hover:bg-gray-600/50 font-bold px-8 h-14 text-lg rounded-md backdrop-blur-md transition-transform hover:scale-105",children:[T.jsx(cI,{className:"mr-2 h-6 w-6"})," More Info"]})]})]})]})}function Nc({title:s,movies:e,isLarge:t=!1}){return T.jsxs("div",{className:"py-8 px-4 md:px-12 space-y-4 group/row",children:[T.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-white transition-colors duration-300 hover:text-primary cursor-pointer flex items-center gap-2",children:[s,T.jsx("span",{className:"text-xs text-cyan-400 opacity-0 group-hover/row:opacity-100 transition-opacity duration-300",children:"Explore All >"})]}),T.jsx("div",{className:"relative group",children:T.jsx("div",{className:"flex overflow-x-auto gap-4 pb-8 pt-4 no-scrollbar snap-x snap-mandatory scroll-smooth",children:e.map(n=>T.jsxs("div",{className:De("relative shrink-0 transition-all duration-300 ease-in-out cursor-pointer hover:z-20 group/card snap-start",t?"w-[200px] md:w-[300px]":"w-[200px] md:w-[280px]"),children:[T.jsx(Hs,{href:`/watch/${n.id}`,children:T.jsxs("div",{className:De("relative rounded-md overflow-hidden aspect-video transition-transform duration-300 group-hover/card:scale-105 group-hover/card:shadow-2xl group-hover/card:ring-2 ring-white/50",t&&"aspect-[2/3]"),children:[T.jsx("img",{src:t?n.heroImage:n.thumbnail,alt:n.title,className:"w-full h-full object-cover"}),T.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/card:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:T.jsx("div",{className:"rounded-full bg-white/20 backdrop-blur p-3 ring-1 ring-white/50",children:T.jsx(ya,{className:"w-6 h-6 fill-white text-white"})})})]})}),T.jsxs("div",{className:"mt-2 opacity-0 group-hover/card:opacity-100 transition-opacity duration-300 absolute top-full left-0 right-0 bg-[#181818] p-4 rounded-b-md shadow-xl z-20 -mt-1 scale-105 hidden md:block",children:[T.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[T.jsx(Hs,{href:`/watch/${n.id}`,children:T.jsx("button",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center hover:bg-gray-200 transition-colors",children:T.jsx(ya,{className:"w-4 h-4 fill-black text-black"})})}),T.jsx("button",{className:"w-8 h-8 rounded-full border-2 border-gray-400 flex items-center justify-center hover:border-white hover:bg-white/10 text-gray-300 hover:text-white transition-colors",children:T.jsx(OT,{className:"w-4 h-4"})}),T.jsx("button",{className:"w-8 h-8 rounded-full border-2 border-gray-400 flex items-center justify-center hover:border-white hover:bg-white/10 text-gray-300 hover:text-white transition-colors",children:T.jsx(DI,{className:"w-4 h-4"})}),T.jsx("button",{className:"ml-auto w-8 h-8 rounded-full border-2 border-gray-400 flex items-center justify-center hover:border-white hover:bg-white/10 text-gray-300 hover:text-white transition-colors",children:T.jsx(KD,{className:"w-4 h-4"})})]}),T.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-400 mb-1",children:[T.jsx("span",{className:"text-green-400",children:"98% Match"}),T.jsx("span",{className:"border border-gray-500 px-1 rounded text-[10px]",children:n.rating}),T.jsx("span",{children:n.duration})]}),T.jsx("div",{className:"flex flex-wrap gap-1",children:n.genre.slice(0,3).map(r=>T.jsx("span",{className:"text-[10px] text-gray-300 flex items-center after:content-[''] after:ml-1 after:text-gray-600 last:after:content-none",children:r},r))})]})]},n.id))})})]})}function Lo(){const{movies:s,loading:e}=bg();if(e)return T.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:T.jsx("div",{className:"text-white text-xl",children:"Loading videos..."})});if(s.length===0)return T.jsxs("div",{className:"min-h-screen bg-background",children:[T.jsx(gE,{}),T.jsx("div",{className:"flex items-center justify-center h-96",children:T.jsxs("div",{className:"text-center text-gray-400",children:[T.jsx("h2",{className:"text-2xl font-bold mb-2",children:"No videos available"}),T.jsx("p",{children:"Upload some videos in the admin panel to get started!"})]})})]});const t=s[0],n=s.slice(1,6),r=s.filter(l=>l.genre.includes("Sci-Fi")),o=[...s].slice(0,8);return T.jsxs("div",{className:"min-h-screen bg-background text-foreground overflow-x-hidden",children:[T.jsx(gE,{}),T.jsxs("main",{className:"pb-20",children:[T.jsx(w2,{movie:t}),T.jsxs("div",{className:"-mt-32 relative z-20 space-y-4",children:[T.jsx(Nc,{title:"New Releases",movies:o,isLarge:!0}),T.jsx(Nc,{title:"Trending Now",movies:n}),T.jsx(Nc,{title:"Top Sci-Fi Picks",movies:r}),T.jsx(Nc,{title:"Watch It Again",movies:s})]})]}),T.jsxs("footer",{className:"py-12 px-12 text-gray-500 text-sm bg-black/50 mt-12",children:[T.jsxs("div",{className:"max-w-5xl mx-auto grid grid-cols-2 md:grid-cols-4 gap-8",children:[T.jsxs("div",{className:"space-y-3",children:[T.jsx("p",{children:"Audio Description"}),T.jsx("p",{children:"Investor Relations"}),T.jsx("p",{children:"Legal Notices"})]}),T.jsxs("div",{className:"space-y-3",children:[T.jsx("p",{children:"Help Center"}),T.jsx("p",{children:"Jobs"}),T.jsx("p",{children:"Cookie Preferences"})]}),T.jsxs("div",{className:"space-y-3",children:[T.jsx("p",{children:"Gift Cards"}),T.jsx("p",{children:"Terms of Use"}),T.jsx("p",{children:"Corporate Information"})]}),T.jsxs("div",{className:"space-y-3",children:[T.jsx("p",{children:"Media Center"}),T.jsx("p",{children:"Privacy"}),T.jsx("p",{children:"Contact Us"})]})]}),T.jsxs("div",{className:"max-w-5xl mx-auto mt-8",children:[T.jsx("button",{className:"border border-gray-500 px-4 py-2 hover:text-white hover:border-white transition-colors",children:"Service Code"}),T.jsx("p",{className:"mt-4 text-xs",children:" 2025 Nubinix Inc."})]})]})]})}const me=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},D2=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=I2},I2=Number.MAX_SAFE_INTEGER||9007199254740991;let Ee=(function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s})({}),X=(function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",s.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",s.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.ASSET_LIST_LOAD_ERROR="assetListLoadError",s.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",s.ASSET_LIST_PARSING_ERROR="assetListParsingError",s.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.ATTACH_MEDIA_ERROR="attachMediaError",s.UNKNOWN="unknown",s})({}),C=(function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.MEDIA_ENDED="hlsMediaEnded",s.STALL_RESOLVED="hlsStallResolved",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFERED_TO_END="hlsBufferedToEnd",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s.ASSET_LIST_LOADING="hlsAssetListLoading",s.ASSET_LIST_LOADED="hlsAssetListLoaded",s.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",s.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",s.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",s.INTERSTITIAL_STARTED="hlsInterstitialStarted",s.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",s.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",s.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",s.INTERSTITIAL_ENDED="hlsInterstitialEnded",s.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",s.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",s.EVENT_CUE_ENTER="hlsEventCueEnter",s})({});var Me={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ge={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Zr{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class O2{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Zr(e),this.fast_=new Zr(t),this.defaultTTFB_=r,this.ttfb_=new Zr(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:o}=this;n.halfLife!==e&&(this.slow_=new Zr(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new Zr(t,r.getEstimate(),r.getTotalWeight())),o.halfLife!==e&&(this.ttfb_=new Zr(e,o.getEstimate(),o.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,r=e/1e3,o=n/r;this.fast_.sample(r,o),this.slow_.sample(r,o)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function M2(s,e,t){return(e=k2(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Ze(){return Ze=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},Ze.apply(null,arguments)}function pE(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,n)}return t}function Ye(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?pE(Object(t),!0).forEach(function(n){M2(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):pE(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function N2(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function k2(s){var e=N2(s,"string");return typeof e=="symbol"?e:e+""}class Pn{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=bi,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const bi=function(){},P2={trace:bi,debug:bi,log:bi,warn:bi,info:bi,error:bi};function Cm(){return Ze({},P2)}function F2(s,e){const t=self.console[s];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${s}] >`):bi}function yE(s,e,t){return e[s]?e[s].bind(e):F2(s,t)}const _m=Cm();function U2(s,e,t){const n=Cm();if(typeof console=="object"&&s===!0||typeof s=="object"){const r=["debug","log","info","warn","error"];r.forEach(o=>{n[o]=yE(o,s,t)});try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return Cm()}r.forEach(o=>{_m[o]=yE(o,s)})}else Ze(_m,n);return n}const qe=_m;function Di(s=!0){return typeof self>"u"?void 0:(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function B2(s){return typeof self<"u"&&s===self.ManagedMediaSource}function QA(s,e){const t=Object.keys(s),n=Object.keys(e),r=t.length,o=n.length;return!r||!o||r===o&&!t.some(l=>n.indexOf(l)===-1)}function Tn(s,e=!1){if(typeof TextDecoder<"u"){const d=new TextDecoder("utf-8").decode(s);if(e){const m=d.indexOf("\0");return m!==-1?d.substring(0,m):d}return d.replace(/\0/g,"")}const t=s.length;let n,r,o,l="",u=0;for(;u<t;){if(n=s[u++],n===0&&e)return l;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(n);break;case 12:case 13:r=s[u++],l+=String.fromCharCode((n&31)<<6|r&63);break;case 14:r=s[u++],o=s[u++],l+=String.fromCharCode((n&15)<<12|(r&63)<<6|(o&63)<<0);break}}return l}function Ft(s){let e="";for(let t=0;t<s.length;t++){let n=s[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}function ZA(s){return Uint8Array.from(s.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function $2(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Uh={exports:{}},vE;function j2(){return vE||(vE=1,(function(s,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,o=/(?:\/|^)\.(?=\/)/g,l=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u={buildAbsoluteURL:function(f,d,m){if(m=m||{},f=f.trim(),d=d.trim(),!d){if(!m.alwaysNormalize)return f;var g=u.parseURL(f);if(!g)throw new Error("Error trying to parse base URL.");return g.path=u.normalizePath(g.path),u.buildURLFromParts(g)}var y=u.parseURL(d);if(!y)throw new Error("Error trying to parse relative URL.");if(y.scheme)return m.alwaysNormalize?(y.path=u.normalizePath(y.path),u.buildURLFromParts(y)):d;var x=u.parseURL(f);if(!x)throw new Error("Error trying to parse base URL.");if(!x.netLoc&&x.path&&x.path[0]!=="/"){var E=r.exec(x.path);x.netLoc=E[1],x.path=E[2]}x.netLoc&&!x.path&&(x.path="/");var S={scheme:x.scheme,netLoc:y.netLoc,path:null,params:y.params,query:y.query,fragment:y.fragment};if(!y.netLoc&&(S.netLoc=x.netLoc,y.path[0]!=="/"))if(!y.path)S.path=x.path,y.params||(S.params=x.params,y.query||(S.query=x.query));else{var b=x.path,R=b.substring(0,b.lastIndexOf("/")+1)+y.path;S.path=u.normalizePath(R)}return S.path===null&&(S.path=m.alwaysNormalize?u.normalizePath(y.path):y.path),u.buildURLFromParts(S)},parseURL:function(f){var d=n.exec(f);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(f){for(f=f.split("").reverse().join("").replace(o,"");f.length!==(f=f.replace(l,"")).length;);return f.split("").reverse().join("")},buildURLFromParts:function(f){return f.scheme+f.netLoc+f.path+f.params+f.query+f.fragment}};s.exports=u})()})(Uh)),Uh.exports}var Fg=j2();class Ug{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var et={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class JA{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,H2(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let r;n.length===1?r=t?.byteRangeEndOffset||0:r=parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[et.AUDIO]:null,[et.VIDEO]:null,[et.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Ug),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Fg.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[et.AUDIO]=null,e[et.VIDEO]=null,e[et.AUDIOVIDEO]=null}}function gt(s){return s.sn!=="initSegment"}class Bh extends JA{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(me(e)&&me(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const n=Object.keys(t);if(n.length===1){const r=this._decryptdata=t[n[0]]||null;r&&(this._decryptdata=r.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=me(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const n=Object.keys(this.levelkeys),r=n.length;if(r>1||r===1&&(t=this.levelkeys[n[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!me(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return gt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var n;const r=t[e];r&&!((n=this._decryptdata)!=null&&n.keyId)&&(this._decryptdata=r.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,r,o,l=!1){const{elementaryStreams:u}=this,f=u[e];if(!f){u[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:o,partial:l};return}f.startPTS=Math.min(f.startPTS,t),f.endPTS=Math.max(f.endPTS,n),f.startDTS=Math.min(f.startDTS,r),f.endDTS=Math.max(f.endDTS,o)}}class G2 extends JA{constructor(e,t,n,r,o){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const l=e.enumeratedString("BYTERANGE");l&&this.setByteRange(l,o),o&&(this.fragOffset=o.fragOffset+o.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function eR(s,e){const t=Object.getPrototypeOf(s);if(t){const n=Object.getOwnPropertyDescriptor(t,e);return n||eR(t,e)}}function H2(s,e){const t=eR(s,e);t&&(t.enumerable=!0,Object.defineProperty(s,e,t))}const xE=Math.pow(2,32)-1,V2=[].push,tR={video:1,audio:2,id3:3,text:4};function bt(s){return String.fromCharCode.apply(null,s)}function nR(s,e){const t=s[e]<<8|s[e+1];return t<0?65536+t:t}function be(s,e){const t=sR(s,e);return t<0?4294967296+t:t}function EE(s,e){let t=be(s,e);return t*=Math.pow(2,32),t+=be(s,e+4),t}function sR(s,e){return s[e]<<24|s[e+1]<<16|s[e+2]<<8|s[e+3]}function K2(s){const e=s.byteLength;for(let t=0;t<e;){const n=be(s,t);if(n>8&&s[t+4]===109&&s[t+5]===111&&s[t+6]===111&&s[t+7]===102)return!0;t=n>1?t+n:e}return!1}function Oe(s,e){const t=[];if(!e.length)return t;const n=s.byteLength;for(let r=0;r<n;){const o=be(s,r),l=bt(s.subarray(r+4,r+8)),u=o>1?r+o:n;if(l===e[0])if(e.length===1)t.push(s.subarray(r+8,u));else{const f=Oe(s.subarray(r+8,u),e.slice(1));f.length&&V2.apply(t,f)}r=u}return t}function z2(s){const e=[],t=s[0];let n=8;const r=be(s,n);n+=4;let o=0,l=0;t===0?(o=be(s,n),l=be(s,n+4),n+=8):(o=EE(s,n),l=EE(s,n+8),n+=16),n+=2;let u=s.length+l;const f=nR(s,n);n+=2;for(let d=0;d<f;d++){let m=n;const g=be(s,m);m+=4;const y=g&2147483647;if((g&2147483648)>>>31===1)return qe.warn("SIDX has hierarchical references (not supported)"),null;const E=be(s,m);m+=4,e.push({referenceSize:y,subsegmentDuration:E,info:{duration:E/r,start:u,end:u+y-1}}),u+=y,m+=4,n=m}return{earliestPresentationTime:o,timescale:r,version:t,referencesCount:f,references:e}}function iR(s){const e=[],t=Oe(s,["moov","trak"]);for(let r=0;r<t.length;r++){const o=t[r],l=Oe(o,["tkhd"])[0];if(l){let u=l[0];const f=be(l,u===0?12:20),d=Oe(o,["mdia","mdhd"])[0];if(d){u=d[0];const m=be(d,u===0?12:20),g=Oe(o,["mdia","hdlr"])[0];if(g){const y=bt(g.subarray(8,12)),x={soun:et.AUDIO,vide:et.VIDEO}[y],E=Oe(o,["mdia","minf","stbl","stsd"])[0],S=Y2(E);x?(e[f]={timescale:m,type:x,stsd:S},e[x]=Ye({timescale:m,id:f},S)):e[f]={timescale:m,type:y,stsd:S}}}}}return Oe(s,["moov","mvex","trex"]).forEach(r=>{const o=be(r,4),l=e[o];l&&(l.default={duration:be(r,12),flags:be(r,20)})}),e}function Y2(s){const e=s.subarray(8),t=e.subarray(86),n=bt(e.subarray(4,8));let r=n,o;const l=n==="enca"||n==="encv";if(l){const d=Oe(e,[n])[0].subarray(n==="enca"?28:78);Oe(d,["sinf"]).forEach(g=>{const y=Oe(g,["schm"])[0];if(y){const x=bt(y.subarray(4,8));if(x==="cbcs"||x==="cenc"){const E=Oe(g,["frma"])[0];E&&(r=bt(E))}}})}const u=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const f=Oe(t,["avcC"])[0];f&&f.length>3&&(r+="."+Pc(f[1])+Pc(f[2])+Pc(f[3]),o=kc(u==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const f=Oe(e,[n])[0],d=Oe(f.subarray(28),["esds"])[0];if(d&&d.length>7){let m=4;if(d[m++]!==3)break;m=$h(d,m),m+=2;const g=d[m++];if(g&128&&(m+=2),g&64&&(m+=d[m++]),d[m++]!==4)break;m=$h(d,m);const y=d[m++];if(y===64)r+="."+Pc(y);else break;if(m+=12,d[m++]!==5)break;m=$h(d,m);const x=d[m++];let E=(x&248)>>3;E===31&&(E+=1+((x&7)<<3)+((d[m]&224)>>5)),r+="."+E}break}case"hvc1":case"hev1":{const f=Oe(t,["hvcC"])[0];if(f&&f.length>12){const d=f[1],m=["","A","B","C"][d>>6],g=d&31,y=be(f,2),x=(d&32)>>5?"H":"L",E=f[12],S=f.subarray(6,12);r+="."+m+g,r+="."+q2(y).toString(16).toUpperCase(),r+="."+x+E;let b="";for(let R=S.length;R--;){const w=S[R];(w||b)&&(b="."+w.toString(16).toUpperCase()+b)}r+=b}o=kc(u=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{r=kc(r,t)||r;break}case"vp09":{const f=Oe(t,["vpcC"])[0];if(f&&f.length>6){const d=f[4],m=f[5],g=f[6]>>4&15;r+="."+ss(d)+"."+ss(m)+"."+ss(g)}break}case"av01":{const f=Oe(t,["av1C"])[0];if(f&&f.length>2){const d=f[1]>>>5,m=f[1]&31,g=f[2]>>>7?"H":"M",y=(f[2]&64)>>6,x=(f[2]&32)>>5,E=d===2&&y?x?12:10:y?10:8,S=(f[2]&16)>>4,b=(f[2]&8)>>3,R=(f[2]&4)>>2,w=f[2]&3;r+="."+d+"."+ss(m)+g+"."+ss(E)+"."+S+"."+b+R+w+"."+ss(1)+"."+ss(1)+"."+ss(1)+"."+0,o=kc("dav1",t)}break}}return{codec:r,encrypted:l,supplemental:o}}function kc(s,e){const t=Oe(e,["dvvC"]),n=t.length?t[0]:Oe(e,["dvcC"])[0];if(n){const r=n[2]>>1&127,o=n[2]<<5&32|n[3]>>3&31;return s+"."+ss(r)+"."+ss(o)}}function q2(s){let e=0;for(let t=0;t<32;t++)e|=(s>>t&1)<<31-t;return e>>>0}function $h(s,e){const t=e+5;for(;s[e++]&128&&e<t;);return e}function Pc(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function ss(s){return(s<10?"0":"")+s}function X2(s,e){if(!s||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&rR(s,(n,r)=>{const o=n.subarray(8,24);o.some(l=>l!==0)||(qe.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${Ft(o)} -> ${Ft(t)}`),n.set(t,8))})}function W2(s){const e=[];return rR(s,t=>e.push(t.subarray(8,24))),e}function rR(s,e){Oe(s,["moov","trak"]).forEach(n=>{const r=Oe(n,["mdia","minf","stbl","stsd"])[0];if(!r)return;const o=r.subarray(8);let l=Oe(o,["enca"]);const u=l.length>0;u||(l=Oe(o,["encv"])),l.forEach(f=>{const d=u?f.subarray(28):f.subarray(78);Oe(d,["sinf"]).forEach(g=>{const y=aR(g);y&&e(y,u)})})})}function aR(s){const e=Oe(s,["schm"])[0];if(e){const t=bt(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const n=Oe(s,["schi","tenc"])[0];if(n)return n}}}function Q2(s,e,t){const n={},r=Oe(s,["moof","traf"]);for(let o=0;o<r.length;o++){const l=r[o],u=Oe(l,["tfhd"])[0],f=be(u,4),d=e[f];if(!d)continue;n[f]||(n[f]={start:NaN,duration:0,sampleCount:0,timescale:d.timescale,type:d.type});const m=n[f],g=Oe(l,["tfdt"])[0];if(g){const _=g[0];let D=be(g,4);_===1&&(D===xE?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(D*=xE+1,D+=be(g,8))),me(D)&&(!me(m.start)||D<m.start)&&(m.start=D)}const y=d.default,x=be(u,0)|y?.flags;let E=y?.duration||0;x&8&&(x&2?E=be(u,12):E=be(u,8));const S=Oe(l,["trun"]);let b=m.start||0,R=0,w=E;for(let _=0;_<S.length;_++){const D=S[_],M=be(D,4),$=m.sampleCount;m.sampleCount+=M;const O=D[3]&1,k=D[3]&4,G=D[2]&1,B=D[2]&2,K=D[2]&4,ne=D[2]&8;let ue=8,ee=M;for(O&&(ue+=4),k&&M&&(!(D[ue+1]&1)&&m.keyFrameIndex===void 0&&(m.keyFrameIndex=$),ue+=4,G?(w=be(D,ue),ue+=4):w=E,B&&(ue+=4),ne&&(ue+=4),b+=w,R+=w,ee--);ee--;)G?(w=be(D,ue),ue+=4):w=E,B&&(ue+=4),K&&(D[ue+1]&1||m.keyFrameIndex===void 0&&(m.keyFrameIndex=m.sampleCount-(ee+1),m.keyFrameStart=b),ue+=4),ne&&(ue+=4),b+=w,R+=w;!R&&E&&(R+=E*M)}m.duration+=R}if(!Object.keys(n).some(o=>n[o].duration)){let o=1/0,l=0;const u=Oe(s,["sidx"]);for(let f=0;f<u.length;f++){const d=z2(u[f]);if(d!=null&&d.references){o=Math.min(o,d.earliestPresentationTime/d.timescale);const m=d.references.reduce((g,y)=>g+y.info.duration||0,0);l=Math.max(l,m+d.earliestPresentationTime/d.timescale)}}l&&me(l)&&Object.keys(n).forEach(f=>{n[f].duration||(n[f].duration=l*n[f].timescale-n[f].start)})}return n}function Z2(s){const e={valid:null,remainder:null},t=Oe(s,["moof"]);if(t.length<2)return e.remainder=s,e;const n=t[t.length-1];return e.valid=s.slice(0,n.byteOffset-8),e.remainder=s.slice(n.byteOffset-8),e}function kn(s,e){const t=new Uint8Array(s.length+e.length);return t.set(s),t.set(e,s.length),t}function SE(s,e){const t=[],n=e.samples,r=e.timescale,o=e.id;let l=!1;return Oe(n,["moof"]).map(f=>{const d=f.byteOffset-8;Oe(f,["traf"]).map(g=>{const y=Oe(g,["tfdt"]).map(x=>{const E=x[0];let S=be(x,4);return E===1&&(S*=Math.pow(2,32),S+=be(x,8)),S/r})[0];return y!==void 0&&(s=y),Oe(g,["tfhd"]).map(x=>{const E=be(x,4),S=be(x,0)&16777215,b=(S&1)!==0,R=(S&2)!==0,w=(S&8)!==0;let _=0;const D=(S&16)!==0;let M=0;const $=(S&32)!==0;let O=8;E===o&&(b&&(O+=8),R&&(O+=4),w&&(_=be(x,O),O+=4),D&&(M=be(x,O),O+=4),$&&(O+=4),e.type==="video"&&(l=Xu(e.codec)),Oe(g,["trun"]).map(k=>{const G=k[0],B=be(k,0)&16777215,K=(B&1)!==0;let ne=0;const ue=(B&4)!==0,ee=(B&256)!==0;let ae=0;const P=(B&512)!==0;let F=0;const U=(B&1024)!==0,Y=(B&2048)!==0;let le=0;const N=be(k,4);let H=8;K&&(ne=be(k,H),H+=4),ue&&(H+=4);let J=ne+d;for(let se=0;se<N;se++){if(ee?(ae=be(k,H),H+=4):ae=_,P?(F=be(k,H),H+=4):F=M,U&&(H+=4),Y&&(G===0?le=be(k,H):le=sR(k,H),H+=4),e.type===et.VIDEO){let de=0;for(;de<F;){const fe=be(n,J);if(J+=4,J2(l,n[J])){const he=n.subarray(J,J+fe);Bg(he,l?2:1,s+le/r,t)}J+=fe,de+=fe+4}}s+=ae/r}}))})})}),t}function Xu(s){if(!s)return!1;const e=s.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function J2(s,e){if(s){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Bg(s,e,t,n){const r=oR(s);let o=0;o+=e;let l=0,u=0,f=0;for(;o<r.length;){l=0;do{if(o>=r.length)break;f=r[o++],l+=f}while(f===255);u=0;do{if(o>=r.length)break;f=r[o++],u+=f}while(f===255);const d=r.length-o;let m=o;if(u<d)o+=u;else if(u>d){qe.error(`Malformed SEI payload. ${u} is too small, only ${d} bytes left to parse.`);break}if(l===4){if(r[m++]===181){const y=nR(r,m);if(m+=2,y===49){const x=be(r,m);if(m+=4,x===1195456820){const E=r[m++];if(E===3){const S=r[m++],b=31&S,R=64&S,w=R?2+b*3:0,_=new Uint8Array(w);if(R){_[0]=S;for(let D=1;D<w;D++)_[D]=r[m++]}n.push({type:E,payloadType:l,pts:t,bytes:_})}}}}}else if(l===5&&u>16){const g=[];for(let E=0;E<16;E++){const S=r[m++].toString(16);g.push(S.length==1?"0"+S:S),(E===3||E===5||E===7||E===9)&&g.push("-")}const y=u-16,x=new Uint8Array(y);for(let E=0;E<y;E++)x[E]=r[m++];n.push({payloadType:l,pts:t,uuid:g.join(""),userData:Tn(x),userDataBytes:x})}}}function oR(s){const e=s.byteLength,t=[];let n=1;for(;n<e-2;)s[n]===0&&s[n+1]===0&&s[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return s;const r=e-t.length,o=new Uint8Array(r);let l=0;for(n=0;n<r;l++,n++)l===t[0]&&(l++,t.shift()),o[n]=s[l];return o}function eF(s){const e=s[0];let t="",n="",r=0,o=0,l=0,u=0,f=0,d=0;if(e===0){for(;bt(s.subarray(d,d+1))!=="\0";)t+=bt(s.subarray(d,d+1)),d+=1;for(t+=bt(s.subarray(d,d+1)),d+=1;bt(s.subarray(d,d+1))!=="\0";)n+=bt(s.subarray(d,d+1)),d+=1;n+=bt(s.subarray(d,d+1)),d+=1,r=be(s,12),o=be(s,16),u=be(s,20),f=be(s,24),d=28}else if(e===1){d+=4,r=be(s,d),d+=4;const g=be(s,d);d+=4;const y=be(s,d);for(d+=4,l=2**32*g+y,D2(l)||(l=Number.MAX_SAFE_INTEGER,qe.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),u=be(s,d),d+=4,f=be(s,d),d+=4;bt(s.subarray(d,d+1))!=="\0";)t+=bt(s.subarray(d,d+1)),d+=1;for(t+=bt(s.subarray(d,d+1)),d+=1;bt(s.subarray(d,d+1))!=="\0";)n+=bt(s.subarray(d,d+1)),d+=1;n+=bt(s.subarray(d,d+1)),d+=1}const m=s.subarray(d,s.byteLength);return{schemeIdUri:t,value:n,timeScale:r,presentationTime:l,presentationTimeDelta:o,eventDuration:u,id:f,payload:m}}function tF(s,...e){const t=e.length;let n=8,r=t;for(;r--;)n+=e[r].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(s,4),r=0,n=8;r<t;r++)o.set(e[r],n),n+=e[r].byteLength;return o}function nF(s,e,t){if(s.byteLength!==16)throw new RangeError("Invalid system id");let n,r;n=0,r=new Uint8Array;let o;n>0?(o=new Uint8Array(4),e.length>0&&new DataView(o.buffer).setUint32(0,e.length,!1)):o=new Uint8Array;const l=new Uint8Array(4);return t.byteLength>0&&new DataView(l.buffer).setUint32(0,t.byteLength,!1),tF([112,115,115,104],new Uint8Array([n,0,0,0]),s,o,r,l,t)}function sF(s){const e=[];if(s instanceof ArrayBuffer){const t=s.byteLength;let n=0;for(;n+32<t;){const r=new DataView(s,n),o=iF(r);e.push(o),n+=o.size}}return e}function iF(s){const e=s.getUint32(0),t=s.byteOffset,n=s.byteLength;if(n<e)return{offset:t,size:n};if(s.getUint32(4)!==1886614376)return{offset:t,size:e};const o=s.getUint32(8)>>>24;if(o!==0&&o!==1)return{offset:t,size:e};const l=s.buffer,u=Ft(new Uint8Array(l,t+12,16));let f=null,d=null,m=0;if(o===0)m=28;else{const y=s.getUint32(28);if(!y||n<32+y*16)return{offset:t,size:e};f=[];for(let x=0;x<y;x++)f.push(new Uint8Array(l,t+32+x*16,16));m=32+y*16}if(!m)return{offset:t,size:e};const g=s.getUint32(m);return e-32<g?{offset:t,size:e}:(d=new Uint8Array(l,t+m+4,g),{version:o,systemId:u,kids:f,data:d,offset:t,size:e})}const lR=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Ea={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function $g(s,e){const t=Ea[e];return!!t&&!!t[s.slice(0,4)]}function Ho(s,e,t=!0){return!s.split(",").some(n=>!jg(n,e,t))}function jg(s,e,t=!0){var n;const r=Di(t);return(n=r?.isTypeSupported(Vo(s,e)))!=null?n:!1}function Vo(s,e){return`${e}/mp4;codecs=${s}`}function TE(s){if(s){const e=s.substring(0,4);return Ea.video[e]}return 2}function vu(s){const e=lR();return s.split(",").reduce((t,n)=>{const o=e&&Xu(n)?9:Ea.video[n];return o?(o*2+t)/(t?3:2):(Ea.audio[n]+t)/(t?2:1)},0)}const jh={};function rF(s,e=!0){if(jh[s])return jh[s];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[s];for(let r=0;r<t.length;r++){var n;if(jg(t[r],"audio",e))return jh[s]=t[r],t[r];if(t[r]==="mp3"&&(n=Di(e))!=null&&n.isTypeSupported("audio/mpeg"))return""}return s}const aF=/flac|opus|mp4a\.40\.34/i;function xu(s,e=!0){return s.replace(aF,t=>rF(t.toLowerCase(),e))}function oF(s,e){const t=[];if(s){const n=s.split(",");for(let r=0;r<n.length;r++)$g(n[r],"video")||t.push(n[r])}return e&&t.push(e),t.join(",")}function tu(s,e){if(s&&(s.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(s)!==-1)&&(bE(s,"audio")||bE(s,"video")))return s;if(e){const t=e.split(",");if(t.length>1){if(s){for(let n=t.length;n--;)if(t[n].substring(0,4)===s.substring(0,4))return t[n]}return t[0]}}return e||s}function bE(s,e){return $g(s,e)&&jg(s,e)}function lF(s){const e=s.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");n.length>2&&n[0]==="avc1"&&(e[t]=`avc1.${parseInt(n[1]).toString(16)}${("000"+parseInt(n[2]).toString(16)).slice(-4)}`)}return e.join(",")}function cF(s){if(s.startsWith("av01.")){const e=s.split("."),t=["0","111","01","01","01","0"];for(let n=e.length;n>4&&n<10;n++)e[n]=t[n-4];return e.join(".")}return s}function AE(s){const e=Di(s)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function wm(s){return s.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const uF={supported:!0,powerEfficient:!0,smooth:!0},dF={supported:!1,smooth:!1,powerEfficient:!1},cR={supported:!0,configurations:[],decodingInfoResults:[uF]};function uR(s,e){return{supported:!1,configurations:e,decodingInfoResults:[dF],error:s}}function fF(s,e,t,n,r,o){const l=s.videoCodec,u=s.audioCodec?s.audioGroups:null,f=o?.audioCodec,d=o?.channels,m=d?parseInt(d):f?1/0:2;let g=null;if(u!=null&&u.length)try{u.length===1&&u[0]?g=e.groups[u[0]].channels:g=u.reduce((y,x)=>{if(x){const E=e.groups[x];if(!E)throw new Error(`Audio track group ${x} not found`);Object.keys(E.channels).forEach(S=>{y[S]=(y[S]||0)+E.channels[S]})}return y},{2:0})}catch{return!0}return l!==void 0&&(l.split(",").some(y=>Xu(y))||s.width>1920&&s.height>1088||s.height>1920&&s.width>1088||s.frameRate>Math.max(n,30)||s.videoRange!=="SDR"&&s.videoRange!==t||s.bitrate>Math.max(r,8e6))||!!g&&me(m)&&Object.keys(g).some(y=>parseInt(y)>m)}function dR(s,e,t,n={}){const r=s.videoCodec;if(!r&&!s.audioCodec||!t)return Promise.resolve(cR);const o=[],l=hF(s),u=l.length,f=mF(s,e,u>0),d=f.length;for(let m=u||1*d||1;m--;){const g={type:"media-source"};if(u&&(g.video=l[m%u]),d){g.audio=f[m%d];const y=g.audio.bitrate;g.video&&y&&(g.video.bitrate-=y)}o.push(g)}if(r){const m=navigator.userAgent;if(r.split(",").some(g=>Xu(g))&&lR())return Promise.resolve(uR(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${m})`),o))}return Promise.all(o.map(m=>{const g=pF(m);return n[g]||(n[g]=t.decodingInfo(m))})).then(m=>({supported:!m.some(g=>!g.supported),configurations:o,decodingInfoResults:m})).catch(m=>({supported:!1,configurations:o,decodingInfoResults:[],error:m}))}function hF(s){var e;const t=(e=s.videoCodec)==null?void 0:e.split(","),n=fR(s),r=s.width||640,o=s.height||480,l=s.frameRate||30,u=s.videoRange.toLowerCase();return t?t.map(f=>{const d={contentType:Vo(cF(f),"video"),width:r,height:o,bitrate:n,framerate:l};return u!=="sdr"&&(d.transferFunction=u),d}):[]}function mF(s,e,t){var n;const r=(n=s.audioCodec)==null?void 0:n.split(","),o=fR(s);return r&&s.audioGroups?s.audioGroups.reduce((l,u)=>{var f;const d=u?(f=e.groups[u])==null?void 0:f.tracks:null;return d?d.reduce((m,g)=>{if(g.groupId===u){const y=parseFloat(g.channels||"");r.forEach(x=>{const E={contentType:Vo(x,"audio"),bitrate:t?gF(x,o):o};y&&(E.channels=""+y),m.push(E)})}return m},l):l},[]):[]}function gF(s,e){if(e<=1)return 1;let t=128e3;return s==="ec-3"?t=768e3:s==="ac-3"&&(t=64e4),Math.min(e/2,t)}function fR(s){return Math.ceil(Math.max(s.bitrate*.9,s.averageBitrate)/1e3)*1e3||1}function pF(s){let e="";const{audio:t,video:n}=s;if(n){const r=wm(n.contentType);e+=`${r}_r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${Math.ceil(n.bitrate/1e5)}`}if(t){const r=wm(t.contentType);e+=`${n?"_":""}${r}_c${t.channels}`}return e}const Dm=["NONE","TYPE-0","TYPE-1",null];function yF(s){return Dm.indexOf(s)>-1}const Eu=["SDR","PQ","HLG"];function vF(s){return!!s&&Eu.indexOf(s)>-1}var nu={No:"",Yes:"YES",v2:"v2"};function RE(s){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=s,r=n<e/2;return e&&r?t?nu.v2:nu.Yes:nu.No}class LE{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Ko{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=(t=e.supplemental)==null?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return CE(this._audioGroups,e)}hasSubtitleGroup(e){return CE(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function CE(s,e){return!e||!s?!1:s.indexOf(e)!==-1}function xF(){if(typeof matchMedia=="function"){const s=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(s.media!==e.media)return s.matches===!0}return!1}function EF(s,e){let t=!1,n=[];if(s&&(t=s!=="SDR",n=[s]),e){n=e.allowedVideoRanges||Eu.slice(0);const r=n.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:r&&xF(),t||(n=["SDR"])}return{preferHDR:t,allowedVideoRanges:n}}const SF=s=>{const e=new WeakSet;return(t,n)=>{if(s&&(n=s(t,n)),typeof n=="object"&&n!==null){if(e.has(n))return;e.add(n)}return n}},tt=(s,e)=>JSON.stringify(s,SF(e));function TF(s,e,t,n,r){const o=Object.keys(s),l=n?.channels,u=n?.audioCodec,f=r?.videoCodec,d=l&&parseInt(l)===2;let m=!1,g=!1,y=1/0,x=1/0,E=1/0,S=1/0,b=0,R=[];const{preferHDR:w,allowedVideoRanges:_}=EF(e,r);for(let k=o.length;k--;){const G=s[o[k]];m||(m=G.channels[2]>0),y=Math.min(y,G.minHeight),x=Math.min(x,G.minFramerate),E=Math.min(E,G.minBitrate),_.filter(K=>G.videoRanges[K]>0).length>0&&(g=!0)}y=me(y)?y:0,x=me(x)?x:0;const D=Math.max(1080,y),M=Math.max(30,x);E=me(E)?E:t,t=Math.max(E,t),g||(e=void 0);const $=o.length>1;return{codecSet:o.reduce((k,G)=>{const B=s[G];if(G===k)return k;if(R=g?_.filter(K=>B.videoRanges[K]>0):[],$){if(B.minBitrate>t)return ts(G,`min bitrate of ${B.minBitrate} > current estimate of ${t}`),k;if(!B.hasDefaultAudio)return ts(G,"no renditions with default or auto-select sound found"),k;if(u&&G.indexOf(u.substring(0,4))%5!==0)return ts(G,`audio codec preference "${u}" not found`),k;if(l&&!d){if(!B.channels[l])return ts(G,`no renditions with ${l} channel sound found (channels options: ${Object.keys(B.channels)})`),k}else if((!u||d)&&m&&B.channels[2]===0)return ts(G,"no renditions with stereo sound found"),k;if(B.minHeight>D)return ts(G,`min resolution of ${B.minHeight} > maximum of ${D}`),k;if(B.minFramerate>M)return ts(G,`min framerate of ${B.minFramerate} > maximum of ${M}`),k;if(!R.some(K=>B.videoRanges[K]>0))return ts(G,`no variants with VIDEO-RANGE of ${tt(R)} found`),k;if(f&&G.indexOf(f.substring(0,4))%5!==0)return ts(G,`video codec preference "${f}" not found`),k;if(B.maxScore<b)return ts(G,`max score of ${B.maxScore} < selected max of ${b}`),k}return k&&(vu(G)>=vu(k)||B.fragmentError>s[k].fragmentError)?k:(S=B.minIndex,b=B.maxScore,G)},void 0),videoRanges:R,preferHDR:w,minFramerate:x,minBitrate:E,minIndex:S}}function ts(s,e){qe.log(`[abr] start candidates with "${s}" ignored because ${e}`)}function hR(s){return s.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const r=t.channels||"2";return n.channels[r]=(n.channels[r]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function bF(s,e,t,n){return s.slice(t,n+1).reduce((r,o,l)=>{if(!o.codecSet)return r;const u=o.audioGroups;let f=r[o.codecSet];f||(r[o.codecSet]=f={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:l,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!u,fragmentError:0}),f.minBitrate=Math.min(f.minBitrate,o.bitrate);const d=Math.min(o.height,o.width);return f.minHeight=Math.min(f.minHeight,d),f.minFramerate=Math.min(f.minFramerate,o.frameRate),f.minIndex=Math.min(f.minIndex,l),f.maxScore=Math.max(f.maxScore,o.score),f.fragmentError+=o.fragmentError,f.videoRanges[o.videoRange]=(f.videoRanges[o.videoRange]||0)+1,u&&u.forEach(m=>{if(!m)return;const g=e.groups[m];g&&(f.hasDefaultAudio=f.hasDefaultAudio||e.hasDefaultAudio?g.hasDefault:g.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(g.channels).forEach(y=>{f.channels[y]=(f.channels[y]||0)+g.channels[y]}))}),r},{})}function _E(s){if(!s)return s;const{lang:e,assocLang:t,characteristics:n,channels:r,audioCodec:o}=s;return{lang:e,assocLang:t,characteristics:n,channels:r,audioCodec:o}}function os(s,e,t){if("attrs"in s){const n=e.indexOf(s);if(n!==-1)return n}for(let n=0;n<e.length;n++){const r=e[n];if(tr(s,r,t))return n}return-1}function tr(s,e,t){const{groupId:n,name:r,lang:o,assocLang:l,default:u}=s,f=s.forced;return(n===void 0||e.groupId===n)&&(r===void 0||e.name===r)&&(o===void 0||AF(o,e.lang))&&(o===void 0||e.assocLang===l)&&(u===void 0||e.default===u)&&(f===void 0||e.forced===f)&&(!("characteristics"in s)||RF(s.characteristics||"",e.characteristics))&&(t===void 0||t(s,e))}function AF(s,e="--"){return s.length===e.length?s===e:s.startsWith(e)||e.startsWith(s)}function RF(s,e=""){const t=s.split(","),n=e.split(",");return t.length===n.length&&!t.some(r=>n.indexOf(r)===-1)}function er(s,e){const{audioCodec:t,channels:n}=s;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function LF(s,e,t,n,r){const o=e[n],u=e.reduce((y,x,E)=>{const S=x.uri;return(y[S]||(y[S]=[])).push(E),y},{})[o.uri];u.length>1&&(n=Math.max.apply(Math,u));const f=o.videoRange,d=o.frameRate,m=o.codecSet.substring(0,4),g=wE(e,n,y=>{if(y.videoRange!==f||y.frameRate!==d||y.codecSet.substring(0,4)!==m)return!1;const x=y.audioGroups,E=t.filter(S=>!x||x.indexOf(S.groupId)!==-1);return os(s,E,r)>-1});return g>-1?g:wE(e,n,y=>{const x=y.audioGroups,E=t.filter(S=>!x||x.indexOf(S.groupId)!==-1);return os(s,E,r)>-1})}function wE(s,e,t){for(let n=e;n>-1;n--)if(t(s[n]))return n;for(let n=e+1;n<s.length;n++)if(t(s[n]))return n;return-1}function Su(s,e){var t;return!!s&&s!==((t=e.loadLevelObj)==null?void 0:t.uri)}class CF extends Pn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var n;const{fragCurrent:r,partCurrent:o,hls:l}=this,{autoLevelEnabled:u,media:f}=l;if(!r||!f)return;const d=performance.now(),m=o?o.stats:r.stats,g=o?o.duration:r.duration,y=d-m.loading.start,x=l.minAutoLevel,E=r.level,S=this._nextAutoLevel;if(m.aborted||m.loaded&&m.loaded===m.total||E<=x){this.clearTimer(),this._nextAutoLevel=-1;return}if(!u)return;const b=S>-1&&S!==E,R=!!t||b;if(!R&&(f.paused||!f.playbackRate||!f.readyState))return;const w=l.mainForwardBufferInfo;if(!R&&w===null)return;const _=this.bwEstimator.getEstimateTTFB(),D=Math.abs(f.playbackRate);if(y<=Math.max(_,1e3*(g/(D*2))))return;const M=w?w.len/D:0,$=m.loading.first?m.loading.first-m.loading.start:-1,O=m.loaded&&$>-1,k=this.getBwEstimate(),G=l.levels,B=G[E],K=Math.max(m.loaded,Math.round(g*(r.bitrate||B.averageBitrate)/8));let ne=O?y-$:y;ne<1&&O&&(ne=Math.min(y,m.loaded*8/k));const ue=O?m.loaded*1e3/ne:0,ee=_/1e3,ae=ue?(K-m.loaded)/ue:K*8/k+ee;if(ae<=M)return;const P=ue?ue*8:k,F=((n=t?.details||this.hls.latestLevelDetails)==null?void 0:n.live)===!0,U=this.hls.config.abrBandWidthUpFactor;let Y=Number.POSITIVE_INFINITY,le;for(le=E-1;le>x;le--){const se=G[le].maxBitrate,de=!G[le].details||F;if(Y=this.getTimeToLoadFrag(ee,P,g*se,de),Y<Math.min(M,g+ee))break}if(Y>=ae||Y>g*10)return;O?this.bwEstimator.sample(y-Math.min(_,$),m.loaded):this.bwEstimator.sampleTTFB(y);const N=G[le].maxBitrate;this.getBwEstimate()*U>N&&this.resetEstimator(N);const H=this.findBestLevel(N,x,le,0,M,1,1);H>-1&&(le=H),this.warn(`Fragment ${r.sn}${o?" part "+o.index:""} of level ${E} is loading too slowly;
      Fragment duration: ${r.duration.toFixed(3)}
      Time to underbuffer: ${M.toFixed(3)} s
      Estimated load time for current fragment: ${ae.toFixed(3)} s
      Estimated load time for down switch fragment: ${Y.toFixed(3)} s
      TTFB estimate: ${$|0} ms
      Current BW estimate: ${me(k)?k|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${le} @ ${N|0} bps`),l.nextLoadLevel=l.nextAutoLevel=le,this.clearTimer();const J=()=>{if(this.clearTimer(),this.fragCurrent===r&&this.hls.loadLevel===le&&le>0){const se=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${le>0?"and switching down":""}
      Fragment duration: ${r.duration.toFixed(3)} s
      Time to underbuffer: ${se.toFixed(3)} s`),r.abortRequests(),this.fragCurrent=this.partCurrent=null,le>x){let de=this.findBestLevel(this.hls.levels[x].bitrate,x,le,0,se,1,1);de===-1&&(de=x),this.hls.nextLoadLevel=this.hls.nextAutoLevel=de,this.resetEstimator(this.hls.levels[de].bitrate)}}};b||ae>Y*2?J():this.timer=self.setInterval(J,Y*1e3),l.trigger(C.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:o,stats:m})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new O2(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(C.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var r;this.fragCurrent=n,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case X.BUFFER_ADD_CODEC_ERROR:case X.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case X.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:r,partCurrent:o}=this;if(n&&r&&n.sn===r.sn&&n.level===r.level){const l=performance.now(),u=o?o.stats:n.stats,f=l-u.loading.start,d=u.loading.first?u.loading.first-u.loading.start:-1;if(u.loaded&&d>-1){const g=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(f-Math.min(g,d),u.loaded)}else this.bwEstimator.sampleTTFB(f)}break}}}getTimeToLoadFrag(e,t,n,r){const o=e+n/t,l=r?e+this.lastLevelLoadSec:0;return o+l}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,o=r.end-r.first;me(o)&&(this.lastLevelLoadSec=o/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===ge.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const o=n?n.duration:t.duration,l=this.hls.levels[t.level],u=(l.loaded?l.loaded.bytes:0)+r.loaded,f=(l.loaded?l.loaded.duration:0)+o;l.loaded={bytes:u,duration:f},l.realBitrate=Math.round(8*u/f)}if(t.bitrateTest){const o={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(C.FRAG_BUFFERED,o),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:r}=t,o=r!=null&&r.stats.loaded?r.stats:n.stats;if(o.aborted||this.ignoreFragment(n))return;const l=o.parsing.end-o.loading.start-Math.min(o.loading.first-o.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(l,o.loaded),o.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ge.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,o=this.findBestLevel(n,t,e,0,r,1,1);if(o>-1)return o;const l=this.hls.firstLevel,u=Math.min(Math.max(l,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${l} clamped to ${u}`),u}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const o=n&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const l=this.hls.levels;if(l.length>Math.max(e,o)&&l[e].loadError<=l[o].loadError)return e}return this._nextAutoLevel=o,this.nextAutoLevelKey=this.getAutoLevelKey(),o}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:r,config:o,minAutoLevel:l}=n,u=t?t.duration:e?e.duration:0,f=this.getBwEstimate(),d=this.getStarvationDelay();let m=o.abrBandWidthFactor,g=o.abrBandWidthUpFactor;if(d){const b=this.findBestLevel(f,l,r,d,0,m,g);if(b>=0)return this.rebufferNotice=-1,b}let y=u?Math.min(u,o.maxStarvationDelay):o.maxStarvationDelay;if(!d){const b=this.bitrateTestDelay;b&&(y=(u?Math.min(u,o.maxLoadingDelay):o.maxLoadingDelay)-b,this.info(`bitrate test took ${Math.round(1e3*b)}ms, set first fragment max fetchDuration to ${Math.round(1e3*y)} ms`),m=g=1)}const x=this.findBestLevel(f,l,r,d,y,m,g);if(this.rebufferNotice!==x&&(this.rebufferNotice=x,this.info(`${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${x}`)),x>-1)return x;const E=n.levels[l],S=n.loadLevelObj;return S&&E?.bitrate<S.bitrate?l:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,o,l,u){var f;const d=r+o,m=this.lastLoadedFragLevel,g=m===-1?this.hls.firstLevel:m,{fragCurrent:y,partCurrent:x}=this,{levels:E,allAudioTracks:S,loadLevel:b,config:R}=this.hls;if(E.length===1)return 0;const w=E[g],_=!!((f=this.hls.latestLevelDetails)!=null&&f.live),D=b===-1||m===-1;let M,$="SDR",O=w?.frameRate||0;const{audioPreference:k,videoPreference:G}=R,B=this.audioTracksByGroup||(this.audioTracksByGroup=hR(S));let K=-1;if(D){if(this.firstSelection!==-1)return this.firstSelection;const P=this.codecTiers||(this.codecTiers=bF(E,B,t,n)),F=TF(P,$,e,k,G),{codecSet:U,videoRanges:Y,minFramerate:le,minBitrate:N,minIndex:H,preferHDR:J}=F;K=H,M=U,$=J?Y[Y.length-1]:Y[0],O=le,e=Math.max(e,N),this.log(`picked start tier ${tt(F)}`)}else M=w?.codecSet,$=w?.videoRange;const ne=x?x.duration:y?y.duration:0,ue=this.bwEstimator.getEstimateTTFB()/1e3,ee=[];for(let P=n;P>=t;P--){var ae;const F=E[P],U=P>g;if(!F)continue;if(R.useMediaCapabilities&&!F.supportedResult&&!F.supportedPromise){const de=navigator.mediaCapabilities;typeof de?.decodingInfo=="function"&&fF(F,B,$,O,e,k)?(F.supportedPromise=dR(F,B,de,this.supportedCache),F.supportedPromise.then(fe=>{if(!this.hls)return;F.supportedResult=fe;const he=this.hls.levels,Le=he.indexOf(F);fe.error?this.warn(`MediaCapabilities decodingInfo error: "${fe.error}" for level ${Le} ${tt(fe)}`):fe.supported?fe.decodingInfoResults.some(_e=>_e.smooth===!1||_e.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Le} not smooth or powerEfficient: ${tt(fe)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Le} ${tt(fe)}`),Le>-1&&he.length>1&&(this.log(`Removing unsupported level ${Le}`),this.hls.removeLevel(Le),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(fe=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${fe}`)})):F.supportedResult=cR}if((M&&F.codecSet!==M||$&&F.videoRange!==$||U&&O>F.frameRate||!U&&O>0&&O<F.frameRate||(ae=F.supportedResult)!=null&&(ae=ae.decodingInfoResults)!=null&&ae.some(de=>de.smooth===!1))&&(!D||P!==K)){ee.push(P);continue}const Y=F.details,le=(x?Y?.partTarget:Y?.averagetargetduration)||ne;let N;U?N=u*e:N=l*e;const H=ne&&r>=ne*2&&o===0?F.averageBitrate:F.maxBitrate,J=this.getTimeToLoadFrag(ue,N,H*le,Y===void 0);if(N>=H&&(P===m||F.loadError===0&&F.fragmentError===0)&&(J<=ue||!me(J)||_&&!this.bitrateTestDelay||J<d)){const de=this.forcedAutoLevel;return P!==b&&(de===-1||de!==b)&&(ee.length&&this.trace(`Skipped level(s) ${ee.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${E[ee[0]].codecs}" ${E[ee[0]].videoRange}; not compatible with "${M}" ${$}`),this.info(`switch candidate:${g}->${P} adjustedbw(${Math.round(N)})-bitrate=${Math.round(N-H)} ttfb:${ue.toFixed(1)} avgDuration:${le.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${J.toFixed(1)} firstSelection:${D} codecSet:${F.codecSet} videoRange:${F.videoRange} hls.loadLevel:${b}`)),D&&(this.firstSelection=P),P}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const mR={search:function(s,e){let t=0,n=s.length-1,r=null,o=null;for(;t<=n;){r=(t+n)/2|0,o=s[r];const l=e(o);if(l>0)t=r+1;else if(l<0)n=r-1;else return o}return null}};function _F(s,e,t){if(e===null||!Array.isArray(s)||!s.length||!me(e))return null;const n=s[0].programDateTime;if(e<(n||0))return null;const r=s[s.length-1].endProgramDateTime;if(e>=(r||0))return null;for(let o=0;o<s.length;++o){const l=s[o];if(DF(e,t,l))return l}return null}function sr(s,e,t=0,n=0,r=.005){let o=null;if(s){o=e[1+s.sn-e[0].sn]||null;const u=s.endDTS-t;u>0&&u<15e-7&&(t+=15e-7),o&&s.level!==o.level&&o.end<=s.end&&(o=e[2+s.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(o=e[0]);if(o&&((!s||s.level===o.level)&&DE(t,n,o)===0||wF(o,s,Math.min(r,n))))return o;const l=mR.search(e,DE.bind(null,t,n));return l&&(l!==s||!o)?l:o}function wF(s,e,t){if(e&&e.start===0&&e.level<s.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((r,o)=>(o[0]==="INF"&&(r+=parseFloat(o[1])),r),t);return s.start<=n}return!1}function DE(s=0,e=0,t){if(t.start<=s&&t.start+t.duration>s)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=s?1:t.start-n>s&&t.start?-1:0}function DF(s,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>s}function gR(s,e,t){if(s&&s.startCC<=e&&s.endCC>=e){let n=s.fragments;const{fragmentHint:r}=s;r&&(n=n.concat(r));let o;return mR.search(n,l=>l.cc<e?1:l.cc>e?-1:(o=l,l.end<=t?1:l.start>t?-1:0)),o||null}return null}function Tu(s){switch(s.details){case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_TIMEOUT:case X.LEVEL_LOAD_TIMEOUT:case X.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function pR(s){return s.details.startsWith("key")}function yR(s){return pR(s)&&!!s.frag&&!s.frag.decryptdata}function IE(s,e){const t=Tu(e);return s.default[`${t?"timeout":"error"}Retry`]}function Gg(s,e){const t=s.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*s.retryDelayMs,s.maxRetryDelayMs)}function OE(s){return Ye(Ye({},s),{errorRetry:null,timeoutRetry:null})}function bu(s,e,t,n){if(!s)return!1;const r=n?.code,o=e<s.maxNumRetry&&(IF(r)||!!t);return s.shouldRetry?s.shouldRetry(s,e,t,n,o):o}function IF(s){return Im(s)||!!s&&(s<400||s>499)}function Im(s){return s===0&&navigator.onLine===!1}var Pt={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},pn={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class OF extends Pn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(C.ERROR,this.onError,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(C.ERROR,this.onError,this),e.off(C.ERROR,this.onErrorOut,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===ge.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,n=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||n===-1?t.loadLevel:n}variantHasKey(e,t){if(e){var n;if((n=e.details)!=null&&n.hasKey(t))return!0;const r=e.audioGroups;if(r)return this.hls.allAudioTracks.filter(l=>r.indexOf(l.groupId)>=0).some(l=>{var u;return(u=l.details)==null?void 0:u.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const r=this.hls,o=t.context;switch(t.details){case X.FRAG_LOAD_ERROR:case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_ERROR:case X.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case X.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction=ha();return}case X.FRAG_GAP:case X.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Pt.SendAlternateToPenaltyBox;return}case X.LEVEL_EMPTY_ERROR:case X.LEVEL_PARSING_ERROR:{var l;const f=t.parent===ge.MAIN?t.level:r.loadLevel;t.details===X.LEVEL_EMPTY_ERROR&&((l=t.context)!=null&&(l=l.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,f):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,f))}return;case X.LEVEL_LOAD_ERROR:case X.LEVEL_LOAD_TIMEOUT:typeof o?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case X.AUDIO_TRACK_LOAD_ERROR:case X.AUDIO_TRACK_LOAD_TIMEOUT:case X.SUBTITLE_LOAD_ERROR:case X.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const f=r.loadLevelObj;if(f&&(o.type===Me.AUDIO_TRACK&&f.hasAudioGroup(o.groupId)||o.type===Me.SUBTITLE_TRACK&&f.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=Pt.SendAlternateToPenaltyBox,t.errorAction.flags=pn.MoveAllAlternatesMatchingHost;return}}return;case X.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:Pt.SendAlternateToPenaltyBox,flags:pn.MoveAllAlternatesMatchingHDCP};return;case X.KEY_SYSTEM_SESSION_UPDATE_FAILED:case X.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case X.KEY_SYSTEM_NO_SESSION:t.errorAction={action:Pt.SendAlternateToPenaltyBox,flags:pn.MoveAllAlternatesMatchingKey};return;case X.BUFFER_ADD_CODEC_ERROR:case X.REMUX_ALLOC_ERROR:case X.BUFFER_APPEND_ERROR:if(!t.errorAction){var u;t.errorAction=this.getLevelSwitchAction(t,(u=t.level)!=null?u:r.loadLevel)}return;case X.INTERNAL_EXCEPTION:case X.BUFFER_APPENDING_ERROR:case X.BUFFER_FULL_ERROR:case X.LEVEL_SWITCH_ERROR:case X.BUFFER_STALLED_ERROR:case X.BUFFER_SEEK_OVER_HOLE:case X.BUFFER_NUDGE_ON_STALL:t.errorAction=ha();return}t.type===Ee.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=ha())}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,r=IE(n.config.playlistLoadPolicy,e),o=this.playlistError++;if(bu(r,o,Tu(e),e.response))return{action:Pt.RetryRequest,flags:pn.None,retryConfig:r,retryCount:o};const u=this.getLevelSwitchAction(e,t);return r&&(u.retryConfig=r,u.retryCount=o),u}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:o,keyLoadPolicy:l}=t.config,u=IE(pR(e)?l:o,e),f=t.levels.reduce((m,g)=>m+g.fragmentError,0);if(r&&(e.details!==X.FRAG_GAP&&r.fragmentError++,!yR(e)&&bu(u,f,Tu(e),e.response)))return{action:Pt.RetryRequest,flags:pn.None,retryConfig:u,retryCount:f};const d=this.getLevelSwitchAction(e,n);return u&&(d.retryConfig=u,d.retryCount=f),d}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const r=this.hls.levels[t];if(r){var o,l;const d=e.details;r.loadError++,d===X.BUFFER_APPEND_ERROR&&r.fragmentError++;let m=-1;const{levels:g,loadLevel:y,minAutoLevel:x,maxAutoLevel:E}=n;!n.autoLevelEnabled&&!n.config.preserveManualLevelOnError&&(n.loadLevel=-1);const S=(o=e.frag)==null?void 0:o.type,R=(S===ge.AUDIO&&d===X.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(d===X.BUFFER_ADD_CODEC_ERROR||d===X.BUFFER_APPEND_ERROR))&&g.some(({audioCodec:$})=>r.audioCodec!==$),_=e.sourceBufferName==="video"&&(d===X.BUFFER_ADD_CODEC_ERROR||d===X.BUFFER_APPEND_ERROR)&&g.some(({codecSet:$,audioCodec:O})=>r.codecSet!==$&&r.audioCodec===O),{type:D,groupId:M}=(l=e.context)!=null?l:{};for(let $=g.length;$--;){const O=($+y)%g.length;if(O!==y&&O>=x&&O<=E&&g[O].loadError===0){var u,f;const k=g[O];if(d===X.FRAG_GAP&&S===ge.MAIN&&e.frag){const G=g[O].details;if(G){const B=sr(e.frag,G.fragments,e.frag.start);if(B!=null&&B.gap)continue}}else{if(D===Me.AUDIO_TRACK&&k.hasAudioGroup(M)||D===Me.SUBTITLE_TRACK&&k.hasSubtitleGroup(M))continue;if(S===ge.AUDIO&&(u=r.audioGroups)!=null&&u.some(G=>k.hasAudioGroup(G))||S===ge.SUBTITLE&&(f=r.subtitleGroups)!=null&&f.some(G=>k.hasSubtitleGroup(G))||R&&r.audioCodec===k.audioCodec||_&&r.codecSet===k.codecSet||!R&&r.codecSet!==k.codecSet)continue}m=O;break}}if(m>-1&&n.loadLevel!==m)return e.levelRetry=!0,this.playlistError=0,{action:Pt.SendAlternateToPenaltyBox,flags:pn.None,nextAutoLevel:m}}return{action:Pt.SendAlternateToPenaltyBox,flags:pn.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case Pt.DoNothing:break;case Pt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==X.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r}=n,o=n.nextAutoLevel;switch(r){case pn.None:this.switchLevel(e,o);break;case pn.MoveAllAlternatesMatchingHDCP:{const f=this.getVariantLevelIndex(e.frag),d=t.levels[f],m=d?.attrs["HDCP-LEVEL"];if(n.hdcpLevel=m,m==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(m){t.maxHdcpLevel=Dm[Dm.indexOf(m)-1],n.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case pn.MoveAllAlternatesMatchingKey:{const f=e.decryptdata;if(f){const d=this.hls.levels,m=d.length;for(let y=m;y--;)if(this.variantHasKey(d[y],f)){var l,u;this.log(`Banned key found in level ${y} (${d[y].bitrate}bps) or audio group "${(l=d[y].audioGroups)==null?void 0:l.join(",")}" (${(u=e.frag)==null?void 0:u.type} fragment) ${Ft(f.keyId||[])}`),d[y].fragmentError++,d[y].loadError++,this.log(`Removing level ${y} with key error (${e.error})`),this.hls.removeLevel(y)}const g=e.frag;if(this.hls.levels.length<m)n.resolved=!0;else if(g&&g.type!==ge.MAIN){const y=g.decryptdata;y&&!f.matches(y)&&(n.resolved=!0)}}break}}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===X.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const n=wm(e.mimeType),r=this.hls.levels;for(let o=r.length;o--;)r[o][`${e.sourceBufferName}Codec`]===n&&(this.log(`Removing level ${o} for ${e.details} ("${n}" not supported)`),this.hls.removeLevel(o))}}}function ha(s){const e={action:Pt.DoNothing,flags:pn.None};return s&&(e.resolved=!0),e}var At={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class MF{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let r=n.length;r--;){const o=n[r];if(!o)break;if(o.start<=e&&e<=o.end&&o.loaded)return o}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:r}=this,o=Object.keys(r);for(let l=o.length;l--;){const u=r[o[l]];if(u?.body.type===t&&(!n||u.buffered)){const f=u.body;if(f.start<=e&&e<=f.end)return f}}return null}detectEvictedFragments(e,t,n,r,o){this.timeRanges&&(this.timeRanges[e]=t);const l=r?.fragment.sn||-1;Object.keys(this.fragments).forEach(u=>{const f=this.fragments[u];if(!f||l>=f.body.sn)return;if(!f.buffered&&(!f.loaded||o)){f.body.type===n&&this.removeFragment(f.body);return}const d=f.range[e];if(d){if(d.time.length===0){this.removeFragment(f.body);return}d.time.some(m=>{const g=!this.isTimeBuffered(m.startPTS,m.endPTS,t);return g&&this.removeFragment(f.body),g})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const n=e.frag,r=Jr(n),o=this.fragments[r];if(!o||o.buffered&&n.gap)return;const l=!n.relurl;Object.keys(t).forEach(u=>{const f=n.elementaryStreams[u];if(!f)return;const d=t[u],m=l||f.partial===!0;o.range[u]=this.getBufferedTimes(n,e.part,m,d)}),o.loaded=null,Object.keys(o.range).length?(this.bufferedEnd(o,n),Fc(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}bufferedEnd(e,t){e.buffered=!0,(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=ME(n,r=>r.fragment.sn>=e))}fragBuffered(e,t){const n=Jr(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,this.bufferedEnd(r,e))}getBufferedTimes(e,t,n,r){const o={time:[],partial:n},l=e.start,u=e.end,f=e.minEndPTS||u,d=e.maxStartPTS||l;for(let m=0;m<r.length;m++){const g=r.start(m)-this.bufferPadding,y=r.end(m)+this.bufferPadding;if(d>=g&&f<=y){o.time.push({startPTS:Math.max(l,r.start(m)),endPTS:Math.min(u,r.end(m))});break}else if(l<y&&u>g){const x=Math.max(l,r.start(m)),E=Math.min(u,r.end(m));E>x&&(o.partial=!0,o.time.push({startPTS:x,endPTS:E}))}else if(u<=g)break}return o}getPartialFragment(e){let t=null,n,r,o,l=0;const{bufferPadding:u,fragments:f}=this;return Object.keys(f).forEach(d=>{const m=f[d];m&&Fc(m)&&(r=m.body.start-u,o=m.body.end+u,e>=r&&e<=o&&(n=Math.min(e-r,o-e),l<=n&&(t=m.body,l=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Fc(t))}getState(e){const t=Jr(e),n=this.fragments[t];return n?n.buffered?Fc(n)?At.PARTIAL:At.OK:At.APPENDING:At.NOT_LOADED}isTimeBuffered(e,t,n){let r,o;for(let l=0;l<n.length;l++){if(r=n.start(l)-this.bufferPadding,o=n.end(l)+this.bufferPadding,e>=r&&t<=o)return!0;if(t<=r)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const n=t.frag,r=t.part?null:t,o=Jr(n);this.fragments[o]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:o,type:l}=t;if(n.sn==="initSegment")return;const u=n.type;if(r){let d=this.activePartLists[u];d||(this.activePartLists[u]=d=[]),d.push(r)}this.timeRanges=o;const f=o[l];this.detectEvictedFragments(l,f,u,r)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Jr(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let r=n.length;r--;){const o=t[n[r]];if(o?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,r,o){r&&!this.hasGaps||Object.keys(this.fragments).forEach(l=>{const u=this.fragments[l];if(!u)return;const f=u.body;f.type!==n||r&&!f.gap||f.start<t&&f.end>e&&(u.buffered||o)&&this.removeFragment(f)})}removeFragment(e){const t=Jr(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const r=e.sn;this.activePartLists[e.type]=ME(n,o=>o.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(n=>n.clearElementaryStreamInfo())}}function Fc(s){var e,t,n;return s.buffered&&!!(s.body.gap||(e=s.range.video)!=null&&e.partial||(t=s.range.audio)!=null&&t.partial||(n=s.range.audiovideo)!=null&&n.partial)}function Jr(s){return`${s.type}_${s.level}_${s.sn}`}function ME(s,e){return s.filter(t=>{const n=e(t);return n||t.clearElementaryStreamInfo(),n})}var Ii={cbc:0,ctr:1};class NF{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case Ii.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Ii.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function kF(s){const e=s.byteLength,t=e&&new DataView(s.buffer).getUint8(e-1);return t?s.slice(0,e-t):s}class PF{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(r*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],o=n[1],l=n[2],u=n[3],f=this.invSubMix,d=f[0],m=f[1],g=f[2],y=f[3],x=new Uint32Array(256);let E=0,S=0,b=0;for(b=0;b<256;b++)b<128?x[b]=b<<1:x[b]=b<<1^283;for(b=0;b<256;b++){let R=S^S<<1^S<<2^S<<3^S<<4;R=R>>>8^R&255^99,e[E]=R,t[R]=E;const w=x[E],_=x[w],D=x[_];let M=x[R]*257^R*16843008;r[E]=M<<24|M>>>8,o[E]=M<<16|M>>>16,l[E]=M<<8|M>>>24,u[E]=M,M=D*16843009^_*65537^w*257^E*16843008,d[R]=M<<24|M>>>8,m[R]=M<<16|M>>>16,g[R]=M<<8|M>>>24,y[R]=M,E?(E=w^x[x[x[D^w]]],S^=x[x[S]]):E=S=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const o=this.keySize=t.length;if(o!==4&&o!==6&&o!==8)throw new Error("Invalid aes key size="+o);const l=this.ksRows=(o+6+1)*4;let u,f;const d=this.keySchedule=new Uint32Array(l),m=this.invKeySchedule=new Uint32Array(l),g=this.sBox,y=this.rcon,x=this.invSubMix,E=x[0],S=x[1],b=x[2],R=x[3];let w,_;for(u=0;u<l;u++){if(u<o){w=d[u]=t[u];continue}_=w,u%o===0?(_=_<<8|_>>>24,_=g[_>>>24]<<24|g[_>>>16&255]<<16|g[_>>>8&255]<<8|g[_&255],_^=y[u/o|0]<<24):o>6&&u%o===4&&(_=g[_>>>24]<<24|g[_>>>16&255]<<16|g[_>>>8&255]<<8|g[_&255]),d[u]=w=(d[u-o]^_)>>>0}for(f=0;f<l;f++)u=l-f,f&3?_=d[u]:_=d[u-4],f<4||u<=4?m[f]=_:m[f]=E[g[_>>>24]]^S[g[_>>>16&255]]^b[g[_>>>8&255]]^R[g[_&255]],m[f]=m[f]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,o=this.invKeySchedule,l=this.invSBox,u=this.invSubMix,f=u[0],d=u[1],m=u[2],g=u[3],y=this.uint8ArrayToUint32Array_(n);let x=y[0],E=y[1],S=y[2],b=y[3];const R=new Int32Array(e),w=new Int32Array(R.length);let _,D,M,$,O,k,G,B,K,ne,ue,ee,ae,P;const F=this.networkToHostOrderSwap;for(;t<R.length;){for(K=F(R[t]),ne=F(R[t+1]),ue=F(R[t+2]),ee=F(R[t+3]),O=K^o[0],k=ee^o[1],G=ue^o[2],B=ne^o[3],ae=4,P=1;P<r;P++)_=f[O>>>24]^d[k>>16&255]^m[G>>8&255]^g[B&255]^o[ae],D=f[k>>>24]^d[G>>16&255]^m[B>>8&255]^g[O&255]^o[ae+1],M=f[G>>>24]^d[B>>16&255]^m[O>>8&255]^g[k&255]^o[ae+2],$=f[B>>>24]^d[O>>16&255]^m[k>>8&255]^g[G&255]^o[ae+3],O=_,k=D,G=M,B=$,ae=ae+4;_=l[O>>>24]<<24^l[k>>16&255]<<16^l[G>>8&255]<<8^l[B&255]^o[ae],D=l[k>>>24]<<24^l[G>>16&255]<<16^l[B>>8&255]<<8^l[O&255]^o[ae+1],M=l[G>>>24]<<24^l[B>>16&255]<<16^l[O>>8&255]<<8^l[k&255]^o[ae+2],$=l[B>>>24]<<24^l[O>>16&255]<<16^l[k>>8&255]<<8^l[G&255]^o[ae+3],w[t]=F(_^x),w[t+1]=F($^E),w[t+2]=F(M^S),w[t+3]=F(D^b),x=K,E=ne,S=ue,b=ee,t=t+4}return w.buffer}}class FF{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=UF(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function UF(s){switch(s){case Ii.cbc:return"AES-CBC";case Ii.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${s}`)}}const BF=16;class Hg{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?kF(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,r){return this.useSoftware?new Promise((o,l)=>{const u=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(u,t,n,r);const f=this.flush();f?o(f.buffer):l(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,r)}softwareDecrypt(e,t,n,r){const{currentIV:o,currentResult:l,remainderData:u}=this;if(r!==Ii.cbc||t.byteLength!==16)return qe.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),u&&(e=kn(u,e),this.remainderData=null);const f=this.getValidChunk(e);if(!f.length)return null;o&&(n=o);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new PF),d.expandKey(t);const m=l;return this.currentResult=d.decrypt(f.buffer,0,n),this.currentIV=f.slice(-16).buffer,m||null}webCryptoDecrypt(e,t,n,r){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,r));this.key=t,this.fastAesKey=new FF(this.subtle,t,r)}return this.fastAesKey.expandKey().then(o=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new NF(this.subtle,new Uint8Array(n),r).decrypt(e.buffer,o)):Promise.reject(new Error("web crypto not initialized"))).catch(o=>(qe.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${o.name}: ${o.message}`),this.onWebCryptoError(e,t,n,r)))}onWebCryptoError(e,t,n,r){const o=this.enableSoftwareAES;if(o){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,r);const l=this.flush();if(l)return l.buffer}throw new Error("WebCrypto"+(o?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%BF;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(qe.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const NE=Math.pow(2,17);class $F{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Bs({type:Ee.NETWORK_ERROR,details:X.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,o=r.fLoader,l=r.loader;return new Promise((u,f)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(E=>E[0]==="GAP")){f(PE(e));return}else e.gap=!1;const d=this.loader=o?new o(r):new l(r),m=kE(e);e.loader=d;const g=OE(r.fragLoadPolicy.default),y={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:NE};e.stats=d.stats;const x={onSuccess:(E,S,b,R)=>{this.resetLoader(e,d);let w=E.data;b.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(w.slice(0,16)),w=w.slice(16)),u({frag:e,part:null,payload:w,networkDetails:R})},onError:(E,S,b,R)=>{this.resetLoader(e,d),f(new Bs({type:Ee.NETWORK_ERROR,details:X.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Ye({url:n,data:void 0},E),error:new Error(`HTTP Error ${E.code} ${E.text}`),networkDetails:b,stats:R}))},onAbort:(E,S,b)=>{this.resetLoader(e,d),f(new Bs({type:Ee.NETWORK_ERROR,details:X.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:b,stats:E}))},onTimeout:(E,S,b)=>{this.resetLoader(e,d),f(new Bs({type:Ee.NETWORK_ERROR,details:X.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:b,stats:E}))}};t&&(x.onProgress=(E,S,b,R)=>t({frag:e,part:null,payload:b,networkDetails:R})),d.load(m,y,x)})}loadPart(e,t,n){this.abort();const r=this.config,o=r.fLoader,l=r.loader;return new Promise((u,f)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){f(PE(e,t));return}const d=this.loader=o?new o(r):new l(r),m=kE(e,t);e.loader=d;const g=OE(r.fragLoadPolicy.default),y={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:NE};t.stats=d.stats,d.load(m,y,{onSuccess:(x,E,S,b)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const R={frag:e,part:t,payload:x.data,networkDetails:b};n(R),u(R)},onError:(x,E,S,b)=>{this.resetLoader(e,d),f(new Bs({type:Ee.NETWORK_ERROR,details:X.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Ye({url:m.url,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:S,stats:b}))},onAbort:(x,E,S)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),f(new Bs({type:Ee.NETWORK_ERROR,details:X.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:S,stats:x}))},onTimeout:(x,E,S)=>{this.resetLoader(e,d),f(new Bs({type:Ee.NETWORK_ERROR,details:X.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:S,stats:x}))}})})}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,o=r.total;if(n.loaded+=r.loaded,o){const f=Math.round(e.duration/t.duration),d=Math.min(Math.round(n.loaded/o),f),g=(f-d)*Math.round(n.loaded/d);n.total=n.loaded+g}else n.total=Math.max(n.loaded,n.total);const l=n.loading,u=r.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function kE(s,e=null){const t=e||s,n={frag:s,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,o=t.byteRangeEndOffset;if(me(r)&&me(o)){var l;let u=r,f=o;if(s.sn==="initSegment"&&jF((l=s.decryptdata)==null?void 0:l.method)){const d=o-r;d%16&&(f=o+(16-d%16)),r!==0&&(n.resetIV=!0,u=r-16)}n.rangeStart=u,n.rangeEnd=f}return n}function PE(s,e){const t=new Error(`GAP ${s.gap?"tag":"attribute"} found`),n={type:Ee.MEDIA_ERROR,details:X.FRAG_GAP,fatal:!1,frag:s,error:t,networkDetails:null};return e&&(n.part=e),(e||s).stats.aborted=!0,new Bs(n)}function jF(s){return s==="AES-128"||s==="AES-256"}class Bs extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class vR extends Pn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Vg{constructor(e,t,n,r=0,o=-1,l=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Uc(),this.buffering={audio:Uc(),video:Uc(),audiovideo:Uc()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=o,this.partial=l}}function Uc(){return{start:0,executeStart:0,executeEnd:0,end:0}}const FE={length:0,start:()=>0,end:()=>0};class Ae{static isBuffered(e,t){if(e){const n=Ae.getBuffered(e);for(let r=n.length;r--;)if(t>=n.start(r)&&t<=n.end(r))return!0}return!1}static bufferedRanges(e){if(e){const t=Ae.getBuffered(e);return Ae.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const r=Ae.bufferedRanges(e);if(r.length)return Ae.bufferedInfo(r,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((m,g)=>m.start-g.start||g.end-m.end);let r=-1,o=[];if(n)for(let m=0;m<e.length;m++){t>=e[m].start&&t<=e[m].end&&(r=m);const g=o.length;if(g){const y=o[g-1].end;e[m].start-y<n?e[m].end>y&&(o[g-1].end=e[m].end):o.push(e[m])}else o.push(e[m])}else o=e;let l=0,u,f=t,d=t;for(let m=0;m<o.length;m++){const g=o[m].start,y=o[m].end;if(r===-1&&t>=g&&t<=y&&(r=m),t+n>=g&&t<y)f=g,d=y,l=d-t;else if(t+n<g){u=g;break}}return{len:l,start:f||0,end:d||0,nextStart:u,buffered:e,bufferedIndex:r}}static getBuffered(e){try{return e.buffered||FE}catch(t){return qe.log("failed to get media.buffered",t),FE}}}const xR=/\{\$([a-zA-Z0-9-_]+)\}/g;function UE(s){return xR.test(s)}function Om(s,e){if(s.variableList!==null||s.hasVariableRefs){const t=s.variableList;return e.replace(xR,n=>{const r=n.substring(2,n.length-1),o=t?.[r];return o===void 0?(s.playlistParsingError||(s.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),n):o})}return e}function BE(s,e,t){let n=s.variableList;n||(s.variableList=n={});let r,o;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const l=new self.URL(t).searchParams;if(l.has(r))o=l.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(l){s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${l.message}`))}}else r=e.NAME,o=e.VALUE;r in n?s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):n[r]=o||""}function GF(s,e,t){const n=e.IMPORT;if(t&&n in t){let r=s.variableList;r||(s.variableList=r={}),r[n]=t[n]}else s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const HF=/^(\d+)x(\d+)$/,$E=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ot{constructor(e,t){typeof e=="string"&&(e=ot.parseAttrList(e,t)),Ze(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(r*2,r*2+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((r,o)=>(r[o.toLowerCase()]=!0,r),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=HF.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const r={};for($E.lastIndex=0;(n=$E.exec(e))!==null;){const l=n[1].trim();let u=n[2];const f=u.indexOf('"')===0&&u.lastIndexOf('"')===u.length-1;let d=!1;if(f)u=u.slice(1,-1);else switch(l){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":d=!0}if(t&&(f||d))u=Om(t,u);else if(!d&&!f)switch(l){case"CLOSED-CAPTIONS":if(u==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":qe.warn(`${e}: attribute ${l} is missing quotes`)}r[l]=u}return r}}const VF="com.apple.hls.interstitial";function KF(s){return s!=="ID"&&s!=="CLASS"&&s!=="CUE"&&s!=="START-DATE"&&s!=="DURATION"&&s!=="END-DATE"&&s!=="END-ON-NEXT"}function zF(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"||s==="SCTE35-CMD"}class ER{constructor(e,t,n=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(r=t?.tagOrder)!=null?r:n,t){const o=t.attr;for(const l in o)if(Object.prototype.hasOwnProperty.call(e,l)&&e[l]!==o[l]){qe.warn(`DATERANGE tag attribute: "${l}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=l;break}e=Ze(new ot({}),o,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const o=t?.endDate||new Date(this.attr["END-DATE"]);me(o.getTime())&&(this._endDate=o)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(qe.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(me(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===VF}get isValid(){return!!this.id&&!this._badValueForSameId&&me(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const YF=10;class qF{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let n=t.decryptdata;return n||(t.setKeyFormat(e.keyFormat),n=t.decryptdata),!!n&&e.matches(n)})}get hasProgramDateTime(){return this.fragments.length?me(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||YF}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Au(s,e){return s.length===e.length?!s.some((t,n)=>t!==e[n]):!1}function jE(s,e){return!s&&!e?!0:!s||!e?!1:Au(s,e)}function ma(s){return s==="AES-128"||s==="AES-256"||s==="AES-256-CTR"}function Kg(s){switch(s){case"AES-128":case"AES-256":return Ii.cbc;case"AES-256-CTR":return Ii.ctr;default:throw new Error(`invalid full segment method ${s}`)}}function zg(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0))}function Mm(s){return Uint8Array.from(unescape(encodeURIComponent(s)),e=>e.charCodeAt(0))}function XF(s){const e=Mm(s).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function SR(s){const e=function(n,r,o){const l=n[r];n[r]=n[o],n[o]=l};e(s,0,3),e(s,1,2),e(s,4,5),e(s,6,7)}function TR(s){const e=s.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),r=n[n.length-1].split(",");if(r.length===2){const o=r[0]==="base64",l=r[1];o?(n.splice(-1,1),t=zg(l)):t=XF(l)}}return t}const Ru=typeof self<"u"?self:void 0;var lt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Ut={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function su(s){switch(s){case Ut.FAIRPLAY:return lt.FAIRPLAY;case Ut.PLAYREADY:return lt.PLAYREADY;case Ut.WIDEVINE:return lt.WIDEVINE;case Ut.CLEARKEY:return lt.CLEARKEY}}function Gh(s){switch(s){case lt.FAIRPLAY:return Ut.FAIRPLAY;case lt.PLAYREADY:return Ut.PLAYREADY;case lt.WIDEVINE:return Ut.WIDEVINE;case lt.CLEARKEY:return Ut.CLEARKEY}}function Do(s){const{drmSystems:e,widevineLicenseUrl:t}=s,n=e?[lt.FAIRPLAY,lt.WIDEVINE,lt.PLAYREADY,lt.CLEARKEY].filter(r=>!!e[r]):[];return!n[lt.WIDEVINE]&&t&&n.push(lt.WIDEVINE),n}const bR=(function(s){return Ru!=null&&(s=Ru.navigator)!=null&&s.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function WF(s,e,t,n){let r;switch(s){case lt.FAIRPLAY:r=["cenc","sinf"];break;case lt.WIDEVINE:case lt.PLAYREADY:r=["cenc"];break;case lt.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${s}`)}return QF(r,e,t,n)}function QF(s,e,t,n){return[{initDataTypes:s,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(o=>({contentType:`audio/mp4; codecs=${o}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(o=>({contentType:`video/mp4; codecs=${o}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function ZF(s){var e;return!!s&&(s.sessionType==="persistent-license"||!!((e=s.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function AR(s){const e=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),l=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(l){const u=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(u){const f=zg(u).subarray(0,16);return SR(f),f}}return null}let ea={};class Ci{static clearKeyUriToKeyIdMap(){ea={}}static setKeyIdForUri(e,t){ea[e]=t}static addKeyIdForUri(e){const t=Object.keys(ea).length%Number.MAX_SAFE_INTEGER,n=new Uint8Array(16);return new DataView(n.buffer,12,4).setUint32(0,t),ea[e]=n,n}constructor(e,t,n,r=[1],o=null,l){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=o,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!ma(e),l!=null&&l.startsWith("0x")&&(this.keyId=new Uint8Array(ZA(l)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Au(e.keyFormatVersions,this.keyFormatVersions)&&jE(e.iv,this.iv)&&jE(e.keyId,this.keyId)}isSupported(){if(this.method){if(ma(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Ut.FAIRPLAY:case Ut.WIDEVINE:case Ut.PLAYREADY:case Ut.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(ma(this.method)){let o=this.iv;return o||(typeof e!="number"&&(qe.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),o=eU(e)),new Ci(this.method,this.uri,"identity",this.keyFormatVersions,o)}if(this.keyId){const o=ea[this.uri];if(o&&!Au(this.keyId,o)&&Ci.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const n=TR(this.uri);if(n)switch(this.keyFormat){case Ut.WIDEVINE:if(this.pssh=n,!this.keyId){const o=sF(n.buffer);if(o.length){var r;const l=o[0];this.keyId=(r=l.kids)!=null&&r.length?l.kids[0]:null}}this.keyId||(this.keyId=GE(t));break;case Ut.PLAYREADY:{const o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=nF(o,null,n),this.keyId=AR(n);break}default:{let o=n.subarray(0,16);if(o.length!==16){const l=new Uint8Array(16);l.set(o,16-o.length),o=l}this.keyId=o;break}}if(!this.keyId||this.keyId.byteLength!==16){let o;o=JF(t),o||(o=GE(t),o||(o=ea[this.uri])),o&&(this.keyId=o,Ci.setKeyIdForUri(this.uri,o))}return this}}function JF(s){const e=s?.[Ut.WIDEVINE];return e?e.keyId:null}function GE(s){const e=s?.[Ut.PLAYREADY];if(e){const t=TR(e.uri);if(t)return AR(t)}return null}function eU(s){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=s>>8*(15-t)&255;return e}const HE=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,VE=/#EXT-X-MEDIA:(.*)/g,tU=/^#EXT(?:INF|-X-TARGETDURATION):/m,Hh=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),nU=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ls{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static resolve(e,t){return Fg.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return tU.test(e)}static parseMasterPlaylist(e,t){const n=UE(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},o=[];if(HE.lastIndex=0,!e.startsWith("#EXTM3U"))return r.playlistParsingError=new Error("no EXTM3U delimiter"),r;let l;for(;(l=HE.exec(e))!=null;)if(l[1]){var u;const d=new ot(l[1],r),m=Om(r,l[2]),g={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:ls.resolve(m,t)},y=d.decimalResolution("RESOLUTION");y&&(g.width=y.width,g.height=y.height),YE(d.CODECS,g);const x=d["SUPPLEMENTAL-CODECS"];x&&(g.supplemental={},YE(x,g.supplemental)),(u=g.unknownCodecs)!=null&&u.length||o.push(g),r.levels.push(g)}else if(l[3]){const d=l[3],m=l[4];switch(d){case"SESSION-DATA":{const g=new ot(m,r),y=g["DATA-ID"];y&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[y]=g);break}case"SESSION-KEY":{const g=KE(m,t,r);g.encrypted&&g.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(g)):qe.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${m}"`);break}case"DEFINE":{{const g=new ot(m,r);BE(r,g,t)}break}case"CONTENT-STEERING":{const g=new ot(m,r);r.contentSteering={uri:ls.resolve(g["SERVER-URI"],t),pathwayId:g["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=zE(m);break}}}const f=o.length>0&&o.length<r.levels.length;return r.levels=f?o:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r;const o={},l=n.levels,u={AUDIO:l.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:l.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let f=0;for(VE.lastIndex=0;(r=VE.exec(e))!==null;){const d=new ot(r[1],n),m=d.TYPE;if(m){const g=u[m],y=o[m]||[];o[m]=y;const x=d.LANGUAGE,E=d["ASSOC-LANGUAGE"],S=d.CHANNELS,b=d.CHARACTERISTICS,R=d["INSTREAM-ID"],w={attrs:d,bitrate:0,id:f++,groupId:d["GROUP-ID"]||"",name:d.NAME||x||"",type:m,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:x,url:d.URI?ls.resolve(d.URI,t):""};if(E&&(w.assocLang=E),S&&(w.channels=S),b&&(w.characteristics=b),R&&(w.instreamId=R),g!=null&&g.length){const _=ls.findGroup(g,w.groupId)||g[0];qE(w,_,"audioCodec"),qE(w,_,"textCodec")}y.push(w)}}return o}static parseLevelPlaylist(e,t,n,r,o,l){var u;const f={url:t},d=new qF(t),m=d.fragments,g=[];let y=null,x=0,E=0,S=0,b=0,R=0,w=null,_=new Bh(r,f),D,M,$,O=-1,k=!1,G=null,B;if(Hh.lastIndex=0,d.m3u8=e,d.hasVariableRefs=UE(e),((u=Hh.exec(e))==null?void 0:u[0])!=="#EXTM3U")return d.playlistParsingError=new Error("Missing format identifier #EXTM3U"),d;for(;(D=Hh.exec(e))!==null;){k&&(k=!1,_=new Bh(r,f),_.playlistOffset=S,_.setStart(S),_.sn=x,_.cc=b,R&&(_.bitrate=R),_.level=n,y&&(_.initSegment=y,y.rawProgramDateTime&&(_.rawProgramDateTime=y.rawProgramDateTime,y.rawProgramDateTime=null),G&&(_.setByteRange(G),G=null)));const ee=D[1];if(ee){_.duration=parseFloat(ee);const ae=(" "+D[2]).slice(1);_.title=ae||null,_.tagList.push(ae?["INF",ee,ae]:["INF",ee])}else if(D[3]){if(me(_.duration)){_.playlistOffset=S,_.setStart(S),$&&WE(_,$,d),_.sn=x,_.level=n,_.cc=b,m.push(_);const ae=(" "+D[3]).slice(1);_.relurl=Om(d,ae),Nm(_,w,g),w=_,S+=_.duration,x++,E=0,k=!0}}else{if(D=D[0].match(nU),!D){qe.warn("No matches on slow regex match for level playlist!");continue}for(M=1;M<D.length&&D[M]===void 0;M++);const ae=(" "+D[M]).slice(1),P=(" "+D[M+1]).slice(1),F=D[M+2]?(" "+D[M+2]).slice(1):null;switch(ae){case"BYTERANGE":w?_.setByteRange(P,w):_.setByteRange(P);break;case"PROGRAM-DATE-TIME":_.rawProgramDateTime=P,_.tagList.push(["PROGRAM-DATE-TIME",P]),O===-1&&(O=m.length);break;case"PLAYLIST-TYPE":d.type&&Fs(d,ae,D),d.type=P.toUpperCase();break;case"MEDIA-SEQUENCE":d.startSN!==0?Fs(d,ae,D):m.length>0&&QE(d,ae,D),x=d.startSN=parseInt(P);break;case"SKIP":{d.skippedSegments&&Fs(d,ae,D);const U=new ot(P,d),Y=U.decimalInteger("SKIPPED-SEGMENTS");if(me(Y)){d.skippedSegments+=Y;for(let N=Y;N--;)m.push(null);x+=Y}const le=U.enumeratedString("RECENTLY-REMOVED-DATERANGES");le&&(d.recentlyRemovedDateranges=(d.recentlyRemovedDateranges||[]).concat(le.split("	")));break}case"TARGETDURATION":d.targetduration!==0&&Fs(d,ae,D),d.targetduration=Math.max(parseInt(P),1);break;case"VERSION":d.version!==null&&Fs(d,ae,D),d.version=parseInt(P);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":d.live||Fs(d,ae,D),d.live=!1;break;case"#":(P||F)&&_.tagList.push(F?[P,F]:[P]);break;case"DISCONTINUITY":b++,_.tagList.push(["DIS"]);break;case"GAP":_.gap=!0,_.tagList.push([ae]);break;case"BITRATE":_.tagList.push([ae,P]),R=parseInt(P)*1e3,me(R)?_.bitrate=R:R=0;break;case"DATERANGE":{const U=new ot(P,d),Y=new ER(U,d.dateRanges[U.ID],d.dateRangeTagCount);d.dateRangeTagCount++,Y.isValid||d.skippedSegments?d.dateRanges[Y.id]=Y:qe.warn(`Ignoring invalid DATERANGE tag: "${P}"`),_.tagList.push(["EXT-X-DATERANGE",P]);break}case"DEFINE":{{const U=new ot(P,d);"IMPORT"in U?GF(d,U,l):BE(d,U,t)}break}case"DISCONTINUITY-SEQUENCE":d.startCC!==0?Fs(d,ae,D):m.length>0&&QE(d,ae,D),d.startCC=b=parseInt(P);break;case"KEY":{const U=KE(P,t,d);if(U.isSupported()){if(U.method==="NONE"){$=void 0;break}$||($={});const Y=$[U.keyFormat];Y!=null&&Y.matches(U)||(Y&&($=Ze({},$)),$[U.keyFormat]=U)}else qe.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${P}"`);break}case"START":d.startTimeOffset=zE(P);break;case"MAP":{const U=new ot(P,d);if(_.duration){const Y=new Bh(r,f);XE(Y,U,n,$),y=Y,_.initSegment=y,y.rawProgramDateTime&&!_.rawProgramDateTime&&(_.rawProgramDateTime=y.rawProgramDateTime)}else{const Y=_.byteRangeEndOffset;if(Y){const le=_.byteRangeStartOffset;G=`${Y-le}@${le}`}else G=null;XE(_,U,n,$),y=_,k=!0}y.cc=b;break}case"SERVER-CONTROL":{B&&Fs(d,ae,D),B=new ot(P),d.canBlockReload=B.bool("CAN-BLOCK-RELOAD"),d.canSkipUntil=B.optionalFloat("CAN-SKIP-UNTIL",0),d.canSkipDateRanges=d.canSkipUntil>0&&B.bool("CAN-SKIP-DATERANGES"),d.partHoldBack=B.optionalFloat("PART-HOLD-BACK",0),d.holdBack=B.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{d.partTarget&&Fs(d,ae,D);const U=new ot(P);d.partTarget=U.decimalFloatingPoint("PART-TARGET");break}case"PART":{let U=d.partList;U||(U=d.partList=[]);const Y=E>0?U[U.length-1]:void 0,le=E++,N=new ot(P,d),H=new G2(N,_,f,le,Y);U.push(H),_.duration+=H.duration;break}case"PRELOAD-HINT":{const U=new ot(P,d);d.preloadHint=U;break}case"RENDITION-REPORT":{const U=new ot(P,d);d.renditionReports=d.renditionReports||[],d.renditionReports.push(U);break}default:qe.warn(`line parsed but not handled: ${D}`);break}}}w&&!w.relurl?(m.pop(),S-=w.duration,d.partList&&(d.fragmentHint=w)):d.partList&&(Nm(_,w,g),_.cc=b,d.fragmentHint=_,$&&WE(_,$,d)),d.targetduration||(d.playlistParsingError=new Error("Missing Target Duration"));const K=m.length,ne=m[0],ue=m[K-1];if(S+=d.skippedSegments*d.targetduration,S>0&&K&&ue){d.averagetargetduration=S/K;const ee=ue.sn;d.endSN=ee!=="initSegment"?ee:0,d.live||(ue.endList=!0),O>0&&(iU(m,O),ne&&g.unshift(ne))}return d.fragmentHint&&(S+=d.fragmentHint.duration),d.totalduration=S,g.length&&d.dateRangeTagCount&&ne&&RR(g,d),d.endCC=b,d}}function RR(s,e){let t=s.length;if(!t)if(e.hasProgramDateTime){const u=e.fragments[e.fragments.length-1];s.push(u),t++}else return;const n=s[t-1],r=e.live?1/0:e.totalduration,o=Object.keys(e.dateRanges);for(let u=o.length;u--;){const f=e.dateRanges[o[u]],d=f.startDate.getTime();f.tagAnchor=n.ref;for(let m=t;m--;){var l;if(((l=s[m])==null?void 0:l.sn)<e.startSN)break;const g=sU(e,d,s,m,r);if(g!==-1){f.tagAnchor=e.fragments[g].ref;break}}}}function sU(s,e,t,n,r){const o=t[n];if(o){const u=o.programDateTime;if(e>=u||n===0){var l;const f=(((l=t[n+1])==null?void 0:l.start)||r)-o.start;if(e<=u+f*1e3){const d=t[n].sn-s.startSN;if(d<0)return-1;const m=s.fragments;if(m.length>t.length){const y=(t[n+1]||m[m.length-1]).sn-s.startSN;for(let x=y;x>d;x--){const E=m[x].programDateTime;if(e>=E&&e<E+m[x].duration*1e3)return x}}return d}}}return-1}function KE(s,e,t){var n,r;const o=new ot(s,t),l=(n=o.METHOD)!=null?n:"",u=o.URI,f=o.hexadecimalInteger("IV"),d=o.KEYFORMATVERSIONS,m=(r=o.KEYFORMAT)!=null?r:"identity";u&&o.IV&&!f&&qe.error(`Invalid IV: ${o.IV}`);const g=u?ls.resolve(u,e):"",y=(d||"1").split("/").map(Number).filter(Number.isFinite);return new Ci(l,g,m,y,f,o.KEYID)}function zE(s){const t=new ot(s).decimalFloatingPoint("TIME-OFFSET");return me(t)?t:null}function YE(s,e){let t=(s||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const r=t.filter(o=>$g(o,n));r.length&&(e[`${n}Codec`]=r.map(o=>o.split("/")[0]).join(","),t=t.filter(o=>r.indexOf(o)===-1))}),e.unknownCodecs=t}function qE(s,e,t){const n=e[t];n&&(s[t]=n)}function iU(s,e){let t=s[e];for(let n=e;n--;){const r=s[n];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function Nm(s,e,t){s.rawProgramDateTime?t.push(s):e!=null&&e.programDateTime&&(s.programDateTime=e.endProgramDateTime)}function XE(s,e,t,n){s.relurl=e.URI,e.BYTERANGE&&s.setByteRange(e.BYTERANGE),s.level=t,s.sn="initSegment",n&&(s.levelkeys=n),s.initSegment=null}function WE(s,e,t){s.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&n.push(s)}function Fs(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function QE(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Vh(s,e){const t=e.startPTS;if(me(t)){let n=0,r;e.sn>s.sn?(n=t-s.start,r=s):(n=s.start-t,r=e),r.duration!==n&&r.setDuration(n)}else e.sn>s.sn?s.cc===e.cc&&s.minEndPTS?e.setStart(s.start+(s.minEndPTS-s.start)):e.setStart(s.start+s.duration):e.setStart(Math.max(s.start-e.duration,0))}function LR(s,e,t,n,r,o,l){n-t<=0&&(l.warn("Fragment should have a positive duration",e),n=t+e.duration,o=r+e.duration);let f=t,d=n;const m=e.startPTS,g=e.endPTS;if(me(m)){const R=Math.abs(m-t);s&&R>s.totalduration?l.warn(`media timestamps and playlist times differ by ${R}s for level ${e.level} ${s.url}`):me(e.deltaPTS)?e.deltaPTS=Math.max(R,e.deltaPTS):e.deltaPTS=R,f=Math.max(t,m),t=Math.min(t,m),r=e.startDTS!==void 0?Math.min(r,e.startDTS):r,d=Math.min(n,g),n=Math.max(n,g),o=e.endDTS!==void 0?Math.max(o,e.endDTS):o}const y=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(n-e.start),e.startPTS=t,e.maxStartPTS=f,e.startDTS=r,e.endPTS=n,e.minEndPTS=d,e.endDTS=o;const x=e.sn;if(!s||x<s.startSN||x>s.endSN)return 0;let E;const S=x-s.startSN,b=s.fragments;for(b[S]=e,E=S;E>0;E--)Vh(b[E],b[E-1]);for(E=S;E<b.length-1;E++)Vh(b[E],b[E+1]);return s.fragmentHint&&Vh(b[b.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,y}function rU(s,e,t){if(s===e)return;let n=null;const r=s.fragments;for(let m=r.length-1;m>=0;m--){const g=r[m].initSegment;if(g){n=g;break}}s.fragmentHint&&delete s.fragmentHint.endPTS;let o;lU(s,e,(m,g,y,x)=>{if((!e.startCC||e.skippedSegments)&&g.cc!==m.cc){const E=m.cc-g.cc;for(let S=y;S<x.length;S++)x[S].cc+=E;e.endCC=x[x.length-1].cc}me(m.startPTS)&&me(m.endPTS)&&(g.setStart(g.startPTS=m.startPTS),g.startDTS=m.startDTS,g.maxStartPTS=m.maxStartPTS,g.endPTS=m.endPTS,g.endDTS=m.endDTS,g.minEndPTS=m.minEndPTS,g.setDuration(m.endPTS-m.startPTS),g.duration&&(o=g),e.PTSKnown=e.alignedSliding=!0),m.hasStreams&&(g.elementaryStreams=m.elementaryStreams),g.loader=m.loader,m.hasStats&&(g.stats=m.stats),m.initSegment&&(g.initSegment=m.initSegment,n=m.initSegment)});const l=e.fragments,u=e.fragmentHint?l.concat(e.fragmentHint):l;if(n&&u.forEach(m=>{var g;m&&(!m.initSegment||m.initSegment.relurl===((g=n)==null?void 0:g.relurl))&&(m.initSegment=n)}),e.skippedSegments){if(e.deltaUpdateFailed=l.some(m=>!m),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let m=e.skippedSegments;m--;)l.shift();e.startSN=l[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=aU(s.dateRanges,e,t));const m=s.fragments.filter(g=>g.rawProgramDateTime);if(s.hasProgramDateTime&&!e.hasProgramDateTime)for(let g=1;g<u.length;g++)u[g].programDateTime===null&&Nm(u[g],u[g-1],m);RR(m,e)}e.endCC=l[l.length-1].cc}if(!e.startCC){var f;const m=wR(s,e.startSN-1);e.startCC=(f=m?.cc)!=null?f:l[0].cc}oU(s.partList,e.partList,(m,g)=>{g.elementaryStreams=m.elementaryStreams,g.stats=m.stats}),o?LR(e,o,o.startPTS,o.endPTS,o.startDTS,o.endDTS,t):CR(s,e),l.length&&(e.totalduration=e.edge-l[0].start),e.driftStartTime=s.driftStartTime,e.driftStart=s.driftStart;const d=e.advancedDateTime;if(e.advanced&&d){const m=e.edge;e.driftStart||(e.driftStartTime=d,e.driftStart=m),e.driftEndTime=d,e.driftEnd=m}else e.driftEndTime=s.driftEndTime,e.driftEnd=s.driftEnd,e.advancedDateTime=s.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=s.requestScheduled)}function aU(s,e,t){const{dateRanges:n,recentlyRemovedDateranges:r}=e,o=Ze({},s);r&&r.forEach(f=>{delete o[f]});const u=Object.keys(o).length;return u?(Object.keys(n).forEach(f=>{const d=o[f],m=new ER(n[f].attr,d);m.isValid?(o[f]=m,d||(m.tagOrder+=u)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${tt(n[f].attr)}"`)}),o):n}function oU(s,e,t){if(s&&e){let n=0;for(let r=0,o=s.length;r<=o;r++){const l=s[r],u=e[r+n];l&&u&&l.index===u.index&&l.fragment.sn===u.fragment.sn?t(l,u):n--}}}function lU(s,e,t){const n=e.skippedSegments,r=Math.max(s.startSN,e.startSN)-e.startSN,o=(s.fragmentHint?1:0)+(n?e.endSN:Math.min(s.endSN,e.endSN))-e.startSN,l=e.startSN-s.startSN,u=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,f=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;for(let d=r;d<=o;d++){const m=f[l+d];let g=u[d];if(n&&!g&&m&&(g=e.fragments[d]=m),m&&g){t(m,g,d,u);const y=m.relurl,x=g.relurl;if(y&&cU(y,x)){e.playlistParsingError=ZE(`media sequence mismatch ${g.sn}:`,s,e,m,g);return}else if(m.cc!==g.cc){e.playlistParsingError=ZE(`discontinuity sequence mismatch (${m.cc}!=${g.cc})`,s,e,m,g);return}}}}function ZE(s,e,t,n,r){return new Error(`${s} ${r.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function CR(s,e,t=!0){const n=e.startSN+e.skippedSegments-s.startSN,r=s.fragments,o=n>=0;let l=0;if(o&&n<r.length)l=r[n].start;else if(o&&e.startSN===s.endSN+1)l=s.fragmentEnd;else if(o&&t)l=s.fragmentStart+n*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)l=s.fragmentStart;else return;km(e,l)}function km(s,e){if(e){const t=s.fragments;for(let n=s.skippedSegments;n<t.length;n++)t[n].addStart(e);s.fragmentHint&&s.fragmentHint.addStart(e)}}function _R(s,e=1/0){let t=1e3*s.targetduration;if(s.updated){const n=s.fragments;if(n.length&&t*4>e){const o=n[n.length-1].duration*1e3;o<t&&(t=o)}}else t/=2;return Math.round(t)}function wR(s,e,t){if(!s)return null;let n=s.fragments[e-s.startSN];return n||(n=s.fragmentHint,n&&n.sn===e)?n:e<s.startSN&&t&&t.sn===e?t:null}function JE(s,e,t){return s?DR(s.partList,e,t):null}function DR(s,e,t){if(s)for(let n=s.length;n--;){const r=s[n];if(r.index===t&&r.fragment.sn===e)return r}return null}function IR(s){s.forEach((e,t)=>{var n;(n=e.details)==null||n.fragments.forEach(r=>{r.level=t,r.initSegment&&(r.initSegment.level=t)})})}function cU(s,e){return s!==e&&e?eS(s)!==eS(e):!1}function eS(s){return s.replace(/\?[^?]*$/,"")}function Mo(s,e){for(let n=0,r=s.length;n<r;n++){var t;if(((t=s[n])==null?void 0:t.cc)===e)return s[n]}return null}function uU(s,e){return!!(s&&e.startCC<s.endCC&&e.endCC>s.startCC)}function tS(s,e){const t=s.start+e;s.startPTS=t,s.setStart(t),s.endPTS=t+s.duration}function OR(s,e){const t=e.fragments;for(let n=0,r=t.length;n<r;n++)tS(t[n],s);e.fragmentHint&&tS(e.fragmentHint,s),e.alignedSliding=!0}function dU(s,e){s&&(MR(e,s),e.alignedSliding||Lu(e,s),!e.alignedSliding&&!e.skippedSegments&&CR(s,e,!1))}function MR(s,e){if(!uU(e,s))return;const t=Math.min(e.endCC,s.endCC),n=Mo(e.fragments,t),r=Mo(s.fragments,t);if(!n||!r)return;qe.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const o=n.start-r.start;OR(o,s)}function Lu(s,e){if(!s.hasProgramDateTime||!e.hasProgramDateTime)return;const t=s.fragments,n=e.fragments;if(!t.length||!n.length)return;let r,o;const l=Math.min(e.endCC,s.endCC);e.startCC<l&&s.startCC<l&&(r=Mo(n,l),o=Mo(t,l)),(!r||!o)&&(r=n[Math.floor(n.length/2)],o=Mo(t,r.cc)||t[Math.floor(t.length/2)]);const u=r.programDateTime,f=o.programDateTime;if(!u||!f)return;const d=(f-u)/1e3-(o.start-r.start);OR(d,s)}function zt(s,e,t){rn(s,e,t),s.addEventListener(e,t)}function rn(s,e,t){s.removeEventListener(e,t)}const fU={toString:function(s){let e="";const t=s.length;for(let n=0;n<t;n++)e+=`[${s.start(n).toFixed(3)}-${s.end(n).toFixed(3)}]`;return e}},re={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Yg extends vR{constructor(e,t,n,r,o){super(r,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=re.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:l,fragCurrent:u,media:f,mediaBuffer:d,state:m}=this,g=f?f.currentTime:0,y=Ae.bufferInfo(d||f,g,l.maxBufferHole),x=!y.len;if(this.log(`Media seeking to ${me(g)?g.toFixed(3):g}, state: ${m}, ${x?"out of":"in"} buffer`),this.state===re.ENDED)this.resetLoadingState();else if(u){const E=l.maxFragLookUpTolerance,S=u.start-E,b=u.start+u.duration+E;if(x||b<y.start||S>y.end){const R=g>b;(g<S||R)&&(R&&u.loader&&(this.log(`Cancelling fragment load for seek (sn: ${u.sn})`),u.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(f){this.fragmentTracker.removeFragmentsInRange(g,1/0,this.playlistType,!0);const E=this.lastCurrentTime;if(g>E&&(this.lastCurrentTime=g),!this.loadingParts){const S=Math.max(y.end,g),b=this.shouldLoadParts(this.getLevelDetails(),S);b&&(this.log(`LL-Part loading ON after seeking to ${g.toFixed(2)} with buffer @${S.toFixed(2)}`),this.loadingParts=b)}}this.hls.hasEnoughToStart||(this.log(`Setting ${x?"startPosition":"nextLoadPosition"} to ${g} for seek without enough to start`),this.nextLoadPosition=g,x&&(this.startPosition=g)),x&&this.state===re.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=o,this.hls=e,this.fragmentLoader=new $F(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Hg(e.config)}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===re.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=re.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,r=this.config.timelineOffset||0;if(n<=r)return!1;const o=e.buffered;this.config.maxBufferHole&&o&&o.length>1&&(e=Ae.bufferedInfo(o,e.start,0));const l=e.nextStart;if(l&&l>r&&l<t.edge||this.media.currentTime<e.start)return!1;const f=t.partList;if(f!=null&&f.length){const m=f[f.length-1];return Ae.isBuffered(this.media,m.start+m.duration/2)}const d=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(d)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;zt(n,"seeking",this.onMediaSeeking),zt(n,"ended",this.onMediaEnded);const r=this.config;this.levels&&r.autoStartLoad&&this.state===re.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,r=this.media;if(r!==null){if(r.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),rn(r,"seeking",this.onMediaSeeking),rn(r,"ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=re.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const r=o=>{const l=o.frag;if(this.fragContextChanged(l)){this.warn(`${l.type} sn: ${l.sn}${o.part?" part: "+o.part.index:""} of ${this.fragInfo(l,!1,o.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(l);return}l.stats.chunkCount++,this._handleFragmentLoadProgress(o)};this._doFragLoad(e,t,n,r).then(o=>{if(!o)return;const l=this.state,u=o.frag;if(this.fragContextChanged(u)){(l===re.FRAG_LOADING||!this.fragCurrent&&l===re.PARSING)&&(this.fragmentTracker.removeFragment(u),this.state=re.IDLE);return}"payload"in o&&(this.log(`Loaded ${u.type} sn: ${u.sn} of ${this.playlistLabel()} ${u.level}`),this.hls.trigger(C.FRAG_LOADED,o)),this._handleFragmentLoadComplete(o)}).catch(o=>{this.state===re.STOPPED||this.state===re.ERROR||(this.warn(`Frag error: ${o?.message||o}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===At.APPENDING){const o=e.type,l=this.getFwdBufferInfo(this.mediaBuffer,o),u=Math.max(e.duration,l?l.len:this.config.maxBufferLength),f=this.backtrackFragment;((f?e.sn-f.sn:0)===1||this.reduceMaxBufferLength(u,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===At.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:n};this.hls.trigger(C.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{const r=n?.frag;if(!r||this.fragContextChanged(r)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:r}=this,{frag:o,payload:l}=n,u=o.decryptdata;if(l&&l.byteLength>0&&u!=null&&u.key&&u.iv&&ma(u.method)){const f=self.performance.now();return this.decrypter.decrypt(new Uint8Array(l),u.key.buffer,u.iv.buffer,Kg(u.method)).catch(d=>{throw r.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:o}),d}).then(d=>{const m=self.performance.now();return r.trigger(C.FRAG_DECRYPTED,{frag:o,payload:d,stats:{tstart:f,tdecrypt:m}}),n.payload=d,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===re.STOPPED||this.state===re.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==re.STOPPED&&(this.state=re.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var n,r;const o=e.tracks;if(o&&!t.encrypted&&((n=o.audio)!=null&&n.encrypted||(r=o.video)!=null&&r.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const l=this.media,u=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${l?"attached mediaKeys: "+l.mediaKeys:"detached"})`);return this.warn(u.message),!l||l.mediaKeys?!1:(this.hls.trigger(C.ERROR,{type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_KEYS,fatal:!1,error:u,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?fU.toString(Ae.getBuffered(n)):"(detached)"})`),gt(e)){var r;if(e.type!==ge.SUBTITLE){const l=e.elementaryStreams;if(!Object.keys(l).some(u=>!!l[u])){this.state=re.IDLE;return}}const o=(r=this.levels)==null?void 0:r[e.level];o!=null&&o.fragmentError&&(this.log(`Resetting level fragment error count of ${o.fragmentError} on frag buffered`),o.fragmentError=0)}this.state=re.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:o}=e,l=!o||o.length===0||o.some(f=>!f),u=new Vg(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!l);t.flush(u)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var o;this.fragCurrent=e;const l=t.details;if(!this.levels||!l)throw new Error(`frag load aborted, missing level${l?"":" detail"}s`);let u=null;if(e.encrypted&&!((o=e.decryptdata)!=null&&o.key)){if(this.log(`Loading key for ${e.sn} of [${l.startSN}-${l.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=re.KEY_LOADING,this.fragCurrent=e,u=this.keyLoader.load(e).then(y=>{if(!this.fragContextChanged(y.frag))return this.hls.trigger(C.KEY_LOADED,y),this.state===re.KEY_LOADING&&(this.state=re.IDLE),y}),this.hls.trigger(C.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(u=this.keyLoader.loadClear(e,l.encryptedFragments,this.startFragRequested),u&&this.log("[eme] blocking frag load until media-keys acquired"));const f=this.fragPrevious;if(gt(e)&&(!f||e.sn!==f.sn)){const y=this.shouldLoadParts(t.details,e.end);y!==this.loadingParts&&(this.log(`LL-Part loading ${y?"ON":"OFF"} loading sn ${f?.sn}->${e.sn}`),this.loadingParts=y)}if(n=Math.max(e.start,n||0),this.loadingParts&&gt(e)){const y=l.partList;if(y&&r){n>l.fragmentEnd&&l.fragmentHint&&(e=l.fragmentHint);const x=this.getNextPart(y,e,n);if(x>-1){const E=y[x];e=this.fragCurrent=E.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${E.index} (${x}/${y.length-1}) of ${this.fragInfo(e,!1,E)}) cc: ${e.cc} [${l.startSN}-${l.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=E.start+E.duration,this.state=re.FRAG_LOADING;let S;return u?S=u.then(b=>!b||this.fragContextChanged(b.frag)?null:this.doFragPartsLoad(e,E,t,r)).catch(b=>this.handleFragLoadError(b)):S=this.doFragPartsLoad(e,E,t,r).catch(b=>this.handleFragLoadError(b)),this.hls.trigger(C.FRAG_LOADING,{frag:e,part:E,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):S}else if(!e.url||this.loadedEndOfParts(y,n))return Promise.resolve(null)}}if(gt(e)&&this.loadingParts){var d;this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(d=l.partList)==null?void 0:d.filter(y=>y.loaded).map(y=>`[${y.start}-${y.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+l.startSN+"-"+l.endSN+"]"}, target: ${parseFloat(n.toFixed(3))}`),me(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=re.FRAG_LOADING;const m=this.config.progressive&&e.type!==ge.SUBTITLE;let g;return m&&u?g=u.then(y=>!y||this.fragContextChanged(y.frag)?null:this.fragmentLoader.load(e,r)).catch(y=>this.handleFragLoadError(y)):g=Promise.all([this.fragmentLoader.load(e,m?r:void 0),u]).then(([y])=>(!m&&r&&r(y),y)).catch(y=>this.handleFragLoadError(y)),this.hls.trigger(C.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):g}doFragPartsLoad(e,t,n,r){return new Promise((o,l)=>{var u;const f=[],d=(u=n.details)==null?void 0:u.partList,m=g=>{this.fragmentLoader.loadPart(e,g,r).then(y=>{f[g.index]=y;const x=y.part;this.hls.trigger(C.FRAG_LOADED,y);const E=JE(n.details,e.sn,g.index+1)||DR(d,e.sn,g.index+1);if(E)m(E);else return o({frag:e,part:x,partsLoaded:f})}).catch(l)};m(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===X.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Ee.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(C.ERROR,t)}else this.hls.trigger(C.ERROR,{type:Ee.OTHER_ERROR,details:X.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==re.PARSING){!this.fragCurrent&&this.state!==re.STOPPED&&this.state!==re.ERROR&&(this.state=re.IDLE);return}const{frag:n,part:r,level:o}=t,l=self.performance.now();n.stats.parsing.end=l,r&&(r.stats.parsing.end=l);const u=this.getLevelDetails(),d=u&&n.sn>u.endSN||this.shouldLoadParts(u,n.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=d),this.updateLevelTiming(n,r,o,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var n;const o=e.partList[0];if(o.fragment.type===ge.SUBTITLE)return!1;const l=o.end+(((n=e.fragmentHint)==null?void 0:n.duration)||0);if(t>=l){var r;if((this.hls.hasEnoughToStart?((r=this.media)==null?void 0:r.currentTime)||this.lastCurrentTime:this.getLoadPosition())>o.start-o.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:o,part:l}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${o} of ${this.playlistLabel()} ${r}. The current chunk will not be buffered.`),null;const u=t[r],f=u.details,d=l>-1?JE(f,o,l):null,m=d?d.fragment:wR(f,o,n);return m?(n&&n!==m&&(m.stats=n.stats),{frag:m,part:d,level:u}):null}bufferFragmentData(e,t,n,r,o){if(this.state!==re.PARSING)return;const{data1:l,data2:u}=e;let f=l;if(u&&(f=kn(l,u)),!f.length)return;const d=this.initPTS[t.cc],m=d?-d.baseTime/d.timescale:void 0,g={type:e.type,frag:t,part:n,chunkMeta:r,offset:m,parent:t.type,data:f};if(this.hls.trigger(C.BUFFER_APPENDING,g),e.dropped&&e.independent&&!n){if(o)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Ae.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,r=Ae.bufferInfo(t,n,0),o=e.duration,l=Math.min(this.config.maxFragLookUpTolerance*2,o*.25),u=Math.max(Math.min(e.start-l,r.end-l),n+l);e.start-u>l&&this.flushMainBuffer(u,e.start)}getFwdBufferInfo(e,t){var n;const r=this.getLoadPosition();if(!me(r))return null;const l=this.lastCurrentTime>r||(n=this.media)!=null&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,r,t,l)}getFwdBufferInfoAtPos(e,t,n,r){const o=Ae.bufferInfo(e,t,r);if(o.len===0&&o.nextStart!==void 0){const l=this.fragmentTracker.getBufferedFrag(t,n);if(l&&(o.nextStart<=l.end||l.gap)){const u=Math.max(Math.min(o.nextStart,l.end)-t,r);return Ae.bufferInfo(e,t,u)}}return o}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,r=Math.max(Math.min(e-t,n.maxBufferLength),t),o=Math.max(e-t*3,n.maxMaxBufferLength/2,r);return o>=r?(n.maxMaxBufferLength=o,this.warn(`Reduce max buffer length to ${o}s`),!0):!1}getAppendedFrag(e,t=ge.MAIN){const n=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:o}=this,l=n[0].start,u=o.lowLatencyMode&&!!t.partList;let f=null;if(t.live){const g=o.initialLiveManifestSize;if(r<g)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${g})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<l){var d;u&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),f=this.getInitialLiveFragment(t);const y=this.hls.startPosition,x=this.hls.liveSyncPosition,E=f?(y!==-1&&y>=l?y:x)||f.start:e;this.log(`Setting startPosition to ${E} to match start frag at live edge. mainStart: ${y} liveSyncPosition: ${x} frag.start: ${(d=f)==null?void 0:d.start}`),this.startPosition=this.nextLoadPosition=E}}else e<=l&&(f=n[0]);if(!f){const g=this.loadingParts?t.partEnd:t.fragmentEnd;f=this.getFragmentAtPosition(e,g,t)}let m=this.filterReplacedPrimary(f,t);if(!m&&f){const g=f.sn-t.startSN;m=this.filterReplacedPrimary(n[g+1]||null,t)}return this.mapToInitFragWhenRequired(m)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===At.OK||n===At.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,o){let l=null;if(e.gap&&(l=this.getNextFragment(this.nextLoadPosition,t),l&&!l.gap&&n.nextStart)){const u=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r,0);if(u!==null&&n.len+u.len>=o){const f=l.sn;return this.loopSn!==f&&(this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${f}`),this.loopSn=f),null}}return this.loopSn=void 0,l}get primaryPrefetch(){if(nS(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(nS(this.config)&&e.type!==ge.SUBTITLE){const n=this.hls.interstitialsManager,r=n?.bufferingItem;if(r){const l=r.event;if(l){if(l.appendInPlace||Math.abs(e.start-r.start)>1||r.start===0)return null}else if(e.end<=r.start&&t?.live===!1||e.start>r.end&&r.nextEvent&&(r.nextEvent.appendInPlace||e.start-r.end>1))return null}const o=n?.playerQueue;if(o)for(let l=o.length;l--;){const u=o[l].interstitial;if(u.appendInPlace&&e.start>=u.startTime&&e.end<=u.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let r=-1,o=!1,l=!0;for(let u=0,f=e.length;u<f;u++){const d=e[u];if(l=l&&!d.independent,r>-1&&n<d.start)break;const m=d.loaded;m?r=-1:(o||(d.independent||l)&&d.fragment===t)&&(d.fragment!==t&&this.warn(`Need buffer at ${n} but next unloaded part starts at ${d.start}`),r=u),o=m}return r}loadedEndOfParts(e,t){let n;for(let r=e.length;r--;){if(n=e[r],!n.loaded)return!1;if(t>n.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=_F(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const o=n.sn+1;if(o>=e.startSN&&o<=e.endSN){const l=t[o-e.startSN];n.cc===l.cc&&(r=l,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=gR(e,n.cc,n.end),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const o=this.hls.liveSyncPosition;o!==null&&(r=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:o}=this,{fragments:l,endSN:u}=n;const{fragmentHint:f}=n,{maxFragLookUpTolerance:d}=r,m=n.partList,g=!!(this.loadingParts&&m!=null&&m.length&&f);g&&!this.bitrateTest&&m[m.length-1].fragment.sn===f.sn&&(l=l.concat(f),u=f.sn);let y;if(e<t){var x;const S=e<this.lastCurrentTime||e>t-d||(x=this.media)!=null&&x.paused||!this.startFragRequested?0:d;y=sr(o,l,e,S)}else y=l[l.length-1];if(y){const E=y.sn-n.startSN,S=this.fragmentTracker.getState(y);if((S===At.OK||S===At.PARTIAL&&y.gap)&&(o=y),o&&y.sn===o.sn&&(!g||m[0].fragment.sn>y.sn||!n.live)&&y.level===o.level){const R=l[E+1];y.sn<u&&this.fragmentTracker.getState(R)!==At.OK?y=R:y=null}}return y}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const o=e.fragmentStart,l=!t,u=e.alignedSliding&&me(o);if(l||!u&&!o){dU(n,e);const f=e.fragmentStart;return this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${r}`),f}return o}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const r=this.timelineOffset;if(n===-1){const o=this.startTimeOffset!==null,l=o?this.startTimeOffset:e.startTimeOffset;l!==null&&me(l)?(n=t+l,l<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${l} found in ${o?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+r}this.nextLoadPosition=n+r}getLoadPosition(){var e;const{media:t}=this;let n=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&gt(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==re.FRAG_LOADING_WAITING_RETRY)&&(this.state=re.IDLE)}onFragmentOrKeyLoadError(e,t){var n;if(t.chunkMeta&&!t.frag){const R=this.getCurrentContext(t.chunkMeta);R&&(t.frag=R.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var o;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(o=this.fragCurrent)==null?void 0:o.url}`);return}const l=t.details===X.FRAG_GAP;l&&this.fragmentTracker.fragBuffered(r,!0);const u=t.errorAction;if(!u){this.state=re.ERROR;return}const{action:f,flags:d,retryCount:m=0,retryConfig:g}=u,y=!!g,x=y&&f===Pt.RetryRequest,E=y&&!u.resolved&&d===pn.MoveAllAlternatesMatchingHost,S=(n=this.hls.latestLevelDetails)==null?void 0:n.live;if(!x&&E&&gt(r)&&!r.endList&&S&&!yR(t))this.resetFragmentErrors(e),this.treatAsGap(r),u.resolved=!0;else if((x||E)&&m<g.maxNumRetry){var b;const R=Im((b=t.response)==null?void 0:b.code),w=Gg(g,m);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+w,this.state=re.FRAG_LOADING_WAITING_RETRY,u.resolved=!0,R){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${m+1}/${g.maxNumRetry} in ${w}ms`)}else if(g)if(this.resetFragmentErrors(e),m<g.maxNumRetry)!l&&f!==Pt.RemoveAlternatePermanently&&(u.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${m})`);return}else f===Pt.SendAlternateToPenaltyBox?this.state=re.WAITING_LEVEL:this.state=re.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,n=t===1/0;(!t||e>=t||n&&!Im(0))&&(n&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=re.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===re.PARSING||this.state===re.PARSED){const t=e.frag,n=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,n),o=r&&r.len>.5;o&&this.reduceMaxBufferLength(r.len,t?.duration||10);const l=!o;return l&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),l}return!1}resetFragmentErrors(e){e===ge.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==re.STOPPED&&(this.state=re.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const r=Ae.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===re.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==re.STOPPED&&(this.state=re.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){const o=n.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((f,d)=>{const m=e.elementaryStreams[d];if(m){const g=m.endPTS-m.startPTS;if(g<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${g})`),f||!1;const y=r?0:LR(o,e,m.startPTS,m.endPTS,m.startDTS,m.endDTS,this);return this.hls.trigger(C.LEVEL_PTS_UPDATED,{details:o,level:n,drift:y,type:d,frag:e,start:m.startPTS,end:m.endPTS}),!0}return f},!1)){var u;const f=((u=this.transmuxer)==null?void 0:u.error)===null;if((n.fragmentError===0||f&&(n.fragmentError<2||e.endList))&&this.treatAsGap(e,n),f){const d=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=re.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(C.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ge.MAIN?"level":"track"}fragInfo(e,t=!0,n){var r,o;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${((r=t&&!n?e.startPTS:(n||e).start)!=null?r:NaN).toFixed(3)}-${((o=t&&!n?e.endPTS:(n||e).end)!=null?o:NaN).toFixed(3)}]${n&&e.type==="main"?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function nS(s){return!!s.interstitialsController&&s.enableInterstitialPlayback!==!1}class NR{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=hU(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function hU(s,e){const t=new Uint8Array(e);let n=0;for(let r=0;r<s.length;r++){const o=s[r];t.set(o,n),n+=o.length}return t}var Kh={exports:{}},sS;function mU(){return sS||(sS=1,(function(s){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(f,d,m){this.fn=f,this.context=d,this.once=m||!1}function o(f,d,m,g,y){if(typeof m!="function")throw new TypeError("The listener must be a function");var x=new r(m,g||f,y),E=t?t+d:d;return f._events[E]?f._events[E].fn?f._events[E]=[f._events[E],x]:f._events[E].push(x):(f._events[E]=x,f._eventsCount++),f}function l(f,d){--f._eventsCount===0?f._events=new n:delete f._events[d]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var d=[],m,g;if(this._eventsCount===0)return d;for(g in m=this._events)e.call(m,g)&&d.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(m)):d},u.prototype.listeners=function(d){var m=t?t+d:d,g=this._events[m];if(!g)return[];if(g.fn)return[g.fn];for(var y=0,x=g.length,E=new Array(x);y<x;y++)E[y]=g[y].fn;return E},u.prototype.listenerCount=function(d){var m=t?t+d:d,g=this._events[m];return g?g.fn?1:g.length:0},u.prototype.emit=function(d,m,g,y,x,E){var S=t?t+d:d;if(!this._events[S])return!1;var b=this._events[S],R=arguments.length,w,_;if(b.fn){switch(b.once&&this.removeListener(d,b.fn,void 0,!0),R){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,m),!0;case 3:return b.fn.call(b.context,m,g),!0;case 4:return b.fn.call(b.context,m,g,y),!0;case 5:return b.fn.call(b.context,m,g,y,x),!0;case 6:return b.fn.call(b.context,m,g,y,x,E),!0}for(_=1,w=new Array(R-1);_<R;_++)w[_-1]=arguments[_];b.fn.apply(b.context,w)}else{var D=b.length,M;for(_=0;_<D;_++)switch(b[_].once&&this.removeListener(d,b[_].fn,void 0,!0),R){case 1:b[_].fn.call(b[_].context);break;case 2:b[_].fn.call(b[_].context,m);break;case 3:b[_].fn.call(b[_].context,m,g);break;case 4:b[_].fn.call(b[_].context,m,g,y);break;default:if(!w)for(M=1,w=new Array(R-1);M<R;M++)w[M-1]=arguments[M];b[_].fn.apply(b[_].context,w)}}return!0},u.prototype.on=function(d,m,g){return o(this,d,m,g,!1)},u.prototype.once=function(d,m,g){return o(this,d,m,g,!0)},u.prototype.removeListener=function(d,m,g,y){var x=t?t+d:d;if(!this._events[x])return this;if(!m)return l(this,x),this;var E=this._events[x];if(E.fn)E.fn===m&&(!y||E.once)&&(!g||E.context===g)&&l(this,x);else{for(var S=0,b=[],R=E.length;S<R;S++)(E[S].fn!==m||y&&!E[S].once||g&&E[S].context!==g)&&b.push(E[S]);b.length?this._events[x]=b.length===1?b[0]:b:l(this,x)}return this},u.prototype.removeAllListeners=function(d){var m;return d?(m=t?t+d:d,this._events[m]&&l(this,m)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,s.exports=u})(Kh)),Kh.exports}var gU=mU(),qg=$2(gU);const zo="1.6.15",Sa={};function pU(){return typeof __HLS_WORKER_BUNDLE__=="function"}function yU(){const s=Sa[zo];if(s)return s.clientCount++,s;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),r={worker:new self.Worker(t),objectURL:t,clientCount:1};return Sa[zo]=r,r}function vU(s){const e=Sa[s];if(e)return e.clientCount++,e;const t=new self.URL(s,self.location.href).href,r={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Sa[s]=r,r}function xU(s){const e=Sa[s||zo];if(e&&e.clientCount--===1){const{worker:n,objectURL:r}=e;delete Sa[s||zo],r&&self.URL.revokeObjectURL(r),n.terminate()}}function kR(s,e){return e+10<=s.length&&s[e]===51&&s[e+1]===68&&s[e+2]===73&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function Xg(s,e){return e+10<=s.length&&s[e]===73&&s[e+1]===68&&s[e+2]===51&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function Wu(s,e){let t=0;return t=(s[e]&127)<<21,t|=(s[e+1]&127)<<14,t|=(s[e+2]&127)<<7,t|=s[e+3]&127,t}function Yo(s,e){const t=e;let n=0;for(;Xg(s,e);){n+=10;const r=Wu(s,e+6);n+=r,kR(s,e+10)&&(n+=10),e+=n}if(n>0)return s.subarray(t,t+n)}function EU(s,e,t,n){const r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],o=e[t+2],l=o>>2&15;if(l>12){const x=new Error(`invalid ADTS sampling index:${l}`);s.emit(C.ERROR,C.ERROR,{type:Ee.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!0,error:x,reason:x.message});return}const u=(o>>6&3)+1,f=e[t+3]>>6&3|(o&1)<<2,d="mp4a.40."+u,m=r[l];let g=l;(u===5||u===29)&&(g-=3);const y=[u<<3|(g&14)>>1,(g&1)<<7|f<<3];return qe.log(`manifest codec:${n}, parsed codec:${d}, channels:${f}, rate:${m} (ADTS object type:${u} sampling index:${l})`),{config:y,samplerate:m,channelCount:f,codec:d,parsedCodec:d,manifestCodec:n}}function PR(s,e){return s[e]===255&&(s[e+1]&246)===240}function FR(s,e){return s[e+1]&1?7:9}function Wg(s,e){return(s[e+3]&3)<<11|s[e+4]<<3|(s[e+5]&224)>>>5}function SU(s,e){return e+5<s.length}function Cu(s,e){return e+1<s.length&&PR(s,e)}function TU(s,e){return SU(s,e)&&PR(s,e)&&Wg(s,e)<=s.length-e}function bU(s,e){if(Cu(s,e)){const t=FR(s,e);if(e+t>=s.length)return!1;const n=Wg(s,e);if(n<=t)return!1;const r=e+n;return r===s.length||Cu(s,r)}return!1}function UR(s,e,t,n,r){if(!s.samplerate){const o=EU(e,t,n,r);if(!o)return;Ze(s,o)}}function BR(s){return 1024*9e4/s}function AU(s,e){const t=FR(s,e);if(e+t<=s.length){const n=Wg(s,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function $R(s,e,t,n,r){const o=BR(s.samplerate),l=n+r*o,u=AU(e,t);let f;if(u){const{frameLength:g,headerLength:y}=u,x=y+g,E=Math.max(0,t+x-e.length);E?(f=new Uint8Array(x-y),f.set(e.subarray(t+y,e.length),0)):f=e.subarray(t+y,t+x);const S={unit:f,pts:l};return E||s.samples.push(S),{sample:S,length:x,missing:E}}const d=e.length-t;return f=new Uint8Array(d),f.set(e.subarray(t,e.length),0),{sample:{unit:f,pts:l},length:d,missing:-1}}function RU(s,e){return Xg(s,e)&&Wu(s,e+6)+10<=s.length-e}function LU(s){return s instanceof ArrayBuffer?s:s.byteOffset==0&&s.byteLength==s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer}function zh(s,e=0,t=1/0){return CU(s,e,t,Uint8Array)}function CU(s,e,t,n){const r=_U(s);let o=1;"BYTES_PER_ELEMENT"in n&&(o=n.BYTES_PER_ELEMENT);const l=wU(s)?s.byteOffset:0,u=(l+s.byteLength)/o,f=(l+e)/o,d=Math.floor(Math.max(0,Math.min(f,u))),m=Math.floor(Math.min(d+Math.max(t,0),u));return new n(r,d,m-d)}function _U(s){return s instanceof ArrayBuffer?s:s.buffer}function wU(s){return s&&s.buffer instanceof ArrayBuffer&&s.byteLength!==void 0&&s.byteOffset!==void 0}function DU(s){const e={key:s.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(s.size<2)return;if(s.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const n=s.data.subarray(1).indexOf(0);if(n===-1)return;const r=Tn(zh(s.data,1,n)),o=s.data[2+n],l=s.data.subarray(3+n).indexOf(0);if(l===-1)return;const u=Tn(zh(s.data,3+n,l));let f;return r==="-->"?f=Tn(zh(s.data,4+n+l)):f=LU(s.data.subarray(4+n+l)),e.mimeType=r,e.pictureType=o,e.description=u,e.data=f,e}function IU(s){if(s.size<2)return;const e=Tn(s.data,!0),t=new Uint8Array(s.data.subarray(e.length+1));return{key:s.type,info:e,data:t.buffer}}function OU(s){if(s.size<2)return;if(s.type==="TXXX"){let t=1;const n=Tn(s.data.subarray(t),!0);t+=n.length+1;const r=Tn(s.data.subarray(t));return{key:s.type,info:n,data:r}}const e=Tn(s.data.subarray(1));return{key:s.type,info:"",data:e}}function MU(s){if(s.type==="WXXX"){if(s.size<2)return;let t=1;const n=Tn(s.data.subarray(t),!0);t+=n.length+1;const r=Tn(s.data.subarray(t));return{key:s.type,info:n,data:r}}const e=Tn(s.data);return{key:s.type,info:"",data:e}}function NU(s){return s.type==="PRIV"?IU(s):s.type[0]==="W"?MU(s):s.type==="APIC"?DU(s):OU(s)}function kU(s){const e=String.fromCharCode(s[0],s[1],s[2],s[3]),t=Wu(s,4),n=10;return{type:e,size:t,data:s.subarray(n,n+t)}}const Bc=10,PU=10;function jR(s){let e=0;const t=[];for(;Xg(s,e);){const n=Wu(s,e+6);s[e+5]>>6&1&&(e+=Bc),e+=Bc;const r=e+n;for(;e+PU<r;){const o=kU(s.subarray(e)),l=NU(o);l&&t.push(l),e+=o.size+Bc}kR(s,e)&&(e+=Bc)}return t}function GR(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"}function FU(s){if(s.data.byteLength===8){const e=new Uint8Array(s.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}}function Qg(s){const e=jR(s);for(let t=0;t<e.length;t++){const n=e[t];if(GR(n))return FU(n)}}let xn=(function(s){return s.audioId3="org.id3",s.dateRange="com.apple.quicktime.HLS",s.emsg="https://aomedia.org/emsg/ID3",s.misbklv="urn:misb:KLV:bin:1910.1",s})({});function is(s="",e=9e4){return{type:s,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Zg{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=kn(this.cachedData,e),this.cachedData=null);let n=Yo(e,0),r=n?n.length:0,o;const l=this._audioTrack,u=this._id3Track,f=n?Qg(n):void 0,d=e.length;for((this.basePTS===null||this.frameIndex===0&&me(f))&&(this.basePTS=UU(f,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:xn.audioId3,duration:Number.POSITIVE_INFINITY});r<d;){if(this.canParse(e,r)){const m=this.appendFrame(l,e,r);m?(this.frameIndex++,this.lastPTS=m.sample.pts,r+=m.length,o=r):r=d}else RU(e,r)?(n=Yo(e,r),u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:xn.audioId3,duration:Number.POSITIVE_INFINITY}),r+=n.length,o=r):r++;if(r===d&&o!==d){const m=e.slice(o);this.cachedData?this.cachedData=kn(this.cachedData,m):this.cachedData=m}}return{audioTrack:l,videoTrack:is(),id3Track:u,textTrack:is()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:is(),id3Track:this._id3Track,textTrack:is()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const UU=(s,e,t)=>{if(me(s))return s*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};let $c=null;const BU=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],$U=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],jU=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],GU=[0,1,1,4];function HR(s,e,t,n,r){if(t+24>e.length)return;const o=VR(e,t);if(o&&t+o.frameLength<=e.length){const l=o.samplesPerFrame*9e4/o.sampleRate,u=n+r*l,f={unit:e.subarray(t,t+o.frameLength),pts:u,dts:u};return s.config=[],s.channelCount=o.channelCount,s.samplerate=o.sampleRate,s.samples.push(f),{sample:f,length:o.frameLength,missing:0}}}function VR(s,e){const t=s[e+1]>>3&3,n=s[e+1]>>1&3,r=s[e+2]>>4&15,o=s[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&o!==3){const l=s[e+2]>>1&1,u=s[e+3]>>6,f=t===3?3-n:n===3?3:4,d=BU[f*14+r-1]*1e3,g=$U[(t===3?0:t===2?1:2)*3+o],y=u===3?1:2,x=jU[t][n],E=GU[n],S=x*8*E,b=Math.floor(x*d/g+l)*E;if($c===null){const _=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);$c=_?parseInt(_[1]):0}return!!$c&&$c<=87&&n===2&&d>=224e3&&u===0&&(s[e+3]=s[e+3]|128),{sampleRate:g,channelCount:y,frameLength:b,samplesPerFrame:S}}}function Jg(s,e){return s[e]===255&&(s[e+1]&224)===224&&(s[e+1]&6)!==0}function KR(s,e){return e+1<s.length&&Jg(s,e)}function HU(s,e){return Jg(s,e)&&4<=s.length-e}function zR(s,e){if(e+1<s.length&&Jg(s,e)){const n=VR(s,e);let r=4;n!=null&&n.frameLength&&(r=n.frameLength);const o=e+r;return o===s.length||KR(s,o)}return!1}class VU extends Zg{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=Yo(e,0);let r=n?.length||0;if(zR(e,r))return!1;for(let o=e.length;r<o;r++)if(bU(e,r))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return TU(e,t)}appendFrame(e,t,n){UR(e,this.observer,t,n,e.manifestCodec);const r=$R(e,t,n,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const YR=(s,e)=>{let t=0,n=5;e+=n;const r=new Uint32Array(1),o=new Uint32Array(1),l=new Uint8Array(1);for(;n>0;){l[0]=s[e];const u=Math.min(n,8),f=8-u;o[0]=4278190080>>>24+f<<f,r[0]=(l[0]&o[0])>>f,t=t?t<<u|r[0]:r[0],e+=1,n-=u}return t};class KU extends Zg{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const r=qR(e,t,n,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=Yo(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&Qg(t)!==void 0&&YR(e,n)<16}}function qR(s,e,t,n,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const o=e[t+4]>>6;if(o>=3)return-1;const u=[48e3,44100,32e3][o],f=e[t+4]&63,m=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][f*3+o]*2;if(t+m>e.length)return-1;const g=e[t+6]>>5;let y=0;g===2?y+=2:(g&1&&g!==1&&(y+=2),g&4&&(y+=2));const x=(e[t+6]<<8|e[t+7])>>12-y&1,S=[2,1,2,3,3,4,4,5][g]+x,b=e[t+5]>>3,R=e[t+5]&7,w=new Uint8Array([o<<6|b<<1|R>>2,(R&3)<<6|g<<3|x<<2|f>>4,f<<4&224]),_=1536/u*9e4,D=n+r*_,M=e.subarray(t,t+m);return s.config=w,s.channelCount=S,s.samplerate=u,s.samples.push({unit:M,pts:D}),m}class zU extends Zg{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Yo(e,0);let n=t?.length||0;if(t&&e[n]===11&&e[n+1]===119&&Qg(t)!==void 0&&YR(e,n)<=16)return!1;for(let r=e.length;n<r;n++)if(zR(e,n))return qe.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return HU(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return HR(e,t,n,this.basePTS,this.frameIndex)}}const YU=/\/emsg[-/]ID3/i;class qU{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const o=this.videoTrack=is("video",1),l=this.audioTrack=is("audio",1),u=this.txtTrack=is("text",1);if(this.id3Track=is("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const f=iR(e);if(f.video){const{id:d,timescale:m,codec:g,supplemental:y}=f.video;o.id=d,o.timescale=u.timescale=m,o.codec=g,o.supplemental=y}if(f.audio){const{id:d,timescale:m,codec:g}=f.audio;l.id=d,l.timescale=m,l.codec=g}u.id=tR.text,o.sampleDuration=0,o.duration=l.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return K2(e)}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,o=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=kn(this.remainderData,e));const u=Z2(n);this.remainderData=u.remainder,r.samples=u.valid||new Uint8Array}else r.samples=n;const l=this.extractID3Track(r,t);return o.samples=SE(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:l,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=SE(e,t),{videoTrack:t,audioTrack:is(),id3Track:r,textTrack:is()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=Oe(e.samples,["emsg"]);r&&r.forEach(o=>{const l=eF(o);if(YU.test(l.schemeIdUri)){const u=iS(l,t);let f=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;f<=.001&&(f=Number.POSITIVE_INFINITY);const d=l.payload;n.samples.push({data:d,len:d.byteLength,dts:u,pts:u,type:xn.emsg,duration:f})}else if(this.config.enableEmsgKLVMetadata&&l.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const u=iS(l,t);n.samples.push({data:l.payload,len:l.payload.byteLength,dts:u,pts:u,type:xn.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function iS(s,e){return me(s.presentationTime)?s.presentationTime/s.timeScale:e+s.presentationTimeDelta/s.timeScale}class XU{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Hg(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Ii.cbc)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const o=r.subarray(16,r.length-r.length%16),l=o.buffer.slice(o.byteOffset,o.byteOffset+o.length);this.decryptBuffer(l).then(u=>{const f=new Uint8Array(u);r.set(f,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}).catch(n)}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let r=0;for(let o=32;o<e.length-16;o+=160,r+=16)n.set(e.subarray(o,o+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let o=32;o<e.length-16;o+=160,r+=16)e.set(n.subarray(r,r+16),o);return e}decryptAvcSample(e,t,n,r,o){const l=oR(o.data),u=this.getAvcEncryptedData(l);this.decryptBuffer(u.buffer).then(f=>{o.data=this.getAvcDecryptedUnit(l,f),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)}).catch(r)}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){r();return}const o=e[t].units;for(;!(n>=o.length);n++){const l=o[n];if(!(l.data.length<=48||l.type!==1&&l.type!==5)&&(this.decryptAvcSample(e,t,n,r,l),!this.decrypter.isSync()))return}}}}class XR{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,r;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const o=n.units;r=o[o.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,r=n.length;if(r){const o=n[r-1];e.pts=o.pts,e.dts=o.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,n){const r=t.byteLength;let o=e.naluState||0;const l=o,u=[];let f=0,d,m,g,y=-1,x=0;for(o===-1&&(y=0,x=this.getNALuType(t,0),o=0,f=1);f<r;){if(d=t[f++],!o){o=d?0:1;continue}if(o===1){o=d?0:2;continue}if(!d)o=3;else if(d===1){if(m=f-o-1,y>=0){const E={data:t.subarray(y,m),type:x};u.push(E)}else{const E=this.getLastNalUnit(e.samples);E&&(l&&f<=4-l&&E.state&&(E.data=E.data.subarray(0,E.data.byteLength-l)),m>0&&(E.data=kn(E.data,t.subarray(0,m)),E.state=0))}f<r?(g=this.getNALuType(t,f),y=f,x=g,o=0):o=-1}else o=0}if(y>=0&&o>=0){const E={data:t.subarray(y,r),type:x,state:o};u.push(E)}if(u.length===0){const E=this.getLastNalUnit(e.samples);E&&(E.data=kn(E.data,t))}return e.naluState=o,u}}class No{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),o=Math.min(4,t);if(o===0)throw new Error("no bytes available");r.set(e.subarray(n,n+o)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=o*8,this.bytesAvailable-=o}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&qe.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class WU extends XR{parsePES(e,t,n,r){const o=this.parseNALu(e,n.data,r);let l=this.VideoSample,u,f=!1;n.data=null,l&&o.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),o.forEach(d=>{var m,g;switch(d.type){case 1:{let S=!1;u=!0;const b=d.data;if(f&&b.length>4){const R=this.readSliceType(b);(R===2||R===4||R===7||R===9)&&(S=!0)}if(S){var y;(y=l)!=null&&y.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.frame=!0,l.key=S;break}case 5:u=!0,(m=l)!=null&&m.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 6:{u=!0,Bg(d.data,1,n.pts,t.samples);break}case 7:{var x,E;u=!0,f=!0;const S=d.data,b=this.readSPS(S);if(!e.sps||e.width!==b.width||e.height!==b.height||((x=e.pixelRatio)==null?void 0:x[0])!==b.pixelRatio[0]||((E=e.pixelRatio)==null?void 0:E[1])!==b.pixelRatio[1]){e.width=b.width,e.height=b.height,e.pixelRatio=b.pixelRatio,e.sps=[S];const R=S.subarray(1,4);let w="avc1.";for(let _=0;_<3;_++){let D=R[_].toString(16);D.length<2&&(D="0"+D),w+=D}e.codec=w}break}case 8:u=!0,e.pps=[d.data];break;case 9:u=!0,e.audFound=!0,(g=l)!=null&&g.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:u=!0;break;default:u=!1;break}l&&u&&l.units.push(d)}),r&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new No(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n=8,r=8,o;for(let l=0;l<e;l++)r!==0&&(o=t.readEG(),r=(n+o+256)%256),n=r===0?n:r}readSPS(e){const t=new No(e);let n=0,r=0,o=0,l=0,u,f,d;const m=t.readUByte.bind(t),g=t.readBits.bind(t),y=t.readUEG.bind(t),x=t.readBoolean.bind(t),E=t.skipBits.bind(t),S=t.skipEG.bind(t),b=t.skipUEG.bind(t),R=this.skipScalingList.bind(this);m();const w=m();if(g(5),E(3),m(),b(),w===100||w===110||w===122||w===244||w===44||w===83||w===86||w===118||w===128){const k=y();if(k===3&&E(1),b(),b(),E(1),x())for(f=k!==3?8:12,d=0;d<f;d++)x()&&(d<6?R(16,t):R(64,t))}b();const _=y();if(_===0)y();else if(_===1)for(E(1),S(),S(),u=y(),d=0;d<u;d++)S();b(),E(1);const D=y(),M=y(),$=g(1);$===0&&E(1),E(1),x()&&(n=y(),r=y(),o=y(),l=y());let O=[1,1];if(x()&&x())switch(m()){case 1:O=[1,1];break;case 2:O=[12,11];break;case 3:O=[10,11];break;case 4:O=[16,11];break;case 5:O=[40,33];break;case 6:O=[24,11];break;case 7:O=[20,11];break;case 8:O=[32,11];break;case 9:O=[80,33];break;case 10:O=[18,11];break;case 11:O=[15,11];break;case 12:O=[64,33];break;case 13:O=[160,99];break;case 14:O=[4,3];break;case 15:O=[3,2];break;case 16:O=[2,1];break;case 255:{O=[m()<<8|m(),m()<<8|m()];break}}return{width:Math.ceil((D+1)*16-n*2-r*2),height:(2-$)*(M+1)*16-($?2:4)*(o+l),pixelRatio:O}}}class QU extends XR{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,r){const o=this.parseNALu(e,n.data,r);let l=this.VideoSample,u,f=!1;n.data=null,l&&o.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),o.forEach(d=>{var m,g;switch(d.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),l.frame=!0,u=!0;break;case 16:case 17:case 18:case 21:if(u=!0,f){var y;(y=l)!=null&&y.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 19:case 20:u=!0,(m=l)!=null&&m.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 39:u=!0,Bg(d.data,2,n.pts,t.samples);break;case 32:u=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Ze(e.params,this.readVPS(d.data)),this.initVPS=d.data),e.vps=[d.data];break;case 33:if(u=!0,f=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],d.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const x=this.readSPS(d.data);e.width=x.width,e.height=x.height,e.pixelRatio=x.pixelRatio,e.codec=x.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const E in x.params)e.params[E]=x.params[E]}this.pushParameterSet(e.sps,d.data,e.vps),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0;break;case 34:if(u=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const x=this.readPPS(d.data);for(const E in x)e.params[E]=x[E]}this.pushParameterSet(e.pps,d.data,e.vps)}break;case 35:u=!0,e.audFound=!0,(g=l)!=null&&g.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:u=!1;break}l&&u&&l.units.push(d)}),r&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let r=0;r<e.byteLength;r++)r>=2&&e[r]===3&&e[r-1]===0&&e[r-2]===0||(t[n]=e[r],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new No(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),r=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:r}}readSPS(e){const t=new No(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const r=t.readBits(2),o=t.readBoolean(),l=t.readBits(5),u=t.readUByte(),f=t.readUByte(),d=t.readUByte(),m=t.readUByte(),g=t.readUByte(),y=t.readUByte(),x=t.readUByte(),E=t.readUByte(),S=t.readUByte(),b=t.readUByte(),R=t.readUByte(),w=[],_=[];for(let Pe=0;Pe<n;Pe++)w.push(t.readBoolean()),_.push(t.readBoolean());if(n>0)for(let Pe=n;Pe<8;Pe++)t.readBits(2);for(let Pe=0;Pe<n;Pe++)w[Pe]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),_[Pe]&&t.readUByte();t.readUEG();const D=t.readUEG();D==3&&t.skipBits(1);const M=t.readUEG(),$=t.readUEG(),O=t.readBoolean();let k=0,G=0,B=0,K=0;O&&(k+=t.readUEG(),G+=t.readUEG(),B+=t.readUEG(),K+=t.readUEG());const ne=t.readUEG(),ue=t.readUEG(),ee=t.readUEG(),ae=t.readBoolean();for(let Pe=ae?0:n;Pe<=n;Pe++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Lt=0;Lt<4;Lt++)for(let jt=0;jt<(Lt===3?2:6);jt++)if(!t.readBoolean())t.readUEG();else{const Gt=Math.min(64,1<<4+(Lt<<1));Lt>1&&t.readEG();for(let Xn=0;Xn<Gt;Xn++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const U=t.readUEG();let Y=0;for(let Pe=0;Pe<U;Pe++){let Lt=!1;if(Pe!==0&&(Lt=t.readBoolean()),Lt){Pe===U&&t.readUEG(),t.readBoolean(),t.readUEG();let jt=0;for(let Bn=0;Bn<=Y;Bn++){const Gt=t.readBoolean();let Xn=!1;Gt||(Xn=t.readBoolean()),(Gt||Xn)&&jt++}Y=jt}else{const jt=t.readUEG(),Bn=t.readUEG();Y=jt+Bn;for(let Gt=0;Gt<jt;Gt++)t.readUEG(),t.readBoolean();for(let Gt=0;Gt<Bn;Gt++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Pe=t.readUEG();for(let Lt=0;Lt<Pe;Lt++){for(let jt=0;jt<ee+4;jt++)t.readBits(1);t.readBits(1)}}let N=0,H=1,J=1,se=!0,de=1,fe=0;t.readBoolean(),t.readBoolean();let he=!1;if(t.readBoolean()){if(t.readBoolean()){const ys=t.readUByte(),il=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Ct=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];ys>0&&ys<16?(H=il[ys-1],J=Ct[ys-1]):ys===255&&(H=t.readBits(16),J=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),he=t.readBoolean(),he&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(de=t.readBits(32),fe=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const Ct=t.readBoolean(),rl=t.readBoolean();let Ys=!1;(Ct||rl)&&(Ys=t.readBoolean(),Ys&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),Ys&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let _a=0;_a<=n;_a++){se=t.readBoolean();const lr=se||t.readBoolean();let al=!1;lr?t.readEG():al=t.readBoolean();const wa=al?1:t.readUEG()+1;if(Ct)for(let Oi=0;Oi<wa;Oi++)t.readUEG(),t.readUEG(),Ys&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(rl)for(let Oi=0;Oi<wa;Oi++)t.readUEG(),t.readUEG(),Ys&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),N=t.readUEG())}let _e=M,at=$;if(O){let Pe=1,Lt=1;D===1?Pe=Lt=2:D==2&&(Pe=2),_e=M-Pe*G-Pe*k,at=$-Lt*K-Lt*B}const Rt=r?["A","B","C"][r]:"",bn=u<<24|f<<16|d<<8|m;let Fn=0;for(let Pe=0;Pe<32;Pe++)Fn=(Fn|(bn>>Pe&1)<<31-Pe)>>>0;let Un=Fn.toString(16);return l===1&&Un==="2"&&(Un="6"),{codecString:`hvc1.${Rt}${l}.${Un}.${o?"H":"L"}${R}.B0`,params:{general_tier_flag:o,general_profile_idc:l,general_profile_space:r,general_profile_compatibility_flags:[u,f,d,m],general_constraint_indicator_flags:[g,y,x,E,S,b],general_level_idc:R,bit_depth:ne+8,bit_depth_luma_minus8:ne,bit_depth_chroma_minus8:ue,min_spatial_segmentation_idc:N,chroma_format_idc:D,frame_rate:{fixed:se,fps:fe/de}},width:_e,height:at,pixelRatio:[H,J]}}readPPS(e){const t=new No(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const r=t.readBoolean(),o=t.readBoolean();let l=1;return o&&r?l=0:o?l=3:r&&(l=2),{parallelismType:l}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Dt=188;class Ai{constructor(e,t,n,r){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=r,this.videoParser=null}static probe(e,t){const n=Ai.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){const t=e.length;let n=Math.min(Dt*5,t-Dt)+1,r=0;for(;r<n;){let o=!1,l=-1,u=0;for(let f=r;f<t;f+=Dt)if(e[f]===71&&(t-f===Dt||e[f+Dt]===71)){if(u++,l===-1&&(l=f,l!==0&&(n=Math.min(l+Dt*99,e.length-Dt)+1)),o||(o=Pm(e,f)===0),o&&u>1&&(l===0&&u>2||f+Dt>n))return l}else{if(u)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:tR[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Ai.createTrack("video"),this._videoTrack.duration=r,this._audioTrack=Ai.createTrack("audio",r),this._id3Track=Ai.createTrack("id3"),this._txtTrack=Ai.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,r=!1){n||(this.sampleAes=null);let o;const l=this._videoTrack,u=this._audioTrack,f=this._id3Track,d=this._txtTrack;let m=l.pid,g=l.pesData,y=u.pid,x=f.pid,E=u.pesData,S=f.pesData,b=null,R=this.pmtParsed,w=this._pmtId,_=e.length;if(this.remainderData&&(e=kn(this.remainderData,e),_=e.length,this.remainderData=null),_<Dt&&!r)return this.remainderData=e,{audioTrack:u,videoTrack:l,id3Track:f,textTrack:d};const D=Math.max(0,Ai.syncOffset(e));_-=(_-D)%Dt,_<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,_,e.buffer.byteLength-_));let M=0;for(let O=D;O<_;O+=Dt)if(e[O]===71){const k=!!(e[O+1]&64),G=Pm(e,O),B=(e[O+3]&48)>>4;let K;if(B>1){if(K=O+5+e[O+4],K===O+Dt)continue}else K=O+4;switch(G){case m:k&&(g&&(o=ta(g,this.logger))&&(this.readyVideoParser(l.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(l,d,o,!1)),g={data:[],size:0}),g&&(g.data.push(e.subarray(K,O+Dt)),g.size+=O+Dt-K);break;case y:if(k){if(E&&(o=ta(E,this.logger)))switch(u.segmentCodec){case"aac":this.parseAACPES(u,o);break;case"mp3":this.parseMPEGPES(u,o);break;case"ac3":this.parseAC3PES(u,o);break}E={data:[],size:0}}E&&(E.data.push(e.subarray(K,O+Dt)),E.size+=O+Dt-K);break;case x:k&&(S&&(o=ta(S,this.logger))&&this.parseID3PES(f,o),S={data:[],size:0}),S&&(S.data.push(e.subarray(K,O+Dt)),S.size+=O+Dt-K);break;case 0:k&&(K+=e[K]+1),w=this._pmtId=ZU(e,K);break;case w:{k&&(K+=e[K]+1);const ne=JU(e,K,this.typeSupported,n,this.observer,this.logger);m=ne.videoPid,m>0&&(l.pid=m,l.segmentCodec=ne.segmentVideoCodec),y=ne.audioPid,y>0&&(u.pid=y,u.segmentCodec=ne.segmentAudioCodec),x=ne.id3Pid,x>0&&(f.pid=x),b!==null&&!R&&(this.logger.warn(`MPEG-TS PMT found at ${O} after unknown PID '${b}'. Backtracking to sync byte @${D} to parse all TS packets.`),b=null,O=D-188),R=this.pmtParsed=!0;break}case 17:case 8191:break;default:b=G;break}}else M++;M>0&&Fm(this.observer,new Error(`Found ${M} TS packet/s that do not start with 0x47`),void 0,this.logger),l.pesData=g,u.pesData=E,f.pesData=S;const $={audioTrack:u,videoTrack:l,id3Track:f,textTrack:d};return r&&this.extractRemainingSamples($),$}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:o}=e,l=n.pesData,u=t.pesData,f=r.pesData;let d;if(l&&(d=ta(l,this.logger))?(this.readyVideoParser(n.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(n,o,d,!0),n.pesData=null)):n.pesData=l,u&&(d=ta(u,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d);break}t.pesData=null}else u!=null&&u.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=u;f&&(d=ta(f,this.logger))?(this.parseID3PES(r,d),r.pesData=null):r.pesData=f}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),o=this.sampleAes=new XU(this.observer,this.config,t);return this.decrypt(r,o)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new WU:e==="hevc"&&(this.videoParser=new QU))}decrypt(e,t){return new Promise(n=>{const{audioTrack:r,videoTrack:o}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{o.samples?t.decryptAvcSamples(o.samples,0,0,()=>{n(e)}):n(e)}):o.samples&&t.decryptAvcSamples(o.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let o=t.data;if(r){this.aacOverFlow=null;const g=r.missing,y=r.sample.unit.byteLength;if(g===-1)o=kn(r.sample.unit,o);else{const x=y-g;r.sample.unit.set(o.subarray(0,g),x),e.samples.push(r.sample),n=r.missing}}let l,u;for(l=n,u=o.length;l<u-1&&!Cu(o,l);l++);if(l!==n){let g;const y=l<u-1;if(y?g=`AAC PES did not start with ADTS header,offset:${l}`:g="No ADTS header found in AAC PES",Fm(this.observer,new Error(g),y,this.logger),!y)return}UR(e,this.observer,o,l,this.audioCodec);let f;if(t.pts!==void 0)f=t.pts;else if(r){const g=BR(e.samplerate);f=r.sample.pts+g}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,m;for(;l<u;)if(m=$R(e,o,l,f,d),l+=m.length,m.missing){this.aacOverFlow=m;break}else for(d++;l<u-1&&!Cu(o,l);l++);}parseMPEGPES(e,t){const n=t.data,r=n.length;let o=0,l=0;const u=t.pts;if(u===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;l<r;)if(KR(n,l)){const f=HR(e,n,l,u,o);if(f)l+=f.length,o++;else break}else l++}parseAC3PES(e,t){{const n=t.data,r=t.pts;if(r===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const o=n.length;let l=0,u=0,f;for(;u<o&&(f=qR(e,n,u,r,l++))>0;)u+=f}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=Ze({},t,{type:this._videoTrack?xn.emsg:xn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Pm(s,e){return((s[e+1]&31)<<8)+s[e+2]}function ZU(s,e){return(s[e+10]&31)<<8|s[e+11]}function JU(s,e,t,n,r,o){const l={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(s[e+1]&15)<<8|s[e+2],f=e+3+u-4,d=(s[e+10]&15)<<8|s[e+11];for(e+=12+d;e<f;){const m=Pm(s,e),g=(s[e+3]&15)<<8|s[e+4];switch(s[e]){case 207:if(!n){Yh("ADTS AAC",o);break}case 15:l.audioPid===-1&&(l.audioPid=m);break;case 21:l.id3Pid===-1&&(l.id3Pid=m);break;case 219:if(!n){Yh("H.264",o);break}case 27:l.videoPid===-1&&(l.videoPid=m);break;case 3:case 4:!t.mpeg&&!t.mp3?o.log("MPEG audio found, not supported in this browser"):l.audioPid===-1&&(l.audioPid=m,l.segmentAudioCodec="mp3");break;case 193:if(!n){Yh("AC-3",o);break}case 129:t.ac3?l.audioPid===-1&&(l.audioPid=m,l.segmentAudioCodec="ac3"):o.log("AC-3 audio found, not supported in this browser");break;case 6:if(l.audioPid===-1&&g>0){let y=e+5,x=g;for(;x>2;){switch(s[y]){case 106:t.ac3!==!0?o.log("AC-3 audio found, not supported in this browser for now"):(l.audioPid=m,l.segmentAudioCodec="ac3");break}const S=s[y+1]+2;y+=S,x-=S}}break;case 194:case 135:return Fm(r,new Error("Unsupported EC-3 in M2TS found"),void 0,o),l;case 36:l.videoPid===-1&&(l.videoPid=m,l.segmentVideoCodec="hevc",o.log("HEVC in M2TS found"));break}e+=g+5}return l}function Fm(s,e,t,n){n.warn(`parsing error: ${e.message}`),s.emit(C.ERROR,C.ERROR,{type:Ee.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Yh(s,e){e.log(`${s} with AES-128-CBC encryption found in unencrypted stream`)}function ta(s,e){let t=0,n,r,o,l,u;const f=s.data;if(!s||s.size===0)return null;for(;f[0].length<19&&f.length>1;)f[0]=kn(f[0],f[1]),f.splice(1,1);if(n=f[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(r=(n[4]<<8)+n[5],r&&r>s.size-6)return null;const m=n[7];m&192&&(l=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,m&64?(u=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,l-u>60*9e4&&(e.warn(`${Math.round((l-u)/9e4)}s delta between PTS and DTS, align them`),l=u)):u=l),o=n[8];let g=o+9;if(s.size<=g)return null;s.size-=g;const y=new Uint8Array(s.size);for(let x=0,E=f.length;x<E;x++){n=f[x];let S=n.byteLength;if(g)if(g>S){g-=S;continue}else n=n.subarray(g),S-=g,g=0;y.set(n,t),t+=S}return r&&(r-=o+3),{data:y,pts:l,dts:u,len:r}}return null}class eB{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Ei=Math.pow(2,32)-1;class q{static init(){q.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in q.types)q.types.hasOwnProperty(e)&&(q.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);q.HDLR_TYPES={video:t,audio:n};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);q.STTS=q.STSC=q.STCO=o,q.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),q.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),q.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),q.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const l=new Uint8Array([105,115,111,109]),u=new Uint8Array([97,118,99,49]),f=new Uint8Array([0,0,0,1]);q.FTYP=q.box(q.types.ftyp,l,f,l,u),q.DINF=q.box(q.types.dinf,q.box(q.types.dref,r))}static box(e,...t){let n=8,r=t.length;const o=r;for(;r--;)n+=t[r].byteLength;const l=new Uint8Array(n);for(l[0]=n>>24&255,l[1]=n>>16&255,l[2]=n>>8&255,l[3]=n&255,l.set(e,4),r=0,n=8;r<o;r++)l.set(t[r],n),n+=t[r].byteLength;return l}static hdlr(e){return q.box(q.types.hdlr,q.HDLR_TYPES[e])}static mdat(e){return q.box(q.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Ei+1)),r=Math.floor(t%(Ei+1));return q.box(q.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return q.box(q.types.mdia,q.mdhd(e.timescale||0,e.duration||0),q.hdlr(e.type),q.minf(e))}static mfhd(e){return q.box(q.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?q.box(q.types.minf,q.box(q.types.smhd,q.SMHD),q.DINF,q.stbl(e)):q.box(q.types.minf,q.box(q.types.vmhd,q.VMHD),q.DINF,q.stbl(e))}static moof(e,t,n){return q.box(q.types.moof,q.mfhd(e),q.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=q.trak(e[t]);return q.box.apply(null,[q.types.moov,q.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(q.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=q.trex(e[t]);return q.box.apply(null,[q.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Ei+1)),r=Math.floor(t%(Ei+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return q.box(q.types.mvhd,o)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let r,o;for(r=0;r<t.length;r++)o=t[r].flags,n[r+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return q.box(q.types.sdtp,n)}static stbl(e){return q.box(q.types.stbl,q.stsd(e),q.box(q.types.stts,q.STTS),q.box(q.types.stsc,q.STSC),q.box(q.types.stsz,q.STSZ),q.box(q.types.stco,q.STCO))}static avc1(e){let t=[],n=[],r,o,l;for(r=0;r<e.sps.length;r++)o=e.sps[r],l=o.byteLength,t.push(l>>>8&255),t.push(l&255),t=t.concat(Array.prototype.slice.call(o));for(r=0;r<e.pps.length;r++)o=e.pps[r],l=o.byteLength,n.push(l>>>8&255),n.push(l&255),n=n.concat(Array.prototype.slice.call(o));const u=q.box(q.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),f=e.width,d=e.height,m=e.pixelRatio[0],g=e.pixelRatio[1];return q.box(q.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,q.box(q.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),q.box(q.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,g>>24,g>>16&255,g>>8&255,g&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return q.box(q.types.mp4a,q.audioStsd(e),q.box(q.types.esds,q.esds(e)))}static mp3(e){return q.box(q.types[".mp3"],q.audioStsd(e))}static ac3(e){return q.box(q.types["ac-3"],q.audioStsd(e),q.box(q.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return q.box(q.types.stsd,q.STSD,q.mp4a(e));if(t==="ac3"&&e.config)return q.box(q.types.stsd,q.STSD,q.ac3(e));if(t==="mp3"&&e.codec==="mp3")return q.box(q.types.stsd,q.STSD,q.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return q.box(q.types.stsd,q.STSD,q.avc1(e));if(t==="hevc"&&e.vps)return q.box(q.types.stsd,q.STSD,q.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),r=e.width||0,o=e.height||0,l=Math.floor(n/(Ei+1)),u=Math.floor(n%(Ei+1));return q.box(q.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,o>>8&255,o&255,0,0]))}static traf(e,t){const n=q.sdtp(e),r=e.id,o=Math.floor(t/(Ei+1)),l=Math.floor(t%(Ei+1));return q.box(q.types.traf,q.box(q.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),q.box(q.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255])),q.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,q.box(q.types.trak,q.tkhd(e),q.mdia(e))}static trex(e){const t=e.id;return q.box(q.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],r=n.length,o=12+16*r,l=new Uint8Array(o);let u,f,d,m,g,y;for(t+=8+o,l.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),u=0;u<r;u++)f=n[u],d=f.duration,m=f.size,g=f.flags,y=f.cts,l.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,g.isLeading<<2|g.dependsOn,g.isDependedOn<<6|g.hasRedundancy<<4|g.paddingValue<<1|g.isNonSync,g.degradPrio&61440,g.degradPrio&15,y>>>24&255,y>>>16&255,y>>>8&255,y&255],12+16*u);return q.box(q.types.trun,l)}static initSegment(e){q.types||q.init();const t=q.moov(e);return kn(q.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],r=4,o=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),r-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let l=o.length;for(let E=0;E<n.length;E+=1){l+=3;for(let S=0;S<n[E].length;S+=1)l+=2+n[E][S].length}const u=new Uint8Array(l);u.set(o,0),l=o.length;const f=n.length-1;for(let E=0;E<n.length;E+=1){u.set(new Uint8Array([32+E|(E===f?128:0),0,n[E].length]),l),l+=3;for(let S=0;S<n[E].length;S+=1)u.set(new Uint8Array([n[E][S].length>>8,n[E][S].length&255]),l),l+=2,u.set(n[E][S],l),l+=n[E][S].length}const d=q.box(q.types.hvcC,u),m=e.width,g=e.height,y=e.pixelRatio[0],x=e.pixelRatio[1];return q.box(q.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,m&255,g>>8&255,g&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,q.box(q.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),q.box(q.types.pasp,new Uint8Array([y>>24,y>>16&255,y>>8&255,y&255,x>>24,x>>16&255,x>>8&255,x&255])))}}q.types=void 0;q.HDLR_TYPES=void 0;q.STTS=void 0;q.STSC=void 0;q.STCO=void 0;q.STSZ=void 0;q.VMHD=void 0;q.SMHD=void 0;q.STSD=void 0;q.FTYP=void 0;q.DINF=void 0;const WR=9e4;function ep(s,e,t=1,n=!1){const r=s*e*t;return n?Math.round(r):r}function tB(s,e,t=1,n=!1){return ep(s,e,1/t,n)}function Co(s,e=!1){return ep(s,1e3,1/WR,e)}function nB(s,e=1){return ep(s,WR,1/e)}function rS(s){const{baseTime:e,timescale:t,trackId:n}=s;return`${e/t} (${e}/${t}) trackId: ${n}`}const sB=10*1e3,iB=1024,rB=1152,aB=1536;let na=null,qh=null;function aS(s,e,t,n){return{duration:e,size:t,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:s?2:1,isNonSync:s?0:1}}}class iu extends Pn{constructor(e,t,n,r){if(super("mp4-remuxer",r),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,na===null){const l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);na=l?parseInt(l[1]):0}if(qh===null){const o=navigator.userAgent.match(/Safari\/(\d+)/i);qh=o?parseInt(o[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&rS(t)} > ${e&&rS(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,r=e.reduce((o,l)=>{let u=l.pts,f=u-o;return f<-4294967296&&(t=!0,u=yn(u,n),f=u-o),f>0?o:u},n);return t&&this.debug("PTS rollover detected"),r}remux(e,t,n,r,o,l,u,f){let d,m,g,y,x,E,S=o,b=o;const R=e.pid>-1,w=t.pid>-1,_=t.samples.length,D=e.samples.length>0,M=u&&_>0||_>1;if((!R||D)&&(!w||M)||this.ISGenerated||u){if(this.ISGenerated){var O,k,G,B;const ee=this.videoTrackConfig;(ee&&(t.width!==ee.width||t.height!==ee.height||((O=t.pixelRatio)==null?void 0:O[0])!==((k=ee.pixelRatio)==null?void 0:k[0])||((G=t.pixelRatio)==null?void 0:G[1])!==((B=ee.pixelRatio)==null?void 0:B[1]))||!ee&&M||this.nextAudioTs===null&&D)&&this.resetInitSegment()}this.ISGenerated||(g=this.generateIS(e,t,o,l));const K=this.isVideoContiguous;let ne=-1,ue;if(M&&(ne=oB(t.samples),!K&&this.config.forceKeyFrameOnDiscontinuity))if(E=!0,ne>0){this.warn(`Dropped ${ne} out of ${_} video samples due to a missing keyframe`);const ee=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(ne),t.dropped+=ne,b+=(t.samples[0].pts-ee)/t.inputTimeScale,ue=b}else ne===-1&&(this.warn(`No keyframe found out of ${_} video samples`),E=!1);if(this.ISGenerated){if(D&&M){const ee=this.getVideoStartPts(t.samples),P=(yn(e.samples[0].pts,ee)-ee)/t.inputTimeScale;S+=Math.max(0,P),b+=Math.max(0,-P)}if(D){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),g=this.generateIS(e,t,o,l)),m=this.remuxAudio(e,S,this.isAudioContiguous,l,w||M||f===ge.AUDIO?b:void 0),M){const ee=m?m.endPTS-m.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),g=this.generateIS(e,t,o,l)),d=this.remuxVideo(t,b,K,ee)}}else M&&(d=this.remuxVideo(t,b,K,0));d&&(d.firstKeyFrame=ne,d.independent=ne!==-1,d.firstKeyFramePTS=ue)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(x=QR(n,o,this._initPTS,this._initDTS)),r.samples.length&&(y=ZR(r,o,this._initPTS))),{audio:m,video:d,initSegment:g,independent:E,text:y,id3:x}}computeInitPts(e,t,n,r){const o=Math.round(n*t);let l=yn(e,o);if(l<o+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(o-l)/t} ${r}`);l<o+t;)l+=8589934592;return l-o}generateIS(e,t,n,r){const o=e.samples,l=t.samples,u=this.typeSupported,f={},d=this._initPTS;let m=!d||r,g="audio/mp4",y,x,E,S=-1;if(m&&(y=x=1/0),e.config&&o.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(g="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}f.audio={id:"audio",container:g,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&u.mpeg?new Uint8Array(0):q.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(S=e.id,E=e.inputTimeScale,!d||E!==d.timescale?y=x=this.computeInitPts(o[0].pts,E,n,"audio"):m=!1)}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,f.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:q.initSegment([t]),metadata:{width:t.width,height:t.height}},m)if(S=t.id,E=t.inputTimeScale,!d||E!==d.timescale){const b=this.getVideoStartPts(l),R=yn(l[0].dts,b),w=this.computeInitPts(R,E,n,"video"),_=this.computeInitPts(b,E,n,"video");x=Math.min(x,w),y=Math.min(y,_)}else m=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(f).length)return this.ISGenerated=!0,m?(d&&this.warn(`Timestamps at playlist time: ${r?"":"~"}${n} ${y/E} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${n} offset: ${y/E} (${y}/${E}) trackId: ${S}`),this._initPTS={baseTime:y,timescale:E,trackId:S},this._initDTS={baseTime:x,timescale:E,trackId:S}):y=E=void 0,{tracks:f,initPTS:y,timescale:E,trackId:S}}remuxVideo(e,t,n,r){const o=e.inputTimeScale,l=e.samples,u=[],f=l.length,d=this._initPTS,m=d.baseTime*o/d.timescale;let g=this.nextVideoTs,y=8,x=this.videoSampleDuration,E,S,b=Number.POSITIVE_INFINITY,R=Number.NEGATIVE_INFINITY,w=!1;if(!n||g===null){const N=m+t*o,H=l[0].pts-yn(l[0].dts,l[0].pts);na&&g!==null&&Math.abs(N-H-(g+m))<15e3?n=!0:g=N-H-m}const _=g+m;for(let N=0;N<f;N++){const H=l[N];H.pts=yn(H.pts,_),H.dts=yn(H.dts,_),H.dts<l[N>0?N-1:N].dts&&(w=!0)}w&&l.sort(function(N,H){const J=N.dts-H.dts,se=N.pts-H.pts;return J||se}),E=l[0].dts,S=l[l.length-1].dts;const D=S-E,M=D?Math.round(D/(f-1)):x||e.inputTimeScale/30;if(n){const N=E-_,H=N>M,J=N<-1;if((H||J)&&(H?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Co(N,!0)} ms (${N}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Co(-N,!0)} ms (${N}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!J||_>=l[0].pts||na)){E=_;const se=l[0].pts-N;if(H)l[0].dts=E,l[0].pts=se;else{let de=!0;for(let fe=0;fe<l.length&&!(l[fe].dts>se&&de);fe++){const he=l[fe].pts;if(l[fe].dts-=N,l[fe].pts-=N,fe<l.length-1){const Le=l[fe+1].pts,_e=l[fe].pts,at=Le<=_e,Rt=Le<=he;de=at==Rt}}}this.log(`Video: Initial PTS/DTS adjusted: ${Co(se,!0)}/${Co(E,!0)}, delta: ${Co(N,!0)} ms`)}}E=Math.max(0,E);let $=0,O=0,k=E;for(let N=0;N<f;N++){const H=l[N],J=H.units,se=J.length;let de=0;for(let fe=0;fe<se;fe++)de+=J[fe].data.length;O+=de,$+=se,H.length=de,H.dts<k?(H.dts=k,k+=M/4|0||1):k=H.dts,b=Math.min(H.pts,b),R=Math.max(H.pts,R)}S=l[f-1].dts;const G=O+4*$+8;let B;try{B=new Uint8Array(G)}catch(N){this.observer.emit(C.ERROR,C.ERROR,{type:Ee.MUX_ERROR,details:X.REMUX_ALLOC_ERROR,fatal:!1,error:N,bytes:G,reason:`fail allocating video mdat ${G}`});return}const K=new DataView(B.buffer);K.setUint32(0,G),B.set(q.types.mdat,4);let ne=!1,ue=Number.POSITIVE_INFINITY,ee=Number.POSITIVE_INFINITY,ae=Number.NEGATIVE_INFINITY,P=Number.NEGATIVE_INFINITY;for(let N=0;N<f;N++){const H=l[N],J=H.units;let se=0;for(let he=0,Le=J.length;he<Le;he++){const _e=J[he],at=_e.data,Rt=_e.data.byteLength;K.setUint32(y,Rt),y+=4,B.set(at,y),y+=Rt,se+=4+Rt}let de;if(N<f-1)x=l[N+1].dts-H.dts,de=l[N+1].pts-H.pts;else{const he=this.config,Le=N>0?H.dts-l[N-1].dts:M;if(de=N>0?H.pts-l[N-1].pts:M,he.stretchShortVideoTrack&&this.nextAudioTs!==null){const _e=Math.floor(he.maxBufferHole*o),at=(r?b+r*o:this.nextAudioTs+m)-H.pts;at>_e?(x=at-Le,x<0?x=Le:ne=!0,this.log(`It is approximately ${at/90} ms to the next segment; using duration ${x/90} ms for the last video frame.`)):x=Le}else x=Le}const fe=Math.round(H.pts-H.dts);ue=Math.min(ue,x),ae=Math.max(ae,x),ee=Math.min(ee,de),P=Math.max(P,de),u.push(aS(H.key,x,se,fe))}if(u.length){if(na){if(na<70){const N=u[0].flags;N.dependsOn=2,N.isNonSync=0}}else if(qh&&P-ee<ae-ue&&M/ae<.025&&u[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let N=E;for(let H=0,J=u.length;H<J;H++){const se=N+u[H].duration,de=N+u[H].cts;if(H<J-1){const fe=se+u[H+1].cts;u[H].duration=fe-de}else u[H].duration=H?u[H-1].duration:M;u[H].cts=0,N=se}}}x=ne||!x?M:x;const F=S+x;this.nextVideoTs=g=F-m,this.videoSampleDuration=x,this.isVideoContiguous=!0;const le={data1:q.moof(e.sequenceNumber++,E,Ze(e,{samples:u})),data2:B,startPTS:(b-m)/o,endPTS:(R+x-m)/o,startDTS:(E-m)/o,endDTS:g/o,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,le}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return rB;case"ac3":return aB;default:return iB}}remuxAudio(e,t,n,r,o){const l=e.inputTimeScale,u=e.samplerate?e.samplerate:l,f=l/u,d=this.getSamplesPerFrame(e),m=d*f,g=this._initPTS,y=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,x=[],E=o!==void 0;let S=e.samples,b=y?0:8,R=this.nextAudioTs||-1;const w=g.baseTime*l/g.timescale,_=w+t*l;if(this.isAudioContiguous=n=n||S.length&&R>0&&(r&&Math.abs(_-(R+w))<9e3||Math.abs(yn(S[0].pts,_)-(R+w))<20*m),S.forEach(function(P){P.pts=yn(P.pts,_)}),!n||R<0){const P=S.length;if(S=S.filter(F=>F.pts>=0),P!==S.length&&this.warn(`Removed ${S.length-P} of ${P} samples (initPTS ${w} / ${l})`),!S.length)return;o===0?R=0:r&&!E?R=Math.max(0,_-w):R=S[0].pts-w}if(e.segmentCodec==="aac"){const P=this.config.maxAudioFramesDrift;for(let F=0,U=R+w;F<S.length;F++){const Y=S[F],le=Y.pts,N=le-U,H=Math.abs(1e3*N/l);if(N<=-P*m&&E)F===0&&(this.warn(`Audio frame @ ${(le/l).toFixed(3)}s overlaps marker by ${Math.round(1e3*N/l)} ms.`),this.nextAudioTs=R=le-w,U=le);else if(N>=P*m&&H<sB&&E){let J=Math.round(N/m);for(U=le-J*m;U<0&&J&&m;)J--,U+=m;F===0&&(this.nextAudioTs=R=U-w),this.warn(`Injecting ${J} audio frames @ ${((U-w)/l).toFixed(3)}s due to ${Math.round(1e3*N/l)} ms gap.`);for(let se=0;se<J;se++){let de=eB.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);de||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),de=Y.unit.subarray()),S.splice(F,0,{unit:de,pts:U}),U+=m,F++}}Y.pts=U,U+=m}}let D=null,M=null,$,O=0,k=S.length;for(;k--;)O+=S[k].unit.byteLength;for(let P=0,F=S.length;P<F;P++){const U=S[P],Y=U.unit;let le=U.pts;if(M!==null){const H=x[P-1];H.duration=Math.round((le-M)/f)}else if(n&&e.segmentCodec==="aac"&&(le=R+w),D=le,O>0){O+=b;try{$=new Uint8Array(O)}catch(H){this.observer.emit(C.ERROR,C.ERROR,{type:Ee.MUX_ERROR,details:X.REMUX_ALLOC_ERROR,fatal:!1,error:H,bytes:O,reason:`fail allocating audio mdat ${O}`});return}y||(new DataView($.buffer).setUint32(0,O),$.set(q.types.mdat,4))}else return;$.set(Y,b);const N=Y.byteLength;b+=N,x.push(aS(!0,d,N,0)),M=le}const G=x.length;if(!G)return;const B=x[x.length-1];R=M-w,this.nextAudioTs=R+f*B.duration;const K=y?new Uint8Array(0):q.moof(e.sequenceNumber++,D/f,Ze({},e,{samples:x}));e.samples=[];const ne=(D-w)/l,ue=this.nextAudioTs/l,ae={data1:K,data2:$,startPTS:ne,endPTS:ue,startDTS:ne,endDTS:ue,type:"audio",hasAudio:!0,hasVideo:!1,nb:G};return this.isAudioContiguous=!0,ae}}function yn(s,e){let t;if(e===null)return s;for(e<s?t=-8589934592:t=8589934592;Math.abs(s-e)>4294967296;)s+=t;return s}function oB(s){for(let e=0;e<s.length;e++)if(s[e].key)return e;return-1}function QR(s,e,t,n){const r=s.samples.length;if(!r)return;const o=s.inputTimeScale;for(let u=0;u<r;u++){const f=s.samples[u];f.pts=yn(f.pts-t.baseTime*o/t.timescale,e*o)/o,f.dts=yn(f.dts-n.baseTime*o/n.timescale,e*o)/o}const l=s.samples;return s.samples=[],{samples:l}}function ZR(s,e,t){const n=s.samples.length;if(!n)return;const r=s.inputTimeScale;for(let l=0;l<n;l++){const u=s.samples[l];u.pts=yn(u.pts-t.baseTime*r/t.timescale,e*r)/r}s.samples.sort((l,u)=>l.pts-u.pts);const o=s.samples;return s.samples=[],{samples:o}}class lB extends Pn{constructor(e,t,n,r){super("passthrough-remuxer",r),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(e,r),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:n,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:o,video:l}=this.initData=iR(e);if(t)X2(e,t);else{const f=o||l;f!=null&&f.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${f.codec}")!`)}o&&(n=oS(o,et.AUDIO,this)),l&&(r=oS(l,et.VIDEO,this));const u={};o&&l?u.audiovideo={container:"video/mp4",codec:n+","+r,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:e,id:"main"}:o?u.audio={container:"audio/mp4",codec:n,encrypted:o.encrypted,initSegment:e,id:"audio"}:l?u.video={container:"video/mp4",codec:r,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=u}remux(e,t,n,r,o,l){var u,f;let{initPTS:d,lastEndTime:m}=this;const g={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};me(m)||(m=this.lastEndTime=o||0);const y=t.samples;if(!y.length)return g;const x={initPTS:void 0,timescale:void 0,trackId:void 0};let E=this.initData;if((u=E)!=null&&u.length||(this.generateInitSegment(y),E=this.initData),!((f=E)!=null&&f.length))return this.warn("Failed to generate initSegment."),g;this.emitInitSegment&&(x.tracks=this.initTracks,this.emitInitSegment=!1);const S=Q2(y,E,this),b=E.audio?S[E.audio.id]:null,R=E.video?S[E.video.id]:null,w=jc(R,1/0),_=jc(b,1/0),D=jc(R,0,!0),M=jc(b,0,!0);let $=o,O=0;const k=b&&(!R||!d&&_<w||d&&d.trackId===E.audio.id),G=k?b:R;if(G){const U=G.timescale,Y=G.start-o*U,le=k?E.audio.id:E.video.id;$=G.start/U,O=k?M-_:D-w,(l||!d)&&(cB(d,$,o,O)||U!==d.timescale)&&(d&&this.warn(`Timestamps at playlist time: ${l?"":"~"}${o} ${Y/U} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${o} offset: ${$-o} (${Y}/${U}) trackId: ${le}`),d=null,x.initPTS=Y,x.timescale=U,x.trackId=le)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${o}`);d?(x.initPTS=d.baseTime,x.timescale=d.timescale,x.trackId=d.trackId):((!x.timescale||x.trackId===void 0||x.initPTS===void 0)&&(this.warn("Could not set initPTS"),x.initPTS=$,x.timescale=1,x.trackId=-1),this.initPTS=d={baseTime:x.initPTS,timescale:x.timescale,trackId:x.trackId});const B=$-d.baseTime/d.timescale,K=B+O;O>0?this.lastEndTime=K:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const ne=!!E.audio,ue=!!E.video;let ee="";ne&&(ee+="audio"),ue&&(ee+="video");const ae=(E.audio?E.audio.encrypted:!1)||(E.video?E.video.encrypted:!1),P={data1:y,startPTS:B,startDTS:B,endPTS:K,endDTS:K,type:ee,hasAudio:ne,hasVideo:ue,nb:1,dropped:0,encrypted:ae};g.audio=ne&&!ue?P:void 0,g.video=ue?P:void 0;const F=R?.sampleCount;if(F){const U=R.keyFrameIndex,Y=U!==-1;P.nb=F,P.dropped=U===0||this.isVideoContiguous?0:Y?U:F,P.independent=Y,P.firstKeyFrame=U,Y&&R.keyFrameStart&&(P.firstKeyFramePTS=(R.keyFrameStart-d.baseTime)/d.timescale),this.isVideoContiguous||(g.independent=Y),this.isVideoContiguous||(this.isVideoContiguous=Y),P.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${U}/${F} dropped: ${P.dropped} start: ${P.firstKeyFramePTS||"NA"}`)}return g.initSegment=x,g.id3=QR(n,o,d,d),r.samples.length&&(g.text=ZR(r,o,d)),g}}function jc(s,e,t=!1){return s?.start!==void 0?(s.start+(t?s.duration:0))/s.timescale:e}function cB(s,e,t,n){if(s===null)return!0;const r=Math.max(n,1),o=e-s.baseTime/s.timescale;return Math.abs(o-t)>r}function oS(s,e,t){const n=s.codec;return n&&n.length>4?n:e===et.AUDIO?n==="ec-3"||n==="ac-3"||n==="alac"?n:n==="fLaC"||n==="Opus"?xu(n,!1):(t.warn(`Unhandled audio codec "${n}" in mp4 MAP`),n||"mp4a"):(t.warn(`Unhandled video codec "${n}" in mp4 MAP`),n||"avc1")}let $s;try{$s=self.performance.now.bind(self.performance)}catch{$s=Date.now}const ru=[{demux:qU,remux:lB},{demux:Ai,remux:iu},{demux:VU,remux:iu},{demux:zU,remux:iu}];ru.splice(2,0,{demux:KU,remux:iu});class lS{constructor(e,t,n,r,o,l){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=o,this.logger=l}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const o=n.transmuxing;o.executeStart=$s();let l=new Uint8Array(e);const{currentTransmuxState:u,transmuxConfig:f}=this;r&&(this.currentTransmuxState=r);const{contiguous:d,discontinuity:m,trackSwitch:g,accurateTimeOffset:y,timeOffset:x,initSegmentChange:E}=r||u,{audioCodec:S,videoCodec:b,defaultInitPts:R,duration:w,initSegmentData:_}=f,D=uB(l,t);if(D&&ma(D.method)){const k=this.getDecrypter(),G=Kg(D.method);if(k.isSync()){let B=k.softwareDecrypt(l,D.key.buffer,D.iv.buffer,G);if(n.part>-1){const ne=k.flush();B=ne&&ne.buffer}if(!B)return o.executeEnd=$s(),Xh(n);l=new Uint8Array(B)}else return this.asyncResult=!0,this.decryptionPromise=k.webCryptoDecrypt(l,D.key.buffer,D.iv.buffer,G).then(B=>{const K=this.push(B,null,n);return this.decryptionPromise=null,K}),this.decryptionPromise}const M=this.needsProbing(m,g);if(M){const k=this.configureTransmuxer(l);if(k)return this.logger.warn(`[transmuxer] ${k.message}`),this.observer.emit(C.ERROR,C.ERROR,{type:Ee.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!1,error:k,reason:k.message}),o.executeEnd=$s(),Xh(n)}(m||g||E||M)&&this.resetInitSegment(_,S,b,w,t),(m||E||M)&&this.resetInitialTimestamp(R),d||this.resetContiguity();const $=this.transmux(l,D,x,y,n);this.asyncResult=qo($);const O=this.currentTransmuxState;return O.contiguous=!0,O.discontinuity=!1,O.trackSwitch=!1,o.executeEnd=$s(),$}flush(e){const t=e.transmuxing;t.executeStart=$s();const{decrypter:n,currentTransmuxState:r,decryptionPromise:o}=this;if(o)return this.asyncResult=!0,o.then(()=>this.flush(e));const l=[],{timeOffset:u}=r;if(n){const g=n.flush();g&&l.push(this.push(g.buffer,null,e))}const{demuxer:f,remuxer:d}=this;if(!f||!d){t.executeEnd=$s();const g=[Xh(e)];return this.asyncResult?Promise.resolve(g):g}const m=f.flush(u);return qo(m)?(this.asyncResult=!0,m.then(g=>(this.flushRemux(l,g,e),l))):(this.flushRemux(l,m,e),this.asyncResult?Promise.resolve(l):l)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:o,id3Track:l,textTrack:u}=t,{accurateTimeOffset:f,timeOffset:d}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===ge.MAIN?"level":"track"} ${n.level}`);const m=this.remuxer.remux(r,o,l,u,d,f,!0,this.id);e.push({remuxResult:m,chunkMeta:n}),n.transmuxing.executeEnd=$s()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,o){const{demuxer:l,remuxer:u}=this;!l||!u||(l.resetInitSegment(e,t,n,r),u.resetInitSegment(e,t,n,o))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,o){let l;return t&&t.method==="SAMPLE-AES"?l=this.transmuxSampleAes(e,t,n,r,o):l=this.transmuxUnencrypted(e,n,r,o),l}transmuxUnencrypted(e,t,n,r){const{audioTrack:o,videoTrack:l,id3Track:u,textTrack:f}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(o,l,u,f,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,o){return this.demuxer.demuxSampleAes(e,t,n).then(l=>({remuxResult:this.remuxer.remux(l.audioTrack,l.videoTrack,l.id3Track,l.textTrack,n,r,!1,this.id),chunkMeta:o}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r}=this;let o;for(let g=0,y=ru.length;g<y;g++){var l;if((l=ru[g].demux)!=null&&l.probe(e,this.logger)){o=ru[g];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const u=this.demuxer,f=this.remuxer,d=o.remux,m=o.demux;(!f||!(f instanceof d))&&(this.remuxer=new d(n,t,r,this.logger)),(!u||!(u instanceof m))&&(this.demuxer=new m(n,t,r,this.logger),this.probe=m.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Hg(this.config)),e}}function uB(s,e){let t=null;return s.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Xh=s=>({remuxResult:{},chunkMeta:s});function qo(s){return"then"in s&&s.then instanceof Function}class dB{constructor(e,t,n,r,o){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=o||null}}class fB{constructor(e,t,n,r,o,l){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=o,this.initSegmentChange=l}}let cS=0;class JR{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=cS++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=f=>{const d=f.data,m=this.hls;if(!(!m||!(d!=null&&d.event)||d.instanceNo!==this.instanceNo))switch(d.event){case"init":{var g;const y=(g=this.workerContext)==null?void 0:g.objectURL;y&&self.URL.revokeObjectURL(y);break}case"transmuxComplete":{this.handleTransmuxComplete(d.data);break}case"flush":{this.onFlush(d.data);break}case"workerLog":{m.logger[d.data.logType]&&m.logger[d.data.logType](d.data.message);break}default:{d.data=d.data||{},d.data.frag=this.frag,d.data.part=this.part,d.data.id=this.id,m.trigger(d.event,d.data);break}}},this.onWorkerError=f=>{if(!this.hls)return;const d=new Error(`${f.message}  (${f.filename}:${f.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(C.ERROR,{type:Ee.OTHER_ERROR,details:X.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:d})};const o=e.config;this.hls=e,this.id=t,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const l=(f,d)=>{d=d||{},d.frag=this.frag||void 0,f===C.ERROR&&(d=d,d.parent=this.id,d.part=this.part,this.error=d.error),this.hls.trigger(f,d)};this.observer=new qg,this.observer.on(C.FRAG_DECRYPTED,l),this.observer.on(C.ERROR,l);const u=AE(o.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const f=this.hls.logger;if(o.workerPath||pU()){try{o.workerPath?(f.log(`loading Web Worker ${o.workerPath} for "${t}"`),this.workerContext=vU(o.workerPath)):(f.log(`injecting Web Worker for "${t}"`),this.workerContext=yU());const{worker:m}=this.workerContext;m.addEventListener("message",this.onWorkerMessage),m.addEventListener("error",this.onWorkerError),m.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:u,id:t,config:tt(o)})}catch(m){f.warn(`Error setting up "${t}" Web Worker, fallback to inline`,m),this.terminateWorker(),this.error=null,this.transmuxer=new lS(this.observer,u,o,"",t,e.logger)}return}}this.transmuxer=new lS(this.observer,u,o,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=cS++;const t=this.hls.config,n=AE(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:tt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),xU(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,r,o,l,u,f,d,m){var g,y;d.transmuxing.start=self.performance.now();const{instanceNo:x,transmuxer:E}=this,S=l?l.start:o.start,b=o.decryptdata,R=this.frag,w=!(R&&o.cc===R.cc),_=!(R&&d.level===R.level),D=R?d.sn-R.sn:-1,M=this.part?d.part-this.part.index:-1,$=D===0&&d.id>1&&d.id===R?.stats.chunkCount,O=!_&&(D===1||D===0&&(M===1||$&&M<=0)),k=self.performance.now();(_||D||o.stats.parsing.start===0)&&(o.stats.parsing.start=k),l&&(M||!O)&&(l.stats.parsing.start=k);const G=!(R&&((g=o.initSegment)==null?void 0:g.url)===((y=R.initSegment)==null?void 0:y.url)),B=new fB(w,O,f,_,S,G);if(!O||w||G){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${o.type} sn: ${d.sn}${d.part>-1?" part: "+d.part:""} ${this.id===ge.MAIN?"level":"track"}: ${d.level} id: ${d.id}
        discontinuity: ${w}
        trackSwitch: ${_}
        contiguous: ${O}
        accurateTimeOffset: ${f}
        timeOffset: ${S}
        initSegmentChange: ${G}`);const K=new dB(n,r,t,u,m);this.configureTransmuxer(K)}if(this.frag=o,this.part=l,this.workerContext)this.workerContext.worker.postMessage({instanceNo:x,cmd:"demux",data:e,decryptdata:b,chunkMeta:d,state:B},e instanceof ArrayBuffer?[e]:[]);else if(E){const K=E.push(e,b,d,B);qo(K)?K.then(ne=>{this.handleTransmuxComplete(ne)}).catch(ne=>{this.transmuxerError(ne,d,"transmuxer-interface push error")}):this.handleTransmuxComplete(K)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const r=n.flush(e);qo(r)?r.then(o=>{this.handleFlushResult(o,e)}).catch(o=>{this.transmuxerError(o,e,"transmuxer-interface flush error")}):this.handleFlushResult(r,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const uS=100;class hB extends Yg{constructor(e,t,n){super(e,t,n,"audio-stream-controller",ge.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(C.BUFFER_RESET,this.onBufferReset,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(C.BUFFER_RESET,this.onBufferReset,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:o,trackId:l}){if(n===ge.MAIN){const u=t.cc,f=this.fragCurrent;if(this.initPTS[u]={baseTime:r,timescale:o,trackId:l},this.log(`InitPTS for cc: ${u} found from main: ${r/o} (${r}/${o}) trackId: ${l}`),this.mainAnchor=t,this.state===re.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==u)&&this.syncWithAnchor(t,d?.frag)}else!this.hls.hasEnoughToStart&&f&&f.cc!==u?(f.abortRequests(),this.syncWithAnchor(t,f)):this.state===re.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var n;const r=((n=this.mainFragLoading)==null?void 0:n.frag)||null;if(t&&r?.cc===t.cc)return;const o=(r||e).cc,l=this.getLevelDetails(),u=this.getLoadPosition(),f=gR(l,o,u);f&&(this.log(`Syncing with main frag at ${f.start} cc ${f.cc}`),this.startFragRequested=!1,this.nextLoadPosition=f.start,this.resetLoadingState(),this.state===re.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=re.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(uS),n>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=re.IDLE):this.state=re.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case re.IDLE:this.doTickIdle();break;case re.WAITING_TRACK:{const{levels:e,trackId:t}=this,n=e?.[t],r=n?.details;if(r&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(r))break;this.state=re.WAITING_INIT_PTS}break}case re.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case re.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:r,complete:o}=e,l=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=re.FRAG_LOADING;const u=r.flush().buffer,f={frag:t,part:n,payload:u,networkDetails:null};this._handleFragmentLoadProgress(f),o&&super._handleFragmentLoadComplete(f)}else l&&l.cc!==e.frag.cc&&this.syncWithAnchor(l,e.frag)}else this.state=re.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:r,trackId:o}=this,l=t.config;if(!this.buffering||!r&&!this.primaryPrefetch&&(this.startFragRequested||!l.startFragPrefetch)||!(n!=null&&n[o]))return;const u=n[o],f=u.details;if(!f||this.waitForLive(u)||this.waitForCdnTuneIn(f)){this.state=re.WAITING_TRACK,this.startFragRequested=!1;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,et.AUDIO,ge.AUDIO));const m=this.getFwdBufferInfo(d,ge.AUDIO);if(m===null)return;if(!this.switchingTrack&&this._streamEnded(m,f)){t.trigger(C.BUFFER_EOS,{type:"audio"}),this.state=re.ENDED;return}const g=m.len,y=t.maxBufferLength,x=f.fragments,E=x[0].start,S=this.getLoadPosition(),b=this.flushing?S:m.end;if(this.switchingTrack&&r){const _=S;f.PTSKnown&&_<E&&(m.end>E||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=E+.05)}if(g>=y&&!this.switchingTrack&&b<x[x.length-1].start)return;let R=this.getNextFragment(b,f);if(R&&this.isLoopLoading(R,b)&&(R=this.getNextFragmentLoopLoading(R,f,m,ge.MAIN,y)),!R){this.bufferFlushed=!0;return}let w=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&w&&gt(R)&&!R.endList&&(!f.live||!this.loadingParts&&b<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(w)===At.OK&&(this.mainFragLoading=w=null),w&&gt(w))){if(R.start>w.end){const D=this.fragmentTracker.getFragAtPos(b,ge.MAIN);D&&D.end>w.end&&(w=D,this.mainFragLoading={frag:D,targetBufferTime:null})}if(R.start>w.end)return}this.loadFragment(R,u,b)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new Ko(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==re.STOPPED&&(this.setInterval(uS),this.state=re.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(C.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:r}=this,{details:o,id:l,groupId:u,track:f}=t;if(!r){this.warn(`Audio tracks reset while loading track ${l} "${f.name}" of "${u}"`);return}const d=this.mainDetails;if(!d||o.endCC>d.endCC||d.expired){this.cachedTrackLoadedData=t,this.state!==re.STOPPED&&(this.state=re.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${l} "${f.name}" of "${u}" loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`);const m=r[l];let g=0;if(o.live||(n=m.details)!=null&&n.live){if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;if(m.details){var y;g=this.alignPlaylists(o,m.details,(y=this.levelLastLoaded)==null?void 0:y.details)}o.alignedSliding||(MR(o,d),o.alignedSliding||Lu(o,d),g=o.fragmentStart)}m.details=o,this.levelLastLoaded=m,this.startFragRequested||this.setStartPosition(d,g),this.hls.trigger(C.AUDIO_TRACK_UPDATED,{details:o,id:l,groupId:t.groupId}),this.state===re.WAITING_TRACK&&!this.waitForCdnTuneIn(o)&&(this.state=re.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:r,payload:o}=e,{config:l,trackId:u,levels:f}=this;if(!f){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const d=f[u];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const m=d.details;if(!m){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const g=l.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let y=this.transmuxer;y||(y=this.transmuxer=new JR(this.hls,ge.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const x=this.initPTS[n.cc],E=(t=n.initSegment)==null?void 0:t.data;if(x!==void 0){const b=r?r.index:-1,R=b!==-1,w=new Vg(n.level,n.sn,n.stats.chunkCount,o.byteLength,b,R);y.push(o,E,g,"",n,r,m.totalduration,!1,w,x)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${m.startSN} ,${m.endSN}],track ${u}`);const{cache:S}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new NR,complete:!1};S.push(new Uint8Array(o)),this.state!==re.STOPPED&&(this.state=re.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ge.MAIN&&gt(t.frag)&&(this.mainFragLoading=t,this.state===re.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type!==ge.AUDIO){!this.audioOnly&&n.type===ge.MAIN&&!n.elementaryStreams.video&&!n.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(gt(n)){this.fragPrevious=n;const o=this.switchingTrack;o&&(this.bufferedTrack=o,this.switchingTrack=null,this.hls.trigger(C.AUDIO_TRACK_SWITCHED,Ye({},o)))}this.fragBufferedComplete(n,r),this.media&&this.tick()}onError(e,t){var n;if(t.fatal){this.state=re.ERROR;return}switch(t.details){case X.FRAG_GAP:case X.FRAG_PARSING_ERROR:case X.FRAG_DECRYPT_ERROR:case X.FRAG_LOAD_ERROR:case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_ERROR:case X.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ge.AUDIO,t);break;case X.AUDIO_TRACK_LOAD_ERROR:case X.AUDIO_TRACK_LOAD_TIMEOUT:case X.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===re.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===Me.AUDIO_TRACK&&(this.state=re.IDLE);break;case X.BUFFER_ADD_CODEC_ERROR:case X.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case X.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case X.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==et.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==et.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===re.ENDED&&(this.state=re.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,ge.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:o,chunkMeta:l}=e,u=this.getCurrentContext(l);if(!u){this.resetWhenMissingContext(l);return}const{frag:f,part:d,level:m}=u,{details:g}=m,{audio:y,text:x,id3:E,initSegment:S}=o;if(this.fragContextChanged(f)||!g){this.fragmentTracker.removeFragment(f);return}if(this.state=re.PARSING,this.switchingTrack&&y&&this.completeAudioSwitch(this.switchingTrack),S!=null&&S.tracks){const b=f.initSegment||f;if(this.unhandledEncryptionError(S,f))return;this._bufferInitSegment(m,S.tracks,b,l),r.trigger(C.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:n,tracks:S.tracks})}if(y){const{startPTS:b,endPTS:R,startDTS:w,endDTS:_}=y;d&&(d.elementaryStreams[et.AUDIO]={startPTS:b,endPTS:R,startDTS:w,endDTS:_}),f.setElementaryStreamInfo(et.AUDIO,b,R,w,_),this.bufferFragmentData(y,f,d,l)}if(E!=null&&(t=E.samples)!=null&&t.length){const b=Ze({id:n,frag:f,details:g},E);r.trigger(C.FRAG_PARSING_METADATA,b)}if(x){const b=Ze({id:n,frag:f,details:g},x);r.trigger(C.FRAG_PARSING_USERDATA,b)}}_bufferInitSegment(e,t,n,r){if(this.state!==re.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const o=t.audio;o.id=ge.AUDIO;const l=e.audioCodec;this.log(`Init audio buffer, container:${o.container}, codecs[level/parsed]=[${l}/${o.codec}]`),l&&l.split(",").length===1&&(o.levelCodec=l),this.hls.trigger(C.BUFFER_CODECS,t);const u=o.initSegment;if(u!=null&&u.byteLength){const f={type:"audio",frag:n,part:null,chunkMeta:r,parent:n.type,data:u};this.hls.trigger(C.BUFFER_APPENDING,f)}this.tickImmediate()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);if(this.switchingTrack||r===At.NOT_LOADED||r===At.PARTIAL){var o;if(!gt(e))this._loadInitSegment(e,t);else if((o=t.details)!=null&&o.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=re.WAITING_INIT_PTS;const l=this.mainDetails;l&&l.fragmentStart!==t.details.fragmentStart&&Lu(t.details,l)}else super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:r,characteristics:o,audioCodec:l,channels:u}=this.bufferedTrack;tr({name:t,lang:n,assocLang:r,characteristics:o,audioCodec:l,channels:u},e,er)||(Su(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(C.AUDIO_TRACK_SWITCHED,Ye({},e))}}class tp extends Pn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const r=t?.renditionReports;if(r){let o=-1;for(let l=0;l<r.length;l++){const u=r[l];let f;try{f=new self.URL(u.URI,t.url).href}catch(d){this.warn(`Could not construct new URL for Rendition Report: ${d}`),f=u.URI||""}if(f===e){o=l;break}else f===e.substring(0,f.length)&&(o=l)}if(o!==-1){const l=r[o],u=parseInt(l["LAST-MSN"])||t.lastPartSn;let f=parseInt(l["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const m=Math.min(t.age-t.partTarget,t.targetduration);f>=0&&m>t.partTarget&&(f+=1)}const d=n&&RE(n);return new LE(u,f>=0?f:void 0,d)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:r,stats:o}=t,l=self.performance.now(),u=o.loading.first?Math.max(0,l-o.loading.first):0;r.advancedDateTime=Date.now()-u;const f=this.hls.config.timelineOffset;if(f!==r.appliedTimelineOffset){const m=Math.max(f||0,0);r.appliedTimelineOffset=m,r.fragments.forEach(g=>{g.setStart(g.playlistOffset+m)})}if(r.live||n!=null&&n.live){const m="levelInfo"in t?t.levelInfo:t.track;if(r.reloaded(n),n&&r.fragments.length>0){rU(n,r,this);const w=r.playlistParsingError;if(w){this.warn(w);const _=this.hls;if(!_.config.ignorePlaylistParsingErrors){var d;const{networkDetails:D}=t;_.trigger(C.ERROR,{type:Ee.NETWORK_ERROR,details:X.LEVEL_PARSING_ERROR,fatal:!1,url:r.url,error:w,reason:w.message,level:t.level||void 0,parent:(d=r.fragments[0])==null?void 0:d.type,networkDetails:D,stats:o});return}r.playlistParsingError=null}}r.requestScheduled===-1&&(r.requestScheduled=o.loading.start);const g=this.hls.mainForwardBufferInfo,y=g?g.end-g.len:0,x=(r.edge-y)*1e3,E=_R(r,x);if(r.requestScheduled+E<l?r.requestScheduled=l:r.requestScheduled+=E,this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),!this.canLoad||!r.live)return;let S,b,R;if(r.canBlockReload&&r.endSN&&r.advanced){const w=this.hls.config.lowLatencyMode,_=r.lastPartSn,D=r.endSN,M=r.lastPartIndex,$=M!==-1,O=_===D;$?O?(b=D+1,R=w?0:M):(b=_,R=w?M+1:r.maxPartIndex):b=D+1;const k=r.age,G=k+r.ageHeader;let B=Math.min(G-r.partTarget,r.targetduration*1.5);if(B>0){if(G>r.targetduration*3)this.log(`Playlist last advanced ${k.toFixed(2)}s ago. Omitting segment and part directives.`),b=void 0,R=void 0;else if(n!=null&&n.tuneInGoal&&G-r.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${B} with playlist age: ${r.age}`),B=0;else{const K=Math.floor(B/r.targetduration);if(b+=K,R!==void 0){const ne=Math.round(B%r.targetduration/r.partTarget);R+=ne}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${k.toFixed(2)}s goal: ${B} skip sn ${K} to part ${R}`)}r.tuneInGoal=B}if(S=this.getDeliveryDirectives(r,t.deliveryDirectives,b,R),w||!O){r.requestScheduled=l,this.loadingPlaylist(m,S);return}}else(r.canBlockReload||r.canSkipUntil)&&(S=this.getDeliveryDirectives(r,t.deliveryDirectives,b,R));S&&b!==void 0&&r.canBlockReload&&(r.requestScheduled=o.loading.first+Math.max(E-u*2,E/2)),this.scheduleLoading(m,S,r)}else this.clearTimer()}scheduleLoading(e,t,n){const r=n||e.details;if(!r){this.loadingPlaylist(e,t);return}const o=self.performance.now(),l=r.requestScheduled;if(o>=l){this.loadingPlaylist(e,t);return}const u=l-o;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(u)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),u)}getDeliveryDirectives(e,t,n,r){let o=RE(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,o=nu.No),new LE(n,r,o)}checkRetry(e){const t=e.details,n=Tu(e),r=e.errorAction,{action:o,retryCount:l=0,retryConfig:u}=r||{},f=!!r&&!!u&&(o===Pt.RetryRequest||!r.resolved&&o===Pt.SendAlternateToPenaltyBox);if(f){var d;if(l>=u.maxNumRetry)return!1;if(n&&(d=e.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const m=Gg(u,l);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),m),this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${t}" in ${m}ms`)}e.levelRetry=!0,r.resolved=!0}return f}}function e1(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!Xo(s[t].attrs,e[t].attrs))return!1;return!0}function Xo(s,e,t){const n=s["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>s[r]!==e[r])}function Um(s,e){return e.label.toLowerCase()===s.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(s.lang||"").toLowerCase())}class mB extends tp{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(C.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:o}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==r){this.warn(`Audio track with id:${n} and group:${r} not found in active group ${l?.groupId}`);return}const u=l.details;l.details=t.details,this.log(`Audio track ${n} "${l.name}" lang:${l.lang} group:${r} loaded [${o.startSN}-${o.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,r=this.groupIds;let o=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(u=>r?.indexOf(u)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(y=>!n||n.indexOf(y.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(y=>y.default)&&(this.selectDefaultTrack=!1),u.forEach((y,x)=>{y.id=x});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const f=this.hls.config.audioPreference;if(!o&&f){const y=os(f,u,er);if(y>-1)o=u[y];else{const x=os(f,this.tracks);o=this.tracks[x]}}let d=this.findTrackId(o);d===-1&&o&&(d=this.findTrackId(null));const m={audioTracks:u};this.log(`Updating audio tracks, ${u.length} track(s) found in group(s): ${n?.join(",")}`),this.hls.trigger(C.AUDIO_TRACKS_UPDATED,m);const g=this.trackId;if(d!==-1&&g===-1)this.setAudioTrack(d);else if(u.length&&g===-1){var l;const y=new Error(`No audio track selected for current audio group-ID(s): ${(l=this.groupIds)==null?void 0:l.join(",")} track count: ${u.length}`);this.warn(y.message),this.hls.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:y})}}}onError(e,t){t.fatal||!t.context||t.context.type===Me.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const r=this.currentTrack;if(r&&tr(e,r,er))return r;const o=os(e,this.tracksInGroup,er);if(o>-1){const l=this.tracksInGroup[o];return this.setAudioTrack(o),l}else if(r){let l=t.loadLevel;l===-1&&(l=t.firstAutoLevel);const u=LF(e,t.levels,n,l,er);if(u===-1)return null;t.nextLoadLevel=u}if(e.channels||e.audioCodec){const l=os(e,n);if(l>-1)return n[l]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e],o=r.details&&!r.details.live;if(e===this.trackId&&r===n&&o||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(C.AUDIO_TRACK_SWITCHING,Ye({},r)),o))return;const l=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(l)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(!(this.selectDefaultTrack&&!r.default)&&(!e||tr(e,r,er)))return n}if(e){const{name:n,lang:r,assocLang:o,characteristics:l,audioCodec:u,channels:f}=e;for(let d=0;d<t.length;d++){const m=t[d];if(tr({name:n,lang:r,assocLang:o,characteristics:l,audioCodec:u,channels:f},m,er))return d}for(let d=0;d<t.length;d++){const m=t[d];if(Xo(e.attrs,m.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<t.length;d++){const m=t[d];if(Xo(e.attrs,m.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Su(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,r=e.groupId,o=this.getUrlWithDirectives(e.url,t),l=e.details,u=l?.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${o}`),this.hls.trigger(C.AUDIO_TRACK_LOADING,{url:o,id:n,groupId:r,deliveryDirectives:t||null,track:e})}}class gB{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(this.queues===null||this.tracks===null)return;const r=this.queues[t];r.push(e),r.length===1&&!n&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=(t=e[0])==null?void 0:t.label;(n==="async-blocker"||n==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(o){var n;if(r.onError(o),this.queues===null||this.tracks===null)return;const l=(n=this.tracks[e])==null?void 0:n.buffer;l!=null&&l.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,n;return(t=this.queues)!=null&&t[e]||(n=this.tracks)!=null&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=(t=this.tracks)==null?void 0:t[e],r=n?.buffer;return r?`SourceBuffer${r.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(n=>n.label).join(", "))||""}}const dS=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,t1="HlsJsTrackRemovedError";class pB extends Error{constructor(e){super(e),this.name=t1}}class yB extends Pn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=n=>{var r;this.hls&&((r=this.mediaSource)==null?void 0:r.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=n=>{const{media:r,mediaSource:o}=this;n&&this.log("Media source opened"),!(!r||!o)&&(o.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(C.MEDIA_ATTACHED,{media:r,mediaSource:o}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:r}=this;n!==r&&this.error(`Media element src was set while attaching MediaSource (${r} > ${n})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=B2(Di(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.BUFFER_RESET,this.onBufferReset,this),e.on(C.BUFFER_APPENDING,this.onBufferAppending,this),e.on(C.BUFFER_CODECS,this.onBufferCodecs,this),e.on(C.BUFFER_EOS,this.onBufferEos,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.FRAG_PARSED,this.onFragParsed,this),e.on(C.FRAG_CHANGED,this.onFragChanged,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.BUFFER_RESET,this.onBufferReset,this),e.off(C.BUFFER_APPENDING,this.onBufferAppending,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.BUFFER_EOS,this.onBufferEos,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.FRAG_PARSED,this.onFragParsed,this),e.off(C.FRAG_CHANGED,this.onFragChanged,this),e.off(C.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const o=this.isUpdating();o||this.operationQueue.removeBlockers();const l=this.isQueued();(o||l)&&this.warn(`Transfering MediaSource with${l?" operations in queue":""}${o?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const r=this.transferData;return!this.sourceBufferCount&&r&&r.mediaSource===t?Ze(n,r.tracks):this.sourceBuffers.forEach(o=>{const[l]=o;l&&(n[l]=Ze({},this.tracks[l]),this.removeBuffer(l)),o[0]=o[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsTotal=r,this.log(`${r} bufferCodec event(s) expected.`),(n=this.transferData)!=null&&n.mediaSource&&this.sourceBufferCount&&r&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media;this.transferData=this.overrides=void 0;const r=Di(this.appendSource);if(r){const o=!!t.mediaSource;(o||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const l=this.mediaSource=t.mediaSource||new r;if(this.assignMediaSource(l),o)this._objectUrl=n.src,this.attachTransferred();else{const u=this._objectUrl=self.URL.createObjectURL(l);if(this.appendSource)try{n.removeAttribute("src");const f=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||f&&l instanceof f,fS(n),vB(n,u),n.load()}catch{n.src=u}else n.src=u}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(n=e.constructor)==null?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,r=t.tracks,o=r?Object.keys(r):null,l=o?o.length:0,u=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(r&&o&&l){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${tt(n,(f,d)=>f==="initSegment"?void 0:d)};
transfer tracks: ${tt(r,(f,d)=>f==="initSegment"?void 0:d)}}`),!QA(r,n)){t.mediaSource=null,t.tracks=void 0;const f=e.currentTime,d=this.details,m=Math.max(f,d?.fragments[0].start||0);if(m-f>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${f} -> ${m}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(r)}"->"${Object.keys(n)}") start time: ${m} currentTime: ${f}`),this.onMediaDetaching(C.MEDIA_DETACHING,{}),this.onMediaAttaching(C.MEDIA_ATTACHING,t),e.currentTime=m;return}this.transferData=void 0,o.forEach(f=>{const d=f,m=r[d];if(m){const g=m.buffer;if(g){const y=this.fragmentTracker,x=m.id;if(y.hasFragments(x)||y.hasParts(x)){const b=Ae.getBuffered(g);y.detectEvictedFragments(d,b,x,null,!0)}const E=Wh(d),S=[d,g];this.sourceBuffers[E]=S,g.updating&&this.operationQueue&&this.operationQueue.prependBlocker(d),this.trackSourceBuffer(d,m)}}}),u(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),u()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:r,mediaSource:o,_objectUrl:l}=this;if(o){if(this.log(`media source ${n?"transferring":"detaching"}`),n)this.sourceBuffers.forEach(([u])=>{u&&this.removeBuffer(u)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const u=o.readyState==="open";try{const f=o.sourceBuffers;for(let d=f.length;d--;)u&&f[d].abort(),o.removeSourceBuffer(f[d]);u&&o.endOfStream()}catch(f){this.warn(`onMediaDetaching: ${f.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}o.removeEventListener("sourceopen",this._onMediaSourceOpen),o.removeEventListener("sourceended",this._onMediaSourceEnded),o.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.removeEventListener("startstreaming",this._onStartStreaming),o.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}r&&(r.removeEventListener("emptied",this._onMediaEmptied),n||(l&&self.URL.revokeObjectURL(l),this.mediaSrc===l?(r.removeAttribute("src"),this.appendSource&&fS(r),r.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(C.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),n)try{var r;(r=this.mediaSource)!=null&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(o){this.warn(`onBufferReset ${e}`,o)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Wh(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new gB(this.tracks)}onBufferCodecs(e,t){var n;const r=this.tracks,o=Object.keys(t);this.log(`BUFFER_CODECS: "${o}" (current SB count ${this.sourceBufferCount})`);const l="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),u=!l&&this.sourceBufferCount&&this.media&&o.some(f=>!r[f]);if(l||u){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${o}" SourceBuffers`);return}o.forEach(f=>{var d,m;const g=t[f],{id:y,codec:x,levelCodec:E,container:S,metadata:b,supplemental:R}=g;let w=r[f];const _=(d=this.transferData)==null||(d=d.tracks)==null?void 0:d[f],D=_!=null&&_.buffer?_:w,M=D?.pendingCodec||D?.codec,$=D?.levelCodec;w||(w=r[f]={buffer:void 0,listeners:[],codec:x,supplemental:R,container:S,levelCodec:E,metadata:b,id:y});const O=tu(M,$),k=O?.replace(dS,"$1");let G=tu(x,E);const B=(m=G)==null?void 0:m.replace(dS,"$1");G&&O&&k!==B&&(f.slice(0,5)==="audio"&&(G=xu(G,this.appendSource)),this.log(`switching codec ${M} to ${G}`),G!==(w.pendingCodec||w.codec)&&(w.pendingCodec=G),w.container=S,this.appendChangeType(f,S,G))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((n=t.audio)==null?void 0:n.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const r=`${t};codecs=${n}`,o={label:`change-type=${r}`,execute:()=>{const l=this.tracks[e];if(l){const u=l.buffer;u!=null&&u.changeType&&(this.log(`changing ${e} sourceBuffer type to ${r}`),u.changeType(r),l.codec=n,l.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn(`Failed to change ${e} SourceBuffer type`,l)}};this.append(o,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,r=n+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(n,ge.MAIN))==null?void 0:t.gap)===!0)return;const l={label:"block-audio",execute:()=>{var u;const f=this.tracks.video;(this.lastVideoAppendEnd>r||f!=null&&f.buffer&&Ae.isBuffered(f.buffer,r)||((u=this.fragmentTracker.getAppendedFrag(r,ge.MAIN))==null?void 0:u.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:u=>{this.warn("Error executing block-audio operation",u)}};this.blockedAudioAppend={op:l,frag:e},this.append(l,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:r,type:o,parent:l,frag:u,part:f,chunkMeta:d,offset:m}=t,g=d.buffering[o],{sn:y,cc:x}=u,E=self.performance.now();g.start=E;const S=u.stats.buffering,b=f?f.stats.buffering:null;S.start===0&&(S.start=E),b&&b.start===0&&(b.start=E);const R=n.audio;let w=!1;o==="audio"&&R?.container==="audio/mpeg"&&(w=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const _=n.video,D=_?.buffer;if(D&&y!=="initSegment"){const O=f||u,k=this.blockedAudioAppend;if(o==="audio"&&l!=="main"&&!this.blockedAudioAppend&&!(_.ending||_.ended)){const B=O.start+O.duration*.05,K=D.buffered,ne=this.currentOp("video");!K.length&&!ne?this.blockAudio(O):!ne&&!Ae.isBuffered(D,B)&&this.lastVideoAppendEnd<B&&this.blockAudio(O)}else if(o==="video"){const G=O.end;if(k){const B=k.frag.start;(G>B||G<this.lastVideoAppendEnd||Ae.isBuffered(D,B))&&this.unblockAudio()}this.lastVideoAppendEnd=G}}const M=(f||u).start,$={label:`append-${o}`,execute:()=>{var O;g.executeStart=self.performance.now();const k=(O=this.tracks[o])==null?void 0:O.buffer;k&&(w?this.updateTimestampOffset(k,M,.1,o,y,x):m!==void 0&&me(m)&&this.updateTimestampOffset(k,m,1e-6,o,y,x)),this.appendExecutor(r,o)},onStart:()=>{},onComplete:()=>{const O=self.performance.now();g.executeEnd=g.end=O,S.first===0&&(S.first=O),b&&b.first===0&&(b.first=O);const k={};this.sourceBuffers.forEach(([G,B])=>{G&&(k[G]=Ae.getBuffered(B))}),this.appendErrors[o]=0,o==="audio"||o==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(C.BUFFER_APPENDED,{type:o,frag:u,part:f,chunkMeta:d,parent:u.type,timeRanges:k})},onError:O=>{var k;const G={type:Ee.MEDIA_ERROR,parent:u.type,details:X.BUFFER_APPEND_ERROR,sourceBufferName:o,frag:u,part:f,chunkMeta:d,error:O,err:O,fatal:!1},B=(k=this.media)==null?void 0:k.error;if(O.code===DOMException.QUOTA_EXCEEDED_ERR||O.name=="QuotaExceededError"||"quota"in O)G.details=X.BUFFER_FULL_ERROR;else if(O.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!B)G.errorAction=ha(!0);else if(O.name===t1&&this.sourceBufferCount===0)G.errorAction=ha(!0);else{const K=++this.appendErrors[o];this.warn(`Failed ${K}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${o}" sourceBuffer (${B||"no media error"})`),(K>=this.hls.config.appendErrorMaxRetry||B)&&(G.fatal=!0)}this.hls.trigger(C.ERROR,G)}};this.log(`queuing "${o}" append sn: ${y}${f?" p: "+f.index:""} of ${u.type===ge.MAIN?"level":"track"} ${u.level} cc: ${x}`),this.append($,o,this.isPending(this.tracks[o]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(C.BUFFER_FLUSHED,{type:e})},onError:r=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,r)}}}onBufferFlushing(e,t){const{type:n,startOffset:r,endOffset:o}=t;n?this.append(this.getFlushOp(n,r,o),n):this.sourceBuffers.forEach(([l])=>{l&&this.append(this.getFlushOp(l,r,o),l)})}onFragParsed(e,t){const{frag:n,part:r}=t,o=[],l=r?r.elementaryStreams:n.elementaryStreams;l[et.AUDIOVIDEO]?o.push("audiovideo"):(l[et.AUDIO]&&o.push("audio"),l[et.VIDEO]&&o.push("video"));const u=()=>{const f=self.performance.now();n.stats.buffering.end=f,r&&(r.stats.buffering.end=f);const d=r?r.stats:n.stats;this.hls.trigger(C.FRAG_BUFFERED,{frag:n,part:r,stats:d,id:n.type})};o.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(u,o).catch(f=>{this.warn(`Fragment buffered callback ${f}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([l])=>{if(l){const u=this.tracks[l];(!t.type||t.type===l)&&(u.ending=!0,u.ended||(u.ended=!0,this.log(`${l} buffer reached EOS`)))}});const r=((n=this.overrides)==null?void 0:n.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([l])=>{var u;return l&&!((u=this.tracks[l])!=null&&u.ended)})?r?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:l}=this;if(!l||l.readyState!=="open"){l&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${l.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),l.endOfStream(),this.hls.trigger(C.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(C.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===X.BUFFER_APPEND_ERROR&&t.frag){var n;const r=(n=t.errorAction)==null?void 0:n.nextAutoLevel;me(r)&&r!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.sourceBufferCount)return;const r=e.config,o=n.currentTime,l=t.levelTargetDuration,u=t.live&&r.liveBackBufferLength!==null?r.liveBackBufferLength:r.backBufferLength;if(me(u)&&u>=0){const d=Math.max(u,l),m=Math.floor(o/l)*l-d;this.flushBackBuffer(o,l,m)}const f=r.frontBufferFlushThreshold;if(me(f)&&f>0){const d=Math.max(r.maxBufferLength,f),m=Math.max(d,l),g=Math.floor(o/l)*l+m;this.flushFrontBuffer(o,l,g)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([r,o])=>{if(o){const u=Ae.getBuffered(o);if(u.length>0&&n>u.start(0)){var l;this.hls.trigger(C.BACK_BUFFER_REACHED,{bufferEnd:n});const f=this.tracks[r];if((l=this.details)!=null&&l.live)this.hls.trigger(C.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(f!=null&&f.ended){this.log(`Cannot flush ${r} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:r})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([r,o])=>{if(o){const l=Ae.getBuffered(o),u=l.length;if(u<2)return;const f=l.start(u-1),d=l.end(u-1);if(n>f||e>=f&&e<=d)return;this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:f,endOffset:1/0,type:r})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||n?.readyState!=="open")return null;const r=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&n.setLiveSeekableRange){const d=Math.max(0,t.fragmentStart),m=Math.max(d,r);return{duration:1/0,start:d,end:m}}return{duration:1/0}}const o=(e=this.overrides)==null?void 0:e.duration;if(o)return me(o)?{duration:o}:null;const l=this.media.duration,u=me(n.duration)?n.duration:0;return r>u&&r>l||!me(l)?{duration:r}:null}updateMediaSource({duration:e,start:t,end:n}){const r=this.mediaSource;!this.media||!r||r.readyState!=="open"||(r.duration!==e&&(me(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),t!==void 0&&n!==void 0&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${t}-${n}.`),r.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${tt(n)}`),this.tracksReady){var r;const o=(r=this.transferData)==null?void 0:r.tracks;o&&Object.keys(o).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const r=this.tracks[t];e[t]={buffer:n,container:r.container,codec:r.codec,supplemental:r.supplemental,levelCodec:r.levelCodec,id:r.id,metadata:r.metadata}}}),this.hls.trigger(C.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const o in e){const l=o,u=e[l];if(this.isPending(u)){const f=this.getTrackCodec(u,l),d=`${u.container};codecs=${f}`;u.codec=f,this.log(`creating sourceBuffer(${d})${this.currentOp(l)?" Queued":""} ${tt(u)}`);try{const m=n.addSourceBuffer(d),g=Wh(l),y=[l,m];t[g]=y,u.buffer=m}catch(m){var r;this.error(`error while trying to add sourceBuffer: ${m.message}`),this.shiftAndExecuteNext(l),(r=this.operationQueue)==null||r.removeBlockers(),delete this.tracks[l],this.hls.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:m,sourceBufferName:l,mimeType:d,parent:u.id});return}this.trackSourceBuffer(l,u)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let r=e.codec;n&&(t==="video"||t==="audiovideo")&&Ho(n,"video")&&(r=oF(r,n));const o=tu(r,e.levelCodec);return o?t.slice(0,5)==="audio"?xu(o,this.appendSource):o:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const r=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:r,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(o,l)=>{const u=l.removedRanges;u!=null&&u.length&&this.hls.trigger(C.BUFFER_FLUSHED,{type:o})})}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n?.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${r}`,t),this.hls.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const o=this.currentOp(e);o&&o.onError(r)}updateTimestampOffset(e,t,n,r,o,l){const u=t-e.timestampOffset;Math.abs(u)>=n&&(this.log(`Updating ${r} SourceBuffer timestampOffset to ${t} (sn: ${o} cc: ${l})`),e.timestampOffset=t)}removeExecutor(e,t,n){const{media:r,mediaSource:o}=this,l=this.tracks[e],u=l?.buffer;if(!r||!o||!u){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const f=me(r.duration)?r.duration:1/0,d=me(o.duration)?o.duration:1/0,m=Math.max(0,t),g=Math.min(n,f,d);g>m&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${m},${g}] from the ${e} SourceBuffer`),u.remove(m,g)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],r=n?.buffer;if(!r)throw new pB(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,r.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,r=t.map(l=>this.appendBlocker(l));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(r).then(l=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var n;const r=(n=this.tracks[t])==null?void 0:n.buffer;!r||r.updating||this.shiftAndExecuteNext(t)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const r=this.tracks[e];if(!r)return;const o=r.buffer;if(!o)return;const l=n.bind(this,e);r.listeners.push({event:t,listener:l}),o.addEventListener(t,l)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(r=>{n.removeEventListener(r.event,r.listener)}),t.listeners.length=0)}}function fS(s){const e=s.querySelectorAll("source");[].slice.call(e).forEach(t=>{s.removeChild(t)})}function vB(s,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,s.appendChild(t)}function Wh(s){return s==="audio"?1:0}class np{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(C.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.BUFFER_CODECS,this.onBufferCodecs,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(C.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&me(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((r,o)=>this.isLevelAllowed(r)&&o<=e);return this.clientRect=null,np.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const r=(u,f)=>f?u.width!==f.width||u.height!==f.height:!0;let o=e.length-1;const l=Math.max(t,n);for(let u=0;u<e.length;u+=1){const f=e[u];if((f.width>=l||f.height>=l)&&r(f,e[u+1])){o=u;break}}return o}}const xB={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},nn=xB,EB={HLS:"h"},SB=EB;class ds{constructor(e,t){Array.isArray(e)&&(e=e.map(n=>n instanceof ds?n:new ds(n))),this.value=e,this.params=t}}const TB="Dict";function bB(s){return Array.isArray(s)?JSON.stringify(s):s instanceof Map?"Map{}":s instanceof Set?"Set{}":typeof s=="object"?JSON.stringify(s):String(s)}function AB(s,e,t,n){return new Error(`failed to ${s} "${bB(e)}" as ${t}`,{cause:n})}function fs(s,e,t){return AB("serialize",s,e,t)}class n1{constructor(e){this.description=e}}const hS="Bare Item",RB="Boolean";function LB(s){if(typeof s!="boolean")throw fs(s,RB);return s?"?1":"?0"}function CB(s){return btoa(String.fromCharCode(...s))}const _B="Byte Sequence";function wB(s){if(ArrayBuffer.isView(s)===!1)throw fs(s,_B);return`:${CB(s)}:`}const DB="Integer";function IB(s){return s<-999999999999999||999999999999999<s}function s1(s){if(IB(s))throw fs(s,DB);return s.toString()}function OB(s){return`@${s1(s.getTime()/1e3)}`}function i1(s,e){if(s<0)return-i1(-s,e);const t=Math.pow(10,e);if(Math.abs(s*t%1-.5)<Number.EPSILON){const r=Math.floor(s*t);return(r%2===0?r:r+1)/t}else return Math.round(s*t)/t}const MB="Decimal";function NB(s){const e=i1(s,3);if(Math.floor(Math.abs(e)).toString().length>12)throw fs(s,MB);const t=e.toString();return t.includes(".")?t:`${t}.0`}const kB="String",PB=/[\x00-\x1f\x7f]+/;function FB(s){if(PB.test(s))throw fs(s,kB);return`"${s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function UB(s){return s.description||s.toString().slice(7,-1)}const BB="Token";function mS(s){const e=UB(s);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw fs(e,BB);return e}function Bm(s){switch(typeof s){case"number":if(!me(s))throw fs(s,hS);return Number.isInteger(s)?s1(s):NB(s);case"string":return FB(s);case"symbol":return mS(s);case"boolean":return LB(s);case"object":if(s instanceof Date)return OB(s);if(s instanceof Uint8Array)return wB(s);if(s instanceof n1)return mS(s);default:throw fs(s,hS)}}const $B="Key";function $m(s){if(/^[a-z*][a-z0-9\-_.*]*$/.test(s)===!1)throw fs(s,$B);return s}function sp(s){return s==null?"":Object.entries(s).map(([e,t])=>t===!0?`;${$m(e)}`:`;${$m(e)}=${Bm(t)}`).join("")}function r1(s){return s instanceof ds?`${Bm(s.value)}${sp(s.params)}`:Bm(s)}function jB(s){return`(${s.value.map(r1).join(" ")})${sp(s.params)}`}function GB(s,e={whitespace:!0}){if(typeof s!="object"||s==null)throw fs(s,TB);const t=s instanceof Map?s.entries():Object.entries(s),n=e?.whitespace?" ":"";return Array.from(t).map(([r,o])=>{o instanceof ds||(o=new ds(o));let l=$m(r);return o.value===!0?l+=sp(o.params):(l+="=",Array.isArray(o.value)?l+=jB(o):l+=r1(o)),l}).join(`,${n}`)}function a1(s,e){return GB(s,e)}const ns="CMCD-Object",dt="CMCD-Request",Zi="CMCD-Session",Si="CMCD-Status",HB={br:ns,ab:ns,d:ns,ot:ns,tb:ns,tpb:ns,lb:ns,tab:ns,lab:ns,url:ns,pb:dt,bl:dt,tbl:dt,dl:dt,ltc:dt,mtp:dt,nor:dt,nrr:dt,rc:dt,sn:dt,sta:dt,su:dt,ttfb:dt,ttfbb:dt,ttlb:dt,cmsdd:dt,cmsds:dt,smrt:dt,df:dt,cs:dt,ts:dt,cid:Zi,pr:Zi,sf:Zi,sid:Zi,st:Zi,v:Zi,msd:Zi,bs:Si,bsd:Si,cdn:Si,rtp:Si,bg:Si,pt:Si,ec:Si,e:Si},VB={REQUEST:dt};function KB(s){return Object.keys(s).reduce((e,t)=>{var n;return(n=s[t])===null||n===void 0||n.forEach(r=>e[r]=t),e},{})}function zB(s,e){const t={};if(!s)return t;const n=Object.keys(s),r=e?KB(e):{};return n.reduce((o,l)=>{var u;const f=HB[l]||r[l]||VB.REQUEST,d=(u=o[f])!==null&&u!==void 0?u:o[f]={};return d[l]=s[l],o},t)}function YB(s){return["ot","sf","st","e","sta"].includes(s)}function qB(s){return typeof s=="number"?me(s):s!=null&&s!==""&&s!==!1}const o1="event";function XB(s,e){const t=new URL(s),n=new URL(e);if(t.origin!==n.origin)return s;const r=t.pathname.split("/").slice(1),o=n.pathname.split("/").slice(1,-1);for(;r[0]===o[0];)r.shift(),o.shift();for(;o.length;)o.shift(),r.unshift("..");return r.join("/")+t.search+t.hash}const au=s=>Math.round(s),jm=(s,e)=>Array.isArray(s)?s.map(t=>jm(t,e)):s instanceof ds&&typeof s.value=="string"?new ds(jm(s.value,e),s.params):(e.baseUrl&&(s=XB(s,e.baseUrl)),e.version===1?encodeURIComponent(s):s),Gc=s=>au(s/100)*100,WB=(s,e)=>{let t=s;return e.version>=2&&(s instanceof ds&&typeof s.value=="string"?t=new ds([s]):typeof s=="string"&&(t=[s])),jm(t,e)},QB={br:au,d:au,bl:Gc,dl:Gc,mtp:Gc,nor:WB,rtp:Gc,tb:au},l1="request",c1="response",ip=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],ZB=["e"],JB=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Qu(s){return JB.test(s)}function e3(s){return ip.includes(s)||ZB.includes(s)||Qu(s)}const u1=["d","dl","nor","ot","rtp","su"];function t3(s){return ip.includes(s)||u1.includes(s)||Qu(s)}const n3=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function s3(s){return ip.includes(s)||u1.includes(s)||n3.includes(s)||Qu(s)}const i3=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function r3(s){return i3.includes(s)||Qu(s)}const a3={[c1]:s3,[o1]:e3,[l1]:t3};function d1(s,e={}){const t={};if(s==null||typeof s!="object")return t;const n=e.version||s.v||1,r=e.reportingMode||l1,o=n===1?r3:a3[r];let l=Object.keys(s).filter(o);const u=e.filter;typeof u=="function"&&(l=l.filter(u));const f=r===c1||r===o1;f&&!l.includes("ts")&&l.push("ts"),n>1&&!l.includes("v")&&l.push("v");const d=Ze({},QB,e.formatters),m={version:n,reportingMode:r,baseUrl:e.baseUrl};return l.sort().forEach(g=>{let y=s[g];const x=d[g];if(typeof x=="function"&&(y=x(y,m)),g==="v"){if(n===1)return;y=n}g=="pr"&&y===1||(f&&g==="ts"&&!me(y)&&(y=Date.now()),qB(y)&&(YB(g)&&typeof y=="string"&&(y=new n1(y)),t[g]=y))}),t}function o3(s,e={}){const t={};if(!s)return t;const n=d1(s,e),r=zB(n,e?.customHeaderMap);return Object.entries(r).reduce((o,[l,u])=>{const f=a1(u,{whitespace:!1});return f&&(o[l]=f),o},t)}function l3(s,e,t){return Ze(s,o3(e,t))}const c3="CMCD";function u3(s,e={}){return s?a1(d1(s,e),{whitespace:!1}):""}function d3(s,e={}){if(!s)return"";const t=u3(s,e);return encodeURIComponent(t)}function f3(s,e={}){if(!s)return"";const t=d3(s,e);return`${c3}=${t}`}const gS=/CMCD=[^&#]+/;function h3(s,e,t){const n=f3(e,t);if(!n)return s;if(gS.test(s))return s.replace(gS,n);const r=s.includes("?")?"&":"?";return`${s}${r}${n}`}class m3{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:nn.MANIFEST,su:!this.initialized})}catch(o){this.hls.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=r=>{try{const{frag:o,part:l}=r,u=this.hls.levels[o.level],f=this.getObjectType(o),d={d:(l||o).duration*1e3,ot:f};(f===nn.VIDEO||f===nn.AUDIO||f==nn.MUXED)&&(d.br=u.bitrate/1e3,d.tb=this.getTopBandwidth(f)/1e3,d.bl=this.getBufferLength(f));const m=l?this.getNextPart(l):this.getNextFrag(o);m!=null&&m.url&&m.url!==o.url&&(d.nor=m.url),this.apply(r,d)}catch(o){this.hls.logger.warn("Could not generate segment CMCD data.",o)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHED,this.onMediaDetached,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHED,this.onMediaDetached,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:SB.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ze(t,this.createData());const n=t.ot===nn.INIT||t.ot===nn.VIDEO||t.ot===nn.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((l,u)=>(r.includes(u)&&(l[u]=t[u]),l),{}));const o={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),l3(e.headers,t,o)):e.url=h3(e.url,t,o)}getNextFrag(e){var t;const n=(t=this.hls.levels[e.level])==null?void 0:t.details;if(n){const r=e.sn-n.startSN;return n.fragments[r+1]}}getNextPart(e){var t;const{index:n,fragment:r}=e,o=(t=this.hls.levels[r.level])==null||(t=t.details)==null?void 0:t.partList;if(o){const{sn:l}=r;for(let u=o.length-1;u>=0;u--){const f=o[u];if(f.index===n&&f.fragment.sn===l)return o[u+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return nn.TIMED_TEXT;if(e.sn==="initSegment")return nn.INIT;if(t==="audio")return nn.AUDIO;if(t==="main")return this.hls.audioTracks.length?nn.VIDEO:nn.MUXED}getTopBandwidth(e){let t=0,n;const r=this.hls;if(e===nn.AUDIO)n=r.audioTracks;else{const o=r.maxAutoLevel,l=o>-1?o+1:r.levels.length;n=r.levels.slice(0,l)}return n.forEach(o=>{o.bitrate>t&&(t=o.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,n=e===nn.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Ae.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new n(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,l,u){t(o),this.loader.load(o,l,u)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new n(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,l,u){t(o),this.loader.load(o,l,u)}}}}const g3=3e5;class p3 extends Pn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if(n?.action===Pt.SendAlternateToPenaltyBox&&n.flags===pn.MoveAllAlternatesMatchingHost){const r=this.levels;let o=this._pathwayPriority,l=this.pathwayId;if(t.context){const{groupId:u,pathwayId:f,type:d}=t.context;u&&r?l=this.getPathwayForGroupId(u,d,l):f&&(l=f)}l in this.penalizedPathways||(this.penalizedPathways[l]=performance.now()),!o&&r&&(o=this.pathways()),o&&o.length>1&&(this.updatePathwayPriority(o),n.resolved=this.pathwayId!==l),t.details===X.BUFFER_APPEND_ERROR&&!t.fatal?n.resolved=!0:n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${l} levels: ${r&&r.length} priorities: ${tt(o)} penalized: ${tt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(o=>{r-n[o]>g3&&delete n[o]});for(let o=0;o<e.length;o++){const l=e[o];if(l in n)continue;if(l===this.pathwayId)return;const u=this.hls.nextLoadLevel,f=this.hls.levels[u];if(t=this.getLevelsForPathway(l),t.length>0){this.log(`Setting Pathway to "${l}"`),this.pathwayId=l,IR(t),this.hls.trigger(C.LEVELS_UPDATED,{levels:t});const d=this.hls.levels[u];f&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==f.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==f.bitrate&&this.log(`Unstable Pathways change from bitrate ${f.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=u);break}}}getPathwayForGroupId(e,t,n){const r=this.getLevelsForPathway(n).concat(this.levels||[]);for(let o=0;o<r.length;o++)if(t===Me.AUDIO_TRACK&&r[o].hasAudioGroup(e)||t===Me.SUBTITLE_TRACK&&r[o].hasSubtitleGroup(e))return r[o].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach(o=>{const{ID:l,"BASE-ID":u,"URI-REPLACEMENT":f}=o;if(t.some(m=>m.pathwayId===l))return;const d=this.getLevelsForPathway(u).map(m=>{const g=new ot(m.attrs);g["PATHWAY-ID"]=l;const y=g.AUDIO&&`${g.AUDIO}_clone_${l}`,x=g.SUBTITLES&&`${g.SUBTITLES}_clone_${l}`;y&&(n[g.AUDIO]=y,g.AUDIO=y),x&&(r[g.SUBTITLES]=x,g.SUBTITLES=x);const E=f1(m.uri,g["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",f),S=new Ko({attrs:g,audioCodec:m.audioCodec,bitrate:m.bitrate,height:m.height,name:m.name,url:E,videoCodec:m.videoCodec,width:m.width});if(m.audioGroups)for(let b=1;b<m.audioGroups.length;b++)S.addGroupId("audio",`${m.audioGroups[b]}_clone_${l}`);if(m.subtitleGroups)for(let b=1;b<m.subtitleGroups.length;b++)S.addGroupId("text",`${m.subtitleGroups[b]}_clone_${l}`);return S});t.push(...d),pS(this.audioTracks,n,f,l),pS(this.subtitleTracks,r,f,l)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const m=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+m)}const o={responseType:"json",url:r.href},l=t.steeringManifestLoadPolicy.default,u=l.errorRetry||l.timeoutRetry||{},f={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},d={onSuccess:(m,g,y,x)=>{this.log(`Loaded steering manifest: "${r}"`);const E=m.data;if(E?.VERSION!==1){this.log(`Steering VERSION ${E.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=E.TTL;const{"RELOAD-URI":S,"PATHWAY-CLONES":b,"PATHWAY-PRIORITY":R}=E;if(S)try{this.uri=new self.URL(S,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${S}`);return}this.scheduleRefresh(this.uri||y.url),b&&this.clonePathways(b);const w={steeringManifest:E,url:r.toString()};this.hls.trigger(C.STEERING_MANIFEST_LOADED,w),R&&this.updatePathwayPriority(R)},onError:(m,g,y,x)=>{if(this.log(`Error loading steering manifest: ${m.code} ${m.text} (${g.url})`),this.stopLoad(),m.code===410){this.enabled=!1,this.log(`Steering manifest ${g.url} no longer available`);return}let E=this.timeToLoad*1e3;if(m.code===429){const S=this.loader;if(typeof S?.getResponseHeader=="function"){const b=S.getResponseHeader("Retry-After");b&&(E=parseFloat(b)*1e3)}this.log(`Steering manifest ${g.url} rate limited`);return}this.scheduleRefresh(this.uri||g.url,E)},onTimeout:(m,g,y)=>{this.log(`Timeout loading steering manifest (${g.url})`),this.scheduleRefresh(this.uri||g.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(o,f,d)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const r=(n=this.hls)==null?void 0:n.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function pS(s,e,t,n){s&&Object.keys(e).forEach(r=>{const o=s.filter(l=>l.groupId===r).map(l=>{const u=Ze({},l);return u.details=void 0,u.attrs=new ot(u.attrs),u.url=u.attrs.URI=f1(l.url,l.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),u.groupId=u.attrs["GROUP-ID"]=e[r],u.attrs["PATHWAY-ID"]=n,u});s.push(...o)})}function f1(s,e,t,n){const{HOST:r,PARAMS:o,[t]:l}=n;let u;e&&(u=l?.[e],u&&(s=u));const f=new self.URL(s);return r&&!u&&(f.host=r),o&&Object.keys(o).sort().forEach(d=>{d&&f.searchParams.set(d,o[d])}),f.href}class ga extends Pn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=ga.CDMCleanupPromise?[ga.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:n,initData:r}=t,o=`"${t.type}" event: init data type: "${n}"`;if(this.debug(o),r!==null){if(!this.keyFormatPromise){let l=Object.keys(this.keySystemAccessPromises);l.length||(l=Do(this.config));const u=l.map(Gh).filter(f=>!!f);this.keyFormatPromise=this.getKeyFormatPromise(u)}this.keyFormatPromise.then(l=>{const u=su(l);if(n!=="sinf"||u!==lt.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${n}" for selected key-system ${u}`);return}let f;try{const x=bt(new Uint8Array(r)),E=zg(JSON.parse(x).sinf),S=aR(E);if(!S)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");f=new Uint8Array(S.subarray(8,24))}catch(x){this.warn(`${o} Failed to parse sinf: ${x}`);return}const d=Ft(f),{keyIdToKeySessionPromise:m,mediaKeySessions:g}=this;let y=m[d];for(let x=0;x<g.length;x++){const E=g[x],S=E.decryptdata;if(!S.keyId)continue;const b=Ft(S.keyId);if(Au(f,S.keyId)||S.uri.replace(/-/g,"").indexOf(d)!==-1){if(y=m[b],!y)continue;if(S.pssh)break;delete m[b],S.pssh=new Uint8Array(r),S.keyId=f,y=m[d]=y.then(()=>this.generateRequestWithPreferredKeySession(E,n,r,"encrypted-event-key-match")),y.catch(R=>this.handleError(R));break}}y||this.handleError(new Error(`Key ID ${d} not encountered in playlist. Key-system sessions ${g.length}.`))}).catch(l=>this.handleError(l))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(C.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(C.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(C.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(C.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(C.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(C.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t?.[e];if(r)return r.licenseUrl;if(e===lt.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t?.[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(l,u,f)=>!!l&&f.indexOf(l)===u,r=t.map(l=>l.audioCodec).filter(n),o=t.map(l=>l.videoCodec).filter(n);return r.length+o.length===0&&o.push("avc1.42e01e"),new Promise((l,u)=>{const f=d=>{const m=d.shift();this.getMediaKeysPromise(m,r,o).then(g=>l({keySystem:m,mediaKeys:g})).catch(g=>{d.length?f(d):g instanceof gn?u(g):u(new gn({type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_ACCESS,error:g,fatal:!0},g.message))})};f(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${n}`;return bR===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return n(e,t)}getMediaKeysPromise(e,t,n){var r;const o=WF(e,t,n,this.config.drmSystemOptions||{});let l=this.keySystemAccessPromises[e],u=(r=l)==null?void 0:r.keySystemAccess;if(!u){this.log(`Requesting encrypted media "${e}" key-system access with config: ${tt(o)}`),u=this.requestMediaKeySystemAccess(e,o);const f=l=this.keySystemAccessPromises[e]={keySystemAccess:u};return u.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),u.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const m=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const g=f.mediaKeys=d.createMediaKeys().then(y=>(this.log(`Media-keys created for "${e}"`),f.hasMediaKeys=!0,m.then(x=>x?this.setMediaKeysServerCertificate(y,e,x):y)));return g.catch(y=>{this.error(`Failed to create media-keys for "${e}"}: ${y}`)}),g})}return u.then(()=>l.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Ft(e.keyId||[])} keyUri: ${e.uri}`);const r=n.createSession(),o={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),r=Hc(t),o="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,o,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyId ${Ft(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Gh(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:n})=>this.attemptSetMediaKeys(t,n))}selectKeySystem(e){return new Promise((t,n)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:r})=>{const o=Gh(r);o?t(o):n(new Error(`Unable to find format for key-system "${r}"`))}).catch(n)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Do(this.config),n=e.map(su).filter(r=>!!r&&t.indexOf(r)!==-1);return this.selectKeySystem(n)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let n=0;n<t.length;n++){const r=y3(e,t[n]);if(r)return r}}loadKey(e){const t=e.keyInfo.decryptdata,n=Hc(t),r=this.bannedKeyIds[n];if(r||this.getKeyStatus(t)==="internal-error"){const u=yS(r||"internal-error",t);return this.handleError(u,e.frag),Promise.reject(u)}const o=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${o}`);const l=this.keyIdToKeySessionPromise[n];if(!l){const u=this.getKeySystemForKeyPromise(t).then(({keySystem:f,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${o}`),this.attemptSetMediaKeys(f,d).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:f,mediaKeys:d,decryptdata:t}))))).then(f=>{const d="cenc",m=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(f,d,m,"playlist-key")});return u.catch(f=>this.handleError(f,e.frag)),this.keyIdToKeySessionPromise[n]=u,u}return l.catch(u=>{if(u instanceof gn){const f=Ye({},u.data);this.getKeyStatus(t)==="internal-error"&&(f.decryptdata=t);const d=new gn(f,u.message);this.handleError(d,e.frag)}}),l}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof gn){t&&(e.data.frag=t);const n=e.data.decryptdata;this.error(`${e.message}${n?` (${Ft(n.keyId||[])})`:""}`),this.hls.trigger(C.ERROR,e.data)}else this.error(e.message),this.hls.trigger(C.ERROR,{type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=Hc(e),n=this.keyIdToKeySessionPromise[t];if(!n){const r=su(e.keyFormat),o=r?[r]:Do(this.config);return this.attemptKeySystemAccess(o)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Do(this.config)),e.length===0)throw new gn({type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${tt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(n).then(()=>this.media?this.media.setMediaKeys(t):new Promise((o,l)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return l(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(o).catch(l)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>n.indexOf(o)===-1)})}generateRequestWithPreferredKeySession(e,t,n,r){var o;const l=(o=this.config.drmSystems)==null||(o=o[e.keySystem])==null?void 0:o.generateRequest;if(l)try{const E=l.call(this.hls,t,n,e);if(!E)throw new Error("Invalid response from configured generateRequest filter");t=E.initDataType,n=E.initData?E.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(E){if(this.warn(E.message),this.hls&&this.hls.config.debug)throw E}if(n===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const u=Hc(e.decryptdata),f=e.decryptdata.uri;this.log(`Generating key-session request for "${r}" keyId: ${u} URI: ${f} (init data type: ${t} length: ${n.byteLength})`);const d=new qg,m=e._onmessage=E=>{const S=e.mediaKeysSession;if(!S){d.emit("error",new Error("invalid state"));return}const{messageType:b,message:R}=E;this.log(`"${b}" message event for session "${S.sessionId}" message size: ${R.byteLength}`),b==="license-request"||b==="license-renewal"?this.renewLicense(e,R).catch(w=>{d.eventNames().length?d.emit("error",w):this.handleError(w)}):b==="license-release"?e.keySystem===lt.FAIRPLAY&&this.updateKeySession(e,Mm("acknowledged")).then(()=>this.removeSession(e)).catch(w=>this.handleError(w)):this.warn(`unhandled media key message type "${b}"`)},g=(E,S)=>{S.keyStatus=E;let b;E.startsWith("usable")?d.emit("resolved"):E==="internal-error"||E==="output-restricted"||E==="output-downscaled"?b=yS(E,S.decryptdata):E==="expired"?b=new Error(`key expired (keyId: ${u})`):E==="released"?b=new Error("key released"):E==="status-pending"||this.warn(`unhandled key status change "${E}" (keyId: ${u})`),b&&(d.eventNames().length?d.emit("error",b):this.handleError(b))},y=e._onkeystatuseschange=E=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}const b=this.getKeyStatuses(e);if(!Object.keys(b).some(D=>b[D]!=="status-pending"))return;if(b[u]==="expired"){this.log(`Expired key ${tt(b)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let w=b[u];if(w)g(w,e);else{var _;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(_=e.keyStatusTimeouts)[u]||(_[u]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const M=this.getKeyStatus(e.decryptdata);if(M&&M!=="status-pending")return this.log(`No status for keyId ${u} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${M} from other session.`),g(M,e);this.log(`key status for ${u} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),w="internal-error",g(w,e)},1e3)),this.log(`No status for keyId ${u} (${tt(b)}).`)}};zt(e.mediaKeysSession,"message",m),zt(e.mediaKeysSession,"keystatuseschange",y);const x=new Promise((E,S)=>{d.on("error",S),d.on("resolved",E)});return e.mediaKeysSession.generateRequest(t,n).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${u} URI: ${f}`)}).catch(E=>{throw new gn({type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_SESSION,error:E,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${E}`)}).then(()=>x).catch(E=>(d.removeAllListeners(),this.removeSession(e).then(()=>{throw E}))).then(()=>(d.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((n,r)=>{if(typeof r=="string"&&typeof n=="object"){const u=r;r=n,n=u}const o="buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r);if(e.keySystem===lt.PLAYREADY&&o.length===16){const u=Ft(o);t[u]=n,SR(o)}const l=Ft(o);n==="internal-error"&&(this.bannedKeyIds[l]=n),this.log(`key status change "${n}" for keyStatuses keyId: ${l} key-session "${e.mediaKeysSession.sessionId}"`),t[l]=n}),t}fetchServerCertificate(e){const t=this.config,n=t.loader,r=new n(t),o=this.getServerCertificateUrl(e);return o?(this.log(`Fetching server certificate for "${e}"`),new Promise((l,u)=>{const f={responseType:"arraybuffer",url:o},d=t.certLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(y,x,E,S)=>{l(y.data)},onError:(y,x,E,S)=>{u(new gn({type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:Ye({url:f.url,data:void 0},y)},`"${e}" certificate request failed (${o}). Status: ${y.code} (${y.text})`))},onTimeout:(y,x,E)=>{u(new gn({type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:{url:f.url,data:void 0}},`"${e}" certificate request timed out (${o})`))},onAbort:(y,x,E)=>{u(new Error("aborted"))}};r.load(f,m,g)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((r,o)=>{e.setServerCertificate(n).then(l=>{this.log(`setServerCertificate ${l?"success":"not supported by CDM"} (${n.byteLength}) on "${t}"`),r(e)}).catch(l=>{o(new gn({type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:l,fatal:!0},l.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(r=>{throw new gn({type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:r,fatal:!1},r.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(n,"application/xml"),o=r.querySelectorAll("HttpHeader");if(o.length>0){let m;for(let g=0,y=o.length;g<y;g++){var l,u;m=o[g];const x=(l=m.querySelector("name"))==null?void 0:l.textContent,E=(u=m.querySelector("value"))==null?void 0:u.textContent;x&&E&&e.setRequestHeader(x,E)}}const f=r.querySelector("Challenge"),d=f?.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return Mm(atob(d))}setupLicenseXHR(e,t,n,r){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return o.call(this.hls,e,t,n,r)}).catch(l=>{if(!n.decryptdata)throw l;return e.open("POST",t,!0),o.call(this.hls,e,t,n,r)}).then(l=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:l||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((r,o)=>{const l=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${l}`);const u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return o(new Error("invalid state"));if(u.readyState===4)if(u.status===200){this._requestLicenseFailureCount=0;let f=u.response;this.log(`License received ${f instanceof ArrayBuffer?f.byteLength:f}`);const d=this.config.licenseResponseCallback;if(d)try{f=d.call(this.hls,u,l,e)}catch(m){this.error(m)}r(f)}else{const f=n.errorRetry,d=f?f.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||u.status>=400&&u.status<500)o(new gn({type:Ee.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:u,response:{url:l,data:void 0,code:u.status,text:u.statusText}},`License Request XHR failed (${l}). Status: ${u.status} (${u.statusText})`));else{const m=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${m} attempts left`),this.requestLicense(e,t).then(r,o)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=u,this.setupLicenseXHR(u,l,e,t).then(({xhr:f,licenseChallenge:d})=>{e.keySystem==lt.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(f,d)),f.send(d)}).catch(o)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,zt(n,"encrypted",this.onMediaEncrypted),zt(n,"waitingforkey",this.onWaitingForKey);const r=this.mediaResolved;r?r():this.mediaKeys=n.mediaKeys}onMediaDetached(){const e=this.media;e&&(rn(e,"encrypted",this.onMediaEncrypted),rn(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const n=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Ci.clearKeyUriToKeyIdMap();const o=r.length;ga.CDMCleanupPromise=Promise.all(r.map(l=>this.removeSession(l)).concat((n==null||(e=n.setMediaKeys(null))==null?void 0:e.catch(l=>{this.log(`Could not clear media keys: ${l}`),this.hls&&this.hls.trigger(C.ERROR,{type:Ee.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${l}`)})}))||Promise.resolve())).catch(l=>{this.log(`Could not close sessions and clear media keys: ${l}`),this.hls&&this.hls.trigger(C.ERROR,{type:Ee.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${l}`)})}).then(()=>{o&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((r,o)=>(r.indexOf(o.keyFormat)===-1&&r.push(o.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n,decryptdata:r}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${Ft(r?.keyId||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const o=this.mediaKeySessions.indexOf(e);o>-1&&this.mediaKeySessions.splice(o,1);const{keyStatusTimeouts:l}=e;l&&Object.keys(l).forEach(d=>self.clearTimeout(l[d]));const{drmSystemOptions:u}=this.config;return(ZF(u)?new Promise((d,m)=>{self.setTimeout(()=>m(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(d).catch(m)}):Promise.resolve()).catch(d=>{this.log(`Could not remove session: ${d}`),this.hls&&this.hls.trigger(C.ERROR,{type:Ee.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${d}`)})}).then(()=>t.close()).catch(d=>{this.log(`Could not close session: ${d}`),this.hls&&this.hls.trigger(C.ERROR,{type:Ee.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${d}`)})})}return Promise.resolve()}}ga.CDMCleanupPromise=void 0;function Hc(s){if(!s)throw new Error("Could not read keyId of undefined decryptdata");if(s.keyId===null)throw new Error("keyId is null");return Ft(s.keyId)}function y3(s,e){if(s.keyId&&e.mediaKeysSession.keyStatuses.has(s.keyId))return e.mediaKeysSession.keyStatuses.get(s.keyId);if(s.matches(e.decryptdata))return e.keyStatus}class gn extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function yS(s,e){const t=s==="output-restricted",n=t?X.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:X.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new gn({type:Ee.KEY_SYSTEM_ERROR,details:n,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${s}"`)}class v3{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(C.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(C.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const o=r-this.lastTime,l=n-this.lastDroppedFrames,u=t-this.lastDecodedFrames,f=1e3*l/o,d=this.hls;if(d.trigger(C.FPS_DROP,{currentDropped:l,currentDecoded:u,totalDroppedFrames:n}),f>0&&l>d.config.fpsDroppedMonitoringThreshold*u){let m=d.currentLevel;d.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+m),m>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=m)&&(m=m-1,d.trigger(C.FPS_DROP_LEVEL_CAPPING,{level:m,droppedLevel:d.currentLevel}),d.autoLevelCapping=m,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function h1(s,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=s,e.dispatchEvent(t)}function m1(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues&&!s.cues.getCueById(e.id))try{if(s.addCue(e),!s.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){qe.debug(`[texttrack-utils]: ${n}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,s.addCue(r)}catch(r){qe.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(s.mode=t)}function aa(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues)for(let n=s.cues.length;n--;)e&&s.cues[n].removeEventListener("enter",e),s.removeCue(s.cues[n]);t==="disabled"&&(s.mode=t)}function Gm(s,e,t,n){const r=s.mode;if(r==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0){const o=E3(s.cues,e,t);for(let l=0;l<o.length;l++)(!n||n(o[l]))&&s.removeCue(o[l])}r==="disabled"&&(s.mode=r)}function x3(s,e){if(e<=s[0].startTime)return 0;const t=s.length-1;if(e>s[t].endTime)return-1;let n=0,r=t,o;for(;n<=r;)if(o=Math.floor((r+n)/2),e<s[o].startTime)r=o-1;else if(e>s[o].startTime&&n<t)n=o+1;else return o;return s[n].startTime-e<e-s[r].startTime?n:r}function E3(s,e,t){const n=[],r=x3(s,e);if(r>-1)for(let o=r,l=s.length;o<l;o++){const u=s[o];if(u.startTime>=e&&u.endTime<=t)n.push(u);else if(u.startTime>t)return n}return n}function ou(s){const e=[];for(let t=0;t<s.length;t++){const n=s[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(s[t])}return e}class S3 extends tp{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=ou(this.media.textTracks);for(let o=0;o<n.length;o++)if(n[o].mode==="hidden")t=n[o];else if(n[o].mode==="showing"){t=n[o];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(C.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const r=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,r)return;ou(n.textTracks).forEach(l=>{aa(l)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:r,details:o}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==r){this.warn(`Subtitle track with id:${n} and group:${r} not found in active group ${l?.groupId}`);return}const u=l.details;l.details=t.details,this.log(`Subtitle track ${n} "${l.name}" lang:${l.lang} group:${r} loaded [${o.startSN}-${o.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,r=this.groupIds;let o=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(l=>r?.indexOf(l)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(m=>!n||n.indexOf(m.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(m=>m.default)&&(this.selectDefaultTrack=!1),l.forEach((m,g)=>{m.id=g});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const u=this.hls.config.subtitlePreference;if(!o&&u){this.selectDefaultTrack=!1;const m=os(u,l);if(m>-1)o=l[m];else{const g=os(u,this.tracks);o=this.tracks[g]}}let f=this.findTrackId(o);f===-1&&o&&(f=this.findTrackId(null));const d={subtitleTracks:l};this.log(`Updating subtitle tracks, ${l.length} track(s) found in "${n?.join(",")}" group-id`),this.hls.trigger(C.SUBTITLE_TRACKS_UPDATED,d),f!==-1&&this.trackId===-1&&this.setSubtitleTrack(f)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const o=t[r];if(!(n&&!o.default||!n&&!e)&&(!e||tr(o,e)))return r}if(e){for(let r=0;r<t.length;r++){const o=t[r];if(Xo(e.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const o=t[r];if(Xo(e.attrs,o.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(Um(r,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Me.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&tr(e,n))return n;const r=os(e,this.tracksInGroup);if(r>-1){const o=this.tracksInGroup[r];return this.setSubtitleTrack(r),o}else{if(n)return null;{const o=os(e,t);if(o>-1)return t[o]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,r=e.groupId,o=this.getUrlWithDirectives(e.url,t),l=e.details,u=l?.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${o}`),this.hls.trigger(C.SUBTITLE_TRACK_LOADING,{url:o,id:n,groupId:r,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=ou(e.textTracks),n=this.currentTrack;let r;if(n&&(r=t.filter(o=>Um(n,o))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(o=>{o.mode!=="disabled"&&o!==r&&(o.mode="disabled")}),r){const o=this.subtitleDisplay?"showing":"hidden";r.mode!==o&&(r.mode=o)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!me(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(C.SUBTITLE_TRACK_SWITCH,{id:e});return}const o=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&o)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:l,groupId:u="",name:f,type:d,url:m}=r;this.hls.trigger(C.SUBTITLE_TRACK_SWITCH,{id:l,groupId:u,name:f,type:d,url:m});const g=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(g)}}function T3(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const o=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?o:o&3|8).toString(16)})}}}function ko(s){let e=5381,t=s.length;for(;t;)e=e*33^s.charCodeAt(--t);return(e>>>0).toString()}const pa=.025;let _u=(function(s){return s[s.Point=0]="Point",s[s.Range=1]="Range",s})({});function b3(s,e,t){return`${s.identifier}-${t+1}-${ko(e)}`}class A3{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const n=this.playoutLimit;return e<=0||isNaN(n)?!1:n===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>n}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Qh(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=Qh(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=me(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Qh(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<pa))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?_u.Range:_u.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return R3(this)}}function Qh(s,e){return s-e.start<e.duration/2&&!(Math.abs(s-(e.start+e.duration))<pa)?e.start:e.start+e.duration}function g1(s,e,t){const n=new self.URL(s,t);return n.protocol!=="data:"&&n.searchParams.set("_HLS_primary_id",e),n}function Zh(s,e){for(;(t=s.assetList[++e])!=null&&t.error;)var t;return e}function R3(s){return`["${s.identifier}" ${s.cue.pre?"<pre>":s.cue.post?"<post>":""}${s.timelineStart.toFixed(2)}-${s.resumeTime.toFixed(2)}]`}function ia(s){const e=s.timelineStart,t=s.duration||0;return`["${s.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class L3{constructor(e,t,n,r){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(C.PLAYOUT_LIMIT_REACHED,{})};const o=this.hls=new e(t);this.interstitial=n,this.assetItem=r;const l=()=>{this.hasDetails=!0};o.once(C.LEVEL_LOADED,l),o.once(C.AUDIO_TRACK_LOADED,l),o.once(C.SUBTITLE_TRACK_LOADED,l),o.on(C.MEDIA_ATTACHING,(u,{media:f})=>{this.removeMediaListeners(),this.mediaAttached=f,this.interstitial.playoutLimit&&(f.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&o.on(C.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,o.trigger(C.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=g1(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const n=Math.min(this._bufferedEosTime||1/0,this.duration),r=this.timelineOffset,o=Ae.bufferInfo(e,r,0);return this.getAssetTime(o.end)>=n-.02}reachedPlayout(e){const n=this.interstitial.playoutLimit;return this.startOffset+e>=n}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Ae.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const n=t-this.startOffset;if(n>0&&n<e)return n}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=n=>delete n.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,n){var r;(r=this.hls)==null||r.on(e,t)}once(e,t,n){var r;(r=this.hls)==null||r.once(e,t)}off(e,t,n){var r;(r=this.hls)==null||r.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${ia(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const vS=.033;class C3 extends Pn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,r)=>e<=r.startOffset&&t>r.startOffset?(delete r.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const r=this.items;if(r)for(r[n]||(t===void 0&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&(o=r[n])!=null&&o.event;){var o;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let r=0;r<n.length;r++){let o=n[r];if(t&&t!=="primary"&&(o=o[t]),e===o.start||e>o.start&&e<o.end)return r}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let r=e;r<=t&&n[r];r++){const o=n[r].event;if(o!=null&&o.restrictions.jump&&!o.appendInPlace)return r}return-1}findEventIndex(e){const t=this.items;if(t)for(let r=t.length;r--;){var n;if(((n=t[r].event)==null?void 0:n.identifier)===e)return r}return-1}findAssetIndex(e,t){const n=e.assetList,r=n.length;if(r>1)for(let o=0;o<r;o++){const l=n[o];if(!l.error){const u=l.timelineStart;if(t===u||t>u&&(t<u+(l.duration||0)||o===r-1))return o}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const n=t.assetList,r=n[n.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:r}=n,o=this.events,l=this.parseDateRanges(r,{url:n.url},t),u=Object.keys(r),f=o?o.filter(d=>!u.includes(d.identifier)):[];l.length&&l.sort((d,m)=>{const g=d.cue.pre,y=d.cue.post,x=m.cue.pre,E=m.cue.post;if(g&&!x)return-1;if(x&&!g||y&&!E)return 1;if(E&&!y)return-1;if(!g&&!x&&!y&&!E){const S=d.startTime,b=m.startTime;if(S!==b)return S-b}return d.dateRange.tagOrder-m.dateRange.tagOrder}),this.events=l,f.forEach(d=>{this.removeEvent(d)}),this.updateSchedule(e,f)}updateSchedule(e,t=[],n=!1){const r=this.events||[];if(r.length||t.length||this.length<2){const o=this.items,l=this.parseSchedule(r,e);(n||t.length||o?.length!==l.length||l.some((f,d)=>Math.abs(f.playout.start-o[d].playout.start)>.005||Math.abs(f.playout.end-o[d].playout.end)>.005))&&(this.items=l,this.onScheduleUpdate(t,o))}}parseDateRanges(e,t,n){const r=[],o=Object.keys(e);for(let l=0;l<o.length;l++){const u=o[l],f=e[u];if(f.isInterstitial){let d=this.eventMap[u];d?d.setDateRange(f):(d=new A3(f,t),this.eventMap[u]=d,n===!1&&(d.appendInPlace=n)),r.push(d)}}return r}parseSchedule(e,t){const n=[],r=t.main.details,o=r.live?1/0:r.edge;let l=0;if(e=e.filter(f=>!f.error&&!(f.cue.once&&f.hasPlayed)),e.length){this.resolveOffsets(e,t);let f=0,d=0;if(e.forEach((m,g)=>{const y=m.cue.pre,x=m.cue.post,E=e[g-1]||null,S=m.appendInPlace,b=x?o:m.startOffset,R=m.duration,w=m.timelineOccupancy===_u.Range?R:0,_=m.resumptionOffset,D=E?.startTime===b,M=b+m.cumulativeDuration;let $=S?M+R:b+_;if(y||!x&&b<=0){const k=d;d+=w,m.timelineStart=M;const G=l;l+=R,n.push({event:m,start:M,end:$,playout:{start:G,end:l},integrated:{start:k,end:d}})}else if(b<=o){if(!D){const B=b-f;if(B>vS){const K=f,ne=d;d+=B;const ue=l;l+=B;const ee={previousEvent:e[g-1]||null,nextEvent:m,start:K,end:K+B,playout:{start:ue,end:l},integrated:{start:ne,end:d}};n.push(ee)}else B>0&&E&&(E.cumulativeDuration+=B,n[n.length-1].end=b)}x&&($=M),m.timelineStart=M;const k=d;d+=w;const G=l;l+=R,n.push({event:m,start:M,end:$,playout:{start:G,end:l},integrated:{start:k,end:d}})}else return;const O=m.resumeTime;x||O>o?f=o:f=O}),f<o){var u;const m=f,g=d,y=o-f;d+=y;const x=l;l+=y,n.push({previousEvent:((u=n[n.length-1])==null?void 0:u.event)||null,nextEvent:null,start:f,end:m+y,playout:{start:x,end:l},integrated:{start:g,end:d}})}this.setDurations(o,l,d)}else n.push({previousEvent:null,nextEvent:null,start:0,end:o,playout:{start:0,end:o},integrated:{start:0,end:o}}),this.setDurations(o,o,o);return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,r=n.live?1/0:n.edge;let o=0,l=-1;e.forEach((u,f)=>{const d=u.cue.pre,m=u.cue.post,g=d?0:m?r:u.startTime;this.updateAssetDurations(u),l===g?u.cumulativeDuration=o:(o=0,l=g),!m&&u.snapOptions.in&&(u.resumeAnchor=sr(null,n.fragments,u.startOffset+u.resumptionOffset,0,0)||void 0),u.appendInPlace&&!u.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(u,t)||(u.appendInPlace=!1)),!u.appendInPlace&&f+1<e.length&&e[f+1].startTime-e[f].resumeTime<vS&&(e[f+1].appendInPlace=!1,e[f+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${u}`));const x=me(u.resumeOffset)?u.resumeOffset:u.duration;o+=x})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,r=e.startTime+e.resumptionOffset;return Math.abs(n-r)>pa?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${r}`),!1):!Object.keys(t).some(l=>{const u=t[l].details,f=u.edge;if(n>=f)return this.log(`"${e.identifier}" resumption ${n} past ${l} playlist end ${f}`),!1;const d=sr(null,u.fragments,n);if(!d)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${l} playlist (${u.fragStart}-${u.fragmentEnd})`),!0;const m=l==="audio"?.175:0;return Math.abs(d.start-n)<pa+m||Math.abs(d.end-n)<pa+m?!1:(this.log(`"${e.identifier}" resumption ${n} not aligned with ${l} fragment bounds (${d.start}-${d.end} sn: ${d.sn} cc: ${d.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,r=!1,o=!1;for(let l=0;l<e.assetList.length;l++){const u=e.assetList[l],f=t+n;u.startOffset=n,u.timelineStart=f,r||(r=u.duration===null),o||(o=!!u.error);const d=u.error?0:u.duration||0;n+=d}r&&!o?e.duration=Math.max(n,e.duration):e.duration=n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Hn(s){return`[${s.event?'"'+s.event.identifier+'"':"primary"}: ${s.start.toFixed(2)}-${s.end.toFixed(2)}]`}class _3{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let r;try{r=g1(n,this.hls.sessionId,e.baseUrl)}catch(y){const x=this.assignAssetListError(e,X.ASSET_LIST_LOAD_ERROR,y,n);this.hls.trigger(C.ERROR,x);return}t&&r.protocol!=="data:"&&r.searchParams.set("_HLS_start_offset",""+t);const o=this.hls.config,l=o.loader,u=new l(o),f={responseType:"json",url:r.href},d=o.interstitialAssetListLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(y,x,E,S)=>{const b=y.data,R=b?.ASSETS;if(!Array.isArray(R)){const w=this.assignAssetListError(e,X.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),E.url,x,S);this.hls.trigger(C.ERROR,w);return}e.assetListResponse=b,this.hls.trigger(C.ASSET_LIST_LOADED,{event:e,assetListResponse:b,networkDetails:S})},onError:(y,x,E,S)=>{const b=this.assignAssetListError(e,X.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${y.code} ${y.text} (${x.url})`),x.url,S,E);this.hls.trigger(C.ERROR,b)},onTimeout:(y,x,E)=>{const S=this.assignAssetListError(e,X.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${x.url})`),x.url,y,E);this.hls.trigger(C.ERROR,S)}};return u.load(f,m,g),this.hls.trigger(C.ASSET_LIST_LOADING,{event:e}),u}assignAssetListError(e,t,n,r,o,l){return e.error=n,{type:Ee.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:r,error:n,networkDetails:l,stats:o}}}function xS(s){var e;s==null||(e=s.play())==null||e.catch(()=>{})}function Vc(s,e){return`[${s}] Advancing timeline position to ${e}`}class w3 extends Pn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled||!this.schedule)return;const r=n-this.timelinePos;if(Math.abs(r)<1/7056e5)return;const l=r<=-.01;this.timelinePos=n,this.bufferedPos=n;const u=this.playingItem;if(!u){this.checkBuffer();return}if(l&&this.schedule.resetErrorsInRange(n,n-r)&&this.updateSchedule(!0),this.checkBuffer(),l&&n<u.start||n>=u.end){var f;const x=this.findItemIndex(u);let E=this.schedule.findItemIndexAtTime(n);if(E===-1&&(E=x+(l?-1:1),this.log(`seeked ${l?"back ":""}to position not covered by schedule ${n} (resolving from ${x} to ${E})`)),!this.isInterstitial(u)&&(f=this.media)!=null&&f.paused&&(this.shouldPlay=!1),!l&&E>x){const S=this.schedule.findJumpRestrictedIndex(x+1,E);if(S>x){this.setSchedulePosition(S);return}}this.setSchedulePosition(E);return}const d=this.playingAsset;if(!d){if(this.playingLastItem&&this.isInterstitial(u)){const x=u.event.assetList[0];x&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(n,x))}return}const m=d.timelineStart,g=d.duration||0;if(l&&n<m||n>=m+g){var y;(y=u.event)!=null&&y.appendInPlace&&(this.clearAssetPlayers(u.event,u),this.flushFrontBuffer(n)),this.setScheduleToAssetAtTime(n,d)}},this.onTimeupdate=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;if(n>this.timelinePos)this.timelinePos=n,n>this.bufferedPos&&this.checkBuffer();else return;const r=this.playingItem;if(!r||this.playingLastItem)return;if(n>=r.end){this.timelinePos=r.end;const u=this.findItemIndex(r);this.setSchedulePosition(u+1)}const o=this.playingAsset;if(!o)return;const l=o.timelineStart+(o.duration||0);n>=l&&this.setScheduleToAssetAtTime(n,o)},this.onScheduleUpdate=(n,r)=>{const o=this.schedule;if(!o)return;const l=this.playingItem,u=o.events||[],f=o.items||[],d=o.durations,m=n.map(S=>S.identifier),g=!!(u.length||m.length);(g||r)&&this.log(`INTERSTITIALS_UPDATED (${u.length}): ${u}
Schedule: ${f.map(S=>Hn(S))} pos: ${this.timelinePos}`),m.length&&this.log(`Removed events ${m}`);let y=null,x=null;l&&(y=this.updateItem(l,this.timelinePos),this.itemsMatch(l,y)?this.playingItem=y:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const E=this.bufferingItem;if(E&&(x=this.updateItem(E,this.bufferedPos),this.itemsMatch(E,x)?this.bufferingItem=x:E.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(E.event,null))),n.forEach(S=>{S.assetList.forEach(b=>{this.clearAssetPlayer(b.identifier,null)})}),this.playerQueue.forEach(S=>{if(S.interstitial.appendInPlace){const b=S.assetItem.timelineStart,R=S.timelineOffset-b;if(R)try{S.timelineOffset=b}catch(w){Math.abs(R)>pa&&this.warn(`${w} ("${S.assetId}" ${S.timelineOffset}->${b})`)}}}),g||r){if(this.hls.trigger(C.INTERSTITIALS_UPDATED,{events:u.slice(0),schedule:f.slice(0),durations:d,removedIds:m}),this.isInterstitial(l)&&m.includes(l.event.identifier)){this.warn(`Interstitial "${l.event.identifier}" removed while playing`),this.primaryFallback(l.event);return}l&&this.trimInPlace(y,l),E&&x!==y&&this.trimInPlace(x,E),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new _3(e),this.schedule=new C3(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(C.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(C.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(C.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(C.MEDIA_ENDED,this.onMediaEnded,this),e.on(C.ERROR,this.onError,this),e.on(C.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(C.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(C.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(C.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(C.MEDIA_ENDED,this.onMediaEnded,this),e.off(C.ERROR,this.onError,this),e.off(C.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){rn(e,"play",this.onPlay),rn(e,"pause",this.onPause),rn(e,"seeking",this.onSeeking),rn(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;zt(n,"seeking",this.onSeeking),zt(n,"timeupdate",this.onTimeupdate),zt(n,"play",this.onPlay),zt(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,r=this.detachedData;if(this.detachedData=null,n===null)this.checkStart();else if(!r){this.clearScheduleState();const o=this.findItemIndex(n);this.setSchedulePosition(o)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,r=this.media;if(this.media=null,!n&&(r&&this.removeMediaListeners(r),this.detachedData)){const o=this.getBufferingPlayer();o&&(this.log(`Removing schedule state for detachedData and ${o}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,o.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=g=>g&&e.getAssetPlayer(g.identifier),r=(g,y,x,E,S)=>{if(g){let b=g[y].start;const R=g.event;if(R){if(y==="playout"||R.timelineOccupancy!==_u.Point){const w=n(x);w?.interstitial===R&&(b+=w.assetItem.startOffset+w[S])}}else{const w=E==="bufferedPos"?l():e[E];b+=w-g.start}return b}return 0},o=(g,y)=>{var x;if(g!==0&&y!=="primary"&&(x=e.schedule)!=null&&x.length){var E;const S=e.schedule.findItemIndexAtTime(g),b=(E=e.schedule.items)==null?void 0:E[S];if(b){const R=b[y].start-b.start;return g+R}}return g},l=()=>{const g=e.bufferedPos;return g===Number.MAX_VALUE?u("primary"):Math.max(g,0)},u=g=>{var y,x;return(y=e.primaryDetails)!=null&&y.live?e.primaryDetails.edge:((x=e.schedule)==null?void 0:x.durations[g])||0},f=(g,y)=>{var x,E;const S=e.effectivePlayingItem;if(S!=null&&(x=S.event)!=null&&x.restrictions.skip||!e.schedule)return;e.log(`seek to ${g} "${y}"`);const b=e.effectivePlayingItem,R=e.schedule.findItemIndexAtTime(g,y),w=(E=e.schedule.items)==null?void 0:E[R],_=e.getBufferingPlayer(),D=_?.interstitial,M=D?.appendInPlace,$=b&&e.itemsMatch(b,w);if(b&&(M||$)){const O=n(e.playingAsset),k=O?.media||e.primaryMedia;if(k){const G=y==="primary"?k.currentTime:r(b,y,e.playingAsset,"timelinePos","currentTime"),B=g-G,K=(M?G:k.currentTime)+B;if(K>=0&&(!O||M||K<=O.duration)){k.currentTime=K;return}}}if(w){let O=g;if(y!=="primary"){const G=w[y].start,B=g-G;O=w.start+B}const k=!e.isInterstitial(w);if((!e.isInterstitial(b)||b.event.appendInPlace)&&(k||w.event.appendInPlace)){const G=e.media||(M?_?.media:null);G&&(G.currentTime=O)}else if(b){const G=e.findItemIndex(b);if(R>G){const K=e.schedule.findJumpRestrictedIndex(G+1,R);if(K>G){e.setSchedulePosition(K);return}}let B=0;if(k)e.timelinePos=O,e.checkBuffer();else{const K=w.event.assetList,ne=g-(w[y]||w).start;for(let ue=K.length;ue--;){const ee=K[ue];if(ee.duration&&ne>=ee.startOffset&&ne<ee.startOffset+ee.duration){B=ue;break}}}e.setSchedulePosition(R,B)}}},d=()=>{const g=e.effectivePlayingItem;if(e.isInterstitial(g))return g;const y=t();return e.isInterstitial(y)?y:null},m={get bufferedEnd(){const g=t(),y=e.bufferingItem;if(y&&y===g){var x;return r(y,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-y.playout.start||((x=e.bufferingAsset)==null?void 0:x.startOffset)||0}return 0},get currentTime(){const g=d(),y=e.effectivePlayingItem;return y&&y===g?r(y,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-y.playout.start:0},set currentTime(g){const y=d(),x=e.effectivePlayingItem;x&&x===y&&f(g+x.playout.start,"playout")},get duration(){const g=d();return g?g.playout.end-g.playout.start:0},get assetPlayers(){var g;const y=(g=d())==null?void 0:g.event.assetList;return y?y.map(x=>e.getAssetPlayer(x.identifier)):[]},get playingIndex(){var g;const y=(g=d())==null?void 0:g.event;return y&&e.effectivePlayingAsset?y.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return d()}};return this.manager={get events(){var g;return((g=e.schedule)==null||(g=g.events)==null?void 0:g.slice(0))||[]},get schedule(){var g;return((g=e.schedule)==null||(g=g.items)==null?void 0:g.slice(0))||[]},get interstitialPlayer(){return d()?m:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const g=t();return e.findItemIndex(g)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const g=e.effectivePlayingItem;return e.findItemIndex(g)},primary:{get bufferedEnd(){return l()},get currentTime(){const g=e.timelinePos;return g>0?g:0},set currentTime(g){f(g,"primary")},get duration(){return u("primary")},get seekableStart(){var g;return((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0}},integrated:{get bufferedEnd(){return r(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return r(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(g){f(g,"integrated")},get duration(){return u("integrated")},get seekableStart(){var g;return o(((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0,"integrated")}},skip:()=>{const g=e.effectivePlayingItem,y=g?.event;if(y&&!y.restrictions.skip){const x=e.findItemIndex(g);if(y.appendInPlace){const E=g.playout.start+g.event.duration;f(E+.001,"playout")}else e.advanceAfterAssetEnded(y,x,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!n?!1:this.findItemIndex(t)===n.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let r=this.media;!r&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(r=this.primaryMedia);const o=(t=r)==null?void 0:t.currentTime;if(!(o===void 0||!me(o)))return o}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,r=e.media;if(n&&r===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&r){this.detachedData={media:r};return}const o=e.transferMedia();this.log(`transfer MediaSource from ${e} ${tt(o)}`),this.detachedData=o}else t&&r&&(this.shouldPlay||(this.shouldPlay=!r.paused))}transferMediaTo(e,t){var n,r;if(e.media===t)return;let o=null;const l=this.hls,u=e!==l,f=u&&e.interstitial.appendInPlace,d=(n=this.detachedData)==null?void 0:n.mediaSource;let m;if(l.media)f&&(o=l.transferMedia(),this.detachedData=o),m="Primary";else if(d){const E=this.getBufferingPlayer();E?(o=E.transferMedia(),m=`${E}`):m="detached MediaSource"}else m="detached media";if(!o){if(d)o=this.detachedData,this.log(`using detachedData: MediaSource ${tt(o)}`);else if(!this.detachedData||l.media===t){const E=this.playerQueue;E.length>1&&E.forEach(S=>{if(u&&S.interstitial.appendInPlace!==f){const b=S.interstitial;this.clearInterstitial(S.interstitial,null),b.appendInPlace=!1,b.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${b}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const g=o&&"mediaSource"in o&&((r=o.mediaSource)==null?void 0:r.readyState)!=="closed",y=g&&o?o:t;this.log(`${g?"transfering MediaSource":"attaching media"} to ${u?e:"Primary"} from ${m} (media.currentTime: ${t.currentTime})`);const x=this.schedule;if(y===o&&x){const E=u&&e.assetId===x.assetIdAtEnd;y.overrides={duration:x.duration,endOfStream:!u||E,cueRemoval:!u}}e.attachMedia(y)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e?.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const n=this.timelinePos,r=this.effectivePlayingItem;if(n===-1){const o=this.hls.startPosition;if(this.log(Vc("checkStart",o)),this.timelinePos=o,t.length&&t[0].cue.pre){const l=e.findEventIndex(t[0].identifier);this.setSchedulePosition(l)}else if(o>=0||!this.primaryLive){const l=this.timelinePos=o>0?o:0,u=e.findItemIndexAtTime(l);this.setSchedulePosition(u)}}else if(r&&!this.playingItem){const o=e.findItemIndex(r);this.setSchedulePosition(o)}}advanceAssetBuffering(e,t){const n=e.event,r=n.findAssetIndex(t),o=Zh(n,r);if(!n.isAssetPastPlayoutLimit(o))this.bufferedToEvent(e,o);else if(this.schedule){var l;const u=(l=this.schedule.items)==null?void 0:l[this.findItemIndex(e)+1];u&&this.bufferedToItem(u)}}advanceAfterAssetEnded(e,t,n){const r=Zh(e,n);if(e.isAssetPastPlayoutLimit(r)){if(this.schedule){const o=this.schedule.items;if(o){const l=t+1,u=o.length;if(l>=u){this.setSchedulePosition(-1);return}const f=e.resumeTime;this.timelinePos<f&&(this.log(Vc("advanceAfterAssetEnded",f)),this.timelinePos=f,e.appendInPlace&&this.advanceInPlace(f),this.checkBuffer(this.bufferedPos<f)),this.setSchedulePosition(l)}}}else{if(e.appendInPlace){const o=e.assetList[r];o&&this.advanceInPlace(o.timelineStart)}this.setSchedulePosition(t,r)}}setScheduleToAssetAtTime(e,t){const n=this.schedule;if(!n)return;const r=t.parentIdentifier,o=n.getEvent(r);if(o){const l=n.findEventIndex(r),u=n.findAssetIndex(o,e);this.advanceAfterAssetEnded(o,l,u-1)}}setSchedulePosition(e,t){var n;const r=(n=this.schedule)==null?void 0:n.items;if(!r||this.playbackDisabled)return;const o=e>=0?r[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${o&&Hn(o)}) pos: ${this.timelinePos}`);const l=this.waitingItem||this.playingItem,u=this.playingLastItem;if(this.isInterstitial(l)){const m=l.event,g=this.playingAsset,y=g?.identifier,x=y?this.getAssetPlayer(y):null;if(x&&y&&(!this.eventItemsMatch(l,o)||t!==void 0&&y!==m.assetList[t].identifier)){var f;const E=m.findAssetIndex(g);if(this.log(`INTERSTITIAL_ASSET_ENDED ${E+1}/${m.assetList.length} ${ia(g)}`),this.endedAsset=g,this.playingAsset=null,this.hls.trigger(C.INTERSTITIAL_ASSET_ENDED,{asset:g,assetListIndex:E,event:m,schedule:r.slice(0),scheduleIndex:e,player:x}),l!==this.playingItem){this.itemsMatch(l,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(m,this.findItemIndex(this.playingItem),E);return}this.retreiveMediaSource(y,o),x.media&&!((f=this.detachedData)!=null&&f.mediaSource)&&x.detachMedia()}if(!this.eventItemsMatch(l,o)&&(this.endedItem=l,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${m} ${Hn(l)}`),m.hasPlayed=!0,this.hls.trigger(C.INTERSTITIAL_ENDED,{event:m,schedule:r.slice(0),scheduleIndex:e}),m.cue.once)){var d;this.updateSchedule();const E=(d=this.schedule)==null?void 0:d.items;if(o&&E){const S=this.findItemIndex(o);this.advanceSchedule(S,E,t,l,u)}return}}this.advanceSchedule(e,r,t,l,u)}advanceSchedule(e,t,n,r,o){const l=this.schedule;if(!l)return;const u=t[e]||null,f=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(m=>{const g=m.interstitial,y=l.findEventIndex(g.identifier);(y<e||y>e+1)&&this.clearInterstitial(g,u)}),this.isInterstitial(u)){this.timelinePos=Math.min(Math.max(this.timelinePos,u.start),u.end);const m=u.event;if(n===void 0){n=l.findAssetIndex(m,this.timelinePos);const E=Zh(m,n-1);if(m.isAssetPastPlayoutLimit(E)||m.appendInPlace&&this.timelinePos===u.end){this.advanceAfterAssetEnded(m,e,n);return}n=E}const g=this.waitingItem;this.assetsBuffered(u,f)||this.setBufferingItem(u);let y=this.preloadAssets(m,n);if(this.eventItemsMatch(u,g||r)||(this.waitingItem=u,this.log(`INTERSTITIAL_STARTED ${Hn(u)} ${m.appendInPlace?"append in place":""}`),this.hls.trigger(C.INTERSTITIAL_STARTED,{event:m,schedule:t.slice(0),scheduleIndex:e})),!m.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${m}`);return}if(m.assetListLoader&&(m.assetListLoader.destroy(),m.assetListLoader=void 0),!f){this.log(`Waiting for attachMedia to start Interstitial ${m}`);return}this.waitingItem=this.endedItem=null,this.playingItem=u;const x=m.assetList[n];if(!x){this.advanceAfterAssetEnded(m,e,n||0);return}if(y||(y=this.getAssetPlayer(x.identifier)),y===null||y.destroyed){const E=m.assetList.length;this.warn(`asset ${n+1}/${E} player destroyed ${m}`),y=this.createAssetPlayer(m,x,n),y.loadSource()}if(!this.eventItemsMatch(u,this.bufferingItem)&&m.appendInPlace&&this.isAssetBuffered(x))return;this.startAssetPlayer(y,n,t,e,f),this.shouldPlay&&xS(y.media)}else u?(this.resumePrimary(u,e,r),this.shouldPlay&&xS(this.hls.media)):o&&this.isInterstitial(r)&&(this.endedItem=null,this.playingItem=r,r.event.appendInPlace||this.attachPrimary(l.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,n){var r,o;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Hn(e)}`),!((r=this.detachedData)!=null&&r.mediaSource)){let u=this.timelinePos;(u<e.start||u>=e.end)&&(u=this.getPrimaryResumption(e,t),this.log(Vc("resumePrimary",u)),this.timelinePos=u),this.attachPrimary(u,e)}if(!n)return;const l=(o=this.schedule)==null?void 0:o.items;l&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Hn(e)}`),this.hls.trigger(C.INTERSTITIALS_PRIMARY_RESUMED,{schedule:l.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const r=this.primaryDetails;if(t===0)return this.hls.startPosition;if(r&&(n<r.fragmentStart||n>r.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Ae.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const r=this.primaryMedia;if(!r)return;const o=this.hls;o.media?this.checkBuffer():(this.transferMediaTo(o,r),n&&this.startLoadingPrimaryAt(e,n)),n||(this.log(Vc("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const r=this.hls;!r.loadingEnabled||!r.media||Math.abs((((n=r.mainForwardBufferInfo)==null?void 0:n.start)||r.media.currentTime)-e)>.5?r.startLoad(e,t):r.bufferingEnabled||r.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(C.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(C.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const n=this.hls.levels[t.level];if(!n.details)return;const r=Ye(Ye({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=r,this.schedule.parseInterstitialDateRanges(r,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=Ye(Ye({},this.altSelection),{},{audio:n});return}const o=Ye(Ye({},r),{},{audio:n});this.mediaSelection=o}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=Ye(Ye({},this.altSelection),{},{subtitles:n});return}const o=Ye(Ye({},r),{},{subtitles:n});this.mediaSelection=o}onAudioTrackSwitching(e,t){const n=_E(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setAudioOption(t)||r.setAudioOption(n)))}onSubtitleTrackSwitch(e,t){const n=_E(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setSubtitleOption(t)||t.id!==-1&&r.setSubtitleOption(n)))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const r=this.timelinePos;this.bufferedPos=r,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let r=0;r<t.length;r++){const o=t[r];if(o.cue.post){var n;const l=this.schedule.findEventIndex(o.identifier),u=(n=this.schedule.items)==null?void 0:n[l];this.isInterstitial(u)&&this.eventItemsMatch(u,this.bufferingItem)&&this.bufferedToItem(u,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const n=this.findItemIndex(t);this.setSchedulePosition(n+1)}else this.shouldPlay=!1}updateItem(e,t){var n;const r=(n=this.schedule)==null?void 0:n.items;if(e&&r){const o=this.findItemIndex(e,t);return r[o]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((o,l)=>{e.event.isAssetPastPlayoutLimit(l)&&this.clearAssetPlayer(o.identifier,null)});const n=e.end+.25,r=Ae.bufferInfo(this.primaryMedia,n,0);(r.end>n||(r.nextStart||0)>n)&&(this.log(`trim buffered interstitial ${Hn(e)} (was ${Hn(t)})`),this.attachPrimary(n,null,!0),this.flushFrontBuffer(n))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===((n=t.event)==null?void 0:n.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const n=this.mediaSelection;n&&((t=this.schedule)==null||t.updateSchedule(n,[],e))}checkBuffer(e){var t;const n=(t=this.schedule)==null?void 0:t.items;if(!n)return;const r=Ae.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,n,e)}updateBufferedPos(e,t,n){const r=this.schedule,o=this.bufferingItem;if(this.bufferedPos>e||!r)return;if(t.length===1&&this.itemsMatch(t[0],o)){this.bufferedPos=e;return}const l=this.playingItem,u=this.findItemIndex(l);let f=r.findItemIndexAtTime(e);if(this.bufferedPos<e){var d;const m=this.findItemIndex(o),g=Math.min(m+1,t.length-1),y=t[g];if((f===-1&&o&&e>=o.end||(d=y.event)!=null&&d.appendInPlace&&e+.01>=y.start)&&(f=g),this.isInterstitial(o)){const x=o.event;if(g-u>1&&x.appendInPlace===!1||x.assetList.length===0&&x.assetListLoader)return}if(this.bufferedPos=e,f>m&&f>u)this.bufferedToItem(y);else{const x=this.primaryDetails;this.primaryLive&&x&&e>x.edge-x.targetduration&&y.start<x.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(y)&&this.preloadAssets(y.event,0)}}else n&&l&&!this.itemsMatch(l,o)&&(f===u?this.bufferedToItem(l):f===u+1&&this.bufferedToItem(t[f]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(r=>{const o=this.getAssetPlayer(r.identifier);return!(o!=null&&o.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,t)&&n){const{items:r,events:o}=n;if(!r||!o)return t;const l=this.isInterstitial(e),u=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const f=u?u.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Hn(e)}`+(t?` (${f.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(l){const d=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((m,g)=>{const y=this.getAssetPlayer(m.identifier);y&&(g===d&&y.loadSource(),y.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(d=>d.pauseBuffering());this.hls.trigger(C.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:o.slice(0),schedule:r.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(n!==null){this.bufferingAsset=null;const r=this.detachedData;r?r.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,r=n.assetList.length===0&&!n.assetListLoader,o=n.cue.once;if(r||!o){const l=this.preloadAssets(n,t);if(l!=null&&l.interstitial.appendInPlace){const u=this.primaryMedia;u&&this.bufferAssetPlayer(l,u)}}}preloadAssets(e,t){const n=e.assetUrl,r=e.assetList.length,o=r===0&&!e.assetListLoader,l=e.cue.once;if(o){const f=e.timelineStart;if(e.appendInPlace){var u;const y=this.playingItem;!this.isInterstitial(y)&&(y==null||(u=y.nextEvent)==null?void 0:u.identifier)===e.identifier&&this.flushFrontBuffer(f+.25)}let d,m=0;if(!this.playingItem&&this.primaryLive&&(m=this.hls.startPosition,m===-1&&(m=this.hls.liveSyncPosition||0)),m&&!(e.cue.pre||e.cue.post)){const y=m-f;y>0&&(d=Math.round(y*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:r} ${e}${d?` live-start: ${m} start-offset: ${d}`:""}`),n)return this.createAsset(e,0,0,f,e.duration,n);const g=this.assetListLoader.loadAssetList(e,d);g&&(e.assetListLoader=g)}else if(!l&&r){for(let d=t;d<r;d++){const m=e.assetList[d],g=this.getAssetPlayerQueueIndex(m.identifier);(g===-1||this.playerQueue[g].destroyed)&&!m.error&&this.createAssetPlayer(e,m,d)}const f=e.assetList[t];if(f){const d=this.getAssetPlayer(f.identifier);return d&&d.loadSource(),d}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(r=>{this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n]}return null}createAsset(e,t,n,r,o,l){const u={parentIdentifier:e.identifier,identifier:b3(e,l,t),duration:o,startOffset:n,timelineStart:r,uri:l};return this.createAssetPlayer(e,u,t)}createAssetPlayer(e,t,n){const r=this.hls,o=r.userConfig;let l=o.videoPreference;const u=r.loadLevelObj||r.levels[r.currentLevel];(l||u)&&(l=Ze({},l),u.videoCodec&&(l.videoCodec=u.videoCodec),u.videoRange&&(l.allowedVideoRanges=[u.videoRange]));const f=r.audioTracks[r.audioTrack],d=r.subtitleTracks[r.subtitleTrack];let m=0;if(this.primaryLive||e.appendInPlace){const D=this.timelinePos-t.timelineStart;if(D>1){const M=t.duration;M&&D<M&&(m=D)}}const g=t.identifier,y=Ye(Ye({},o),{},{maxMaxBufferLength:Math.min(180,r.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:r.sessionId,assetPlayerId:g,abrEwmaDefaultEstimate:r.bandwidthEstimate,interstitialsController:void 0,startPosition:m,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:l,audioPreference:f||o.audioPreference,subtitlePreference:d||o.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(y.timelineOffset=t.timelineStart));const x=y.cmcd;x!=null&&x.sessionId&&x.contentId&&(y.cmcd=Ze({},x,{contentId:ko(t.uri)})),this.getAssetPlayer(g)&&this.warn(`Duplicate date range identifier ${e} and asset ${g}`);const E=new L3(this.HlsPlayerClass,y,e,t);this.playerQueue.push(E),e.assetList[n]=t;let S=!0;const b=D=>{if(D.live){var M;const k=new Error(`Interstitials MUST be VOD assets ${e}`),G={fatal:!0,type:Ee.OTHER_ERROR,details:X.INTERSTITIAL_ASSET_ITEM_ERROR,error:k},B=((M=this.schedule)==null?void 0:M.findEventIndex(e.identifier))||-1;this.handleAssetItemError(G,e,B,n,k.message);return}const $=D.edge-D.fragmentStart,O=t.duration;(S||O===null||$>O)&&(S=!1,this.log(`Interstitial asset "${g}" duration change ${O} > ${$}`),t.duration=$,this.updateSchedule())};E.on(C.LEVEL_UPDATED,(D,{details:M})=>b(M)),E.on(C.LEVEL_PTS_UPDATED,(D,{details:M})=>b(M)),E.on(C.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const R=(D,M)=>{const $=this.getAssetPlayer(g);if($&&M.tracks){$.off(C.BUFFER_CODECS,R),$.tracks=M.tracks;const O=this.primaryMedia;this.bufferingAsset===$.assetItem&&O&&!$.media&&this.bufferAssetPlayer($,O)}};E.on(C.BUFFER_CODECS,R);const w=()=>{var D;const M=this.getAssetPlayer(g);if(this.log(`buffered to end of asset ${M}`),!M||!this.schedule)return;const $=this.schedule.findEventIndex(e.identifier),O=(D=this.schedule.items)==null?void 0:D[$];this.isInterstitial(O)&&this.advanceAssetBuffering(O,t)};E.on(C.BUFFERED_TO_END,w);const _=D=>()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;this.shouldPlay=!0;const $=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,$,D)};return E.once(C.MEDIA_ENDED,_(n)),E.once(C.PLAYOUT_LIMIT_REACHED,_(1/0)),E.on(C.ERROR,(D,M)=>{if(!this.schedule)return;const $=this.getAssetPlayer(g);if(M.details===X.BUFFER_STALLED_ERROR){if($!=null&&$.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(M,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${M.error} ${e}`)}),E.on(C.DESTROYING,()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;const M=new Error(`Asset player destroyed unexpectedly ${g}`),$={fatal:!0,type:Ee.OTHER_ERROR,details:X.INTERSTITIAL_ASSET_ITEM_ERROR,error:M};this.handleAssetItemError($,e,this.schedule.findEventIndex(e.identifier),n,M.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${ia(t)}`),this.hls.trigger(C.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:E}),E}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(n=>{this.clearAssetPlayer(n.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const n=this.playerQueue[t];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){const r=this.playerQueue[n];this.log(`clear ${r} toSegment: ${t&&Hn(t)}`),this.transferMediaFromPlayer(r,t),this.playerQueue.splice(n,1),r.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,r,o){const{interstitial:l,assetItem:u,assetId:f}=e,d=l.assetList.length,m=this.playingAsset;this.endedAsset=null,this.playingAsset=u,(!m||m.identifier!==f)&&(m&&(this.clearAssetPlayer(m.identifier,n[r]),delete m.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${d} ${ia(u)}`),this.hls.trigger(C.INTERSTITIAL_ASSET_STARTED,{asset:u,assetListIndex:t,event:l,schedule:n.slice(0),scheduleIndex:r,player:e})),this.bufferAssetPlayer(e,o)}bufferAssetPlayer(e,t){var n,r;if(!this.schedule)return;const{interstitial:o,assetItem:l}=e,u=this.schedule.findEventIndex(o.identifier),f=(n=this.schedule.items)==null?void 0:n[u];if(!f)return;e.loadSource(),this.setBufferingItem(f),this.bufferingAsset=l;const d=this.getBufferingPlayer();if(d===e)return;const m=o.appendInPlace;if(m&&d?.interstitial.appendInPlace===!1)return;const g=d?.tracks||((r=this.detachedData)==null?void 0:r.tracks)||this.requiredTracks;if(m&&l!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(g&&!QA(g,e.tracks)){const y=new Error(`Asset ${ia(l)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(g)}')`),x={fatal:!0,type:Ee.OTHER_ERROR,details:X.INTERSTITIAL_ASSET_ITEM_ERROR,error:y},E=o.findAssetIndex(l);this.handleAssetItemError(x,o,u,E,y.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,n=this.primaryMedia;if(!t||!n)return;const r=n.currentTime,o=t.findAssetIndex(e,r),l=e.assetList[o];if(l){const u=this.getAssetPlayer(l.identifier);if(u){const f=u.currentTime||r-l.timelineStart,d=u.duration-f;if(this.warn(`Stalled at ${f} of ${f+d} in ${u} ${e} (media.currentTime: ${r})`),f&&(d/n.playbackRate<.5||u.bufferedInPlaceToEnd(n))&&u.hls){const m=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,m,o)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,n,r,o){if(e.details===X.BUFFER_STALLED_ERROR)return;const l=t.assetList[r]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${l&&ia(l)} ${e.error}`),!this.schedule)return;const u=l?.identifier||"",f=this.getAssetPlayerQueueIndex(u),d=this.playerQueue[f]||null,m=this.schedule.items,g=Ze({},e,{fatal:!1,errorAction:ha(!0),asset:l,assetListIndex:r,event:t,schedule:m,scheduleIndex:n,player:d});if(this.hls.trigger(C.INTERSTITIAL_ASSET_ERROR,g),!e.fatal)return;const y=this.playingAsset,x=this.bufferingAsset,E=new Error(o);if(l&&(this.clearAssetPlayer(u,null),l.error=E),!t.assetList.some(S=>!S.error))t.error=E;else for(let S=r;S<t.assetList.length;S++)this.resetAssetPlayer(t.assetList[S].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):y&&y.identifier===u?this.advanceAfterAssetEnded(t,n,r):x&&x.identifier===u&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,x)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;let r=this.timelinePos;if(n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${r} playing: ${Hn(n)} error: ${e.error}`),r===-1&&(r=this.hls.startPosition);const l=this.updateItem(n,r);this.itemsMatch(n,l)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(r===-1){this.checkStart();return}if(!this.schedule)return;const o=this.schedule.findItemIndexAtTime(r);this.setSchedulePosition(o)}onAssetListLoaded(e,t){var n,r;const o=t.event,l=o.identifier,u=t.assetListResponse.ASSETS;if(!((n=this.schedule)!=null&&n.hasEvent(l)))return;const f=o.timelineStart,d=o.duration;let m=0;u.forEach((S,b)=>{const R=parseFloat(S.DURATION);this.createAsset(o,b,m,f+m,R,S.URI),m+=R}),o.duration=m,this.log(`Loaded asset-list with duration: ${m} (was: ${d}) ${o}`);const g=this.waitingItem,y=g?.event.identifier===l;this.updateSchedule();const x=(r=this.bufferingItem)==null?void 0:r.event;if(y){var E;const S=this.schedule.findEventIndex(l),b=(E=this.schedule.items)==null?void 0:E[S];if(b){if(!this.playingItem&&this.timelinePos>b.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==S){o.error=new Error(`Interstitial ${u.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${o}`),this.log(o.error.message),this.updateSchedule(!0),this.primaryFallback(o);return}this.setBufferingItem(b)}this.setSchedulePosition(S)}else if(x?.identifier===l){const S=o.assetList[0];if(S){const b=this.getAssetPlayer(S.identifier);if(x.appendInPlace){const R=this.primaryMedia;b&&R&&this.bufferAssetPlayer(b,R)}else b&&b.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case X.ASSET_LIST_PARSING_ERROR:case X.ASSET_LIST_LOAD_ERROR:case X.ASSET_LIST_LOAD_TIMEOUT:{const n=t.interstitial;n&&(this.updateSchedule(!0),this.primaryFallback(n));break}case X.BUFFER_STALLED_ERROR:{const n=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&n.event.appendInPlace){this.handleInPlaceStall(n.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const ES=500;class D3 extends Yg{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",ge.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(C.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(C.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=re.IDLE,this.setInterval(ES),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragContextChanged(n)||(gt(n)&&(this.fragPrevious=n),this.state=re.IDLE),!r)return;const o=this.tracksBuffered[this.currentTrackId];if(!o)return;let l;const u=n.start;for(let d=0;d<o.length;d++)if(u>=o[d].start&&u<=o[d].end){l=o[d];break}const f=n.start+n.duration;l?l.end=f:(l={start:u,end:f},o.push(l)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(n===0&&r!==Number.POSITIVE_INFINITY){const o=r-1;if(o<=0)return;t.endOffsetSubtitles=Math.max(0,o),this.tracksBuffered.forEach(l=>{for(let u=0;u<l.length;){if(l[u].end<=o){l.shift();continue}else if(l[u].start<o)l[u].start=o;else break;u++}}),this.fragmentTracker.removeFragmentsInRange(n,o,ge.SUBTITLE)}}onError(e,t){const n=t.frag;n?.type===ge.SUBTITLE&&(t.details===X.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==re.STOPPED&&(this.state=re.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&e1(this.levels,t)){this.levels=t.map(n=>new Ko(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const r=new Ko(n);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ge.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.state!==re.STOPPED&&this.setInterval(ES)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:r,levels:o}=this,{details:l,id:u}=t;if(!o){this.warn(`Subtitle tracks were reset while loading level ${u}`);return}const f=o[u];if(u>=o.length||!f)return;this.log(`Subtitle track ${u} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(l.live||(n=f.details)!=null&&n.live){if(l.deltaUpdateFailed)return;const g=this.mainDetails;if(!g){this.startFragRequested=!1;return}const y=g.fragments[0];if(!f.details)l.hasProgramDateTime&&g.hasProgramDateTime?(Lu(l,g),d=l.fragmentStart):y&&(d=y.start,km(l,d));else{var m;d=this.alignPlaylists(l,f.details,(m=this.levelLastLoaded)==null?void 0:m.details),d===0&&y&&(d=y.start,km(l,d))}g&&!this.startFragRequested&&this.setStartPosition(g,d)}f.details=l,this.levelLastLoaded=f,u===r&&(this.hls.trigger(C.SUBTITLE_TRACK_UPDATED,{details:l,id:u,groupId:t.groupId}),this.tick(),l.live&&!this.fragCurrent&&this.media&&this.state===re.IDLE&&(sr(null,l.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),f.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,o=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r!=null&&r.key&&r.iv&&ma(r.method)){const l=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer,Kg(r.method)).catch(u=>{throw o.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:t}),u}).then(u=>{const f=performance.now();o.trigger(C.FRAG_DECRYPTED,{frag:t,payload:u,stats:{tstart:l,tdecrypt:f}})}).catch(u=>{this.warn(`${u.name}: ${u.message}`),this.state=re.IDLE})}}doTick(){if(!this.media){this.state=re.IDLE;return}if(this.state===re.IDLE){const{currentTrackId:e,levels:t}=this,n=t?.[e];if(!n||!t.length||!n.details||this.waitForLive(n))return;const{config:r}=this,o=this.getLoadPosition(),l=Ae.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o,r.maxBufferHole),{end:u,len:f}=l,d=n.details,m=this.hls.maxBufferLength+d.levelTargetDuration;if(f>m)return;const g=d.fragments,y=g.length,x=d.edge;let E=null;const S=this.fragPrevious;if(u<x){const w=r.maxFragLookUpTolerance,_=u>x-w?0:w;E=sr(S,g,Math.max(g[0].start,u),_),!E&&S&&S.start<g[0].start&&(E=g[0])}else E=g[y-1];if(E=this.filterReplacedPrimary(E,n.details),!E)return;const b=E.sn-d.startSN,R=g[b-1];if(R&&R.cc===E.cc&&this.fragmentTracker.getState(R)===At.NOT_LOADED&&(E=R),this.fragmentTracker.getState(E)===At.NOT_LOADED){const w=this.mapToInitFragWhenRequired(E);w&&this.loadFragment(w,n,u)}}}loadFragment(e,t,n){gt(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new I3(this.tracksBuffered[this.currentTrackId]||[])}}class I3{constructor(e){this.buffered=void 0;const t=(n,r,o)=>{if(r=r>>>0,r>o-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${o})`);return e[r][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const O3={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},p1=s=>String.fromCharCode(O3[s]||s),Vn=15,Us=100,M3={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},N3={17:2,18:4,21:6,22:8,23:10,19:13,20:15},k3={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},P3={25:2,26:4,29:6,30:8,31:10,27:13,28:15},F3=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class U3{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;qe.log(`${this.time} [${e}] ${n}`)}}}const Ji=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class y1{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class B3{constructor(){this.uchar=" ",this.penState=new y1}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class $3{constructor(e){this.chars=[],this.pos=0,this.currPenState=new y1,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Us;t++)this.chars.push(new B3);this.logger=e}equals(e){for(let t=0;t<Us;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Us;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Us;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Us&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Us)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=p1(e);if(this.pos>=Us){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Us;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Us;n++){const r=this.chars[n].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Jh{constructor(e){this.rows=[],this.currRow=Vn-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Vn;t++)this.rows.push(new $3(e));this.logger=e}reset(){for(let e=0;e<Vn;e++)this.rows[e].clear();this.currRow=Vn-1}equals(e){let t=!0;for(let n=0;n<Vn;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Vn;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Vn;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+tt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let u=0;u<Vn;u++)this.rows[u].clear();const o=this.currRow+1-this.nrRollUpRows,l=this.lastOutputScreen;if(l){const u=l.rows[o].cueStartTime,f=this.logger.time;if(u!==null&&f!==null&&u<f)for(let d=0;d<this.nrRollUpRows;d++)this.rows[t-this.nrRollUpRows+d+1].copy(l.rows[o+d])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const o=e.indent,l=Math.max(o-1,0);n.setCursor(e.indent),e.color=n.chars[l].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+tt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let o=0;o<Vn;o++){const l=this.rows[o].getTextString();l&&(r=o+1,e?t.push("Row "+r+": '"+l+"'"):t.push(l.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class SS{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Jh(n),this.nonDisplayedMemory=new Jh(n),this.lastOutputScreen=new Jh(n),this.currRollUpRow=this.displayedMemory.rows[Vn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Vn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+tt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class TS{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=G3(),this.logger=void 0;const r=this.logger=new U3;this.channels=[null,new SS(e,t,r),new SS(e+1,n,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const r=t[n]&127,o=t[n+1]&127;let l=!1,u=null;if(r===0&&o===0)continue;this.logger.log(3,()=>"["+Ji([t[n],t[n+1]])+"] -> ("+Ji([r,o])+")");const f=this.cmdHistory;if(r>=16&&r<=31){if(j3(r,o,f)){Kc(null,null,f),this.logger.log(3,()=>"Repeated command ("+Ji([r,o])+") is dropped");continue}Kc(r,o,this.cmdHistory),l=this.parseCmd(r,o),l||(l=this.parseMidrow(r,o)),l||(l=this.parsePAC(r,o)),l||(l=this.parseBackgroundAttributes(r,o))}else Kc(null,null,f);if(!l&&(u=this.parseChars(r,o),u)){const m=this.currentChannel;m&&m>0?this.channels[m].insertChars(u):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!l&&!u&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Ji([r,o])+" orig: "+Ji([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(n||r))return!1;const o=e===20||e===21||e===23?1:2,l=this.channels[o];return e===20||e===21||e===28||e===29?t===32?l.ccRCL():t===33?l.ccBS():t===34?l.ccAOF():t===35?l.ccAON():t===36?l.ccDER():t===37?l.ccRU(2):t===38?l.ccRU(3):t===39?l.ccRU(4):t===40?l.ccFON():t===41?l.ccRDC():t===42?l.ccTR():t===43?l.ccRTD():t===44?l.ccEDM():t===45?l.ccCR():t===46?l.ccENM():t===47&&l.ccEOC():l.ccTO(t-32),this.currentChannel=o,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Ji([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,o=(e===16||e===24)&&t>=64&&t<=95;if(!(r||o))return!1;const l=e<=23?1:2;t>=64&&t<=95?n=l===1?M3[e]:k3[e]:n=l===1?N3[e]:P3[e];const u=this.channels[l];return u?(u.setPAC(this.interpretPAC(n,t)),this.currentChannel=l,!0):!1}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,r.underline=(n&1)===1,n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((n-16)/2)*4,r}parseChars(e,t){let n,r=null,o=null;if(e>=25?(n=2,o=e-8):(n=1,o=e),o>=17&&o<=19){let l;o===17?l=t+80:o===18?l=t+112:l=t+144,this.logger.log(2,()=>"Special char '"+p1(l)+"' in channel "+n),r=[l]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+Ji(r).join(",")),r}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(n||r))return!1;let o;const l={};e===16||e===24?(o=Math.floor((t-32)/2),l.background=F3[o],t%2===1&&(l.background=l.background+"_semi")):t===45?l.background="transparent":(l.foreground="black",t===47&&(l.underline=!0));const u=e<=23?1:2;return this.channels[u].setBkgData(l),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Kc(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function Kc(s,e,t){t.a=s,t.b=e}function j3(s,e,t){return t.a===s&&t.b===e}function G3(){return{a:null,b:null}}var rp=(function(){if(Ru!=null&&Ru.VTTCue)return self.VTTCue;const s=["","lr","rl"],e=["start","middle","end","left","right"];function t(u,f){if(typeof f!="string"||!Array.isArray(u))return!1;const d=f.toLowerCase();return~u.indexOf(d)?d:!1}function n(u){return t(s,u)}function r(u){return t(e,u)}function o(u,...f){let d=1;for(;d<arguments.length;d++){const m=arguments[d];for(const g in m)u[g]=m[g]}return u}function l(u,f,d){const m=this,g={enumerable:!0};m.hasBeenReset=!1;let y="",x=!1,E=u,S=f,b=d,R=null,w="",_=!0,D="auto",M="start",$=50,O="middle",k=50,G="middle";Object.defineProperty(m,"id",o({},g,{get:function(){return y},set:function(B){y=""+B}})),Object.defineProperty(m,"pauseOnExit",o({},g,{get:function(){return x},set:function(B){x=!!B}})),Object.defineProperty(m,"startTime",o({},g,{get:function(){return E},set:function(B){if(typeof B!="number")throw new TypeError("Start time must be set to a number.");E=B,this.hasBeenReset=!0}})),Object.defineProperty(m,"endTime",o({},g,{get:function(){return S},set:function(B){if(typeof B!="number")throw new TypeError("End time must be set to a number.");S=B,this.hasBeenReset=!0}})),Object.defineProperty(m,"text",o({},g,{get:function(){return b},set:function(B){b=""+B,this.hasBeenReset=!0}})),Object.defineProperty(m,"region",o({},g,{get:function(){return R},set:function(B){R=B,this.hasBeenReset=!0}})),Object.defineProperty(m,"vertical",o({},g,{get:function(){return w},set:function(B){const K=n(B);if(K===!1)throw new SyntaxError("An invalid or illegal string was specified.");w=K,this.hasBeenReset=!0}})),Object.defineProperty(m,"snapToLines",o({},g,{get:function(){return _},set:function(B){_=!!B,this.hasBeenReset=!0}})),Object.defineProperty(m,"line",o({},g,{get:function(){return D},set:function(B){if(typeof B!="number"&&B!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");D=B,this.hasBeenReset=!0}})),Object.defineProperty(m,"lineAlign",o({},g,{get:function(){return M},set:function(B){const K=r(B);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");M=K,this.hasBeenReset=!0}})),Object.defineProperty(m,"position",o({},g,{get:function(){return $},set:function(B){if(B<0||B>100)throw new Error("Position must be between 0 and 100.");$=B,this.hasBeenReset=!0}})),Object.defineProperty(m,"positionAlign",o({},g,{get:function(){return O},set:function(B){const K=r(B);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");O=K,this.hasBeenReset=!0}})),Object.defineProperty(m,"size",o({},g,{get:function(){return k},set:function(B){if(B<0||B>100)throw new Error("Size must be between 0 and 100.");k=B,this.hasBeenReset=!0}})),Object.defineProperty(m,"align",o({},g,{get:function(){return G},set:function(B){const K=r(B);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");G=K,this.hasBeenReset=!0}})),m.displayState=void 0}return l.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},l})();class H3{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function v1(s){function e(n,r,o,l){return(n|0)*3600+(r|0)*60+(o|0)+parseFloat(l||0)}const t=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class V3{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function x1(s,e,t,n){const r=n?s.split(n):[s];for(const o in r){if(typeof r[o]!="string")continue;const l=r[o].split(t);if(l.length!==2)continue;const u=l[0],f=l[1];e(u,f)}}const Hm=new rp(0,0,""),zc=Hm.align==="middle"?"middle":"center";function K3(s,e,t){const n=s;function r(){const u=v1(s);if(u===null)throw new Error("Malformed timestamp: "+n);return s=s.replace(/^[^\sa-zA-Z-]+/,""),u}function o(u,f){const d=new V3;x1(u,function(y,x){let E;switch(y){case"region":for(let S=t.length-1;S>=0;S--)if(t[S].id===x){d.set(y,t[S].region);break}break;case"vertical":d.alt(y,x,["rl","lr"]);break;case"line":E=x.split(","),d.integer(y,E[0]),d.percent(y,E[0])&&d.set("snapToLines",!1),d.alt(y,E[0],["auto"]),E.length===2&&d.alt("lineAlign",E[1],["start",zc,"end"]);break;case"position":E=x.split(","),d.percent(y,E[0]),E.length===2&&d.alt("positionAlign",E[1],["start",zc,"end","line-left","line-right","auto"]);break;case"size":d.percent(y,x);break;case"align":d.alt(y,x,["start",zc,"end","left","right"]);break}},/:/,/\s/),f.region=d.get("region",null),f.vertical=d.get("vertical","");let m=d.get("line","auto");m==="auto"&&Hm.line===-1&&(m=-1),f.line=m,f.lineAlign=d.get("lineAlign","start"),f.snapToLines=d.get("snapToLines",!0),f.size=d.get("size",100),f.align=d.get("align",zc);let g=d.get("position","auto");g==="auto"&&Hm.position===50&&(g=f.align==="start"||f.align==="left"?0:f.align==="end"||f.align==="right"?100:50),f.position=g}function l(){s=s.replace(/^\s+/,"")}if(l(),e.startTime=r(),l(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);s=s.slice(3),l(),e.endTime=r(),l(),o(s,e)}function E1(s){return s.replace(/<br(?: \/)?>/gi,`
`)}class z3{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new H3,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let o=t.buffer,l=0;for(o=E1(o);l<o.length&&o[l]!=="\r"&&o[l]!==`
`;)++l;const u=o.slice(0,l);return o[l]==="\r"&&++l,o[l]===`
`&&++l,t.buffer=o.slice(l),u}function r(o){x1(o,function(l,u){},/:/)}try{let o="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;o=n();const u=o.match(/^()?WEBVTT([ \t].*)?$/);if(!(u!=null&&u[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let l=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(l?l=!1:o=n(),t.state){case"HEADER":/:/.test(o)?r(o):o||(t.state="ID");continue;case"NOTE":o||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){t.state="NOTE";break}if(!o)continue;if(t.cue=new rp(0,0,""),t.state="CUE",o.indexOf("-->")===-1){t.cue.id=o;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{K3(o,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const u=o.indexOf("-->")!==-1;if(!o||u&&(l=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=o}continue;case"BADCUE":o||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Y3=/\r\n|\n\r|\n|\r/g,em=function(e,t,n=0){return e.slice(n,n+t.length)===t},q3=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),o=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!me(t)||!me(n)||!me(r)||!me(o))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*r,t+=3600*1e3*o,t};function ap(s,e,t){return ko(s.toString())+ko(e.toString())+ko(t)}const X3=function(e,t,n){let r=e[t],o=e[r.prevCC];if(!o||!o.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(l=o)!=null&&l.new;){var l;e.ccOffset+=r.start-o.start,r.new=!1,r=o,o=e[r.prevCC]}e.presentationOffset=n};function W3(s,e,t,n,r,o,l){const u=new z3,f=Tn(new Uint8Array(s)).trim().replace(Y3,`
`).split(`
`),d=[],m=e?nB(e.baseTime,e.timescale):0;let g="00:00.000",y=0,x=0,E,S=!0;u.oncue=function(b){const R=t[n];let w=t.ccOffset;const _=(y-m)/9e4;if(R!=null&&R.new&&(x!==void 0?w=t.ccOffset=R.start:X3(t,n,_)),_){if(!e){E=new Error("Missing initPTS for VTT MPEGTS");return}w=_-t.presentationOffset}const D=b.endTime-b.startTime,M=yn((b.startTime+w-x)*9e4,r*9e4)/9e4;b.startTime=Math.max(M,0),b.endTime=Math.max(M+D,0);const $=b.text.trim();b.text=decodeURIComponent(encodeURIComponent($)),b.id||(b.id=ap(b.startTime,b.endTime,$)),b.endTime>0&&d.push(b)},u.onparsingerror=function(b){E=b},u.onflush=function(){if(E){l(E);return}o(d)},f.forEach(b=>{if(S)if(em(b,"X-TIMESTAMP-MAP=")){S=!1,b.slice(16).split(",").forEach(R=>{em(R,"LOCAL:")?g=R.slice(6):em(R,"MPEGTS:")&&(y=parseInt(R.slice(7)))});try{x=q3(g)/1e3}catch(R){E=R}return}else b===""&&(S=!1);u.parse(b+`
`)}),u.flush()}const tm="stpp.ttml.im1t",S1=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,T1=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Q3={left:"start",center:"center",right:"end",start:"start",end:"end"};function bS(s,e,t,n){const r=Oe(new Uint8Array(s),["mdat"]);if(r.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const o=r.map(u=>Tn(u)),l=tB(e.baseTime,1,e.timescale);try{o.forEach(u=>t(Z3(u,l)))}catch(u){n(u)}}function Z3(s,e){const r=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const o={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},l=Object.keys(o).reduce((g,y)=>(g[y]=r.getAttribute(`ttp:${y}`)||o[y],g),{}),u=r.getAttribute("xml:space")!=="preserve",f=AS(nm(r,"styling","style")),d=AS(nm(r,"layout","region")),m=nm(r,"body","[begin]");return[].map.call(m,g=>{const y=b1(g,u);if(!y||!g.hasAttribute("begin"))return null;const x=im(g.getAttribute("begin"),l),E=im(g.getAttribute("dur"),l);let S=im(g.getAttribute("end"),l);if(x===null)throw RS(g);if(S===null){if(E===null)throw RS(g);S=x+E}const b=new rp(x-e,S-e,y);b.id=ap(b.startTime,b.endTime,b.text);const R=d[g.getAttribute("region")],w=f[g.getAttribute("style")],_=J3(R,w,f),{textAlign:D}=_;if(D){const M=Q3[D];M&&(b.lineAlign=M),b.align=D}return Ze(b,_),b}).filter(g=>g!==null)}function nm(s,e,t){const n=s.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function AS(s){return s.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function b1(s,e){return[].slice.call(s.childNodes).reduce((t,n,r)=>{var o;return n.nodeName==="br"&&r?t+`
`:(o=n.childNodes)!=null&&o.length?b1(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function J3(s,e,t){const n="http://www.w3.org/ns/ttml#styling";let r=null;const o=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],l=s!=null&&s.hasAttribute("style")?s.getAttribute("style"):null;return l&&t.hasOwnProperty(l)&&(r=t[l]),o.reduce((u,f)=>{const d=sm(e,n,f)||sm(s,n,f)||sm(r,n,f);return d&&(u[f]=d),u},{})}function sm(s,e,t){return s&&s.hasAttributeNS(e,t)?s.getAttributeNS(e,t):null}function RS(s){return new Error(`Could not parse ttml timestamp ${s}`)}function im(s,e){if(!s)return null;let t=v1(s);return t===null&&(S1.test(s)?t=e$(s,e):T1.test(s)&&(t=t$(s,e))),t}function e$(s,e){const t=S1.exec(s),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function t$(s,e){const t=T1.exec(s),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class Yc{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class n${constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=CS(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this),e.on(C.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(C.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(C.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this),e.off(C.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(C.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(C.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Yc(this,"textTrack1"),t=new Yc(this,"textTrack2"),n=new Yc(this,"textTrack3"),r=new Yc(this,"textTrack4");this.cea608Parser1=new TS(1,e,t),this.cea608Parser2=new TS(3,n,r)}addCues(e,t,n,r,o){let l=!1;for(let u=o.length;u--;){const f=o[u],d=s$(f[0],f[1],t,n);if(d>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],n),l=!0,d/(n-t)>.5))return}if(l||o.push([t,n]),this.config.renderTextTracksNatively){const u=this.captionsTracks[e];this.Cues.newCue(u,t,n,r)}else{const u=this.Cues.newCue(null,t,n,r);this.hls.trigger(C.CUES_PARSED,{type:"captions",cues:u,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:o,trackId:l}){const{unparsedVttFrags:u}=this;n===ge.MAIN&&(this.initPTS[t.cc]={baseTime:r,timescale:o,trackId:l}),u.length&&(this.unparsedVttFrags=[],u.forEach(f=>{this.initPTS[f.frag.cc]?this.onFragLoaded(C.FRAG_LOADED,f):this.hls.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let r=0;r<n.textTracks.length;r++){const o=n.textTracks[r];if(LS(o,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return o}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:o,languageCode:l}=t[e],u=this.getExistingTrack(o,l);if(u)n[e]=u,aa(n[e]),h1(n[e],r);else{const f=this.createTextTrack("captions",o,l);f&&(f[e]=!0,n[e]=f)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,r={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(C.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:r}=this;Object.keys(r).forEach(o=>{aa(r[o]),delete r[o]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=CS(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)aa(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some(o=>o.textCodec===tm);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(e1(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const l=this.media,u=l?ou(l.textTracks):null;if(this.tracks.forEach((f,d)=>{let m;if(u){let g=null;for(let y=0;y<u.length;y++)if(u[y]&&LS(u[y],f)){g=u[y],u[y]=null;break}g&&(m=g)}if(m)aa(m);else{const g=A1(f);m=this.createTextTrack(g,f.name,f.lang),m&&(m.mode="disabled")}m&&this.textTracks.push(m)}),u!=null&&u.length){const f=u.filter(d=>d!==null).map(d=>d.label);f.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${f.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const l=this.tracks.map(u=>({label:u.name,kind:u.type.toLowerCase(),default:u.default,subtitleTrack:u}));this.hls.trigger(C.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!r)return;const o=`textTrack${r[1]}`,l=this.captionsProperties[o];l&&(l.label=n.name,n.lang&&(l.languageCode=n.lang),l.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ge.MAIN){var n,r;const{cea608Parser1:o,cea608Parser2:l,lastSn:u}=this,{cc:f,sn:d}=t.frag,m=(n=(r=t.part)==null?void 0:r.index)!=null?n:-1;o&&l&&(d!==u+1||d===u&&m!==this.lastPartIndex+1||f!==this.lastCc)&&(o.reset(),l.reset()),this.lastCc=f,this.lastSn=d,this.lastPartIndex=m}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===ge.SUBTITLE)if(r.byteLength){const o=n.decryptdata,l="stats"in t;if(o==null||!o.encrypted||l){const u=this.tracks[n.level],f=this.vttCCs;f[n.cc]||(f[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),u&&u.textCodec===tm?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;bS(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),n.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{n.logger.log(`Failed to parse IMSC1: ${r}`),n.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:o,unparsedVttFrags:l}=this,u=o.length-1;if(!o[n.cc]&&u===-1){l.push(e);return}const f=this.hls,d=(t=n.initSegment)!=null&&t.data?kn(n.initSegment.data,new Uint8Array(r)).buffer:r;W3(d,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,m=>{this._appendCues(m,n.level),f.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},m=>{const g=m.message==="Missing initPTS for VTT MPEGTS";g?l.push(e):this._fallbackToIMSC1(n,r),f.logger.log(`Failed to parse VTT cue: ${m}`),!(g&&u>n.cc)&&f.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:m})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||bS(t,this.initPTS[e.cc],()=>{n.textCodec=tm,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(o=>m1(r,o))}else{const r=this.tracks[t];if(!r)return;const o=r.default?"default":"subtitles"+t;n.trigger(C.CUES_PARSED,{type:"subtitles",cues:e,track:o})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===ge.SUBTITLE&&this.onFragLoaded(C.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:r}=t;if(!(n.type===ge.MAIN&&this.closedCaptionsForLevel(n)==="NONE"))for(let o=0;o<r.length;o++){const l=r[o].bytes;if(l){this.cea608Parser1||this.initCea608Parsers();const u=this.extractCea608Data(l);this.cea608Parser1.addData(r[o].pts,u[0]),this.cea608Parser2.addData(r[o].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:o}){const{media:l}=this;if(!(!l||l.currentTime<n)){if(!o||o==="video"){const{captionsTracks:u}=this;Object.keys(u).forEach(f=>Gm(u[f],t,n))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:u}=this;Object.keys(u).forEach(f=>Gm(u[f],t,r))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let r=2;for(let o=0;o<n;o++){const l=e[r++],u=127&e[r++],f=127&e[r++];if(u===0&&f===0)continue;if((4&l)!==0){const m=3&l;(m===0||m===1)&&(t[m].push(u),t[m].push(f))}}return t}}function A1(s){return s.characteristics&&/transcribes-spoken-dialog/gi.test(s.characteristics)&&/describes-music-and-sound/gi.test(s.characteristics)?"captions":"subtitles"}function LS(s,e){return!!s&&s.kind===A1(e)&&Um(e,s)}function s$(s,e,t,n){return Math.min(e,n)-Math.max(s,t)}function CS(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const i$=/\s/,r$={newCue(s,e,t,n){const r=[];let o,l,u,f,d;const m=self.VTTCue||self.TextTrackCue;for(let y=0;y<n.rows.length;y++)if(o=n.rows[y],u=!0,f=0,d="",!o.isEmpty()){var g;for(let S=0;S<o.chars.length;S++)i$.test(o.chars[S].uchar)&&u?f++:(d+=o.chars[S].uchar,u=!1);o.cueStartTime=e,e===t&&(t+=1e-4),f>=16?f--:f++;const x=E1(d.trim()),E=ap(e,t,x);s!=null&&(g=s.cues)!=null&&g.getCueById(E)||(l=new m(e,t,x),l.id=E,l.line=y+1,l.align="left",l.position=10+Math.min(80,Math.floor(f*8/32)*10),r.push(l))}return s&&r.length&&(r.sort((y,x)=>y.line==="auto"||x.line==="auto"?0:y.line>8&&x.line>8?x.line-y.line:y.line-x.line),r.forEach(y=>m1(s,y))),r}};function a$(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const o$=/(\d+)-(\d+)\/(\d+)/;class _S{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||d$,this.controller=new self.AbortController,this.stats=new Ug}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const o=l$(e,this.controller.signal),l=e.responseType==="arraybuffer",u=l?"byteLength":"length",{maxTimeToFirstByteMs:f,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,o),self.clearTimeout(this.requestTimeout),t.timeout=f&&me(f)?f:d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},t.timeout),(qo(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(g=>{var y;this.response=this.loader=g;const x=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},d-(x-r.loading.start)),!g.ok){const{status:S,statusText:b}=g;throw new f$(b||"fetch, bad network response",S,g)}r.loading.first=x,r.total=u$(g.headers)||r.total;const E=(y=this.callbacks)==null?void 0:y.onProgress;return E&&me(t.highWaterMark)?this.loadProgressively(g,r,e,t.highWaterMark,E):l?g.arrayBuffer():e.responseType==="json"?g.json():g.text()}).then(g=>{var y,x;const E=this.response;if(!E)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const S=g[u];S&&(r.loaded=r.total=S);const b={url:E.url,data:g,code:E.status},R=(y=this.callbacks)==null?void 0:y.onProgress;R&&!me(t.highWaterMark)&&R(r,e,g,E),(x=this.callbacks)==null||x.onSuccess(b,r,e,E)}).catch(g=>{var y;if(self.clearTimeout(this.requestTimeout),r.aborted)return;const x=g&&g.code||0,E=g?g.message:null;(y=this.callbacks)==null||y.onError({code:x,text:E},e,g?g.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,o){const l=new NR,u=e.body.getReader(),f=()=>u.read().then(d=>{if(d.done)return l.dataLength&&o(t,n,l.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const m=d.value,g=m.length;return t.loaded+=g,g<r||l.dataLength?(l.push(m),l.dataLength>=r&&o(t,n,l.flush().buffer,e)):o(t,n,m.buffer,e),f()}).catch(()=>Promise.reject());return f()}}function l$(s,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ze({},s.headers))};return s.rangeEnd&&t.headers.set("Range","bytes="+s.rangeStart+"-"+String(s.rangeEnd-1)),t}function c$(s){const e=o$.exec(s);if(e)return parseInt(e[2])-parseInt(e[1])+1}function u$(s){const e=s.get("Content-Range");if(e){const n=c$(e);if(me(n))return n}const t=s.get("Content-Length");if(t)return parseInt(t)}function d$(s,e){return new self.Request(s.url,e)}class f$ extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const h$=/^age:\s*[\d.]+\s*$/im;class R1{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Ug,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const o=this.xhrSetup;o?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return o(n,t.url)}).catch(l=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),o(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(l=>{var u;(u=this.callbacks)==null||u.onError({code:n.status,text:l.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:o,maxLoadTimeMs:l}=n.loadPolicy;if(r)for(const u in r)e.setRequestHeader(u,r[u]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=o&&me(o)?o:l,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,o=this.config;if(!n.aborted&&r>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),o.timeout!==o.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),o.timeout=o.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),o.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const d=t.status,m=t.responseType==="text"?t.responseText:null;if(d>=200&&d<300){const E=m??t.response;if(E!=null){var l,u;n.loading.end=Math.max(self.performance.now(),n.loading.first);const S=t.responseType==="arraybuffer"?E.byteLength:E.length;n.loaded=n.total=S,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first);const b=(l=this.callbacks)==null?void 0:l.onProgress;b&&b(n,e,E,t);const R={url:t.responseURL,data:E,code:d};(u=this.callbacks)==null||u.onSuccess(R,n,e,t);return}}const g=o.loadPolicy.errorRetry,y=n.retry,x={url:e.url,data:void 0,code:d};if(bu(g,y,!1,x))this.retry(g);else{var f;qe.error(`${d} while loading ${e.url}`),(f=this.callbacks)==null||f.onError({code:d,text:t.statusText},e,t,n)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(bu(e,t,!0))this.retry(e);else{var n;qe.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Gg(e,n.retry),n.retry++,qe.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&h$.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const m$={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},g$=Ye(Ye({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:R1,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:CF,bufferController:yB,capLevelController:np,errorController:OF,fpsController:v3,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:bR,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:m$},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},p$()),{},{subtitleStreamController:D3,subtitleTrackController:S3,timelineController:n$,audioStreamController:hB,audioTrackController:mB,emeController:ga,cmcdController:m3,contentSteeringController:p3,interstitialsController:w3});function p$(){return{cueHandler:r$,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function y$(s,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Vm(s),r=["manifest","level","frag"],o=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(l=>{const u=`${l==="level"?"playlist":l}LoadPolicy`,f=e[u]===void 0,d=[];o.forEach(m=>{const g=`${l}Loading${m}`,y=e[g];if(y!==void 0&&f){d.push(g);const x=n[u].default;switch(e[u]={default:x},m){case"TimeOut":x.maxLoadTimeMs=y,x.maxTimeToFirstByteMs=y;break;case"MaxRetry":x.errorRetry.maxNumRetry=y,x.timeoutRetry.maxNumRetry=y;break;case"RetryDelay":x.errorRetry.retryDelayMs=y,x.timeoutRetry.retryDelayMs=y;break;case"MaxRetryTimeout":x.errorRetry.maxRetryDelayMs=y,x.timeoutRetry.maxRetryDelayMs=y;break}}}),d.length&&t.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${u}": ${tt(e[u])}`)}),Ye(Ye({},n),e)}function Vm(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(Vm):Object.keys(s).reduce((e,t)=>(e[t]=Vm(s[t]),e),{}):s}function v$(s,e){const t=s.loader;t!==_S&&t!==R1?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):a$()&&(s.loader=_S,s.progressive=!0,s.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const lu=2,x$=.1,E$=.05,S$=100;class T$ extends vR{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var n;(n=this.media)!=null&&n.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var n;this.ended=((n=this.media)==null?void 0:n.currentTime)||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(S$),this.mediaSource=t.mediaSource;const n=this.media=t.media;zt(n,"playing",this.onMediaPlaying),zt(n,"waiting",this.onMediaWaiting),zt(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(rn(n,"playing",this.onMediaPlaying),rn(n,"waiting",this.onMediaWaiting),rn(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,r;const o=(n=this.hls)==null?void 0:n.config;if(!o)return;const l=this.media;if(!l)return;const{seeking:u}=l,f=this.seeking&&!u,d=!this.seeking&&u,m=l.paused&&!u||l.ended||l.playbackRate===0;if(this.seeking=u,e!==t){t&&(this.ended=0),this.moved=!0,u||(this.nudgeRetry=0,o.nudgeOnVideoHole&&!m&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(d||f){f&&this.stallResolved(e);return}if(m){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&l.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!1}));return}if(!Ae.getBuffered(l).length){this.nudgeRetry=0;return}const g=Ae.bufferInfo(l,e,0),y=g.nextStart||0,x=this.fragmentTracker;if(u&&x&&this.hls){const $=wS(this.hls.inFlightFragments,e),O=g.len>lu,k=!y||$||y-e>lu&&!x.getPartialFragment(e);if(O||k)return;this.moved=!1}const E=(r=this.hls)==null?void 0:r.latestLevelDetails;if(!this.moved&&this.stalled!==null&&x){if(!(g.len>0)&&!y)return;const O=Math.max(y,g.start||0)-e,G=!!(E!=null&&E.live)?E.targetduration*2:lu,B=qc(e,x);if(O>0&&(O<=G||B)){l.paused||this._trySkipBufferHole(B);return}}const S=o.detectStallWithCurrentTimeMs,b=self.performance.now(),R=this.waiting;let w=this.stalled;if(w===null)if(R>0&&b-R<S)w=this.stalled=R;else{this.stalled=b;return}const _=b-w;if(!u&&(_>=S||R)&&this.hls){var D;if(((D=this.mediaSource)==null?void 0:D.readyState)==="ended"&&!(E!=null&&E.live)&&Math.abs(e-(E?.edge||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(g),!this.media||!this.hls)return}const M=Ae.bufferInfo(l,e,o.maxBufferHole);this._tryFixBufferStall(M,_,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(C.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const r=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(n=this.buffered.audio)!=null&&n.length&&r&&r.length>1&&e>r.end(0)){const o=Ae.bufferedInfo(Ae.timeRangesToArray(this.buffered.audio),e,0);if(o.len>1&&t>=o.start){const l=Ae.timeRangesToArray(r),u=Ae.bufferedInfo(l,t,0).bufferedIndex;if(u>-1&&u<l.length-1){const f=Ae.bufferedInfo(l,e,0).bufferedIndex,d=l[u].end,m=l[u+1].start;if((f===-1||f>u)&&m-d<1&&e-d<2){const g=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${d} -> ${m} buffered index: ${f}`);this.warn(g.message),this.media.currentTime+=1e-6;let y=qc(e,this.fragmentTracker);y&&"fragment"in y?y=y.fragment:y||(y=void 0);const x=Ae.bufferInfo(this.media,e,0);this.hls.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:g,reason:g.message,frag:y,buffer:x.len,bufferInfo:x})}}}}}_tryFixBufferStall(e,t,n){var r,o;const{fragmentTracker:l,media:u}=this,f=(r=this.hls)==null?void 0:r.config;if(!u||!l||!f)return;const d=(o=this.hls)==null?void 0:o.latestLevelDetails,m=qc(n,l);if((m||d!=null&&d.live&&n<d.fragmentStart)&&(this._trySkipBufferHole(m)||!this.media))return;const g=e.buffered,y=this.adjacentTraversal(e,n);(g&&g.length>1&&e.len>f.maxBufferHole||e.nextStart&&(e.nextStart-n<f.maxBufferHole||y))&&(t>f.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const n=this.fragmentTracker,r=e.nextStart;if(n&&r){const o=n.getFragAtPos(t,ge.MAIN),l=n.getFragAtPos(r,ge.MAIN);if(o&&l)return l.sn-o.sn<2}return!1}_reportStall(e){const{hls:t,media:n,stallReported:r,stalled:o}=this;if(!r&&o!==null&&n&&t){this.stallReported=!0;const l=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${tt(e)})`);this.warn(l.message),t.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.BUFFER_STALLED_ERROR,fatal:!1,error:l,buffer:e.len,bufferInfo:e,stalled:{start:o}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:r}=this,o=(t=this.hls)==null?void 0:t.config;if(!r||!n||!o)return 0;const l=r.currentTime,u=Ae.bufferInfo(r,l,0),f=l<u.start?u.start:u.nextStart;if(f&&this.hls){const m=u.len<=o.maxBufferHole,g=u.len>0&&u.len<1&&r.readyState<3,y=f-l;if(y>0&&(m||g)){if(y>o.maxBufferHole){let E=!1;if(l===0){const S=n.getAppendedFrag(0,ge.MAIN);S&&f<S.end&&(E=!0)}if(!E&&e){var d;if(!((d=this.hls.loadLevelObj)!=null&&d.details)||wS(this.hls.inFlightFragments,f))return 0;let b=!1,R=e.end;for(;R<f;){const w=qc(R,n);if(w)R+=w.duration;else{b=!0;break}}if(b)return 0}}const x=Math.max(f+E$,l+x$);if(this.warn(`skipping hole, adjusting currentTime from ${l} to ${x}`),this.moved=!0,r.currentTime=x,!(e!=null&&e.gap)){const E=new Error(`fragment loaded with buffer holes, seeking from ${l} to ${x}`),S={type:Ee.MEDIA_ERROR,details:X.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:E,reason:E.message,buffer:u.len,bufferInfo:u};e&&("fragment"in e?S.part=e:S.frag=e),this.hls.trigger(C.ERROR,S)}return x}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:r}=this,o=t?.config;if(!n||!o)return 0;const l=n.currentTime;if(this.nudgeRetry++,r<o.nudgeMaxRetry){const u=l+(r+1)*o.nudgeOffset,f=new Error(`Nudging 'currentTime' from ${l} to ${u}`);this.warn(f.message),n.currentTime=u,t.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.BUFFER_NUDGE_ON_STALL,error:f,fatal:!1,buffer:e.len,bufferInfo:e})}else{const u=new Error(`Playhead still not moving while enough data buffered @${l} after ${o.nudgeMaxRetry} nudges`);this.error(u.message),t.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.BUFFER_STALLED_ERROR,error:u,fatal:!0,buffer:e.len,bufferInfo:e})}}}function wS(s,e){const t=DS(s.main);if(t&&t.start<=e)return t;const n=DS(s.audio);return n&&n.start<=e?n:null}function DS(s){if(!s)return null;switch(s.state){case re.IDLE:case re.STOPPED:case re.ENDED:case re.ERROR:return null}return s.frag}function qc(s,e){return e.getAppendedFrag(s,ge.MAIN)||e.getPartialFragment(s)}const b$=.25;function Km(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function rm(s,e,t,n,r){let o=new s(e,t,"");try{o.value=n,r&&(o.type=r)}catch{o=new s(e,t,tt(r?Ye({type:r},n):n))}return o}const Xc=(()=>{const s=Km();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class A${constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(C.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var n;this.media=t.media,((n=t.overrides)==null?void 0:n.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&aa(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return h1(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:n,enableID3MetadataCues:r}=this.hls.config;if(!n&&!r)return;const{samples:o}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=Km();if(l)for(let u=0;u<o.length;u++){const f=o[u].type;if(f===xn.emsg&&!n||!r)continue;const d=jR(o[u].data),m=o[u].pts;let g=m+o[u].duration;g>Xc&&(g=Xc),g-m<=0&&(g=m+b$);for(let x=0;x<d.length;x++){const E=d[x];if(!GR(E)){this.updateId3CueEnds(m,f);const S=rm(l,m,g,E,f);S&&this.id3Track.addCue(S)}}}}updateId3CueEnds(e,t){var n;const r=(n=this.id3Track)==null?void 0:n.cues;if(r)for(let o=r.length;o--;){const l=r[o];l.type===t&&l.startTime<e&&l.endTime===Xc&&(l.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:o,hls:l}=this;if(!l)return;const{config:{enableEmsgMetadataCues:u,enableID3MetadataCues:f}}=l;if(o&&(u||f)){let d;r==="audio"?d=m=>m.type===xn.audioId3&&f:r==="video"?d=m=>m.type===xn.emsg&&u:d=m=>m.type===xn.audioId3&&f||m.type===xn.emsg&&u,Gm(o,t,n,d)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:n,timelineOffset:r,enableDateRangeMetadataCues:o,interstitialsController:l}=this.hls.config;if(!o)return;const u=Km();if(n&&r&&!l){const{fragmentStart:S,fragmentEnd:b}=e;let R=this.assetCue;R?(R.startTime=S,R.endTime=b):u&&(R=this.assetCue=rm(u,S,b,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),R&&(R.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(R),R.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:f}=this,{dateRanges:d}=e,m=Object.keys(d);let g=this.dateRangeCuesAppended;if(f&&t){var y;if((y=f.cues)!=null&&y.length){const S=Object.keys(g).filter(b=>!m.includes(b));for(let b=S.length;b--;){var x;const R=S[b],w=(x=g[R])==null?void 0:x.cues;delete g[R],w&&Object.keys(w).forEach(_=>{const D=w[_];if(D){D.removeEventListener("enter",this.onEventCueEnter);try{f.removeCue(D)}catch{}}})}}else g=this.dateRangeCuesAppended={}}const E=e.fragments[e.fragments.length-1];if(!(m.length===0||!me(E?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let S=0;S<m.length;S++){const b=m[S],R=d[b],w=R.startTime,_=g[b],D=_?.cues||{};let M=_?.durationKnown||!1,$=Xc;const{duration:O,endDate:k}=R;if(k&&O!==null)$=w+O,M=!0;else if(R.endOnNext&&!M){const B=m.reduce((K,ne)=>{if(ne!==R.id){const ue=d[ne];if(ue.class===R.class&&ue.startDate>R.startDate&&(!K||R.startDate<K.startDate))return ue}return K},null);B&&($=B.startTime,M=!0)}const G=Object.keys(R.attr);for(let B=0;B<G.length;B++){const K=G[B];if(!KF(K))continue;const ne=D[K];if(ne)M&&!(_!=null&&_.durationKnown)?ne.endTime=$:Math.abs(ne.startTime-w)>.01&&(ne.startTime=w,ne.endTime=$);else if(u){let ue=R.attr[K];zF(K)&&(ue=ZA(ue));const ae=rm(u,w,$,{key:K,data:ue},xn.dateRange);ae&&(ae.id=b,this.id3Track.addCue(ae),D[K]=ae,l&&(K==="X-ASSET-LIST"||K==="X-ASSET-URL")&&ae.addEventListener("enter",this.onEventCueEnter))}}g[b]={cues:D,dateRange:R,durationKnown:M}}}}}class R${constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,n=this.levelDetails;if(!t||!n)return;this.currentTime=t.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:o,maxLiveSyncPlaybackRate:l}=this.config;if(!o||l===1||!n.live)return;const u=this.targetLatency;if(u===null)return;const f=r-u,d=Math.min(this.maxLatency,u+n.targetduration);if(f<d&&f>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,l)),y=Math.round(2/(1+Math.exp(-.75*f-this.edgeStalled))*20)/20,x=Math.min(g,Math.max(1,y));this.changeMediaPlaybackRate(t,x)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:o,liveSyncDurationCount:l,lowLatencyMode:u}=this.config,f=this.hls.userConfig;let d=u&&n||t;(this._targetLatencyUpdated||f.liveSyncDuration||f.liveSyncDurationCount||d===0)&&(d=o!==void 0?o:l*r);const m=r;return d+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,m)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const n=this.levelDetails;if(n===null)return null;const r=n.edge,o=e-t-this.edgeStalled,l=r-n.totalduration,u=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(l,o),u)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===X.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(n=this.levelDetails)!=null&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,r;e.playbackRate!==t&&((n=this.hls)==null||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(r=this.targetLatency)==null?void 0:r.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class L$ extends tp{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,r=[],o={},l={};let u=!1,f=!1,d=!1;t.levels.forEach(m=>{const g=m.attrs;let{audioCodec:y,videoCodec:x}=m;y&&(m.audioCodec=y=xu(y,n)||void 0),x&&(x=m.videoCodec=lF(x));const{width:E,height:S,unknownCodecs:b}=m,R=b?.length||0;if(u||(u=!!(E&&S)),f||(f=!!x),d||(d=!!y),R||y&&!this.isAudioSupported(y)||x&&!this.isVideoSupported(x)){this.log(`Some or all CODECS not supported "${g.CODECS}"`);return}const{CODECS:w,"FRAME-RATE":_,"HDCP-LEVEL":D,"PATHWAY-ID":M,RESOLUTION:$,"VIDEO-RANGE":O}=g,G=`${`${M||"."}-`}${m.bitrate}-${$}-${_}-${w}-${O}-${D}`;if(o[G])if(o[G].uri!==m.url&&!m.attrs["PATHWAY-ID"]){const B=l[G]+=1;m.attrs["PATHWAY-ID"]=new Array(B+1).join(".");const K=this.createLevel(m);o[G]=K,r.push(K)}else o[G].addGroupId("audio",g.AUDIO),o[G].addGroupId("text",g.SUBTITLES);else{const B=this.createLevel(m);o[G]=B,l[G]=1,r.push(B)}}),this.filterAndSortMediaOptions(r,t,u,f,d)}createLevel(e){const t=new Ko(e),n=e.supplemental;if(n!=null&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const r=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(r.message),t.supportedResult=uR(r,[])}return t}isAudioSupported(e){return Ho(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Ho(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,r,o){var l;let u=[],f=[],d=e;const m=((l=t.stats)==null?void 0:l.parsing)||{};if((n||r)&&o&&(d=d.filter(({videoCodec:w,videoRange:_,width:D,height:M})=>(!!w||!!(D&&M))&&vF(_))),d.length===0){Promise.resolve().then(()=>{if(this.hls){let w="no level with compatible codecs found in manifest",_=w;t.levels.length&&(_=`one or more CODECS in variant not supported: ${tt(t.levels.map(M=>M.attrs.CODECS).filter((M,$,O)=>O.indexOf(M)===$))}`,this.warn(_),w+=` (${_})`);const D=new Error(w);this.hls.trigger(C.ERROR,{type:Ee.MEDIA_ERROR,details:X.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:D,reason:_})}}),m.end=performance.now();return}t.audioTracks&&(u=t.audioTracks.filter(w=>!w.audioCodec||this.isAudioSupported(w.audioCodec)),IS(u)),t.subtitles&&(f=t.subtitles,IS(f));const g=d.slice(0);d.sort((w,_)=>{if(w.attrs["HDCP-LEVEL"]!==_.attrs["HDCP-LEVEL"])return(w.attrs["HDCP-LEVEL"]||"")>(_.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&w.height!==_.height)return w.height-_.height;if(w.frameRate!==_.frameRate)return w.frameRate-_.frameRate;if(w.videoRange!==_.videoRange)return Eu.indexOf(w.videoRange)-Eu.indexOf(_.videoRange);if(w.videoCodec!==_.videoCodec){const D=TE(w.videoCodec),M=TE(_.videoCodec);if(D!==M)return M-D}if(w.uri===_.uri&&w.codecSet!==_.codecSet){const D=vu(w.codecSet),M=vu(_.codecSet);if(D!==M)return M-D}return w.averageBitrate!==_.averageBitrate?w.averageBitrate-_.averageBitrate:0});let y=g[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==g.length)){for(let w=0;w<g.length;w++)if(g[w].pathwayId===d[0].pathwayId){y=g[w];break}}this._levels=d;for(let w=0;w<d.length;w++)if(d[w]===y){var x;this._firstLevel=w;const _=y.bitrate,D=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${_}`),((x=this.hls.userConfig)==null?void 0:x.abrEwmaDefaultEstimate)===void 0){const M=Math.min(_,this.hls.config.abrEwmaDefaultEstimateMax);M>D&&D===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=M)}break}const E=o&&!r,S=this.hls.config,b=!!(S.audioStreamController&&S.audioTrackController),R={levels:d,audioTracks:u,subtitleTracks:f,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:r,altAudio:b&&!E&&u.some(w=>!!w.url)};m.end=performance.now(),this.hls.trigger(C.MANIFEST_PARSED,R)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const m=new Error("invalid level idx"),g=e<0;if(this.hls.trigger(C.ERROR,{type:Ee.OTHER_ERROR,details:X.LEVEL_SWITCH_ERROR,level:e,fatal:g,error:m,reason:m.message}),g)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,o=r?r.attrs["PATHWAY-ID"]:void 0,l=t[e],u=l.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=l,n===e&&r&&o===u)return;this.log(`Switching to level ${e} (${l.height?l.height+"p ":""}${l.videoRange?l.videoRange+" ":""}${l.codecSet?l.codecSet+" ":""}@${l.bitrate})${u?" with Pathway "+u:""} from level ${n}${o?" with Pathway "+o:""}`);const f={level:e,attrs:l.attrs,details:l.details,bitrate:l.bitrate,averageBitrate:l.averageBitrate,maxBitrate:l.maxBitrate,realBitrate:l.realBitrate,width:l.width,height:l.height,codecSet:l.codecSet,audioCodec:l.audioCodec,videoCodec:l.videoCodec,audioGroups:l.audioGroups,subtitleGroups:l.subtitleGroups,loaded:l.loaded,loadError:l.loadError,fragmentError:l.fragmentError,name:l.name,id:l.id,uri:l.uri,url:l.url,urlId:0,audioGroupIds:l.audioGroupIds,textGroupIds:l.textGroupIds};this.hls.trigger(C.LEVEL_SWITCHING,f);const d=l.details;if(!d||d.live){const m=this.switchParams(l.uri,r?.details,d);this.loadPlaylist(m)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(r=>t.indexOf(r)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=n}}onError(e,t){t.fatal||!t.context||t.context.type===Me.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===ge.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(o=>!!n[o]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:o}=t,l=t.levelInfo;if(!l){var u;this.warn(`Invalid level index ${r}`),(u=t.deliveryDirectives)!=null&&u.skip&&(o.deltaUpdateFailed=!0);return}if(l===this.currentLevel||t.withoutMultiVariant){l.fragmentError===0&&(l.loadError=0);let f=l.details;f===t.details&&f.advanced&&(f=void 0),this.playlistLoaded(r,t,f)}else(n=t.deliveryDirectives)!=null&&n.skip&&(o.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),r=this.currentLevelIndex,o=e.attrs["PATHWAY-ID"],l=e.details,u=l?.age;this.log(`Loading level index ${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${o?" Pathway "+o:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${n}`),this.hls.trigger(C.LEVEL_LOADING,{url:n,level:r,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const n=this._levels.filter((o,l)=>l!==e?!0:(this.steering&&this.steering.removeLevel(o),o===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,o.details&&o.details.fragments.forEach(u=>u.level=-1)),!1));IR(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const r=n.length-1;this._firstLevel=Math.min(this._firstLevel,r),this._startLevel&&(this._startLevel=Math.min(this._startLevel,r)),this.hls.trigger(C.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(C.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function IS(s){const e={};s.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}function L1(){return self.SourceBuffer||self.WebKitSourceBuffer}function C1(){if(!Di())return!1;const e=L1();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function C$(){if(!C1())return!1;const s=Di();return typeof s?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>s.isTypeSupported(Vo(e,"video")))||["mp4a.40.2","fLaC"].some(e=>s.isTypeSupported(Vo(e,"audio"))))}function _$(){var s;const e=L1();return typeof(e==null||(s=e.prototype)==null?void 0:s.changeType)=="function"}const w$=100;class D$ extends Yg{constructor(e,t,n){super(e,t,n,"stream-controller",ge.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const r=this.media,o=r?r.currentTime:null;if(o===null||!me(o)||(this.log(`Media seeked to ${o.toFixed(3)}`),!this.getBufferedFrag(o)))return;const l=this.getFwdBufferInfoAtPos(r,o,ge.MAIN,0);if(l===null||l.len===0){this.warn(`Main forward buffer length at ${o} on "seeked" event ${l?l.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:r}=this;if(this.stopLoad(),this.setInterval(w$),this.level=-1,!this.startFragRequested){let o=r.startLevel;o===-1&&(r.config.testBandwidth&&this.levels.length>1?(o=0,this.bitrateTest=!0):o=r.firstAutoLevel),r.nextLoadLevel=o,this.level=r.loadLevel,this._hasEnoughToStart=!!t}n>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=re.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=re.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case re.WAITING_LEVEL:{const{levels:e,level:t}=this,n=e?.[t],r=n?.details;if(r&&(!r.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(r))break;this.state=re.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=re.IDLE;break}break}case re.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===re.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this;if(t===null||!r&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const o=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[o]))return;const l=n[o],u=this.getMainFwdBufferInfo();if(u===null)return;const f=this.getLevelDetails();if(f&&this._streamEnded(u,f)){const S={};this.altAudio===2&&(S.type="video"),this.hls.trigger(C.BUFFER_EOS,S),this.state=re.ENDED;return}if(!this.buffering)return;e.loadLevel!==o&&e.manualLevel===-1&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const d=l.details;if(!d||this.state===re.WAITING_LEVEL||this.waitForLive(l)){this.level=o,this.state=re.WAITING_LEVEL,this.startFragRequested=!1;return}const m=u.len,g=this.getMaxBufferLength(l.maxBitrate);if(m>=g)return;this.backtrackFragment&&this.backtrackFragment.start>u.end&&(this.backtrackFragment=null);const y=this.backtrackFragment?this.backtrackFragment.start:u.end;let x=this.getNextFragment(y,d);if(this.couldBacktrack&&!this.fragPrevious&&x&&gt(x)&&this.fragmentTracker.getState(x)!==At.OK){var E;const b=((E=this.backtrackFragment)!=null?E:x).sn-d.startSN,R=d.fragments[b-1];R&&x.cc===R.cc&&(x=R,this.fragmentTracker.removeFragment(R))}else this.backtrackFragment&&u.len&&(this.backtrackFragment=null);if(x&&this.isLoopLoading(x,y)){if(!x.gap){const b=this.audioOnly&&!this.altAudio?et.AUDIO:et.VIDEO,R=(b===et.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;R&&this.afterBufferFlushed(R,b,ge.MAIN)}x=this.getNextFragmentLoopLoading(x,d,u,ge.MAIN,g)}x&&(x.initSegment&&!x.initSegment.data&&!this.bitrateTest&&(x=x.initSegment),this.loadFragment(x,l,y))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);r===At.NOT_LOADED||r===At.PARTIAL?gt(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ge.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const o=this.getLevelDetails();if(o!=null&&o.live){const u=this.getMainFwdBufferInfo();if(!u||u.len<o.targetduration*2)return}if(!t.paused&&e){const u=this.hls.nextLoadLevel,f=e[u],d=this.fragLastKbps;d&&this.fragCurrent?n=this.fragCurrent.duration*f.maxBitrate/(1e3*d)+1:n=0}else n=0;const l=this.getBufferedFrag(t.currentTime+n);if(l){const u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();const f=u.maxStartPTS?u.maxStartPTS:u.start,d=u.duration,m=Math.max(l.end,f+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case re.KEY_LOADING:case re.FRAG_LOADING:case re.FRAG_LOADING_WAITING_RETRY:case re.PARSING:case re.PARSED:this.state=re.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;zt(n,"playing",this.onMediaPlaying),zt(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(rn(n,"playing",this.onMediaPlaying),rn(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(C.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,r=!1;for(let o=0;o<t.levels.length;o++){const l=t.levels[o].audioCodec;l&&(n=n||l.indexOf("mp4a.40.2")!==-1,r=r||l.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=n&&r&&!_$(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==re.IDLE)return;const r=t.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=re.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:r,startFragRequested:o}=this,l=t.level,u=t.details,f=u.totalduration;if(!r){this.warn(`Levels were reset while loading level ${l}`);return}this.log(`Level ${l} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""}, cc [${u.startCC}, ${u.endCC}] duration:${f}`);const d=t.levelInfo,m=this.fragCurrent;m&&(this.state===re.FRAG_LOADING||this.state===re.FRAG_LOADING_WAITING_RETRY)&&m.level!==t.level&&m.loader&&this.abortCurrentFrag();let g=0;if(u.live||(n=d.details)!=null&&n.live){var y;if(this.checkLiveUpdate(u),u.deltaUpdateFailed)return;g=this.alignPlaylists(u,d.details,(y=this.levelLastLoaded)==null?void 0:y.details)}if(d.details=u,this.levelLastLoaded=d,o||this.setStartPosition(u,g),this.hls.trigger(C.LEVEL_UPDATED,{details:u,level:l}),this.state===re.WAITING_LEVEL){if(this.waitForCdnTuneIn(u))return;this.state=re.IDLE}o&&u.live&&this.synchronizeToLiveEdge(u),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,o=this.getLoadPosition(),l=e.fragmentStart,u=e.edge,f=o>=l-t.maxFragLookUpTolerance&&o<=u;if(r!==null&&n.duration>r&&(o<r||!f)){const m=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!f&&n.readyState<4||o<u-m)&&(this._hasEnoughToStart||(this.nextLoadPosition=r),n.readyState))if(this.warn(`Playback: ${o.toFixed(3)} is located too far from the end of live sliding playlist: ${u}, reset currentTime to : ${r.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var d;const g=Ae.bufferInfo(n,r,0);if(!((d=g.buffered)!=null&&d.length)){n.currentTime=r;return}if(g.start<=o){n.currentTime=r;return}const{nextStart:x}=Ae.bufferedInfo(g.buffered,o,0);x&&(n.currentTime=x)}else n.currentTime=r}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:r,payload:o}=e,{levels:l}=this;if(!l){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=l[n.level];if(!u){this.warn(`Level ${n.level} not found on progress`);return}const f=u.details;if(!f){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const d=u.videoCodec,m=f.PTSKnown||!f.live,g=(t=n.initSegment)==null?void 0:t.data,y=this._getAudioCodec(u),x=this.transmuxer=this.transmuxer||new JR(this.hls,ge.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),E=r?r.index:-1,S=E!==-1,b=new Vg(n.level,n.sn,n.stats.chunkCount,o.byteLength,E,S),R=this.initPTS[n.cc];x.push(o,g,y,d,n,r,f.totalduration,m,b,R)}onAudioTrackSwitching(e,t){const n=this.hls,r=this.altAudio!==0;if(Su(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const l=this.fragCurrent;l&&(this.log("Switching to main audio track, cancel main fragment load"),l.abortRequests(),this.fragmentTracker.removeFragment(l)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(r){this.altAudio=0,this.fragmentTracker.removeAllFragments(),n.once(C.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(C.AUDIO_TRACK_SWITCHED,t)}),n.trigger(C.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}n.trigger(C.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=Su(t.url,this.hls);if(n){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,o,l=!1;for(const u in n){const f=n[u];if(f.id==="main"){if(o=u,r=f,u==="video"){const d=n[u];d&&(this.videoBuffer=d.buffer)}}else l=!0}l&&r?(this.log(`Alternate track found, use ${o}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t,o=n.type===ge.MAIN;if(o){if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===re.PARSED&&(this.state=re.IDLE);return}const u=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),gt(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}const l=this.media;l&&(!this._hasEnoughToStart&&Ae.getBuffered(l).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),o&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal){this.state=re.ERROR;return}switch(t.details){case X.FRAG_GAP:case X.FRAG_PARSING_ERROR:case X.FRAG_DECRYPT_ERROR:case X.FRAG_LOAD_ERROR:case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_ERROR:case X.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ge.MAIN,t);break;case X.LEVEL_LOAD_ERROR:case X.LEVEL_LOAD_TIMEOUT:case X.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===re.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===Me.LEVEL&&(this.state=re.IDLE);break;case X.BUFFER_ADD_CODEC_ERROR:case X.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case X.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case X.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=re.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==et.AUDIO||!this.altAudio){const n=(t===et.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,t,ge.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const r=this.timelineOffset;r&&n&&(n+=r);const o=this.getLevelDetails(),l=Ae.getBuffered(e),u=l.length?l.start(0):0,f=u-n,d=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||f>0&&(f<d||this.loadingParts&&f<2*(o?.partTarget||0)))&&(this.log(`adjusting start position by ${f} to match buffer start`),n+=f,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${u}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:r}=this,o=n?.frag;if(!o||this.fragContextChanged(o))return;t.fragmentError=0,this.state=re.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const l=o.stats;l.parsing.start=l.parsing.end=l.buffering.start=l.buffering.end=self.performance.now(),r.trigger(C.FRAG_LOADED,n),o.bitrateTest=!1}).catch(n=>{this.state===re.STOPPED||this.state===re.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:n}=this,{remuxResult:r,chunkMeta:o}=e,l=this.getCurrentContext(o);if(!l){this.resetWhenMissingContext(o);return}const{frag:u,part:f,level:d}=l,{video:m,text:g,id3:y,initSegment:x}=r,{details:E}=d,S=this.altAudio?void 0:r.audio;if(this.fragContextChanged(u)){this.fragmentTracker.removeFragment(u);return}if(this.state=re.PARSING,x){const b=x.tracks;if(b){const D=u.initSegment||u;if(this.unhandledEncryptionError(x,u))return;this._bufferInitSegment(d,b,D,o),n.trigger(C.FRAG_PARSING_INIT_SEGMENT,{frag:D,id:t,tracks:b})}const R=x.initPTS,w=x.timescale,_=this.initPTS[u.cc];if(me(R)&&(!_||_.baseTime!==R||_.timescale!==w)){const D=x.trackId;this.initPTS[u.cc]={baseTime:R,timescale:w,trackId:D},n.trigger(C.INIT_PTS_FOUND,{frag:u,id:t,initPTS:R,timescale:w,trackId:D})}}if(m&&E){S&&m.type==="audiovideo"&&this.logMuxedErr(u);const b=E.fragments[u.sn-1-E.startSN],R=u.sn===E.startSN,w=!b||u.cc>b.cc;if(r.independent!==!1){const{startPTS:_,endPTS:D,startDTS:M,endDTS:$}=m;if(f)f.elementaryStreams[m.type]={startPTS:_,endPTS:D,startDTS:M,endDTS:$};else if(m.firstKeyFrame&&m.independent&&o.id===1&&!w&&(this.couldBacktrack=!0),m.dropped&&m.independent){const O=this.getMainFwdBufferInfo(),k=(O?O.end:this.getLoadPosition())+this.config.maxBufferHole,G=m.firstKeyFramePTS?m.firstKeyFramePTS:_;if(!R&&k<G-this.config.maxBufferHole&&!w){this.backtrack(u);return}else w&&(u.gap=!0);u.setElementaryStreamInfo(m.type,u.start,D,u.start,$,!0)}else R&&_-(E.appliedTimelineOffset||0)>lu&&(u.gap=!0);u.setElementaryStreamInfo(m.type,_,D,M,$),this.backtrackFragment&&(this.backtrackFragment=u),this.bufferFragmentData(m,u,f,o,R||w)}else if(R||w)u.gap=!0;else{this.backtrack(u);return}}if(S){const{startPTS:b,endPTS:R,startDTS:w,endDTS:_}=S;f&&(f.elementaryStreams[et.AUDIO]={startPTS:b,endPTS:R,startDTS:w,endDTS:_}),u.setElementaryStreamInfo(et.AUDIO,b,R,w,_),this.bufferFragmentData(S,u,f,o)}if(E&&y!=null&&y.samples.length){const b={id:t,frag:u,details:E,samples:y.samples};n.trigger(C.FRAG_PARSING_METADATA,b)}if(E&&g){const b={id:t,frag:u,details:E,samples:g.samples};n.trigger(C.FRAG_PARSING_USERDATA,b)}}logMuxedErr(e){this.warn(`${gt(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,r){if(this.state!==re.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:o,video:l,audiovideo:u}=t;if(o){const d=e.audioCodec;let m=tu(o.codec,d);m==="mp4a"&&(m="mp4a.40.5");const g=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){m&&(m.indexOf("mp4a.40.5")!==-1?m="mp4a.40.2":m="mp4a.40.5");const y=o.metadata;y&&"channelCount"in y&&(y.channelCount||1)!==1&&g.indexOf("firefox")===-1&&(m="mp4a.40.5")}m&&m.indexOf("mp4a.40.5")!==-1&&g.indexOf("android")!==-1&&o.container!=="audio/mpeg"&&(m="mp4a.40.2",this.log(`Android: force audio codec to ${m}`)),d&&d!==m&&this.log(`Swapping manifest audio codec "${d}" for "${m}"`),o.levelCodec=m,o.id=ge.MAIN,this.log(`Init audio buffer, container:${o.container}, codecs[selected/level/parsed]=[${m||""}/${d||""}/${o.codec}]`),delete t.audiovideo}if(l){l.levelCodec=e.videoCodec,l.id=ge.MAIN;const d=l.codec;if(d?.length===4)switch(d){case"hvc1":case"hev1":l.codec="hvc1.1.6.L120.90";break;case"av01":l.codec="av01.0.04M.08";break;case"avc1":l.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${l.container}, codecs[level/parsed]=[${e.videoCodec||""}/${d}]${l.codec!==d?" parsed-corrected="+l.codec:""}${l.supplemental?" supplemental="+l.supplemental:""}`),delete t.audiovideo}u&&(this.log(`Init audiovideo buffer, container:${u.container}, codecs[level/parsed]=[${e.codecs}/${u.codec}]`),delete t.video,delete t.audio);const f=Object.keys(t);if(f.length){if(this.hls.trigger(C.BUFFER_CODECS,t),!this.hls)return;f.forEach(d=>{const g=t[d].initSegment;g!=null&&g.byteLength&&this.hls.trigger(C.BUFFER_APPENDING,{type:d,data:g,frag:n,part:null,chunkMeta:r,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ge.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=e?.[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=re.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Ae.isBuffered(e,n)?t=this.getAppendedFrag(n):Ae.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,o=t.level;(!r||t.sn!==r.sn||r.level!==o)&&(this.fragPlaying=t,this.hls.trigger(C.FRAG_CHANGED,{frag:t}),(!r||r.level!==o)&&this.hls.trigger(C.LEVEL_SWITCHED,{level:o}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return me(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(me(t)){const n=this.getLevelDetails(),r=this.currentFrag||(n?sr(null,n.fragments,t):null);if(r){const o=r.programDateTime;if(o!==null){const l=o+(t-r.start)*1e3;return new Date(l)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class I$ extends Pn{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyIdToKeyInfo){const r=this.keyIdToKeyInfo[n].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=X.KEY_LOAD_ERROR,n,r,o){return new Bs({type:Ee.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:o,error:n,networkDetails:r})}loadClear(e,t,n){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let r=0,o=t.length;r<o;r++){const l=t[r];if(e.cc<=l.cc&&(!gt(e)||!gt(l)||e.sn<l.sn)||!n&&r==o-1)return this.emeController.selectKeySystemFormat(l).then(u=>{if(!this.emeController)return;l.setKeyFormat(u);const f=su(u);if(f)return this.emeController.getKeySystemAccess([f])})}if(this.config.requireKeySystemAccessOnStart){const r=Do(this.config);if(r.length)return this.emeController.getKeySystemAccess(r)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const o=e.decryptdata;if(!o){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,X.KEY_LOAD_ERROR,d))}const l=o.uri;if(!l)return Promise.reject(this.createKeyLoadError(e,X.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${l}"`)));const u=am(o);let f=this.keyIdToKeyInfo[u];if((n=f)!=null&&n.decryptdata.key)return o.key=f.decryptdata.key,Promise.resolve({frag:e,keyInfo:f});if(this.emeController&&(r=f)!=null&&r.keyLoadPromise)switch(this.emeController.getKeyStatus(f.decryptdata)){case"usable":case"usable-in-future":return f.keyLoadPromise.then(m=>{const{keyInfo:g}=m;return o.key=g.decryptdata.key,{frag:e,keyInfo:g}})}switch(this.log(`${this.keyIdToKeyInfo[u]?"Rel":"L"}oading${o.keyId?" keyId: "+Ft(o.keyId):""} URI: ${o.uri} from ${e.type} ${e.level}`),f=this.keyIdToKeyInfo[u]={decryptdata:o,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},o.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return o.keyFormat==="identity"?this.loadKeyHTTP(f,e):this.loadKeyEME(f,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(f,e);default:return Promise.reject(this.createKeyLoadError(e,X.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${o.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var r;if(!e.decryptdata.keyId&&(r=t.initSegment)!=null&&r.data){const l=W2(t.initSegment.data);if(l.length){let u=l[0];u.some(f=>f!==0)?(this.log(`Using keyId found in init segment ${Ft(u)}`),Ci.setKeyIdForUri(e.decryptdata.uri,u)):(u=Ci.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${Ft(u)}`)),e.decryptdata.keyId=u}}if(!e.decryptdata.keyId&&!gt(t))return Promise.resolve(n);const o=this.emeController.loadKey(n);return(e.keyLoadPromise=o.then(l=>(e.mediaKeySessionContext=l,n))).catch(l=>{throw e.keyLoadPromise=null,"data"in l&&(l.data.frag=t),l})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,r=n.loader,o=new r(n);return t.keyLoader=e.loader=o,e.keyLoadPromise=new Promise((l,u)=>{const f={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},d=n.keyLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(y,x,E,S)=>{const{frag:b,keyInfo:R}=E,w=am(R.decryptdata);if(!b.decryptdata||R!==this.keyIdToKeyInfo[w])return u(this.createKeyLoadError(b,X.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),S));R.decryptdata.key=b.decryptdata.key=new Uint8Array(y.data),b.keyLoader=null,R.loader=null,l({frag:b,keyInfo:R})},onError:(y,x,E,S)=>{this.resetLoader(x),u(this.createKeyLoadError(t,X.KEY_LOAD_ERROR,new Error(`HTTP Error ${y.code} loading key ${y.text}`),E,Ye({url:f.url,data:void 0},y)))},onTimeout:(y,x,E)=>{this.resetLoader(x),u(this.createKeyLoadError(t,X.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),E))},onAbort:(y,x,E)=>{this.resetLoader(x),u(this.createKeyLoadError(t,X.INTERNAL_ABORTED,new Error("key loading aborted"),E))}};o.load(f,m,g)})}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,o=n.loader;t.keyLoader===o&&(t.keyLoader=null,n.loader=null);const l=am(n.decryptdata)||r;delete this.keyIdToKeyInfo[l],o&&o.destroy()}}function am(s){if(s.keyFormat!==Ut.FAIRPLAY){const e=s.keyId;if(e)return Ft(e)}return s.uri}function OS(s){const{type:e}=s;switch(e){case Me.AUDIO_TRACK:return ge.AUDIO;case Me.SUBTITLE_TRACK:return ge.SUBTITLE;default:return ge.MAIN}}function om(s,e){let t=s.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class O${constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(C.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(C.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,r=t.loader,o=n||r,l=new o(t);return this.loaders[e.type]=l,l}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Me.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:r,pathwayId:o,url:l,deliveryDirectives:u,levelInfo:f}=t;this.load({id:n,level:r,pathwayId:o,responseType:"text",type:Me.LEVEL,url:l,deliveryDirectives:u,levelOrTrack:f})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:o,deliveryDirectives:l,track:u}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:Me.AUDIO_TRACK,url:o,deliveryDirectives:l,levelOrTrack:u})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:o,deliveryDirectives:l,track:u}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:Me.SUBTITLE_TRACK,url:o,deliveryDirectives:l,levelOrTrack:u})}onLevelsUpdated(e,t){const n=this.loaders[Me.LEVEL];if(n){const r=n.context;r&&!t.levels.some(o=>o===r.levelOrTrack)&&(n.abort(),delete this.loaders[Me.LEVEL])}}load(e){var t;const n=this.hls.config;let r=this.getInternalLoader(e);if(r){const d=this.hls.logger,m=r.context;if(m&&m.levelOrTrack===e.levelOrTrack&&(m.url===e.url||m.deliveryDirectives&&!e.deliveryDirectives)){m.url===e.url?d.log(`[playlist-loader]: ignore ${e.url} ongoing request`):d.log(`[playlist-loader]: ignore ${e.url} in favor of ${m.url}`);return}d.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let o;if(e.type===Me.MANIFEST?o=n.manifestLoadPolicy.default:o=Ze({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),me((t=e.deliveryDirectives)==null?void 0:t.part)){let d;if(e.type===Me.LEVEL&&e.level!==null?d=this.hls.levels[e.level].details:e.type===Me.AUDIO_TRACK&&e.id!==null?d=this.hls.audioTracks[e.id].details:e.type===Me.SUBTITLE_TRACK&&e.id!==null&&(d=this.hls.subtitleTracks[e.id].details),d){const m=d.partTarget,g=d.targetduration;if(m&&g){const y=Math.max(m*3,g*.8)*1e3;o=Ze({},o,{maxTimeToFirstByteMs:Math.min(y,o.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(y,o.maxTimeToFirstByteMs)})}}}const l=o.errorRetry||o.timeoutRetry||{},u={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},f={onSuccess:(d,m,g,y)=>{const x=this.getInternalLoader(g);this.resetInternalLoader(g.type);const E=d.data;m.parsing.start=performance.now(),ls.isMediaPlaylist(E)||g.type!==Me.MANIFEST?this.handleTrackOrLevelPlaylist(d,m,g,y||null,x):this.handleMasterPlaylist(d,m,g,y)},onError:(d,m,g,y)=>{this.handleNetworkError(m,g,!1,d,y)},onTimeout:(d,m,g)=>{this.handleNetworkError(m,g,!0,void 0,d)}};r.load(e,u,f)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,r){const o=this.hls,l=e.data,u=om(e,n),f=ls.parseMasterPlaylist(l,u);if(f.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,n,f.playlistParsingError,r,t);return}const{contentSteering:d,levels:m,sessionData:g,sessionKeys:y,startTimeOffset:x,variableList:E}=f;this.variableList=E,m.forEach(w=>{const{unknownCodecs:_}=w;if(_){const{preferManagedMediaSource:D}=this.hls.config;let{audioCodec:M,videoCodec:$}=w;for(let O=_.length;O--;){const k=_[O];Ho(k,"audio",D)?(w.audioCodec=M=M?`${M},${k}`:k,Ea.audio[M.substring(0,4)]=2,_.splice(O,1)):Ho(k,"video",D)&&(w.videoCodec=$=$?`${$},${k}`:k,Ea.video[$.substring(0,4)]=2,_.splice(O,1))}}});const{AUDIO:S=[],SUBTITLES:b,"CLOSED-CAPTIONS":R}=ls.parseMasterPlaylistMedia(l,u,f);S.length&&!S.some(_=>!_.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),S.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ot({}),bitrate:0,url:""})),o.trigger(C.MANIFEST_LOADED,{levels:m,audioTracks:S,subtitles:b,captions:R,contentSteering:d,url:u,stats:t,networkDetails:r,sessionData:g,sessionKeys:y,startTimeOffset:x,variableList:E})}handleTrackOrLevelPlaylist(e,t,n,r,o){const l=this.hls,{id:u,level:f,type:d}=n,m=om(e,n),g=me(f)?f:me(u)?u:0,y=OS(n),x=ls.parseLevelPlaylist(e.data,m,g,y,0,this.variableList);if(d===Me.MANIFEST){const E={attrs:new ot({}),bitrate:0,details:x,name:"",url:m};x.requestScheduled=t.loading.start+_R(x,0),l.trigger(C.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:m,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=x,this.handlePlaylistLoaded(x,e,t,n,r,o)}handleManifestParsingError(e,t,n,r,o){this.hls.trigger(C.ERROR,{type:Ee.NETWORK_ERROR,details:X.MANIFEST_PARSING_ERROR,fatal:t.type===Me.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:o})}handleNetworkError(e,t,n=!1,r,o){let l=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===Me.LEVEL?l+=`: ${e.level} id: ${e.id}`:(e.type===Me.AUDIO_TRACK||e.type===Me.SUBTITLE_TRACK)&&(l+=` id: ${e.id} group-id: "${e.groupId}"`);const u=new Error(l);this.hls.logger.warn(`[playlist-loader]: ${l}`);let f=X.UNKNOWN,d=!1;const m=this.getInternalLoader(e);switch(e.type){case Me.MANIFEST:f=n?X.MANIFEST_LOAD_TIMEOUT:X.MANIFEST_LOAD_ERROR,d=!0;break;case Me.LEVEL:f=n?X.LEVEL_LOAD_TIMEOUT:X.LEVEL_LOAD_ERROR,d=!1;break;case Me.AUDIO_TRACK:f=n?X.AUDIO_TRACK_LOAD_TIMEOUT:X.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case Me.SUBTITLE_TRACK:f=n?X.SUBTITLE_TRACK_LOAD_TIMEOUT:X.SUBTITLE_LOAD_ERROR,d=!1;break}m&&this.resetInternalLoader(e.type);const g={type:Ee.NETWORK_ERROR,details:f,fatal:d,url:e.url,loader:m,context:e,error:u,networkDetails:t,stats:o};if(r){const y=t?.url||e.url;g.response=Ye({url:y,data:void 0},r)}this.hls.trigger(C.ERROR,g)}handlePlaylistLoaded(e,t,n,r,o,l){const u=this.hls,{type:f,level:d,levelOrTrack:m,id:g,groupId:y,deliveryDirectives:x}=r,E=om(t,r),S=OS(r);let b=typeof r.level=="number"&&S===ge.MAIN?d:void 0;const R=e.playlistParsingError;if(R){if(this.hls.logger.warn(`${R} ${e.url}`),!u.config.ignorePlaylistParsingErrors){u.trigger(C.ERROR,{type:Ee.NETWORK_ERROR,details:X.LEVEL_PARSING_ERROR,fatal:!1,url:E,error:R,reason:R.message,response:t,context:r,level:b,parent:S,networkDetails:o,stats:n});return}e.playlistParsingError=null}if(!e.fragments.length){const w=e.playlistParsingError=new Error("No Segments found in Playlist");u.trigger(C.ERROR,{type:Ee.NETWORK_ERROR,details:X.LEVEL_EMPTY_ERROR,fatal:!1,url:E,error:w,reason:w.message,response:t,context:r,level:b,parent:S,networkDetails:o,stats:n});return}switch(e.live&&l&&(l.getCacheAge&&(e.ageHeader=l.getCacheAge()||0),(!l.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),f){case Me.MANIFEST:case Me.LEVEL:if(b){if(!m)b=0;else if(m!==u.levels[b]){const w=u.levels.indexOf(m);w>-1&&(b=w)}}u.trigger(C.LEVEL_LOADED,{details:e,levelInfo:m||u.levels[0],level:b||0,id:g||0,stats:n,networkDetails:o,deliveryDirectives:x,withoutMultiVariant:f===Me.MANIFEST});break;case Me.AUDIO_TRACK:u.trigger(C.AUDIO_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:y||"",stats:n,networkDetails:o,deliveryDirectives:x});break;case Me.SUBTITLE_TRACK:u.trigger(C.SUBTITLE_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:y||"",stats:n,networkDetails:o,deliveryDirectives:x});break}}}class sn{static get version(){return zo}static isMSESupported(){return C1()}static isSupported(){return C$()}static getMediaSource(){return Di()}static get Events(){return C}static get MetadataSchema(){return xn}static get ErrorTypes(){return Ee}static get ErrorDetails(){return X}static get DefaultConfig(){return sn.defaultConfig?sn.defaultConfig:g$}static set DefaultConfig(e){sn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new qg,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=U2(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=y$(sn.DefaultConfig,e,t);this.userConfig=e,n.progressive&&v$(n,t);const{abrController:r,bufferController:o,capLevelController:l,errorController:u,fpsController:f}=n,d=new u(this),m=this.abrController=new r(this),g=new MF(this),y=n.interstitialsController,x=y?this.interstitialsController=new y(this,sn):null,E=this.bufferController=new o(this,g),S=this.capLevelController=new l(this),b=new f(this),R=new O$(this),w=n.contentSteeringController,_=w?new w(this):null,D=this.levelController=new L$(this,_),M=new A$(this),$=new I$(this.config,this.logger),O=this.streamController=new D$(this,g,$),k=this.gapController=new T$(this,g);S.setStreamController(O),b.setStreamController(O);const G=[R,D,O];x&&G.splice(1,0,x),_&&G.splice(1,0,_),this.networkControllers=G;const B=[m,E,k,S,b,M,g];this.audioTrackController=this.createController(n.audioTrackController,G);const K=n.audioStreamController;K&&G.push(this.audioStreamController=new K(this,g,$)),this.subtitleTrackController=this.createController(n.subtitleTrackController,G);const ne=n.subtitleStreamController;ne&&G.push(this.subtititleStreamController=new ne(this,g,$)),this.createController(n.timelineController,B),$.emeController=this.emeController=this.createController(n.emeController,B),this.cmcdController=this.createController(n.cmcdController,B),this.latencyController=this.createController(R$,B),this.coreComponents=B,G.push(d);const ue=d.onErrorOut;typeof ue=="function"&&this.on(C.ERROR,ue,d),this.on(C.MANIFEST_LOADED,R.onManifestLoaded,R)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const r=e===C.ERROR;this.trigger(C.ERROR,{type:Ee.OTHER_ERROR,details:X.INTERNAL_EXCEPTION,fatal:r,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(C.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const o=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(C.ERROR,{type:Ee.OTHER_ERROR,details:X.ATTACH_MEDIA_ERROR,fatal:!0,error:o});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,r=t?e:{media:n};this._media=n,this.trigger(C.MEDIA_ATTACHING,r)}detachMedia(){this.logger.log("detachMedia"),this.trigger(C.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(C.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,r=this._url=Fg.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${r}`),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(C.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),!(!this.started||!this.networkControllers));n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ge.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[ge.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[ge.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=T3()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){yF(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,n)for(let o=r;o--;){const l=e[o].attrs["HDCP-LEVEL"];if(l&&l<=n)return o}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=hR(t);return dR(e,n,navigator.mediaCapabilities)}}sn.defaultConfig=void 0;function _1(s,[e,t]){return Math.min(t,Math.max(e,s))}function oa(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}var M$=rr[" useInsertionEffect ".trim().toString()]||Yt;function N$({prop:s,defaultProp:e,onChange:t=()=>{},caller:n}){const[r,o,l]=k$({defaultProp:e,onChange:t}),u=s!==void 0,f=u?s:r;{const m=A.useRef(s!==void 0);A.useEffect(()=>{const g=m.current;g!==u&&console.warn(`${n} is changing from ${g?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=u},[u,n])}const d=A.useCallback(m=>{if(u){const g=P$(m)?m(s):m;g!==s&&l.current?.(g)}else o(m)},[u,s,o,l]);return[f,d]}function k$({defaultProp:s,onChange:e}){const[t,n]=A.useState(s),r=A.useRef(t),o=A.useRef(e);return M$(()=>{o.current=e},[e]),A.useEffect(()=>{r.current!==t&&(o.current?.(t),r.current=t)},[t,r]),[t,n,o]}function P$(s){return typeof s=="function"}function F$(s){const e=A.useRef({value:s,previous:s});return A.useMemo(()=>(e.current.value!==s&&(e.current.previous=e.current.value,e.current.value=s),e.current.previous),[s])}var w1=["PageUp","PageDown"],D1=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],I1={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Ca="Slider",[zm,U$,B$]=Ag(Ca),[O1]=hs(Ca,[B$]),[$$,Zu]=O1(Ca),M1=A.forwardRef((s,e)=>{const{name:t,min:n=0,max:r=100,step:o=1,orientation:l="horizontal",disabled:u=!1,minStepsBetweenThumbs:f=0,defaultValue:d=[n],value:m,onValueChange:g=()=>{},onValueCommit:y=()=>{},inverted:x=!1,form:E,...S}=s,b=A.useRef(new Set),R=A.useRef(0),_=l==="horizontal"?j$:G$,[D=[],M]=N$({prop:m,defaultProp:d,onChange:K=>{[...b.current][R.current]?.focus(),g(K)}}),$=A.useRef(D);function O(K){const ne=Y$(D,K);B(K,ne)}function k(K){B(K,R.current)}function G(){const K=$.current[R.current];D[R.current]!==K&&y(D)}function B(K,ne,{commit:ue}={commit:!1}){const ee=Q$(o),ae=Z$(Math.round((K-n)/o)*o+n,ee),P=_1(ae,[n,r]);M((F=[])=>{const U=K$(F,P,ne);if(W$(U,f*o)){R.current=U.indexOf(P);const Y=String(U)!==String(F);return Y&&ue&&y(U),Y?U:F}else return F})}return T.jsx($$,{scope:s.__scopeSlider,name:t,disabled:u,min:n,max:r,valueIndexToChangeRef:R,thumbs:b.current,values:D,orientation:l,form:E,children:T.jsx(zm.Provider,{scope:s.__scopeSlider,children:T.jsx(zm.Slot,{scope:s.__scopeSlider,children:T.jsx(_,{"aria-disabled":u,"data-disabled":u?"":void 0,...S,ref:e,onPointerDown:oa(S.onPointerDown,()=>{u||($.current=D)}),min:n,max:r,inverted:x,onSlideStart:u?void 0:O,onSlideMove:u?void 0:k,onSlideEnd:u?void 0:G,onHomeKeyDown:()=>!u&&B(n,0,{commit:!0}),onEndKeyDown:()=>!u&&B(r,D.length-1,{commit:!0}),onStepKeyDown:({event:K,direction:ne})=>{if(!u){const ae=w1.includes(K.key)||K.shiftKey&&D1.includes(K.key)?10:1,P=R.current,F=D[P],U=o*ae*ne;B(F+U,P,{commit:!0})}}})})})})});M1.displayName=Ca;var[N1,k1]=O1(Ca,{startEdge:"left",endEdge:"right",size:"width",direction:1}),j$=A.forwardRef((s,e)=>{const{min:t,max:n,dir:r,inverted:o,onSlideStart:l,onSlideMove:u,onSlideEnd:f,onStepKeyDown:d,...m}=s,[g,y]=A.useState(null),x=He(e,_=>y(_)),E=A.useRef(void 0),S=Rg(r),b=S==="ltr",R=b&&!o||!b&&o;function w(_){const D=E.current||g.getBoundingClientRect(),M=[0,D.width],O=op(M,R?[t,n]:[n,t]);return E.current=D,O(_-D.left)}return T.jsx(N1,{scope:s.__scopeSlider,startEdge:R?"left":"right",endEdge:R?"right":"left",direction:R?1:-1,size:"width",children:T.jsx(P1,{dir:S,"data-orientation":"horizontal",...m,ref:x,style:{...m.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:_=>{const D=w(_.clientX);l?.(D)},onSlideMove:_=>{const D=w(_.clientX);u?.(D)},onSlideEnd:()=>{E.current=void 0,f?.()},onStepKeyDown:_=>{const M=I1[R?"from-left":"from-right"].includes(_.key);d?.({event:_,direction:M?-1:1})}})})}),G$=A.forwardRef((s,e)=>{const{min:t,max:n,inverted:r,onSlideStart:o,onSlideMove:l,onSlideEnd:u,onStepKeyDown:f,...d}=s,m=A.useRef(null),g=He(e,m),y=A.useRef(void 0),x=!r;function E(S){const b=y.current||m.current.getBoundingClientRect(),R=[0,b.height],_=op(R,x?[n,t]:[t,n]);return y.current=b,_(S-b.top)}return T.jsx(N1,{scope:s.__scopeSlider,startEdge:x?"bottom":"top",endEdge:x?"top":"bottom",size:"height",direction:x?1:-1,children:T.jsx(P1,{"data-orientation":"vertical",...d,ref:g,style:{...d.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:S=>{const b=E(S.clientY);o?.(b)},onSlideMove:S=>{const b=E(S.clientY);l?.(b)},onSlideEnd:()=>{y.current=void 0,u?.()},onStepKeyDown:S=>{const R=I1[x?"from-bottom":"from-top"].includes(S.key);f?.({event:S,direction:R?-1:1})}})})}),P1=A.forwardRef((s,e)=>{const{__scopeSlider:t,onSlideStart:n,onSlideMove:r,onSlideEnd:o,onHomeKeyDown:l,onEndKeyDown:u,onStepKeyDown:f,...d}=s,m=Zu(Ca,t);return T.jsx(nt.span,{...d,ref:e,onKeyDown:oa(s.onKeyDown,g=>{g.key==="Home"?(l(g),g.preventDefault()):g.key==="End"?(u(g),g.preventDefault()):w1.concat(D1).includes(g.key)&&(f(g),g.preventDefault())}),onPointerDown:oa(s.onPointerDown,g=>{const y=g.target;y.setPointerCapture(g.pointerId),g.preventDefault(),m.thumbs.has(y)?y.focus():n(g)}),onPointerMove:oa(s.onPointerMove,g=>{g.target.hasPointerCapture(g.pointerId)&&r(g)}),onPointerUp:oa(s.onPointerUp,g=>{const y=g.target;y.hasPointerCapture(g.pointerId)&&(y.releasePointerCapture(g.pointerId),o(g))})})}),F1="SliderTrack",U1=A.forwardRef((s,e)=>{const{__scopeSlider:t,...n}=s,r=Zu(F1,t);return T.jsx(nt.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...n,ref:e})});U1.displayName=F1;var Ym="SliderRange",B1=A.forwardRef((s,e)=>{const{__scopeSlider:t,...n}=s,r=Zu(Ym,t),o=k1(Ym,t),l=A.useRef(null),u=He(e,l),f=r.values.length,d=r.values.map(y=>G1(y,r.min,r.max)),m=f>1?Math.min(...d):0,g=100-Math.max(...d);return T.jsx(nt.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...n,ref:u,style:{...s.style,[o.startEdge]:m+"%",[o.endEdge]:g+"%"}})});B1.displayName=Ym;var qm="SliderThumb",$1=A.forwardRef((s,e)=>{const t=U$(s.__scopeSlider),[n,r]=A.useState(null),o=He(e,u=>r(u)),l=A.useMemo(()=>n?t().findIndex(u=>u.ref.current===n):-1,[t,n]);return T.jsx(H$,{...s,ref:o,index:l})}),H$=A.forwardRef((s,e)=>{const{__scopeSlider:t,index:n,name:r,...o}=s,l=Zu(qm,t),u=k1(qm,t),[f,d]=A.useState(null),m=He(e,w=>d(w)),g=f?l.form||!!f.closest("form"):!0,y=db(f),x=l.values[n],E=x===void 0?0:G1(x,l.min,l.max),S=z$(n,l.values.length),b=y?.[u.size],R=b?q$(b,E,u.direction):0;return A.useEffect(()=>{if(f)return l.thumbs.add(f),()=>{l.thumbs.delete(f)}},[f,l.thumbs]),T.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[u.startEdge]:`calc(${E}% + ${R}px)`},children:[T.jsx(zm.ItemSlot,{scope:s.__scopeSlider,children:T.jsx(nt.span,{role:"slider","aria-label":s["aria-label"]||S,"aria-valuemin":l.min,"aria-valuenow":x,"aria-valuemax":l.max,"aria-orientation":l.orientation,"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,tabIndex:l.disabled?void 0:0,...o,ref:m,style:x===void 0?{display:"none"}:s.style,onFocus:oa(s.onFocus,()=>{l.valueIndexToChangeRef.current=n})})}),g&&T.jsx(j1,{name:r??(l.name?l.name+(l.values.length>1?"[]":""):void 0),form:l.form,value:x},n)]})});$1.displayName=qm;var V$="RadioBubbleInput",j1=A.forwardRef(({__scopeSlider:s,value:e,...t},n)=>{const r=A.useRef(null),o=He(r,n),l=F$(e);return A.useEffect(()=>{const u=r.current;if(!u)return;const f=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(f,"value").set;if(l!==e&&m){const g=new Event("input",{bubbles:!0});m.call(u,e),u.dispatchEvent(g)}},[l,e]),T.jsx(nt.input,{style:{display:"none"},...t,ref:o,defaultValue:e})});j1.displayName=V$;function K$(s=[],e,t){const n=[...s];return n[t]=e,n.sort((r,o)=>r-o)}function G1(s,e,t){const o=100/(t-e)*(s-e);return _1(o,[0,100])}function z$(s,e){return e>2?`Value ${s+1} of ${e}`:e===2?["Minimum","Maximum"][s]:void 0}function Y$(s,e){if(s.length===1)return 0;const t=s.map(r=>Math.abs(r-e)),n=Math.min(...t);return t.indexOf(n)}function q$(s,e,t){const n=s/2,o=op([0,50],[0,n]);return(n-o(e)*t)*t}function X$(s){return s.slice(0,-1).map((e,t)=>s[t+1]-e)}function W$(s,e){if(e>0){const t=X$(s);return Math.min(...t)>=e}return!0}function op(s,e){return t=>{if(s[0]===s[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(s[1]-s[0]);return e[0]+n*(t-s[0])}}function Q$(s){return(String(s).split(".")[1]||"").length}function Z$(s,e){const t=Math.pow(10,e);return Math.round(s*t)/t}var H1=M1,J$=U1,ej=B1,tj=$1;const Xm=A.forwardRef(({className:s,...e},t)=>T.jsxs(H1,{ref:t,className:De("relative flex w-full touch-none select-none items-center",s),...e,children:[T.jsx(J$,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:T.jsx(ej,{className:"absolute h-full bg-primary"})}),T.jsx(tj,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Xm.displayName=H1.displayName;function nj({src:s,poster:e,title:t,backLink:n="/"}){const r=A.useRef(null),o=A.useRef(null),l=A.useRef(null),[u,f]=A.useState(!1),[d,m]=A.useState(0),[g,y]=A.useState([1]),[x,E]=A.useState(!1),[S,b]=A.useState(!1),[R,w]=A.useState(!0),[_,D]=A.useState("-1"),[M,$]=A.useState([{id:"-1",label:"Auto"}]),[O,k]=A.useState("Auto"),G=A.useRef(null);A.useEffect(()=>{const F=r.current;if(!F)return;if(s.endsWith(".m3u8"))if(sn.isSupported()){const le=new sn({enableWorker:!0,lowLatencyMode:!1,backBufferLength:90});l.current=le,le.loadSource(s),le.attachMedia(F),le.on(sn.Events.MANIFEST_PARSED,(N,H)=>{console.log("HLS manifest loaded, found "+H.levels.length+" quality levels");const J=H.levels.map((se,de)=>({id:String(de),label:`${se.height}p (${Math.round(se.bitrate/1e3)} kbps)`}));$([{id:"-1",label:"Auto"},...J])}),le.on(sn.Events.LEVEL_SWITCHED,(N,H)=>{const J=le.levels[H.level];J&&k(le.autoLevelEnabled?`Auto (${J.height}p)`:`${J.height}p`)}),le.on(sn.Events.ERROR,(N,H)=>{if(H.fatal)switch(H.type){case sn.ErrorTypes.NETWORK_ERROR:console.error("Network error, attempting to recover..."),le.startLoad();break;case sn.ErrorTypes.MEDIA_ERROR:console.error("Media error, attempting to recover..."),le.recoverMediaError();break;default:console.error("Fatal error, cannot recover"),le.destroy();break}})}else F.canPlayType("application/vnd.apple.mpegurl")&&(F.src=s);else F.src=s;const Y=()=>{F.duration&&m(F.currentTime/F.duration*100)};return F.addEventListener("timeupdate",Y),F.addEventListener("ended",()=>f(!1)),()=>{F.removeEventListener("timeupdate",Y),F.removeEventListener("ended",()=>f(!1)),l.current&&l.current.destroy()}},[s]);const B=()=>{r.current&&(u?r.current.pause():r.current.play(),f(!u))},K=F=>{if(r.current){const U=F[0]/100*r.current.duration;r.current.currentTime=U,m(F[0])}},ne=()=>{r.current&&(r.current.muted=!x,E(!x))},ue=F=>{r.current&&(r.current.volume=F[0],y(F),E(F[0]===0))},ee=F=>{if(D(F),l.current){const U=parseInt(F);U===-1?l.current.currentLevel=-1:l.current.currentLevel=U}},ae=()=>{document.fullscreenElement?(document.exitFullscreen(),b(!1)):(o.current?.requestFullscreen(),b(!0))},P=()=>{w(!0),G.current&&clearTimeout(G.current),G.current=setTimeout(()=>{u&&w(!1)},3e3)};return T.jsxs("div",{ref:o,className:"relative w-full h-screen bg-black flex items-center justify-center overflow-hidden group",onMouseMove:P,onMouseLeave:()=>u&&w(!1),children:[T.jsx("video",{ref:r,poster:e,className:"w-full h-full object-contain",onClick:B}),T.jsx("div",{className:De("absolute top-0 left-0 p-6 transition-opacity duration-300 z-50",R?"opacity-100":"opacity-0"),children:T.jsx(Hs,{href:n,children:T.jsx(mt,{variant:"ghost",className:"text-white hover:bg-white/20 rounded-full h-12 w-12 p-0",children:T.jsx(BD,{className:"h-6 w-6"})})})}),!u&&T.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40 z-10 pointer-events-none",children:T.jsx("div",{className:"p-6 rounded-full bg-primary/90 backdrop-blur-sm animate-in zoom-in duration-300",children:T.jsx(ya,{className:"h-12 w-12 text-white fill-white ml-1"})})}),T.jsxs("div",{className:De("absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/90 via-black/60 to-transparent px-6 pb-6 pt-20 transition-opacity duration-300 z-40",R?"opacity-100":"opacity-0"),children:[T.jsx("div",{className:"mb-4 group/slider",children:T.jsx(Xm,{value:[d],max:100,step:.1,onValueChange:K,className:"cursor-pointer"})}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-4",children:[T.jsx(mt,{onClick:B,variant:"ghost",size:"icon",className:"text-white hover:text-primary hover:bg-white/10",children:u?T.jsx(xI,{className:"h-6 w-6 fill-white"}):T.jsx(ya,{className:"h-6 w-6 fill-white"})}),T.jsxs("div",{className:"flex items-center gap-2 group/volume",children:[T.jsx(mt,{onClick:ne,variant:"ghost",size:"icon",className:"text-white hover:text-primary hover:bg-white/10",children:x?T.jsx(UI,{className:"h-6 w-6"}):T.jsx(PI,{className:"h-6 w-6"})}),T.jsx("div",{className:"w-0 overflow-hidden group-hover/volume:w-24 transition-all duration-300",children:T.jsx(Xm,{value:x?[0]:g,max:1,step:.01,onValueChange:ue,className:"w-24"})})]}),T.jsx("h2",{className:"text-white font-medium ml-2 hidden md:block",children:t})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsxs(qA,{modal:!1,children:[T.jsx(XA,{asChild:!0,children:T.jsx(mt,{variant:"ghost",size:"icon",className:"text-white hover:text-primary hover:bg-white/10",children:T.jsx(MT,{className:"h-6 w-6"})})}),T.jsxs(kg,{align:"end",container:o.current,className:"bg-black/90 border-white/10 text-white backdrop-blur-xl z-[9999]",children:[T.jsx(Pg,{children:"Quality (Adaptive Bitrate)"}),T.jsx(fa,{className:"bg-white/10"}),T.jsx(R2,{value:_,onValueChange:ee,children:M.map(F=>T.jsx(WA,{value:F.id,className:"focus:bg-white/20 focus:text-white cursor-pointer",children:F.label},F.id))}),T.jsx(fa,{className:"bg-white/10"}),T.jsxs("div",{className:"px-2 py-1.5 text-xs text-gray-400",children:["Current: ",O]})]})]}),T.jsx(mt,{onClick:ae,variant:"ghost",size:"icon",className:"text-white hover:text-primary hover:bg-white/10",children:S?T.jsx(yI,{className:"h-6 w-6"}):T.jsx(gI,{className:"h-6 w-6"})})]})]})]})]})}function sj(){const[s,e]=ow("/watch/:id"),{movies:t}=bg();if(!s)return T.jsx(bm,{});const n=t.find(r=>r.id===e.id);return n?T.jsx("div",{className:"w-full h-screen bg-black",children:T.jsx(nj,{src:n.videoUrl,poster:n.heroImage,title:n.title,backLink:"/"})}):T.jsx(bm,{})}const ij="/assets/image_1763651111406-Bng3ps3D.png";function Wo({children:s}){const[e]=ig(),t=[{name:"Dashboard",href:"/admin",icon:IT},{name:"Media Library",href:"/admin/media",icon:DT},{name:"AWS Settings",href:"/admin/settings",icon:MT}];return T.jsxs("div",{className:"min-h-screen bg-background flex",children:[T.jsxs("aside",{className:"w-64 bg-card border-r border-border hidden md:flex flex-col fixed h-full",children:[T.jsxs("div",{className:"p-6 flex items-center justify-center border-b border-border",children:[T.jsx("img",{src:ij,alt:"Nubinix Admin",className:"h-8 object-contain"}),T.jsx("span",{className:"ml-2 text-xs font-bold text-primary uppercase tracking-widest",children:"Admin"})]}),T.jsx("nav",{className:"flex-1 p-4 space-y-2",children:t.map(n=>T.jsxs(Hs,{href:n.href,className:De("flex items-center gap-3 px-4 py-3 rounded-md text-sm font-medium transition-colors",e===n.href?"bg-primary/10 text-primary":"text-gray-400 hover:bg-white/5 hover:text-white"),children:[T.jsx(n.icon,{className:"w-5 h-5"}),n.name]},n.href))}),T.jsxs("div",{className:"p-4 border-t border-border space-y-2",children:[T.jsxs(Hs,{href:"/",className:"flex items-center gap-3 px-4 py-3 rounded-md text-sm font-medium text-gray-400 hover:bg-white/5 hover:text-white",children:[T.jsx(oI,{className:"w-5 h-5"}),"Back to App"]}),T.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-md text-sm font-medium text-red-400 hover:bg-red-500/10 transition-colors",children:[T.jsx(hI,{className:"w-5 h-5"}),"Sign Out"]})]})]}),T.jsx("main",{className:"flex-1 md:ml-64 p-8 overflow-y-auto",children:s})]})}function rj(){const{movies:s}=bg(),e=[{title:"Total Videos",value:s.length,icon:DT,color:"text-blue-500"},{title:"Storage Used",value:"45.2 GB",icon:rI,color:"text-purple-500"},{title:"Active Streams",value:"128",icon:FD,color:"text-green-500"},{title:"Total Users",value:"1,204",icon:NI,color:"text-orange-500"}];return T.jsx(Wo,{children:T.jsxs("div",{className:"space-y-8",children:[T.jsxs("div",{children:[T.jsx("h1",{className:"text-3xl font-bold text-white",children:"Dashboard"}),T.jsx("p",{className:"text-gray-400 mt-2",children:"Overview of your streaming platform."})]}),T.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:e.map(t=>T.jsxs(js,{className:"bg-card border-white/10",children:[T.jsxs(Ri,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[T.jsx(Li,{className:"text-sm font-medium text-gray-200",children:t.title}),T.jsx(t.icon,{className:`h-4 w-4 ${t.color}`})]}),T.jsx(Gs,{children:T.jsx("div",{className:"text-2xl font-bold text-white",children:t.value})})]},t.title))}),T.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[T.jsxs(js,{className:"bg-card border-white/10",children:[T.jsx(Ri,{children:T.jsx(Li,{className:"text-white",children:"Recent Activity"})}),T.jsx(Gs,{children:T.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>T.jsxs("div",{className:"flex items-center justify-between border-b border-white/5 pb-2 last:border-0",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-sm font-medium text-white",children:"New video uploaded"}),T.jsx("p",{className:"text-xs text-gray-500",children:"2 hours ago"})]}),T.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-1 rounded",children:"Success"})]},t))})})]}),T.jsxs(js,{className:"bg-card border-white/10",children:[T.jsx(Ri,{children:T.jsx(Li,{className:"text-white",children:"System Status"})}),T.jsxs(Gs,{className:"space-y-4",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("span",{className:"text-sm text-gray-300",children:"S3 Bucket Connection"}),T.jsxs("span",{className:"flex items-center gap-2 text-xs text-green-400",children:[T.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),"Connected"]})]}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("span",{className:"text-sm text-gray-300",children:"MediaConvert Job Queue"}),T.jsxs("span",{className:"flex items-center gap-2 text-xs text-green-400",children:[T.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),"Idle"]})]}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("span",{className:"text-sm text-gray-300",children:"CloudFront Distribution"}),T.jsxs("span",{className:"flex items-center gap-2 text-xs text-green-400",children:[T.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),"Active"]})]})]})]})]})]})})}const Io=A.forwardRef(({className:s,type:e,...t},n)=>T.jsx("input",{type:e,className:De("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...t}));Io.displayName="Input";var aj=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],oj=aj.reduce((s,e)=>{const t=Pb(`Primitive.${e}`),n=A.forwardRef((r,o)=>{const{asChild:l,...u}=r,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),T.jsx(f,{...u,ref:o})});return n.displayName=`Primitive.${e}`,{...s,[e]:n}},{}),lj="Label",V1=A.forwardRef((s,e)=>T.jsx(oj.label,{...s,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(s.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));V1.displayName=lj;var K1=V1;const cj=Pu("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ra=A.forwardRef(({className:s,...e},t)=>T.jsx(K1,{ref:t,className:De(cj(),s),...e}));ra.displayName=K1.displayName;const z1=A.forwardRef(({className:s,...e},t)=>T.jsx("textarea",{className:De("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...e}));z1.displayName="Textarea";function Po(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}var uj=rr[" useInsertionEffect ".trim().toString()]||Yt;function dj({prop:s,defaultProp:e,onChange:t=()=>{},caller:n}){const[r,o,l]=fj({defaultProp:e,onChange:t}),u=s!==void 0,f=u?s:r;{const m=A.useRef(s!==void 0);A.useEffect(()=>{const g=m.current;g!==u&&console.warn(`${n} is changing from ${g?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=u},[u,n])}const d=A.useCallback(m=>{if(u){const g=hj(m)?m(s):m;g!==s&&l.current?.(g)}else o(m)},[u,s,o,l]);return[f,d]}function fj({defaultProp:s,onChange:e}){const[t,n]=A.useState(s),r=A.useRef(t),o=A.useRef(e);return uj(()=>{o.current=e},[e]),A.useEffect(()=>{r.current!==t&&(o.current?.(t),r.current=t)},[t,r]),[t,n,o]}function hj(s){return typeof s=="function"}function mj(s){const e=gj(s),t=A.forwardRef((n,r)=>{const{children:o,...l}=n,u=A.Children.toArray(o),f=u.find(yj);if(f){const d=f.props.children,m=u.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}function gj(s){const e=A.forwardRef((t,n)=>{const{children:r,...o}=t;if(A.isValidElement(r)){const l=xj(r),u=vj(o,r.props);return r.type!==A.Fragment&&(u.ref=n?zs(n,l):l),A.cloneElement(r,u)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var pj=Symbol("radix.slottable");function yj(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===pj}function vj(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function xj(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var Ju="Dialog",[Y1]=hs(Ju),[Ej,qn]=Y1(Ju),q1=s=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:r,onOpenChange:o,modal:l=!0}=s,u=A.useRef(null),f=A.useRef(null),[d,m]=dj({prop:n,defaultProp:r??!1,onChange:o,caller:Ju});return T.jsx(Ej,{scope:e,triggerRef:u,contentRef:f,contentId:la(),titleId:la(),descriptionId:la(),open:d,onOpenChange:m,onOpenToggle:A.useCallback(()=>m(g=>!g),[m]),modal:l,children:t})};q1.displayName=Ju;var X1="DialogTrigger",W1=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=qn(X1,t),o=He(e,r.triggerRef);return T.jsx(nt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":up(r.open),...n,ref:o,onClick:Po(s.onClick,r.onOpenToggle)})});W1.displayName=X1;var lp="DialogPortal",[Sj,Q1]=Y1(lp,{forceMount:void 0}),Z1=s=>{const{__scopeDialog:e,forceMount:t,children:n,container:r}=s,o=qn(lp,e);return T.jsx(Sj,{scope:e,forceMount:t,children:A.Children.map(n,l=>T.jsx(ps,{present:t||o.open,children:T.jsx(Hu,{asChild:!0,container:r,children:l})}))})};Z1.displayName=lp;var wu="DialogOverlay",J1=A.forwardRef((s,e)=>{const t=Q1(wu,s.__scopeDialog),{forceMount:n=t.forceMount,...r}=s,o=qn(wu,s.__scopeDialog);return o.modal?T.jsx(ps,{present:n||o.open,children:T.jsx(bj,{...r,ref:e})}):null});J1.displayName=wu;var Tj=mj("DialogOverlay.RemoveScroll"),bj=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=qn(wu,t);return T.jsx(Cg,{as:Tj,allowPinchZoom:!0,shards:[r.contentRef],children:T.jsx(nt.div,{"data-state":up(r.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),ir="DialogContent",eL=A.forwardRef((s,e)=>{const t=Q1(ir,s.__scopeDialog),{forceMount:n=t.forceMount,...r}=s,o=qn(ir,s.__scopeDialog);return T.jsx(ps,{present:n||o.open,children:o.modal?T.jsx(Aj,{...r,ref:e}):T.jsx(Rj,{...r,ref:e})})});eL.displayName=ir;var Aj=A.forwardRef((s,e)=>{const t=qn(ir,s.__scopeDialog),n=A.useRef(null),r=He(e,t.contentRef,n);return A.useEffect(()=>{const o=n.current;if(o)return zb(o)},[]),T.jsx(tL,{...s,ref:r,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Po(s.onCloseAutoFocus,o=>{o.preventDefault(),t.triggerRef.current?.focus()}),onPointerDownOutside:Po(s.onPointerDownOutside,o=>{const l=o.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0;(l.button===2||u)&&o.preventDefault()}),onFocusOutside:Po(s.onFocusOutside,o=>o.preventDefault())})}),Rj=A.forwardRef((s,e)=>{const t=qn(ir,s.__scopeDialog),n=A.useRef(!1),r=A.useRef(!1);return T.jsx(tL,{...s,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{s.onCloseAutoFocus?.(o),o.defaultPrevented||(n.current||t.triggerRef.current?.focus(),o.preventDefault()),n.current=!1,r.current=!1},onInteractOutside:o=>{s.onInteractOutside?.(o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const l=o.target;t.triggerRef.current?.contains(l)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&r.current&&o.preventDefault()}})}),tL=A.forwardRef((s,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:r,onCloseAutoFocus:o,...l}=s,u=qn(ir,t),f=A.useRef(null),d=He(e,f);return Fb(),T.jsxs(T.Fragment,{children:[T.jsx(Lg,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:r,onUnmountAutoFocus:o,children:T.jsx(Fu,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":up(u.open),...l,ref:d,onDismiss:()=>u.onOpenChange(!1)})}),T.jsxs(T.Fragment,{children:[T.jsx(Lj,{titleId:u.titleId}),T.jsx(_j,{contentRef:f,descriptionId:u.descriptionId})]})]})}),cp="DialogTitle",nL=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=qn(cp,t);return T.jsx(nt.h2,{id:r.titleId,...n,ref:e})});nL.displayName=cp;var sL="DialogDescription",iL=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=qn(sL,t);return T.jsx(nt.p,{id:r.descriptionId,...n,ref:e})});iL.displayName=sL;var rL="DialogClose",aL=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=qn(rL,t);return T.jsx(nt.button,{type:"button",...n,ref:e,onClick:Po(s.onClick,()=>r.onOpenChange(!1))})});aL.displayName=rL;function up(s){return s?"open":"closed"}var oL="DialogTitleWarning",[Vj,lL]=Hw(oL,{contentName:ir,titleName:cp,docsSlug:"dialog"}),Lj=({titleId:s})=>{const e=lL(oL),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return A.useEffect(()=>{s&&(document.getElementById(s)||console.error(t))},[t,s]),null},Cj="DialogDescriptionWarning",_j=({contentRef:s,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${lL(Cj).contentName}}.`;return A.useEffect(()=>{const r=s.current?.getAttribute("aria-describedby");e&&r&&(document.getElementById(e)||console.warn(n))},[n,s,e]),null},wj=q1,Dj=W1,Ij=Z1,cL=J1,uL=eL,dL=nL,fL=iL,Oj=aL;const MS=wj,Mj=Dj,Nj=Ij,hL=A.forwardRef(({className:s,...e},t)=>T.jsx(cL,{ref:t,className:De("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...e}));hL.displayName=cL.displayName;const Wm=A.forwardRef(({className:s,children:e,...t},n)=>T.jsxs(Nj,{children:[T.jsx(hL,{}),T.jsxs(uL,{ref:n,className:De("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t,children:[e,T.jsxs(Oj,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[T.jsx(NT,{className:"h-4 w-4"}),T.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Wm.displayName=uL.displayName;const Qm=({className:s,...e})=>T.jsx("div",{className:De("flex flex-col space-y-1.5 text-center sm:text-left",s),...e});Qm.displayName="DialogHeader";const Zm=({className:s,...e})=>T.jsx("div",{className:De("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...e});Zm.displayName="DialogFooter";const Jm=A.forwardRef(({className:s,...e},t)=>T.jsx(dL,{ref:t,className:De("text-lg font-semibold leading-none tracking-tight",s),...e}));Jm.displayName=dL.displayName;const eg=A.forwardRef(({className:s,...e},t)=>T.jsx(fL,{ref:t,className:De("text-sm text-muted-foreground",s),...e}));eg.displayName=fL.displayName;const kj=Pu("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:"text-foreground border [border-color:var(--badge-outline)]"}},defaultVariants:{variant:"default"}});function tg({className:s,variant:e,...t}){return T.jsx("div",{className:De(kj({variant:e}),s),...t})}function Pj(){const{toast:s}=QS(),[e,t]=A.useState(!1),[n,r]=A.useState([]),[o,l]=A.useState(!0),[u,f]=A.useState(!1),[d,m]=A.useState(0),[g,y]=A.useState(""),[x,E]=A.useState(""),[S,b]=A.useState(null),[R,w]=A.useState(""),[_,D]=A.useState(null),[M,$]=A.useState("");A.useEffect(()=>{O()},[]);const O=async()=>{try{const F=await fetch("/api/videos");if(F.ok){const U=await F.json();r(U)}}catch(F){console.error("Failed to load videos:",F)}finally{l(!1)}},k=F=>{F.target.files&&F.target.files[0]&&b(F.target.files[0])},G=async()=>{if(!g||!S){s({title:"Validation Error",description:"Title and video file are required.",variant:"destructive"});return}f(!0),m(0);let F=null;try{m(10),console.log("[Upload] Creating video record...");const U=await fetch("/api/videos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:g,description:x||null,s3Key:"temp",thumbnailUrl:R||null,heroImageUrl:R||null,videoUrl:null,hlsUrl:null,duration:"0h 00m",year:new Date().getFullYear(),genre:["Uploaded"],rating:"NR",transcodeStatus:"uploading"})});if(!U.ok){const fe=await U.json().catch(()=>({message:"Unknown error creating video record"}));throw new Error(`Failed to create video record: ${fe.message||U.statusText}`)}F=(await U.json()).id,console.log("[Upload] Video record created:",F),m(20),console.log("[Upload] Requesting presigned URL...");const le=await fetch("/api/upload/presigned-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:S.name,contentType:S.type||"video/mp4",videoId:F})});if(!le.ok){const fe=await le.json().catch(()=>({message:"Unknown error getting presigned URL"}));throw new Error(`Failed to get upload URL: ${fe.message||le.statusText}`)}const{uploadUrl:N,s3Key:H,hlsUrl:J}=await le.json();console.log("[Upload] Presigned URL received, uploading to S3..."),m(30);let se;try{se=await fetch(N,{method:"PUT",body:S,headers:{"Content-Type":S.type||"video/mp4"}})}catch(fe){throw console.error("[Upload] Network error during S3 upload:",fe),new Error(`Network error uploading to S3: ${fe.message}. Check your internet connection and S3 bucket endpoint.`)}if(!se.ok){const fe=await se.text().catch(()=>"");throw console.error("[Upload] S3 upload failed:",{status:se.status,statusText:se.statusText,errorText:fe}),new Error(`S3 upload failed (${se.status}): ${fe||se.statusText}. Check S3 bucket permissions and CORS settings.`)}console.log("[Upload] S3 upload successful"),m(80),console.log("[Upload] Updating video record...");const de=await fetch(`/api/videos/${F}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({s3Key:H,hlsUrl:J,transcodeStatus:"processing"})});if(!de.ok){const fe=await de.json().catch(()=>({message:"Unknown error updating video"}));throw new Error(`Failed to update video record: ${fe.message||de.statusText}`)}m(100),console.log("[Upload] Upload complete!"),s({title:"Upload Successful",description:"Video uploaded to S3. Lambda is now transcoding it to adaptive bitrate HLS. This may take a few minutes."}),t(!1),ae(),O()}catch(U){if(console.error("[Upload] Error details:",{message:U.message,stack:U.stack,error:U}),F)try{await fetch(`/api/videos/${F}`,{method:"DELETE"}),console.log("[Upload] Cleaned up failed video record")}catch(Y){console.error("[Upload] Failed to cleanup video record:",Y)}s({title:"Upload Failed",description:U.message||"An unknown error occurred during upload. Check the browser console for details.",variant:"destructive"})}finally{f(!1),m(0)}},B=async F=>{try{const U=await fetch(`/api/videos/${F}/transcode`,{method:"POST"});if(!U.ok){const Y=await U.json();throw new Error(Y.message)}s({title:"Transcoding Started",description:"Video transcoding job has been initiated. This may take several minutes."}),O()}catch(U){s({title:"Error",description:U.message,variant:"destructive"})}},K=async F=>{try{if(!(await fetch(`/api/videos/${F}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcodeStatus:"completed"})})).ok)throw new Error("Failed to update video status");s({title:"Status Updated",description:"Video marked as ready. It will now appear in your library."}),O()}catch(U){s({title:"Error",description:U.message,variant:"destructive"})}},ne=async()=>{if(!(!_||!M))try{if(!(await fetch(`/api/videos/${_}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({hlsUrl:M})})).ok)throw new Error("Failed to update HLS URL");s({title:"HLS URL Updated",description:"Video URL has been updated successfully."}),D(null),$(""),O()}catch(F){s({title:"Error",description:F.message,variant:"destructive"})}},ue=F=>{D(F.id),$(F.hlsUrl||"")},ee=async F=>{try{if(!(await fetch(`/api/videos/${F}`,{method:"DELETE"})).ok)throw new Error("Failed to delete video");s({title:"Video Deleted",description:"The video has been removed from your library."}),O()}catch(U){s({title:"Error",description:U.message,variant:"destructive"})}},ae=()=>{y(""),E(""),b(null),w("")},P=F=>{const Y={pending:{variant:"secondary",label:"Pending"},processing:{variant:"default",label:"Processing"},completed:{variant:"outline",label:"Ready"},failed:{variant:"destructive",label:"Failed"}}[F]||{variant:"secondary",label:F};return T.jsx(tg,{variant:Y.variant,children:Y.label})};return o?T.jsx(Wo,{children:T.jsx("div",{className:"flex items-center justify-center h-96",children:T.jsx(mm,{className:"w-8 h-8 animate-spin text-primary"})})}):T.jsx(Wo,{children:T.jsxs("div",{className:"space-y-8",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("h1",{className:"text-3xl font-bold text-white",children:"Media Library"}),T.jsx("p",{className:"text-gray-400 mt-2",children:"Upload and manage your video content."})]}),T.jsxs(MS,{open:e,onOpenChange:t,children:[T.jsx(Mj,{asChild:!0,children:T.jsxs(mt,{className:"bg-primary hover:bg-primary/90",children:[T.jsx(OT,{className:"w-4 h-4 mr-2"})," Upload New Video"]})}),T.jsxs(Wm,{className:"bg-card border-white/10 text-white max-w-2xl",children:[T.jsxs(Qm,{children:[T.jsx(Jm,{children:"Upload Video to S3"}),T.jsx(eg,{className:"text-gray-400",children:"Upload a video file directly to your S3 bucket. It will automatically trigger the transcoding pipeline."})]}),T.jsxs("div",{className:"grid gap-4 py-4",children:[T.jsxs("div",{className:"grid gap-2",children:[T.jsx(ra,{htmlFor:"title",children:"Title *"}),T.jsx(Io,{id:"title",value:g,onChange:F=>y(F.target.value),className:"bg-black/20 border-white/10",placeholder:"Enter video title",disabled:u})]}),T.jsxs("div",{className:"grid gap-2",children:[T.jsx(ra,{htmlFor:"video-file",children:"Video File *"}),T.jsx(Io,{id:"video-file",type:"file",accept:"video/*",onChange:k,className:"bg-black/20 border-white/10",disabled:u}),S&&T.jsxs("p",{className:"text-xs text-gray-400",children:["Selected: ",S.name," (",(S.size/1024/1024).toFixed(2)," MB)"]})]}),T.jsxs("div",{className:"grid gap-2",children:[T.jsx(ra,{htmlFor:"desc",children:"Description"}),T.jsx(z1,{id:"desc",value:x,onChange:F=>E(F.target.value),className:"bg-black/20 border-white/10",placeholder:"Video description...",disabled:u})]}),T.jsxs("div",{className:"grid gap-2",children:[T.jsx(ra,{htmlFor:"thumb",children:"Thumbnail URL (Optional)"}),T.jsx(Io,{id:"thumb",value:R,onChange:F=>w(F.target.value),className:"bg-black/20 border-white/10",placeholder:"https://...",disabled:u})]}),u&&T.jsxs("div",{className:"space-y-2",children:[T.jsxs("div",{className:"flex justify-between text-sm text-gray-400",children:[T.jsx("span",{children:"Upload Progress"}),T.jsxs("span",{children:[d,"%"]})]}),T.jsx("div",{className:"w-full bg-gray-800 rounded-full h-2",children:T.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${d}%`}})})]})]}),T.jsxs(Zm,{children:[T.jsx(mt,{variant:"outline",onClick:()=>t(!1),className:"border-white/10 text-white hover:bg-white/5",disabled:u,children:"Cancel"}),T.jsxs(mt,{onClick:G,className:"bg-primary hover:bg-primary/90",disabled:u,children:[u&&T.jsx(mm,{className:"w-4 h-4 mr-2 animate-spin"}),u?"Uploading...":"Upload to S3"]})]})]})]})]}),T.jsxs("div",{className:"rounded-md border border-white/10 overflow-hidden",children:[T.jsxs("div",{className:"bg-white/5 p-4 grid grid-cols-12 gap-4 text-sm font-medium text-gray-300",children:[T.jsx("div",{className:"col-span-1",children:"#"}),T.jsx("div",{className:"col-span-4",children:"Title"}),T.jsx("div",{className:"col-span-2",children:"Status"}),T.jsx("div",{className:"col-span-2",children:"Year"}),T.jsx("div",{className:"col-span-3 text-right",children:"Actions"})]}),T.jsx("div",{className:"divide-y divide-white/5",children:n.length===0?T.jsx("div",{className:"p-8 text-center text-gray-400",children:'No videos uploaded yet. Click "Upload New Video" to get started.'}):n.map((F,U)=>T.jsxs("div",{className:"p-4 grid grid-cols-12 gap-4 items-center hover:bg-white/5 transition-colors",children:[T.jsx("div",{className:"col-span-1 text-gray-500 text-sm",children:U+1}),T.jsxs("div",{className:"col-span-4 flex items-center gap-3",children:[T.jsx("div",{className:"w-16 h-10 rounded bg-gray-800 overflow-hidden shrink-0",children:F.thumbnailUrl&&T.jsx("img",{src:F.thumbnailUrl,className:"w-full h-full object-cover",alt:""})}),T.jsxs("div",{children:[T.jsx("span",{className:"text-white font-medium block truncate",children:F.title}),T.jsx("span",{className:"text-xs text-gray-500 truncate block",children:F.s3Key})]})]}),T.jsx("div",{className:"col-span-2",children:P(F.transcodeStatus)}),T.jsx("div",{className:"col-span-2 text-gray-400 text-sm",children:F.year}),T.jsxs("div",{className:"col-span-3 flex justify-end gap-2",children:[F.transcodeStatus==="pending"&&T.jsxs(mt,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary hover:bg-primary/10",onClick:()=>B(F.id),children:[T.jsx(bI,{className:"w-4 h-4 mr-1"}),"Start Transcode"]}),F.transcodeStatus==="processing"&&T.jsxs(mt,{variant:"ghost",size:"sm",className:"text-green-500 hover:text-green-400 hover:bg-green-500/10",onClick:()=>K(F.id),children:[T.jsx(ZD,{className:"w-4 h-4 mr-1"}),"Mark as Ready"]}),T.jsx(mt,{variant:"ghost",size:"icon",className:"h-8 w-8 text-blue-400 hover:text-blue-300",onClick:()=>ue(F),children:T.jsx(_I,{className:"w-4 h-4"})}),F.hlsUrl&&T.jsx(mt,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-400 hover:text-white",children:T.jsx(ya,{className:"w-4 h-4"})}),T.jsx(mt,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-400 hover:text-red-400",onClick:()=>ee(F.id),children:T.jsx(OI,{className:"w-4 h-4"})})]})]},F.id))})]}),T.jsx(MS,{open:!!_,onOpenChange:()=>D(null),children:T.jsxs(Wm,{className:"bg-card border-white/10 text-white max-w-2xl",children:[T.jsxs(Qm,{children:[T.jsx(Jm,{children:"Edit HLS URL"}),T.jsx(eg,{className:"text-gray-400",children:"Update the HLS streaming URL for this video. Make sure the URL points to your .m3u8 playlist file on CloudFront."})]}),T.jsx("div",{className:"grid gap-4 py-4",children:T.jsxs("div",{className:"grid gap-2",children:[T.jsx(ra,{htmlFor:"hls-url",children:"HLS URL (.m3u8)"}),T.jsx(Io,{id:"hls-url",value:M,onChange:F=>$(F.target.value),className:"bg-black/20 border-white/10 font-mono text-sm",placeholder:"https://d2mcz61iafdmct.cloudfront.net/assets/..."}),T.jsx("p",{className:"text-xs text-gray-500",children:"Example: https://d2mcz61iafdmct.cloudfront.net/assets/khalifa/HLS/khalifa.m3u8"})]})}),T.jsxs(Zm,{children:[T.jsx(mt,{variant:"outline",onClick:()=>D(null),className:"border-white/10 text-white hover:bg-white/5",children:"Cancel"}),T.jsx(mt,{onClick:ne,className:"bg-primary hover:bg-primary/90",children:"Save URL"})]})]})})]})})}function Fj(){const[s,e]=A.useState(!0),[t,n]=A.useState(null);A.useEffect(()=>{r()},[]);const r=async()=>{try{const l=await fetch("/api/aws-status");if(l.ok){const u=await l.json();n(u)}}catch(l){console.error("Failed to load AWS status:",l)}finally{e(!1)}};if(s)return T.jsx(Wo,{children:T.jsx("div",{className:"flex items-center justify-center h-96",children:T.jsx(mm,{className:"w-8 h-8 animate-spin text-primary"})})});const o=t?.configured||!1;return T.jsx(Wo,{children:T.jsxs("div",{className:"space-y-8 max-w-4xl",children:[T.jsxs("div",{children:[T.jsx("h1",{className:"text-3xl font-bold text-white",children:"AWS Configuration"}),T.jsx("p",{className:"text-gray-400 mt-2",children:"View your AWS connection status and configuration."})]}),T.jsxs(js,{className:"bg-card border-white/10",children:[T.jsx(Ri,{children:T.jsx("div",{className:"flex items-center justify-between",children:T.jsxs("div",{children:[T.jsxs(Li,{className:"text-white flex items-center gap-2",children:["AWS Service Status",o?T.jsxs(tg,{className:"bg-green-500/20 text-green-400 border-green-500/30",children:[T.jsx(WD,{className:"w-3 h-3 mr-1"}),"Connected"]}):T.jsxs(tg,{className:"bg-red-500/20 text-red-400 border-red-500/30",children:[T.jsx(eI,{className:"w-3 h-3 mr-1"}),"Not Configured"]})]}),T.jsx(_o,{className:"text-gray-400 mt-2",children:o?"AWS services are configured and ready for video uploads and streaming.":"AWS credentials need to be configured via Replit Secrets."})]})})}),T.jsx(Gs,{children:!o&&T.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 space-y-3",children:T.jsxs("div",{className:"flex items-start gap-2",children:[T.jsx(wT,{className:"w-5 h-5 text-yellow-400 mt-0.5"}),T.jsxs("div",{className:"flex-1",children:[T.jsx("h4",{className:"font-semibold text-yellow-400 mb-2",children:"AWS Configuration Required"}),T.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"To enable video uploads and streaming, add the following secrets in the Replit Secrets panel:"}),T.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-yellow-400 font-mono",children:""}),T.jsxs("span",{children:[T.jsx("strong",{className:"font-mono",children:"AWS_ACCESS_KEY_ID"})," - Your AWS access key"]})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-yellow-400 font-mono",children:""}),T.jsxs("span",{children:[T.jsx("strong",{className:"font-mono",children:"AWS_SECRET_ACCESS_KEY"})," - Your AWS secret key"]})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-yellow-400 font-mono",children:""}),T.jsxs("span",{children:[T.jsx("strong",{className:"font-mono",children:"AWS_REGION"})," - AWS region (e.g., us-east-1)"]})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-yellow-400 font-mono",children:""}),T.jsxs("span",{children:[T.jsx("strong",{className:"font-mono",children:"AWS_S3_BUCKET_NAME"})," - Your S3 bucket name"]})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-yellow-400 font-mono",children:""}),T.jsxs("span",{children:[T.jsx("strong",{className:"font-mono",children:"AWS_CLOUDFRONT_DOMAIN"})," - CloudFront domain (e.g., d2mcz61iafdmct.cloudfront.net)"]})]})]}),T.jsx("p",{className:"text-sm text-gray-400 mt-3",children:"After adding these secrets, restart the application for the changes to take effect."})]})]})})})]}),o&&t&&T.jsxs(T.Fragment,{children:[T.jsxs(js,{className:"bg-card border-white/10",children:[T.jsxs(Ri,{children:[T.jsx(Li,{className:"text-white",children:"S3 Bucket Configuration"}),T.jsx(_o,{className:"text-gray-400",children:"Your S3 bucket stores uploaded videos and triggers Lambda transcoding."})]}),T.jsxs(Gs,{className:"space-y-3",children:[T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Bucket Name"}),T.jsx("p",{className:"text-white font-mono",children:t.bucketName})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Region"}),T.jsx("p",{className:"text-white font-mono",children:t.region})]})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Access Key ID"}),T.jsx("p",{className:"text-white font-mono",children:t.accessKeyId})]})]})]}),T.jsxs(js,{className:"bg-card border-white/10",children:[T.jsxs(Ri,{children:[T.jsx(Li,{className:"text-white",children:"CloudFront Distribution"}),T.jsx(_o,{className:"text-gray-400",children:"Videos are delivered via CloudFront for optimal streaming performance."})]}),T.jsxs(Gs,{children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Domain"}),T.jsx("p",{className:"text-white font-mono",children:t.cloudfrontDomain})]}),T.jsx("div",{className:"mt-4 bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:T.jsxs("p",{className:"text-sm text-gray-300",children:[T.jsx("strong",{className:"text-blue-400",children:"HLS URL Pattern:"}),T.jsx("br",{}),T.jsxs("span",{className:"font-mono text-xs",children:["https://",t.cloudfrontDomain,"/assets/[video-id]/HLS/[filename].m3u8"]})]})})]})]}),T.jsxs(js,{className:"bg-card border-white/10",children:[T.jsxs(Ri,{children:[T.jsx(Li,{className:"text-white",children:"Video Processing Workflow"}),T.jsx(_o,{className:"text-gray-400",children:"Automated adaptive bitrate transcoding via AWS Lambda."})]}),T.jsx(Gs,{children:T.jsxs("div",{className:"space-y-3",children:[T.jsxs("div",{className:"flex items-start gap-3",children:[T.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:T.jsx("span",{className:"text-primary font-bold",children:"1"})}),T.jsxs("div",{className:"flex-1",children:[T.jsx("p",{className:"text-white font-medium",children:"Upload to S3"}),T.jsxs("p",{className:"text-sm text-gray-400",children:["Videos uploaded to ",T.jsx("span",{className:"font-mono",children:"inputs/[video-id]/[filename]"})]})]})]}),T.jsxs("div",{className:"flex items-start gap-3",children:[T.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:T.jsx("span",{className:"text-primary font-bold",children:"2"})}),T.jsxs("div",{className:"flex-1",children:[T.jsx("p",{className:"text-white font-medium",children:"Lambda Triggers MediaConvert"}),T.jsx("p",{className:"text-sm text-gray-400",children:"Automatic transcoding to adaptive bitrate HLS (1080p, 720p, 480p, 360p, 240p)"})]})]}),T.jsxs("div",{className:"flex items-start gap-3",children:[T.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:T.jsx("span",{className:"text-primary font-bold",children:"3"})}),T.jsxs("div",{className:"flex-1",children:[T.jsx("p",{className:"text-white font-medium",children:"Output to CloudFront"}),T.jsx("p",{className:"text-sm text-gray-400",children:"HLS manifests served via CloudFront for adaptive streaming"})]})]})]})})]})]})]})})}function Uj(){return T.jsxs(uw,{children:[T.jsx(es,{path:"/",component:Lo}),T.jsx(es,{path:"/watch/:id",component:sj}),T.jsx(es,{path:"/admin",component:rj}),T.jsx(es,{path:"/admin/media",component:Pj}),T.jsx(es,{path:"/admin/settings",component:Fj}),T.jsx(es,{path:"/series",component:Lo}),T.jsx(es,{path:"/movies",component:Lo}),T.jsx(es,{path:"/new",component:Lo}),T.jsx(es,{path:"/my-list",component:Lo}),T.jsx(es,{component:bm})]})}function Bj(){return T.jsx(Nw,{client:Fw,children:T.jsx(NN,{children:T.jsxs(ON,{children:[T.jsx(bO,{}),T.jsx(Uj,{})]})})})}$_.createRoot(document.getElementById("root")).render(T.jsx(Bj,{}));
